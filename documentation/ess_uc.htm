<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Valerie Johnson">
   <meta name="GENERATOR" content="Microsoft FrontPage 4.0">
   <title>RC Model</title>
</head>
<body>

<h3>
UltraCap <b>Model</b></h3>
<b><u>Role of subsystem in vehicle</u></b>
<br>The Energy Storage System (ESS) block typically represents the battery pack that
stores energy on board the modeled vehicle, but in this case the block
represents the ultracapacitor pack that replaces the traditional battery pack.&nbsp; This block accepts a
power request and returns available/actual power output from the ultracapacitor
pack,
the ultracapacitor pack voltage and current, and the ultracapacitor State of Charge (SOC).&nbsp;
By convention, positive power is discharge.<p><b><u>Description of modeling approach</u></b>
<br>ADVISOR's UltraCap model is shown in circuit form in Figure 1. The UltraCap model
uses power as an input and limits the ultracapacitor operation to the high and
low voltage limits.&nbsp; Power delivered by the ultracapacitor is limited to
the maximum that the equivalent circuit can deliver or the maximum that
the motor controller can accept, given its minimum voltage requirement.&nbsp;
However, since the lower voltage limit for an ultracapacitor is 0V, discharge
limiting can also be accomplished by the powertrain control system based on the
&quot;cs_lo_soc&quot; value.&nbsp;
A simple single-node thermal model of the ultracapacitor is implemented with parallel
flow air cooling.&nbsp; More detail can be found in the <a href="ess_therm.htm">battery/ultracapacitor
thermal model explanation</a>.
<p>The capacitor C is very large and is the means through which the ultracapacitor stores charge.
<center>
<p><img SRC="ImageUC.gif">
<p><img SRC="Image109.gif" height=204 width=534>
<p><b>Figure 1: ADVISOR UltraCap Model</b>
<p></center>
&nbsp;
<b><u>Variables used in subsystem</u></b>
<blockquote><a href="advisor_appendices.htm#Input Energy Storage System UC">See
Appendix A.2: Input Variables</a></blockquote>
<b><u>Implementation</u></b>
<br>The UltraCap model is implemented in Matlab/Simulink blocks.&nbsp; The model
limits power to keep the ultracapacitor within
operating limits, and calculates SOC and heat generation from the ultracapacitor.
The block diagram implementation of the model is shown in Figure 2.&nbsp; A
step-by-step explanation follows.
<p align="center"><img SRC="ImageUC2.gif"><center><b><br>
Figure 2: Block Diagram implementation of UltraCap model</b></center>

<ol>
<li>
The ultracapacitor <u> voltage is determined</u> from the present SOC by the
relationship shown in Equation 1.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<img SRC="ImageUC3.gif"><b>Equation 1<br>
<br>
</b></li>

<li>
The set of parameters--Voc, R, and actual Power--are the variables of
a quadratic equation to solve for the equivalent circuit's <u>current</u>.&nbsp;
The total <u>current that the battery can deliver</u> is limited to be in an
allowable range.</li>

<li>
The ultracapacitor current is then used to update the effective <u>SOC</u> of
the ultracapacitor .</li>

<li>
The thermal model of the ultracapacitor calculates the module temperature, which
is fed back to be used in determining the performance parameters.</li>

</ol>

<p>Lastly, in using the UltraCap Model, a new functionality is added which
allows the user to add parallel strings of ultracapacitors.&nbsp; This is
accomplished by changing the variable 'ess_parallel_mod_num' to the integer
value of strings that would be placed in parallel.&nbsp; This enables the
construction of a higher capacity (Ah) ultracapacitor pack.&nbsp; The total
number of ultracapacitors in use is then calculated by ess_module_num*ess_parallel_mod_num.</p>

<p><b><u>Parameter Generation</u></b>
<br>Parameter values were determined from analyzing laboratory data according to
the U.S. DOE Electric Vehicle Capacitor Test Procedure Manual Revision 0.&nbsp;
Parameters were generated for various temperatures and charge/discharge current
values.&nbsp; The specific test used for determining capacitance and resistance
is a constant current charge-discharge cycle that is repeated 3 consecutive
times with the voltage held at Vmax and Vmin for 10 seconds in between
charges/discharges.&nbsp; The current, voltage and Ah values from one charge-discharge cycle
in a representative test can be seen in Figure 3.<p align="center"><img border="0" src="ImageUC4.gif"><center><b><br>
Figure 3: Current, Voltage and Ah data used to determine ultacapacitor's C
and R values</b></center>

<p><u> Capacitor, C</u>
<br>The capacitor value in the DOE manual is determined by using Equation 2, Vw
is the &quot;working voltage&quot; or the maximum voltage.&nbsp; However, this
equation only takes into account the charge added to the ultracapacitor during
the constant current portion of the charge.&nbsp; Therefore, the resulting
capacitance that is calculated using this value has a Peukert type of relation
that noticeably varies with current rate.&nbsp; For the UltraCap model the
desired capacitance is the total capacitance so that the model can determine
when the current output should be reduced due to reaching a voltage limit.
<center>
<p><b><img border="0" src="ImageUC5.gif">Equation 2</b></center>

<p>Instead of using Equation 2 in the UltraCap model, Equation 3 is used to
determine the total charge into and out of the ultracapacitor (including the
tapered current that tops off the charge to Vmax or levels off the discharge to
0V) by using the total Amp-Second integration (total Coulomb charge/discharge)
over the test.

<p align="center"><img border="0" src="ImageUC6.gif"><b>Equation 3</b><p><u>Resistance,
R</u>
<br>
Resistance values are determined during the same test at the beginning of a
charge or discharge.&nbsp; Figure 4 shows the delta V that would be used in
Equation 4 to determine the discharge resistance for the specified current used
during this test.&nbsp; The difficulty with this procedure is determining at
what point the &quot;immediate&quot; drop in voltage ends and the sloped voltage
drop begins.&nbsp; However, validation tests have resulted in percent voltage
error typically less than 5%.
<center>
<p><img border="0" src="ImageUC7.gif"><br>
<b>Figure 4: Drop in voltage immediately after the beginning of discharge</b><p><b><img border="0" src="ImageUC8.gif">Equation
4</b><p></center>
<hr SIZE=5 NOSHADE WIDTH="100%">
<center><a href="advisor_ch3.htm">Back to Chapter 3</a></center>

<p>Last Revised: 4/29/02: mdz
</body>
</html>
