<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Configurable Subsystem Blocks in ADVISOR</title>
</head>

<body>

<h1>Configurable Subsystem Blocks in ADVISOR</h1>
<hr>
<h2><a name="TOC">Contents</a></h2>
<ol>
  <li><a href="#Introduction to Configurable Subsystems">Introduction to Configurable Subsystems</a></li>
  <li><a href="#Usage of Configurable Subsystems in ADVISOR">Usage of Configurable Subsystems in ADVISOR</a></li>
  <li><a href="#Adding User Models">Adding User Models</a></li>
  <li><a href="#A Listing of Configurable Subsystems">A Listing of Configurable Subsystems</a></li>
  <li><a href="#Other References">Other References</a></li>
  <li><a href="advisor_doc.htm">Return to Main Documentation</a></li>
</ol>
<hr>
<a name="Introduction to Configurable Subsystems">
<h2>Introduction to Configurable Subsystems</h2>
</a>
<p>Configurable subsystems add a powerful new dimension to modeling in Simulink. The configurable subsystem allows models with the same "interface" (i.e., the same basic structure in terms of input and output ports)
to be switched in and out of the model (i.e., configured) with ease. Whereas previously in ADVISOR, specific powertrain configurations were 
created each time a new model was added, a configurable subsystem allows the flexibility of keeping the same overall drivetrain structure
with the ability to choose specific models to be used.

<p>For example, in earlier ADVISOR implementations, the inclusion of a new ultracapacitor battery model would facilitate a separate block-diagram file for
each drivetrain. Thus, the block-diagram for a parallel hybrid drivetrain using an internal resistance model would need to be modified and resaved with
the new ultracapacitor model. Alternately, all models would need to be included at the same time with switches to vary which model is used.

<p>With configurable subsystems, however, the user merely indicates which model to use and that model is "switched into" the current block diagram. Using our previous example,
the user can simply select between the internal resistance energy storage model and the ultracapacitor model using a pull-down menu.

<p>This functionality is demonstrated <a href="#bd_config_eg">below</a>. In this
diagram, the BD_PAR.mdl, the user is selecting between different vehicle control
models (which are ultimately contained in lib_controls.mdl). As one can see, the
&quot;electric assist control strategy &lt;cs&gt;&quot; block is also
configurable, as designated by the icon in the lower left-hand corner of the
block icon.

<p>&nbsp;
<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="1" width="100%">
    <tr>
      <td width="100%"><b><a name="bd_config_eg">Configurable Subsystem Example</a></b><br>
      <small>This figure shows a configurable subsystem being selected directly from the Simulink block diagram of the parallel hybrid
      vehicle drivetrain in ADVISOR (BD_PAR.mdl in the &lt;ADVISOR&gt;/models directory).</small></td>
    </tr>
    <tr>
      <td width="100%"><img border="0" src="configurable01a.gif" width="957" height="488"></td>
    </tr>
  </table>
  </center>
</div>

<p>

The configurable subsystem is facilitated by the Simulink configurable subsystem
library block as shown <a href="#config_sim_lib">below</a>.

<p>

&nbsp;
<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="1" width="100%">
    <tr>
      <td width="100%"><b><a name="config_sim_lib">Configurable Subsystem Block</a></b><br>
      <small>Configurable subsystems are created by placing the Simulink Configurable Subsystem Block into a library containing
      the models to be configured.</small></td>
    </tr>
    <tr>
      <td width="100%"><img border="0" src="configurable02.gif" width="520" height="445"></td>
    </tr>
  </table>
  </center>
</div>

<p>Within a model library, the available choices for configurable subsystem models are facilitated using the Simulink configurable subsystem
block. Consider the example seen in the <a href="#config_sub_block_setup">figure below</a> (taken from lib_accessory.mdl in &lt;ADV&gt;/models/library). The block with the blue
outline (the configurable subsystem template) is the Simulink configurable subsystem block (with an icon added to it). The remaining six
blocks all implement the same input/output port combinations and signal widths. These remaining six blocks at the bottom of the picture are
configurable subsystem models. They are linked into the Simulink configurable subystem block by right clicking on the block and checking the models
that apply.
<p>

&nbsp;

<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="1" width="100%">
    <tr>
      <td width="100%"><b><a name="config_sub_block_setup">Configurable Subsystem Block Setup</a>
</b><br>
        <small>The figure below is taken from lib_accessory.mdl. The block
        outlined in blue is the configurable subsystem template. These template
        blocks are the ones actually used in the driveline models (such as
        BD_PAR.mdl). By right clicking on the template block, the six models
        which we would like to link in as being configurable can be selected. In
        general, configurable subsystem models should implement the same basic
        input/output port interface (i.e., consistent with the number, signal
        width, and units of input ports and output ports). However, signal input
        and output ports can be dummy values if they are unused by a specific
        model.</small></td>
    </tr>
    <tr>
      <td width="100%"><img border="0" src="configurable03.gif" width="432" height="481"></td>
    </tr>
  </table>
  </center>
</div>
<p align="center"><a href="#TOC">&gt;&gt;&gt; back to table of contents &lt;&lt;&lt;</a></p>

<a name="Usage of Configurable Subsystems in ADVISOR">
<h2>Usage of Configurable Subsystems in ADVISOR</h2>
</a>
 <p>So how are these configurable subsystems used within ADVISOR? First of all, the user is not expected to open the block diagrams and select
 which configurable subsystems they would like to use before a run. This is done automatically through an m-file called adjust_config_bds.m.
 
 <p>The m-file adjust_config_bds.m uses <a href="version_type_help.htm">version and type</a> and other initialization variables as a means of determining which configurable subsystem models 
 should be used. Thus, when the user finishes setting up their vehicle and hits the run button, the drivetrain block diagram is opened (without
 making the window visible) and all of the appropriate configurable subsystems are chosen just as if the user had opened the block diagram and set the "block_choice" option
 themselves.
 
 <p>It is important to note that even if a user opens a simulink block diagram and changes the block choice on a configurable subsystem, this change will be
 usurped by adjust_config_bds.m because this file is run immediately before the block diagram is executed--thus ensuring that the required changes take place. Therefore, the user
 should feel free to examine the block diagrams and models in configurable subsystems and rest assured that the seetings within the GUI will be
 used when the GUI or m-file system (e.g., adv_no_gui.m) is used to execute advisor.
 
 <p>See the file adjust_config_bds.m for more information.
 
 <p align="center"><a href="#TOC">&gt;&gt;&gt; back to table of contents &lt;&lt;&lt;</a></p>

<a name="Adding User Models">
<h2>Adding User Models</h2>
</a>

<p>Users may wish to incorporate their own models into ADVISOR's configurable subsystem interface.
This is a relatively straightforward process involving the following:</P>

<ol>
  <li><b>Creation of the New Model:</b> Make sure to adhere to the input/output
    interface of the existing configurable subsystem. Also, it is sometimes
    easiest to copy an existing model and change the inner workings of that
    model vs. creating a model from scratch.</li>
  <li><b>Add the New Model to the Template:</b> Be sure that the new model is
    present in the same library file as the other configurable models and the
    Simulink configurable subsystem template (note: configurable subsystem
    templates and models must reside in a common library). Right click on the
    template and a listing of all of the block models on the same level as the
    template will appear. Activate the checkbox next to your new model.</li>
  <li><b>Update adjust_config_bds.m:</b> Once all the above steps have been taken, the user should update
    adjust_config_bds.m (type 'edit adjust_config_bds.m' at the command line). As a precaution, 
  the user may wish to create a backup of the original adjust_config_bds.m. Within, adjust_config_bds.m, you will notice a switch...case routine.
  Add your model's name (exactly as it appears in the model library) to the listing of possible models. Next update the logic
    within the case body if necessary.

</ol>
<p>That's all there is to it!&nbsp; 
<p align="center"><a href="#TOC">&gt;&gt;&gt; back to table of contents &lt;&lt;&lt;</a></p>

<a name="A Listing of Configurable Subsystems">
<h2>A Listing of Configurable Subsystems</h2>
</a>

<p>The table below lists the currently available configurable subsystems:
<div align="center">
  <center>
  <table border="1" cellpadding="0" cellspacing="1" width="100%">
    <tr>
      <th width="50%" bgcolor="#FFCCCC">Configurable Subsystem Template Name [library]</th>
      <th width="50%" bgcolor="#FFCCCC">Available Models</th>
    </tr>
    <tr>
      <td width="50%" rowspan="2" bgcolor="#99CCFF">rolling resistance force [lib_vehicle\submodel]</td>
      <td width="50%" bgcolor="#99CCFF">force req'd to overcome rolling resistance (N)</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">force req'd to overcome rolling resistance (N) j2452</td>
    </tr>
    <tr>
      <td width="50%" rowspan="2">vehicle speed [lib_vehicle\submodel]</td>
      <td width="50%">vehicle speed (m/s)</td>
    </tr>
    <tr>

      <td width="50%">vehicle speed (m/s) j2452</td>
    </tr>
    <tr>
      <td width="50%" rowspan="2" bgcolor="#99CCFF">roll res interactive [lib_interactive\Sub-model
        Library]</td>
      <td width="50%" bgcolor="#99CCFF">roll res force req (N)</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">roll res force req (N) j2452</td>
    </tr>
    <tr>
      <td width="50%" rowspan="2">config traction control [lib_controls\SubSystem]</td>
      <td width="50%">traction control</td>
    </tr>
    <tr>
      <td width="50%">traction control J2452</td>
    </tr>
    <tr>
      <td width="50%" rowspan="2" bgcolor="#99CCFF">electrical accessories (W) [lib_accessory.mdl]</td>
      <td width="50%" bgcolor="#99CCFF">Electrical Accessories: Constant</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">Electrical Accessories: Time Variable</td>
    </tr>
    <tr>
      <td width="50%" rowspan="6">mechanical accessories (Nm) [lib_accessory.mdl]</td>
      <td width="50%">Mechanical Accessories: Const Mech Var Elect</td>
    </tr>
    <tr>
      <td width="50%">Mechanical Accessories: Constant Mechanical &amp; Electrical</td>
    </tr>
    <tr>
      <td width="50%">Mechanical Accessories: Speed Dependant and Variable Electrical</td>
    </tr>
    <tr>
      <td width="50%">Saber Dual Voltage Cosim</td>
    </tr>
    <tr>
      <td width="50%">Saber Single Voltage Cosim</td>
    </tr>
    <tr>
      <td width="50%">SindaTransAC</td>
    </tr>
    <tr>
      <td width="50%" rowspan="3" bgcolor="#99CCFF">Series Cosim [lib_cosimulation.mdl]</td>
      <td width="50%" bgcolor="#99CCFF">Series Saber Cosim</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">Series Simplorer Cosim</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">Series Saber Cosim Text File Exchange</td>
    </tr>
    <tr>
      <td width="50%" rowspan="7">ess config [lib_energy_storage\Ess Choices]</td>
      <td width="50%">Ultracapacitor  System</td>
    </tr>
    <tr>
      <td width="50%">energy storage &lt;ess></td>
    </tr>
    <tr>
      <td width="50%">energy storage &lt;ess> RC</td>
    </tr>
    <tr>
      <td width="50%">energy storage &lt;ess> nnet</td>
    </tr>
    <tr>
      <td width="50%">energy storage &lt;ess> Saber</td>
    </tr>
    <tr>
      <td width="50%">energy storage &lt;ess> fundamental model</td>
    </tr>
    <tr>
      <td width="50%">energy storage &lt;ess> optima fundamental model</td>
    </tr>
    <tr>
      <td width="50%" rowspan="2" bgcolor="#99CCFF">fuel use and EO emis Configurable Subsystem
        [lib_fuel_converter\configurabele subsystems]</td>
      <td width="50%" bgcolor="#99CCFF">fuel use and EO emis</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">fuel use and EO emis Neural Network Model</td>
    </tr>
    <tr>
      <td width="50%" rowspan="5">par &lt;cs> config [lib_controls.mdl]</td>
      <td width="50%">Adaptive control strategy &lt;cs></td>
    </tr>
    <tr>
      <td width="50%">Fuzzy Logic control strategy &lt;cs></td>
    </tr>
    <tr>
      <td width="50%">Fuzzy Logic control strategy with Emissions &lt;cs></td>
    </tr>
    <tr>
      <td width="50%">electric assist control strategy &lt;cs></td>
    </tr>
    <tr>
      <td width="50%">electric assist control strategy bal &lt;cs></td>
    </tr>
    <tr>
      <td width="50%" rowspan="3" bgcolor="#99CCFF">par &lt;vc> config [lib_controls.mdl]</td>
      <td width="50%" bgcolor="#99CCFF">&lt;vc> par</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">&lt;vc> par Adaptive</td>
    </tr>
    <tr>
      <td width="50%" bgcolor="#99CCFF">&lt;vc> par balanced</td>
    </tr>
    <tr>
      <td width="50%" rowspan="3">fuel cell config [lib_fuel_cell.mdl]</td>
      <td width="50%">fuel converter &lt;fc> GCTool linkage</td>
    </tr>
    <tr>
      <td width="50%">fuel converter &lt;fc> net model</td>
    </tr>
    <tr>
      <td width="50%">fuel converter &lt;fc> polarization curve model</td>
    </tr>
  </table>
  </center>
</div>


<p align="center"><a href="#TOC">&gt;&gt;&gt; back to table of contents &lt;&lt;&lt;</a></p>



<a name="Other References">
<h2>Other References</h2>
</a>

<dl>
<dt>Documentation from The Mathworks</dt>
<dd>For more information on configurable subsystems, please check your Matlab/Simulink documentation or search the online archive of <a href="http://www.mathworks.com">the Mathworks</a></dd>
<dt>Documentation specifics on the Accessory Library</dt>
<dd>See also <a href="accessory_models2002.html">documentation</a> on the lib_accessory.mdl library model for accessories. This contains information pertinent to accessory systems</dd>
</dl>
<p align="center"><a href="#TOC">&gt;&gt;&gt; back to table of contents &lt;&lt;&lt;</a></p>

<hr>
<p align="center"><a href="advisor_doc.htm">Return to Main Documentation</a></p>
<hr>
<p>Created: [2002-04-30] mpo<br>
Last Modified: NA</p>

</body>

</html>
