<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="VHJ">
   <meta name="GENERATOR" content="Mozilla/4.5 [en] (WinNT; I) [Netscape]">
   <title>Rint Model</title>
</head>
<body>

<h3>
<b>Rint Battery Model</b></h3>
<a href="ess_update.html">Battery Model Update Impacts</a>
<p><b><u>Role of subsystem in vehicle</u></b>
<br>The Energy Storage System (ESS) block represents the battery pack that
stores energy on board the modeled vehicle.&nbsp; This block accepts a
power request, usually from the power bus, and returns available/actual
power output from the battery, the battery voltage and current, and the
battery <a href="glossary.htm#SOC">State of Charge (SOC)</a>.&nbsp; By
convention, positive power is discharge.
<p><b><u>Description of modeling approach</u></b>
<br>The ESS block models the battery pack as a charge reservoir and an
equivalent circuit whose parameters are a function of the remaining charge
in the reservoir.&nbsp; The equivalent circuit accounts for the circuit
parameters of the battery pack as if it were a perfect <a href="glossary.htm#O">open
circuit voltage</a> source in series with an <a href="glossary.htm#I">internal
resistance</a>.&nbsp;&nbsp; The amount of charge that the ESS can hold
is taken as constant, and the battery is subject to a minimum voltage limit.&nbsp;
The amount of charge that is required to replenish the battery after discharge
is affected by <a href="glossary.htm#Coulombic efficiency">coulombic efficiency</a>.&nbsp;
The charging of the battery is limited by a maximum battery voltage.&nbsp;
While the battery is treated as a perfect electrical voltage source with
a known resistance, the components to which the battery would be connected,
such as a motor or a generator, are treated as power sources or sinks.&nbsp;
Power delivered by the battery is limited to the maximum that the equivalent
circuit can deliver or the maximum that the motor controller can accept,
given its minimum voltage requirement.
<p>Other relevant glossary terms include: <a href="glossary.htm#C">Capacity</a>,
<a href="glossary.htm#R">Rated
Capacity</a>, <a href="glossary.htm#CNrate">C/N rate,</a> <a href="glossary.htm#N">N
hour rate</a>, and <a href="glossary.htm#Peukert's Equation">Peukert's
equation</a>.
<p>A simple single-node thermal model of the battery is implemented with
parallel flow air cooling.&nbsp; More detail can be found in the <a href="ess_therm.htm">battery
thermal model explanation</a>.
<p><b><u>Variables used in subsystem</u></b>
<blockquote><a href="advisor_appendices.htm#Input Energy Storage System">See
Appendix A.2: Input Variables</a>
<br><a href="advisor_appendices.htm#Output Energy Storage System">See Appendix
A.3: Output Variables</a></blockquote>
<b><u>Implementation</u></b>
<p><b>Energy Storage System (Top level)</b>
<p>As described above, the energy storage model computes the battery SOC
in response to the requirements of the power bus and outputs the available
power.&nbsp; Power loss is computed as I<sup>2</sup>R losses plus losses
due to Coulombic (in)efficiency.&nbsp; A step-by-step explanation follows.
<center>
<p><img SRC="energy_storage.gif" height=429 width=683></center>

<ol>
<li>
The battery is modeled as an equivalent circuit comprising a perfect open
circuit voltage source (<a href="glossary.htm#O">Voc</a>) in series with
an effective internal resistance (<a href="glossary.htm#I">Rint</a>).&nbsp;
Voc and Rint are computed as piecewise linear functions of SOC. There are
two such functions for computing Rint, one for discharge power and another
for charge power.</li>

<li>
The total <u>power that the battery can deliver</u> is limited to be in
an allowable range.</li>

<li>
The set of parameters--Voc, Rint, and actual Power--are the variables of
a quadratic equation to solve for equivalent circuit's <u>current</u>.</li>

<li>
The battery current is then used to update the effective <u>SOC</u> of
the battery.</li>

<li>
The thermal model of the battery calculates the module temperature, which
is fed back to be used in determining the performance parameters.</li>
</ol>
Each of these sub-blocks is explained below.
<p><b>1. Pack Open Circuit Voltage and Internal Resistance:</b> This block
calculates Voc and Rint given the current SOC and required battery power.
<center>
<p><img SRC="VOC.jpg" height=314 width=496></center>

<ol>
<li>
Interpolated lookup tables for open circuit voltage (Voc) and the charging
and discharging resistance are used to determine these parameters as functions
of SOC and the module temperature.</li>

<li>
The appropriate resistance is chosen, based on whether the power requirement
is to charge (negative power) or discharge (positive power) the battery.</li>

<li>
The two parameters are scaled by the number of battery modules in series.</li>
</ol>

<p><br><b>2. Limit Power: </b>This block prevents the power that is used
to compute the battery current from exceeding limits imposed by three limits:
SOC, equivalent circuit parameters, and the motor controller’s minimum
allowable voltage.
<center>
<p><img SRC="limit_power.jpg" BORDER=0 height=461 width=911></center>

<ol>
<li>
If an attempt is made to draw power from a depleted battery, the power
request is limited to zero.</li>

<li>
The maximum power available from the battery is limited by three parameters,
all related to the available voltage.&nbsp; The operating voltage cannot
drop below either the motor's minimum voltage or the battery's minimum
voltage.&nbsp; If neither of these limits are exceeded, the maximum power
available will be observed when the voltage is equal to Voc/2.</li>

<li>
The maximum power limit is calculated, according to the formula:<img SRC="maxpower.gif" height=41 width=149>&nbsp;
where Vbus is either Voc/2, the minimum motor controller voltage, or the
minimum battery voltage, whichever is larger.</li>
</ol>

<p><br><b>3. Compute Current: </b>This block solves the quadratic equation
for current that is derived by starting with the definition of electrical
power and Kirchoff’s voltage law (KVL) for the equivalent circuit shown
below.
<blockquote>
<blockquote>
<blockquote><i>Block Diagram</i></blockquote>
</blockquote>
</blockquote>

<blockquote>
<ol>
<blockquote><img SRC="v,current.jpg" height=392 width=833>
<p><i>Equivalent Circuit</i>
<br><img SRC="circuit.jpg" height=155 width=557></blockquote>

<li>
<u>Current</u> is determined.&nbsp; Power is defined as: <i>P=V x I</i>,
or <i>V=P/I</i>.&nbsp; Combining the power equation with KVL yields: <i>P/I=Voc-(R
x I)</i>.&nbsp; Multiplying both sides of the equation by I yields <i>P
= (Voc x I) - RI<sup>2</sup></i> .&nbsp; This is the equation that is solved
in the block diagram: <i>RI<sup>2</sup> - (Voc x I) + P = 0</i>.&nbsp;
There are actually two solutions for this equation, but the larger solution
is not considered because it would require larger current, and thus a lower
terminal voltage, to produce the same power. All solutions that require
a terminal (or bus) voltage less than half the battery’s open circuit voltage
are thus not considered.&nbsp; During charge, the maximum voltage must
not be exceeded.&nbsp; This maximum charge current (or minimum raw value
of current since charging is a negative current) is found from <i>I=(Voc-Vmax)/R</i>.</li>

<li>
<u>Bus voltage</u> is determined.&nbsp; Kirchoff's voltage law, applied
along the equivalent circuit loop, requires that: <i>V=Voc-(RxI).</i></li>
</ol>
</blockquote>

<p><br><b>4. SOC algorithm: </b>The state of charge (SOC) algorithm in
ADVISOR is responsible for determining the residual capacity, in units
of Amp-hours (charge), that remains available for discharge from the battery.
It approximates this value in a series of steps.&nbsp; Note that the coulombic
efficiency and maximum capacity are functions of temperature.
<center>
<p><img SRC="SOC.jpg" height=207 width=757></center>

<ol>
<li>
The sum of all discharging current and all charging current (scaled by
an estimate of average coulombic efficiency) determines an <u>effective
total Ah change</u> in the battery since the beginning of the simulation.</li>

<li>
The initial SOC is accounted for by taking having a non-zero initial A-h
used.</li>

<li>
The SOC is calculated by using the equation: <i>SOC=(Max Capacity-Ah used)/Max
Capacity</i>.</li>
</ol>
<b>5. Thermal model:</b> A simple, single-node lumped-parameter thermal
model was added to the ESS (energy storage system) sub-block of the ADVISOR.
This thermal model predicts the average internal battery temperature and
surface (case) temperature as a function of time while the vehicle is driven
and during soak periods. Currently there is only one cooling option: parallel-flow
air cooling (each module has the same air flow and inlet air temperature,
which are specified by the user).&nbsp; See the <a href="ess_therm.htm">battery
thermal model explanation</a> for more details.
<center><img SRC="ess_therm.jpg" height=259 width=503></center>

<hr SIZE=5 NOSHADE WIDTH="100%">
<center><a href="advisor_ch3.htm">Back to Chapter 3</a></center>

<p>Last Revised: 5/29/01: vhj
</body>
</html>
