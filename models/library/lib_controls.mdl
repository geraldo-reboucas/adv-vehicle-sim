Library {
  Name			  "lib_controls"
  Version		  4.1.1
  LibraryLinkDisplay	  "all"
  CovSaveName		  "covdata"
  CovMetricSettings	  "dw"
  CovNameIncrementing	  off
  CovHtmlReporting	  on
  BlockNameDataTip	  off
  BlockParametersDataTip  off
  BlockDescriptionStringDataTip	off
  ToolBar		  on
  StatusBar		  off
  BrowserShowLibraryLinks on
  BrowserLookUnderMasks	  off
  Created		  "Tue May 30 16:47:17 2000"
  UpdateHistory		  "UpdateHistoryWhenSave"
  ModifiedByFormat	  "%<Auto>"
  LastModifiedBy	  "ssprik"
  ModifiedDateFormat	  "%<Auto>"
  LastModifiedDate	  "Fri Oct 10 08:40:34 2003"
  ModifiedComment	  "ssprik -- Fri Oct 10 08:40:34 2003 -- Version 1.473"
"\nadded goto tag for F_rear_brake_req"
  ModifiedHistory	  "ssprik -- Fri Oct 10 08:40:34 2003 -- Version 1.473"
"\nadded goto tag for F_rear_brake_req\n\nssprik -- Thu Oct 09 15:11:40 2003 -"
"- Version 1.472\nadded F_rear_brake_req   goto \n\ntmarkel -- Fri Mar 07 09:5"
"3:07 2003 -- Version 1.471\n\nadded logic to allow user to keep the engine on"
" during a drive cycle unless the key if off or the engine has been manually d"
"isabled\n\ntmarkel -- Fri Mar 07 09:43:58 2003 -- Version 1.470\n\nadded an o"
"verride bool to keep engine on at all times\n\n\ntmarkel -- Mon Mar 03 14:14:"
"43 2003 -- Version 1.469\n\nupdated traction control block in all vehicle con"
"trol blocks to 2 axle version\n\ntmarkel -- Mon Mar 03 14:07:59 2003 -- Versi"
"on 1.468\n\nadded output from blocks for rear params from traction blocks in "
"all vehicle control blocks\n\ntemp solution - added grounds as inputs to the "
"brake controller for rear drivetrain output to eliminate warnings\n\n\n\n\ntm"
"arkel -- Mon Mar 03 12:40:46 2003 -- Version 1.467\n\n\ntmarkel -- Mon Mar 03"
" 12:37:51 2003 -- Version 1.466\nremoved extra traction control model from co"
"nv.\n\ntmarkel -- Mon Mar 03 12:29:10 2003 -- Version 1.465\n\nupdated tracti"
"on control config subsystem to be two axle model\n\ntmarkel -- Mon Feb 24 16:"
"12:37 2003 -- Version 1.464\nupdated j2452 model for 2 axles\n\nabrooker -- T"
"hu Feb 20 14:21:28 2003 -- Version 1.463\n\n\nmokeefe -- Wed Feb 19 08:45:17 "
"2003 -- Version 1.462\n\n\nmokeefe -- Wed Feb 19 08:43:58 2003 -- Version 1.4"
"61\n\n\ntmarkel -- Fri Feb 14 10:10:01 2003 -- Version 1.460\n\n\ntmarkel -- "
"Fri Feb 14 10:08:23 2003 -- Version 1.459\n\n\ntmarkel -- Thu Feb 13 12:55:41"
" 2003 -- Version 1.458\n\n\ntmarkel -- Thu Feb 13 12:32:44 2003 -- Version 1."
"457\n\n\ntmarkel -- Wed Feb 12 15:47:27 2003 -- Version 1.456\nfixed one more"
" broken link\n\ntmarkel -- Wed Feb 12 15:29:50 2003 -- Version 1.455\nupdated"
" conv controller to include front/rear traction model\n\n\ntmarkel -- Wed Feb"
" 12 15:07:56 2003 -- Version 1.454\nfixed broken link to lib_controls_2axle\n"
"\ntmarkel -- Wed Feb 12 14:32:44 2003 -- Version 1.453\nfixed bad link errors"
"\n\ntmarkel -- Wed Feb 12 09:39:27 2003 -- Version 1.452\n\nAdded the tractio"
"n control blocks for a front/rear traction system to the subsystem box\n\n\nb"
"jeanner -- Thu Dec 26 09:42:29 2002 -- Version 1.451\nadd three new parameter"
"s: allowing calcultion of equivallent ESS function with mean efficiency; plus"
" plotting results parameter\n\n\nbjeanner -- Thu Dec 12 14:52:52 2002 -- Vers"
"ion 1.450\n\n\nbjeanner -- Tue Dec 10 14:49:05 2002 -- Version 1.449\n\n\nbje"
"anner -- Tue Dec 10 13:14:31 2002 -- Version 1.448\n\n\nbjeanner -- Tue Dec 1"
"0 11:50:56 2002 -- Version 1.447\n\n\nbjeanner -- Tue Dec 10 11:41:01 2002 --"
" Version 1.446\n\n\nbjeanner -- Tue Dec 10 11:30:40 2002 -- Version 1.445\n\n"
"\nbjeanner -- Tue Dec 10 11:29:40 2002 -- Version 1.444\n\n\nbjeanner -- Tue "
"Dec 10 11:10:40 2002 -- Version 1.443\n\n\nbjeanner -- Tue Dec 10 10:31:25 20"
"02 -- Version 1.442\n\n\nbjeanner -- Tue Dec 10 10:30:04 2002 -- Version 1.44"
"1\n\n\nbjeanner -- Tue Dec 10 10:29:36 2002 -- Version 1.440\n\n\nbjeanner --"
" Tue Dec 10 10:23:30 2002 -- Version 1.439\n\n\nbjeanner -- Tue Dec 10 09:20:"
"40 2002 -- Version 1.438\n\n\nbjeanner -- Tue Dec 10 09:16:26 2002 -- Version"
" 1.437\nAdd the template for the configurable subsystem for the BD_FUELCELL c"
"ontrol strategy.\nAdd the fuel cell adaptive control strategy\n\n\nmokeefe --"
" Tue Aug 13 07:36:17 2002 -- Version 1.436\nMaking the model look \"pretty\""
"\n\nmokeefe -- Tue Aug 13 07:35:11 2002 -- Version 1.435\nchanged <vc> conv c"
"vt/cvt control to use \"acc_mech_pwr_est\" instead of \"acc_mech_trq_est\" as"
" had been used previously (the required datum is the power and not the torque"
"!)\n\nssprik -- Tue Apr 30 11:21:35 2002 -- Version 1.434\nadded user contrib"
"uted par bal engine on  block\n\nmokeefe -- Tue Apr 23 09:06:10 2002 -- Versi"
"on 1.433\nchanged Insight electric assist control strategy <cs> DIRECT SPLIT/"
"Hard Acceleration to prevent a divide by zero warning. Also added logic to pr"
"event a torque request above the maximum achievable motor torque.\n\nmokeefe "
"-- Tue Apr 23 09:03:51 2002 -- Version 1.432\nchanged Insight electric assist"
" control strategy <cs> DIRECT SPLIT/Hard Acceleration to prevent a divide by "
"zero warning. Also added logic to prevent a torque request above the maximum "
"achievable motor torque.\n\nmokeefe -- Tue Apr 23 08:50:58 2002 -- Version 1."
"431\n\n\nssprik -- Thu Apr 18 14:34:50 2002 -- Version 1.430\n\n\nssprik -- T"
"hu Apr 18 14:32:52 2002 -- Version 1.429\n\n\nssprik -- Thu Apr 18 14:06:57 2"
"002 -- Version 1.428\n\n\nssprik -- Thu Apr 18 13:56:10 2002 -- Version 1.427"
"\n\n\nssprik -- Thu Apr 18 13:46:32 2002 -- Version 1.426\n\n\nkkelly -- Thu "
"Apr 18 10:17:40 2002 -- Version 1.425\n\n\nmokeefe -- Thu Apr 18 08:23:32 200"
"2 -- Version 1.424\nsaving the model:\no \"without the model browser open\"\n"
"o with only top-level screen visible \no with \"fit to view\" enabled\no with"
" \"status bar\" off and \"toolbar\" off\no with \"prompt to update model hist"
"ory with each save\" on\n\nkkelly -- Wed Mar 27 14:57:12 2002 -- Version 1.42"
"3\n\n\nkkelly -- Wed Mar 27 14:57:12 2002 -- Version 1.423\n\n\nkkelly -- Wed"
" Mar 27 14:50:41 2002 -- Version 1.422\n\n\nkkelly -- Wed Mar 27 14:50:24 200"
"2 -- Version 1.421\n\n\nkkelly -- Wed Mar 27 14:26:31 2002 -- Version 1.420\n"
"\n\nkkelly -- Wed Mar 27 14:26:16 2002 -- Version 1.419\n\n\nkkelly -- Wed Ma"
"r 27 14:25:54 2002 -- Version 1.418\n\n\nkkelly -- Wed Mar 27 14:20:49 2002 -"
"- Version 1.417\n\n\nkkelly -- Wed Mar 27 14:18:25 2002 -- Version 1.416\n\n"
"\nkkelly -- Wed Mar 27 14:17:14 2002 -- Version 1.415\n\n\nkkelly -- Wed Mar "
"27 14:09:18 2002 -- Version 1.414\n\n\nkkelly -- Wed Mar 27 14:07:10 2002 -- "
"Version 1.413\n\n\nkkelly -- Wed Mar 27 14:04:42 2002 -- Version 1.412\n\n\nk"
"kelly -- Wed Mar 27 12:39:55 2002 -- Version 1.411\n\n\nkkelly -- Wed Mar 27 "
"12:39:35 2002 -- Version 1.410\n\n\nkkelly -- Wed Mar 27 12:31:18 2002 -- Ver"
"sion 1.409\n\n\nkkelly -- Wed Mar 27 12:12:25 2002 -- Version 1.408\n\n\nkkel"
"ly -- Wed Mar 27 12:03:57 2002 -- Version 1.407\n\n\nkkelly -- Wed Mar 27 12:"
"03:11 2002 -- Version 1.406\nAdded logic to increase torque request for very "
"hard acceleration\n\nkkelly -- Wed Mar 27 11:51:32 2002 -- Version 1.405\nAdd"
"ed logic to allow EM in 1st gear when torque request is high\n\nkkelly -- Wed"
" Mar 27 11:48:18 2002 -- Version 1.404\nAdded logic to allow EM at low speed "
"with high torque request \n\nkkelly -- Wed Mar 27 11:36:20 2002 -- Version 1."
"403\nAdded zero-torque request logic\n\nkkelly -- Wed Mar 27 11:09:35 2002 --"
" Version 1.402\n\n\nkkelly -- Wed Mar 27 11:07:39 2002 -- Version 1.401\n\n\n"
"kkelly -- Wed Mar 27 10:43:33 2002 -- Version 1.400\n\n\nmokeefe -- Fri Mar 0"
"8 08:11:28 2002 -- Version 1.399\ntook all separate auxiliary load calculatio"
"ns out of the <vc> libraries. These will now use the lib_accessory goto tags "
"(acc_mech_trq_est, acc_mech_pwr_est, acc_elec_pwr_est)\n\nmokeefe -- Mon Jul "
"02 10:08:55 2001 -- Version 1.184\n\n\nmokeefe -- Mon Jul 02 10:08:07 2001 --"
" Version 1.183\n\n\nmokeefe -- Mon Jul 02 10:06:51 2001 -- Version 1.182\n\n"
"\nmokeefe -- Mon Jul 02 10:05:17 2001 -- Version 1.181\n\n\nmokeefe -- Mon Ju"
"l 02 10:04:17 2001 -- Version 1.180\n\n\nmokeefe -- Fri Jun 29 13:59:18 2001 "
"-- Version 1.179\n\nall <vc> blocks updated for use with variable cargo mass "
"functionality (cargo mass by distance)--also, all <vc> top-level blocks have "
"been \"cleaned up\" to look neat and organized. A sub-model library has been "
"made and is the preferred way to do future development.\n\nmokeefe -- Fri Jun"
" 29 13:56:37 2001 -- Version 1.178\n\n<vc> prius\n\nmokeefe -- Fri Jun 29 13:"
"46:29 2001 -- Version 1.177\n\n\nmokeefe -- Fri Jun 29 13:40:43 2001 -- Versi"
"on 1.176\n\n\nmokeefe -- Fri Jun 29 13:39:38 2001 -- Version 1.175\n\n<vc> se"
"ries (\"\" \"\")\n\n\nmokeefe -- Fri Jun 29 13:34:00 2001 -- Version 1.174\n"
"\n<vc> par Adaptive (\"\" \"\")\n\nmokeefe -- Fri Jun 29 13:23:41 2001 -- Ver"
"sion 1.173\n\ninsight (ibid.)\n\n\nmokeefe -- Fri Jun 29 13:15:22 2001 -- Ver"
"sion 1.172\n\n<vc> par balanced--> veh_mass to veh_mass+veh_cargo_mass\n\n\nm"
"okeefe -- Fri Jun 29 13:05:39 2001 -- Version 1.171\n\n\nmokeefe -- Fri Jun 2"
"9 12:10:12 2001 -- Version 1.170\n\nfinished veh_mass mods for the <vc> par c"
"vt...\n\n\nmokeefe -- Fri Jun 29 12:09:18 2001 -- Version 1.169\n\n\nmokeefe "
"-- Fri Jun 29 11:56:20 2001 -- Version 1.168\n\n\nmokeefe -- Fri Jun 29 11:44"
":30 2001 -- Version 1.167\n\n\nmokeefe -- Fri Jun 29 11:33:07 2001 -- Version"
" 1.166\n\n\nmokeefe -- Fri Jun 29 11:21:54 2001 -- Version 1.165\n\n\nmokeefe"
" -- Fri Jun 29 11:15:04 2001 -- Version 1.164\n\n\nmokeefe -- Fri Jun 29 11:1"
"3:02 2001 -- Version 1.163\n\n\nmokeefe -- Fri Jun 29 11:06:47 2001 -- Versio"
"n 1.162\n\n\nmokeefe -- Fri Jun 29 11:04:27 2001 -- Version 1.161\n\n\nmokeef"
"e -- Fri Jun 29 10:40:33 2001 -- Version 1.160\n\n\nmokeefe -- Fri Jun 29 10:"
"35:18 2001 -- Version 1.159\n\n\nmokeefe -- Fri Jun 29 10:29:06 2001 -- Versi"
"on 1.158\n\n\nmokeefe -- Fri Jun 29 10:26:50 2001 -- Version 1.157\n\n\nmokee"
"fe -- Fri Jun 29 10:18:10 2001 -- Version 1.156\n\nmade traction control, fro"
"nt and rear brake controller, and braking strategy into \"sub-libraries\" for"
" vehicle control\n\nmokeefe -- Fri Jun 29 10:17:11 2001 -- Version 1.155\n\n"
"\nmokeefe -- Fri Jun 29 10:15:46 2001 -- Version 1.154\n\n\nmokeefe -- Fri Ju"
"n 29 10:09:48 2001 -- Version 1.153\n\n\nmokeefe -- Fri Jun 29 09:58:42 2001 "
"-- Version 1.152\n\n\nmokeefe -- Fri Jun 29 09:57:37 2001 -- Version 1.151\n"
"\ncreating sub-components for vehicle control model (traction control)\n\nmok"
"eefe -- Fri Jun 29 09:21:23 2001 -- Version 1.150\n\n\nmokeefe -- Fri Jun 29 "
"09:19:46 2001 -- Version 1.149\n\n\nmokeefe -- Fri Jun 29 09:09:49 2001 -- Ve"
"rsion 1.148\n\n\nmokeefe -- Fri Jun 29 08:32:46 2001 -- Version 1.147\n\n\nmo"
"keefe -- Fri Jun 29 08:29:03 2001 -- Version 1.146\n\nreplacing veh_mass with"
" veh_mass plus veh_cargo_mass in <vc> conv auto Saber Custom\n\n\nmokeefe -- "
"Thu Jun 28 17:08:40 2001 -- Version 1.145\n\n\nmokeefe -- Thu Jun 28 17:07:02"
" 2001 -- Version 1.144\n\n\nmokeefe -- Thu Jun 28 17:06:28 2001 -- Version 1."
"143\n\nchanges to the CVT controls to subsitute veh_mass + veh_cargo_mass for"
" veh_mass\n\n\nmokeefe -- Thu Jun 28 16:55:42 2001 -- Version 1.142\n\n\nmoke"
"efe -- Thu Jun 28 16:32:01 2001 -- Version 1.141\n\nchanging veh_mass to veh_"
"mass plus veh_cargo_mass\n\n\nmokeefe -- Thu Jun 28 16:21:30 2001 -- Version "
"1.140\n\nreplacing veh_mass with veh_mass + (cargo mass vs time)\n\nmokeefe -"
"- Thu Jun 28 14:12:51 2001 -- Version 1.139\n\nreplaced all 'veh_mass' refere"
"nces with a veh_mass plus a FROM block (originating from drive cycle) that gi"
"ves variable cargo mass by time\n\n"
  ModelVersionFormat	  "1.%<AutoIncrement:473>"
  ConfigurationManager	  "none"
  SimParamPage		  "Solver"
  AlgebraicLoopMsg	  "warning"
  MinStepSizeMsg	  "warning"
  UnconnectedInputMsg	  "warning"
  UnconnectedOutputMsg	  "warning"
  UnconnectedLineMsg	  "warning"
  InheritedTsInSrcMsg	  "warning"
  SingleTaskRateTransMsg  "none"
  MultiTaskRateTransMsg	  "error"
  IntegerOverflowMsg	  "warning"
  CheckForMatrixSingularity "none"
  UnnecessaryDatatypeConvMsg "none"
  Int32ToFloatConvMsg	  "warning"
  InvalidFcnCallConnMsg	  "error"
  SignalLabelMismatchMsg  "none"
  LinearizationMsg	  "none"
  VectorMatrixConversionMsg "none"
  SfunCompatibilityCheckMsg "none"
  BlockPriorityViolationMsg "warning"
  ArrayBoundsChecking	  "none"
  ConsistencyChecking	  "none"
  Profile		  off
  SimulationMode	  "normal"
  RTWRetainRTWFile	  off
  RTWMakeCommand	  "make_rtw"
  RTWGenerateCodeOnly	  off
  TLCProfiler		  off
  TLCDebug		  off
  TLCCoverage		  off
  ExtModeMexFile	  "ext_comm"
  ExtModeBatchMode	  off
  ExtModeTrigType	  "manual"
  ExtModeTrigMode	  "normal"
  ExtModeTrigPort	  "1"
  ExtModeTrigElement	  "any"
  ExtModeTrigDuration	  1000
  ExtModeTrigHoldOff	  0
  ExtModeTrigDelay	  0
  ExtModeTrigDirection	  "rising"
  ExtModeTrigLevel	  0
  ExtModeArchiveMode	  "off"
  ExtModeAutoIncOneShot	  off
  ExtModeIncDirWhenArm	  off
  ExtModeAddSuffixToVar	  off
  ExtModeWriteAllDataToWs off
  ExtModeArmWhenConnect	  on
  ExtModeSkipDownloadWhenConnect off
  ExtModeLogAll		  on
  ExtModeAutoUpdateStatusClock on
  BlockDefaults {
    Orientation		    "right"
    ForegroundColor	    "black"
    BackgroundColor	    "white"
    DropShadow		    off
    NamePlacement	    "normal"
    FontName		    "Helvetica"
    FontSize		    10
    FontWeight		    "normal"
    FontAngle		    "normal"
    ShowName		    on
  }
  AnnotationDefaults {
    HorizontalAlignment	    "center"
    VerticalAlignment	    "middle"
    ForegroundColor	    "black"
    BackgroundColor	    "white"
    DropShadow		    off
    FontName		    "Helvetica"
    FontSize		    10
    FontWeight		    "normal"
    FontAngle		    "normal"
  }
  LineDefaults {
    FontName		    "Helvetica"
    FontSize		    9
    FontWeight		    "normal"
    FontAngle		    "normal"
  }
  System {
    Name		    "lib_controls"
    Location		    [2, 76, 998, 744]
    Open		    on
    ModelBrowserVisibility  off
    ModelBrowserWidth	    200
    ScreenColor		    "automatic"
    PaperOrientation	    "landscape"
    PaperPositionMode	    "auto"
    PaperType		    "usletter"
    PaperUnits		    "inches"
    ZoomFactor		    "86"
    ReportName		    "simulink-default.rpt"
    Block {
      BlockType		      SubSystem
      Name		      "<vc> conv"
      Ports		      [0, 1]
      Position		      [100, 48, 160, 102]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> conv"
	Location		[190, 107, 1002, 777]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"94"
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [590, 525, 685, 545]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [595, 144, 675, 166]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [595, 181, 690, 199]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [580, 360, 675, 380]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [580, 385, 675, 405]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc> clutch cntrl"
	  Position		  [590, 477, 675, 493]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc> gb cntrol"
	  Position		  [590, 507, 675, 523]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc> gb cntrol1"
	  Position		  [580, 327, 665, 343]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [55, 257, 130, 273]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [60, 290, 120, 310]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [45, 221, 130, 239]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [125, 427, 235, 443]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [130, 461, 230, 479]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [590, 561, 675, 579]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [120, 516, 240, 534]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [145, 390, 205, 410]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [310, 255, 370, 275]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [110, 146, 195, 164]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>9"
	  Position		  [130, 557, 240, 573]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_rear_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From traction cntrl"
	  Position		  [595, 215, 690, 235]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [595, 111, 680, 129]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [120, 481, 235, 499]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [770, 207, 845, 233]
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [770, 486, 835, 504]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [765, 516, 850, 534]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [775, 551, 825, 569]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [760, 120, 845, 140]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [765, 166, 845, 184]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [770, 336, 845, 354]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [455, 251, 540, 269]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [450, 180, 535, 200]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [210, 239, 300, 261]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [215, 276, 305, 294]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [355, 436, 440, 454]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [355, 499, 440, 521]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [255, 145, 365, 165]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [210, 306, 300, 324]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [205, 336, 295, 354]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [420, 120, 530, 140]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [400, 242, 430, 273]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [400, 172, 430, 203]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [210, 142, 240, 193]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "clutch\ncontrol"
	  Ports			  [3, 1]
	  Position		  [710, 333, 745, 407]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "clutch\ncontrol"
	    Location		    [69, 202, 914, 652]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 43, 60, 57]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 83, 60, 97]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 193, 55, 207]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [775, 395, 831, 435]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[307, 823, 765, 985]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [155, 108, 190, 132]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [155, 149, 235, 171]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [155, 214, 235, 236]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [155, 280, 190, 300]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [155, 344, 235, 366]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [580, 380, 615, 400]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [670, 135, 730, 165]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [390, 92, 420, 123]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [325, 152, 355, 183]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [580, 325, 610, 355]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [600, 132, 635, 168]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [310, 82, 340, 113]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [270, 202, 300, 233]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [270, 267, 300, 298]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [270, 332, 300, 363]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [460, 42, 490, 73]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [530, 142, 560, 173]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [390, 279, 420, 311]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [470, 330, 505, 365]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [85, 185, 115, 215]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[222, 219, 810, 728]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [795, 143, 825, 157]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-105, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 190]
		DstBlock		"Memory"
		DstPort			1
	      }
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [145, 214, 180, 316]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine\ncontrol"
	  Ports			  [4, 3]
	  Position		  [715, 481, 750, 569]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine\ncontrol"
	    Location		    [344, 74, 1167, 963]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "clutch state"
	      Position		      [35, 33, 65, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 163, 60, 177]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [45, 483, 75, 497]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [30, 303, 60, 317]
	      NamePlacement	      "alternate"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [555, 335, 611, 375]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[156, 423, 612, 520]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine control block determine"
"s whether the engine is on, which it is when\n[(the clutch is slipping or eng"
"aged OR idling is allowed) AND the ignition key is on]\nOR\n(the transmission"
" is shifting AND the engine was on during the previous time step).\nThe secon"
"d part involving shifting is to prevent the engine from shutting down\nfor 1 "
"or 2 seconds during shifts."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [150, 80, 170, 100]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Value		      "1.1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 132, 215, 148]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [300, 424, 380, 446]
	      Orientation	      "left"
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [55, 205, 75, 225]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [55, 325, 75, 345]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [95, 440, 115, 460]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [460, 490, 480, 510]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [390, 111, 420, 144]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [265, 116, 295, 149]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [445, 121, 475, 154]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [390, 160, 420, 195]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [3, 1]
	      Position		      [205, 302, 235, 338]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [395, 215, 425, 245]
	      Orientation	      "left"
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [385, 465, 415, 495]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 465, 355, 495]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [515, 475, 545, 505]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [110, 192, 140, 223]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\nslipping\nor engaged"
	      Position		      [195, 32, 225, 63]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [310, 91, 355, 119]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"key_on"
		Location		[5, 40, 315, 196]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [140, 427, 170, 458]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [110, 302, 140, 333]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [35, 402, 70, 438]
	      ForegroundColor	      "green"
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[59, 74, 434, 236]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [550, 133, 580, 147]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [580, 483, 610, 497]
	      NamePlacement	      "alternate"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [550, 53, 580, 67]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -45]
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		Points			[5, 0]
		DstBlock		"Logical\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 90]
		Branch {
		  Points		  [0, 260]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0; 0, 35]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [0, 160]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      Points		      [10, 0; 0, -10]
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [0, 15]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [0, -35]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping\nor engaged"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -20]
	      DstBlock		      "clutch\nslipping\nor engaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch state"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"clutch\nslipping\nor engaged"
		DstPort			1
	      }
	      Branch {
		Points			[0, 160]
		DstBlock		"clutch\ndisengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [290, 411, 325, 539]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox\n control"
	  Ports			  [4, 3]
	  Position		  [705, 101, 740, 244]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox\n control"
	    Location		    [153, 127, 910, 797]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "78"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 130, 65, 150]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 255, 65, 275]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [900, 610, 956, 650]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [370, 95, 390, 115]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [420, 558, 515, 572]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [350, 423, 445, 437]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [690, 411, 695, 449]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn"
	      Position		      [155, 20, 185, 40]
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [85, 180, 115, 200]
	      Orientation	      "up"
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [520, 530, 645, 550]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [45, 504, 150, 536]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [520, 590, 645, 610]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [460, 450, 585, 470]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [460, 475, 585, 495]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [460, 385, 585, 405]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From5"
	      Position		      [115, 213, 225, 237]
	      BackgroundColor	      "gray"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "acc_mech_trq_est"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [530, 242, 555, 268]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [270, 495, 390, 515]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [270, 519, 390, 541]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto3"
	      Position		      [825, 250, 960, 270]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [835, 95, 945, 115]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [835, 170, 945, 190]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [605, 447, 610, 498]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [265, 142, 295, 173]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [575, 238, 595, 262]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [475, 312, 505, 338]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [90, 20, 120, 40]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [725, 96, 745, 114]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [195, 492, 225, 543]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [365, 135, 395, 165]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [665, 550, 695, 580]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [635, 415, 665, 445]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [475, 42, 505, 78]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[330, 267, 819, 482]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [670, 87, 690, 123]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [615, 144, 645, 176]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [470, 229, 500, 281]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[433, 370, 908, 665]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [310, 210, 340, 230]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "est eng\ntrq"
	      Ports		      [2, 1]
	      Position		      [220, 132, 240, 168]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 258, 170, 282]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 313, 430, 337]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [785, 93, 815, 117]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [220, 255, 250, 285]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 221, 812, 730]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 461, 265, 479]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [315, 151, 335, 169]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [690, 20, 730, 40]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [305, 315, 340, 335]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(gb_num_init)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [785, 164, 815, 196]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[164, 210, 454, 401]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [470, 124, 500, 176]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[326, 353, 801, 648]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 132, 170, 168]
	      FontName		      "Arial"
	      Inputs		      "3"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [760, 395, 780, 415]
	      NamePlacement	      "alternate"
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [760, 440, 780, 460]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [760, 555, 780, 575]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[0, 105]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "est eng\ntrq"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "est eng\ntrq"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [115, 0]
	      Branch {
		Points			[50, 0]
		Branch {
		  Points		  [0, -105]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
		Branch {
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
	      }
	      Branch {
		Points			[0, -50]
		DstBlock		"engine\ntorque\ncapability"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-200, 0; 0, -50]
	      Branch {
		DstBlock		"Fcn1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "gb_spd_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [265, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-35, 0]
	      Branch {
		Points			[0, 65]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[-210, 0; 0, 30]
		Branch {
		  Points		  [0, 75]
		  Branch {
		    Points		    [0, 105]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 80]
		  Branch {
		    Points		    [0, 65]
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto3"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 0]
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -75]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Fcn"
	      SrcPort		      1
	      Points		      [10, 0; 0, 85; -75, 0; 0, 35]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [-55, 0]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [95, 0]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Fcn"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [45, 0]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From5"
	      SrcPort		      1
	      Points		      [0, -25; -25, 0]
	      DstBlock		      "est eng\ntrq"
	      DstPort		      2
	    }
	    Annotation {
	      Position		      [899, 289]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [893, 206]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [902, 134]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [509, 372]
	      Text		      "gear ratio and shifting pre-muxed"
	    }
	    Annotation {
	      Position		      [860, 515]
	      Text		      "output changes depending\nupon whether "
"speed\ndependent shifting is used"
	    }
	    Annotation {
	      Position		      [902, 62]
	      Text		      "local GOTO blocks:"
	    }
	    Annotation {
	      Position		      [336, 470]
	      Text		      "local GOTO blocks"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [50, 30, 80, 80]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [795, 363, 825, 377]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  3
	  Points		  [5, 0]
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <vc> gb cntrol"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <vc> clutch cntrl"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "clutch\ncontrol"
	  SrcPort		  1
	  Points		  [5, 0]
	  Branch {
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <vc> gb cntrol1"
	  SrcPort		  1
	  Points		  [25, 0]
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox\n control"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From traction cntrl"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "gearbox\n control"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  Points		  [40, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [65, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [125, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -50]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 10, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [190, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 5; 15, 0]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox\n control"
	  SrcPort		  3
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [5, 0; 0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>9"
	  SrcPort		  1
	  Points		  [20, 0; 0, -40]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [244, 222]
	  Text			  "required force (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> conv\nSaber custom"
      Ports		      [0, 1]
      Position		      [500, 33, 560, 87]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> conv\nSaber custom"
	Location		[10, 74, 997, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [515, 515, 610, 535]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>1"
	  Position		  [510, 480, 605, 500]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>2"
	  Position		  [510, 445, 605, 465]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [525, 134, 605, 156]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [525, 171, 620, 189]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [525, 206, 620, 224]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [515, 320, 610, 340]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [520, 345, 615, 365]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>6"
	  Position		  [515, 285, 610, 305]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [25, 237, 100, 253]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [40, 270, 100, 290]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [15, 201, 100, 219]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [45, 437, 155, 453]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [50, 471, 150, 489]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [520, 551, 605, 569]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [30, 526, 150, 544]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [65, 400, 125, 420]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [280, 215, 340, 235]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [80, 126, 165, 144]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [525, 101, 610, 119]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [45, 496, 160, 514]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [710, 202, 785, 228]
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [695, 476, 760, 494]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [690, 506, 775, 524]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [700, 541, 750, 559]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [705, 105, 790, 125]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [705, 156, 785, 174]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [700, 296, 775, 314]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [420, 211, 505, 229]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [415, 160, 500, 180]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [180, 219, 270, 241]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [225, 246, 315, 264]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [245, 441, 330, 459]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [245, 504, 330, 526]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [225, 125, 335, 145]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [180, 286, 270, 304]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [175, 316, 265, 334]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [390, 75, 500, 95]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [135, 575, 155, 595]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [365, 202, 395, 233]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [365, 152, 395, 183]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [180, 122, 210, 173]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "clutch\ncontrol"
	  Ports			  [3, 1]
	  Position		  [640, 293, 675, 367]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "clutch\ncontrol"
	    Location		    [69, 202, 914, 652]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 43, 60, 57]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 83, 60, 97]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 193, 55, 207]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [775, 395, 831, 435]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[307, 823, 765, 985]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [155, 108, 190, 132]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [155, 149, 235, 171]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [155, 214, 235, 236]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [155, 280, 190, 300]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [155, 344, 235, 366]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [580, 380, 615, 400]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [670, 135, 730, 165]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [390, 92, 420, 123]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [325, 152, 355, 183]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [580, 325, 610, 355]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [600, 132, 635, 168]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [310, 82, 340, 113]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [270, 202, 300, 233]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [270, 267, 300, 298]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [270, 332, 300, 363]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [460, 42, 490, 73]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [530, 142, 560, 173]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [390, 279, 420, 311]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [470, 330, 505, 365]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [85, 185, 115, 215]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[222, 219, 810, 728]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [795, 143, 825, 157]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	      Branch {
		Points			[0, 190]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-105, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [115, 194, 150, 296]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine\ncontrol"
	  Ports			  [4, 3]
	  Position		  [640, 471, 675, 559]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine\ncontrol"
	    Location		    [271, 88, 923, 631]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "clutch state"
	      Position		      [35, 33, 65, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 163, 60, 177]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [45, 483, 75, 497]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [30, 303, 60, 317]
	      NamePlacement	      "alternate"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [555, 335, 611, 375]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[156, 423, 612, 520]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine control block determine"
"s whether the engine is on, which it is when\n[(the clutch is slipping or eng"
"aged OR idling is allowed) AND the ignition key is on]\nOR\n(the transmission"
" is shifting AND the engine was on during the previous time step).\nThe secon"
"d part involving shifting is to prevent the engine from shutting down\nfor 1 "
"or 2 seconds during shifts."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [150, 80, 170, 100]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Value		      "1.1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 132, 215, 148]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [300, 424, 380, 446]
	      Orientation	      "left"
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [55, 205, 75, 225]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [55, 325, 75, 345]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [95, 440, 115, 460]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [460, 490, 480, 510]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [390, 111, 420, 144]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [265, 116, 295, 149]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [445, 121, 475, 154]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [390, 160, 420, 195]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [3, 1]
	      Position		      [205, 302, 235, 338]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [395, 215, 425, 245]
	      Orientation	      "left"
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [385, 465, 415, 495]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 465, 355, 495]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [515, 475, 545, 505]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [110, 192, 140, 223]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\nslipping\nor engaged"
	      Position		      [195, 32, 225, 63]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [310, 91, 355, 119]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"key_on"
		Location		[5, 40, 315, 196]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [140, 427, 170, 458]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [110, 302, 140, 333]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [35, 402, 70, 438]
	      ForegroundColor	      "green"
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[59, 74, 434, 236]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [550, 133, 580, 147]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [580, 483, 610, 497]
	      NamePlacement	      "alternate"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [550, 53, 580, 67]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "clutch state"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 160]
		DstBlock		"clutch\ndisengaged"
		DstPort			1
	      }
	      Branch {
		DstBlock		"clutch\nslipping\nor engaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -20]
	      DstBlock		      "clutch\nslipping\nor engaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping\nor engaged"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [0, -35]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [0, 15]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      Points		      [10, 0; 0, -10]
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [0, 160]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0; 0, 35]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 90]
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 260]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[5, 0]
		DstBlock		"Logical\nOperator1"
		DstPort			1
	      }
	      Branch {
		Points			[0, -45]
		DstBlock		"key on"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [190, 416, 225, 544]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox\n control"
	  Ports			  [4, 3]
	  Position		  [640, 89, 675, 236]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox\n control"
	    Location		    [-36, 77, 951, 745]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 130, 65, 150]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 255, 65, 275]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [855, 590, 911, 630]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [370, 95, 390, 115]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [435, 573, 530, 587]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [365, 438, 460, 452]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [705, 426, 710, 464]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn"
	      Position		      [155, 20, 185, 40]
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [85, 180, 115, 200]
	      Orientation	      "up"
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [535, 545, 660, 565]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [15, 499, 120, 531]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [535, 605, 660, 625]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [475, 465, 600, 485]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [475, 490, 600, 510]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [475, 400, 600, 420]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [530, 242, 555, 268]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [240, 490, 360, 510]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [240, 514, 360, 536]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto3"
	      Position		      [815, 245, 950, 265]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [835, 95, 945, 115]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [835, 170, 945, 190]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [620, 462, 625, 513]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [265, 142, 295, 173]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [575, 238, 595, 262]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [475, 312, 505, 338]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [90, 20, 120, 40]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [725, 96, 745, 114]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [165, 487, 195, 538]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [365, 135, 395, 165]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [680, 565, 710, 595]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [650, 430, 680, 460]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "accessories\n(Nm)"
	      Ports		      [0, 1]
	      Position		      [150, 192, 180, 228]
	      ForegroundColor	      "magenta"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"accessories\n(Nm)"
		Location		[306, 375, 532, 495]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  From
		  Name			  "From <fc>"
		  Position		  [30, 29, 120, 61]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "fc_acc_trq_r"
		}
		Block {
		  BlockType		  Outport
		  Name			  "T_acc"
		  Position		  [145, 35, 165, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "From <fc>"
		  SrcPort		  1
		  DstBlock		  "T_acc"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [475, 42, 505, 78]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[330, 267, 819, 482]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [670, 87, 690, 123]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [615, 144, 645, 176]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [470, 229, 500, 281]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[433, 370, 908, 665]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [310, 210, 340, 230]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "est eng\ntrq"
	      Ports		      [2, 1]
	      Position		      [205, 142, 225, 178]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 258, 170, 282]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 313, 430, 337]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [780, 93, 810, 117]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [220, 255, 250, 285]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 221, 812, 730]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 461, 265, 479]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [315, 151, 335, 169]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [690, 20, 730, 40]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [305, 315, 340, 335]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(gb_num_init)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [780, 164, 810, 196]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[164, 210, 454, 401]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [470, 124, 500, 176]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[326, 353, 801, 648]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 132, 170, 168]
	      FontName		      "Arial"
	      Inputs		      "3"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [775, 410, 795, 430]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [775, 455, 795, 475]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [775, 570, 795, 590]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Fcn"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [95, 0]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [-55, 0]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn"
	      SrcPort		      1
	      Points		      [10, 0; 0, 85; -75, 0; 0, 35]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, -75]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  Points		  [0, 75]
		  Branch {
		    DstBlock		    "Goto3"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 70]
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-35, 0]
	      Branch {
		Points			[-210, 0; 0, 30]
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 75]
		  Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 105]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 65]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [265, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "gb_spd_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-200, 0; 0, -50]
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Fcn1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "est eng\ntrq"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "accessories\n(Nm)"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "est eng\ntrq"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "est eng\ntrq"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 105]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [115, 0]
	      Branch {
		Points			[0, -50]
		DstBlock		"engine\ntorque\ncapability"
		DstPort			1
	      }
	      Branch {
		Points			[50, 0]
		Branch {
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
		Branch {
		  Points		  [0, -105]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [45, 0]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [524, 387]
	      Text		      "gear ratio and shifting pre-muxed"
	    }
	    Annotation {
	      Position		      [875, 530]
	      Text		      "output changes depending\nupon whether "
"speed\ndependent shifting is used"
	    }
	    Annotation {
	      Position		      [889, 299]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [897, 134]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [887, 67]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [50, 25, 80, 75]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [725, 323, 755, 337]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  Points		  [0, 10]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [45, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "gearbox\n control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 10, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [145, 0]
	    Branch {
	      Points		      [0, -35]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [125, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -75]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "clutch\ncontrol"
	  SrcPort		  1
	  Points		  [5, 0]
	  Branch {
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <gb>6"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  3
	  Points		  [5, 0]
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <fc>1"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <fc>2"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox\n control"
	  SrcPort		  3
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox\n control"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox\n control"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [0, -55]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> conv auto"
      Ports		      []
      Position		      [182, 48, 244, 101]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> conv auto"
	Location		[182, 94, 994, 700]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [590, 370, 610, 390]
	  Value			  "3"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [500, 485, 595, 505]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>1"
	  Position		  [500, 450, 595, 470]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>2"
	  Position		  [500, 415, 595, 435]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [505, 255, 600, 275]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [505, 196, 600, 214]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [505, 295, 600, 315]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 162, 105, 178]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [20, 195, 80, 215]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [20, 126, 105, 144]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [50, 422, 160, 438]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [55, 456, 155, 474]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [50, 380, 110, 400]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [50, 516, 170, 534]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [500, 516, 585, 534]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [135, 26, 220, 44]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [370, 140, 430, 160]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [505, 230, 600, 250]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [50, 481, 165, 499]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [695, 443, 765, 467]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [685, 473, 775, 497]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [705, 516, 755, 534]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [700, 234, 775, 256]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [720, 275, 775, 295]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>"
	  Position		  [700, 312, 775, 328]
	  GotoTag		  "locked_up"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>1"
	  Position		  [700, 204, 775, 226]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [645, 369, 730, 391]
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [560, 136, 645, 154]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [555, 60, 640, 80]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [180, 144, 270, 166]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [265, 171, 355, 189]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [250, 426, 335, 444]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [250, 489, 335, 511]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [290, 25, 400, 45]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [185, 191, 275, 209]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [210, 226, 300, 244]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [490, 15, 600, 35]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [140, 555, 160, 575]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [505, 127, 535, 158]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [505, 52, 535, 83]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [245, 22, 275, 73]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [125, 119, 160, 221]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine\ncontrol"
	  Ports			  [4, 3]
	  Position		  [635, 434, 670, 531]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine\ncontrol"
	    Location		    [261, 145, 1157, 1059]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    281
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [35, 168, 65, 182]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch state"
	      Position		      [35, 33, 65, 47]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [40, 518, 70, 532]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [35, 333, 65, 347]
	      NamePlacement	      "alternate"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [560, 355, 616, 395]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[156, 423, 612, 520]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine control block determine"
"s whether the engine is on, which it is when\n[(the clutch is slipping or eng"
"aged OR idling is allowed) AND the ignition key is on]\nOR\n(the transmission"
" is shifting AND the engine was on during the previous time step).\nThe secon"
"d part involving shifting is to prevent the engine from shutting down\nfor 1 "
"or 2 seconds during shifts."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [105, 70, 125, 90]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "1.1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [125, 111, 200, 129]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [315, 459, 395, 481]
	      Orientation	      "left"
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [55, 230, 75, 250]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [70, 355, 90, 375]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [115, 430, 130, 450]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [455, 535, 475, 555]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [340, 91, 370, 124]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [250, 96, 280, 129]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [405, 101, 435, 134]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [300, 165, 330, 200]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [3, 1]
	      Position		      [210, 324, 240, 376]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [400, 200, 430, 230]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [400, 500, 430, 530]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [340, 500, 370, 530]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [510, 507, 540, 553]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [100, 217, 130, 248]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\nslipping\nor engaged"
	      Position		      [150, 32, 180, 63]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [280, 57, 320, 83]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"key_on"
		Location		[5, 40, 315, 196]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [155, 412, 185, 443]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [115, 332, 145, 363]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [40, 397, 75, 433]
	      ForegroundColor	      "green"
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[59, 74, 434, 236]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [560, 113, 590, 127]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [585, 523, 615, 537]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [560, 63, 590, 77]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Logical\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [15, 0; 0, 165]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0; 0, 35]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [60, 0]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-110, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [50, 0; 0, -60]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [60, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [40, 0]
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 95]
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 315]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping\nor engaged"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "clutch\nslipping\nor engaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch state"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 185]
		DstBlock		"clutch\ndisengaged"
		DstPort			1
	      }
	      Branch {
		DstBlock		"clutch\nslipping\nor engaged"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [195, 401, 230, 529]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox control\nfor use w/ AT"
	  Ports			  [4, 4]
	  Position		  [620, 204, 655, 316]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox control\nfor use w/ AT"
	    Location		    [344, 74, 1167, 963]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "73"
	    Block {
	      BlockType		      Inport
	      Name		      "eta_gb"
	      Position		      [45, 85, 65, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 135, 65, 155]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 180, 65, 200]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 230, 65, 250]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [920, 555, 976, 595]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[430, 234, 888, 441]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
		Annotation {
		  Position		  [217, 162]
		  Text			  "Lock-up of the HTC occurs when it i"
"s supposed to for the current gear, AND\nthe transmission isn't shifting, AND"
"\nthe lockup wouldn't precipitate an immediate downshift."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [385, 65, 405, 85]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [225, 375, 245, 395]
	      Orientation	      "left"
	      Value		      "0.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [460, 818, 555, 832]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [390, 683, 485, 697]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [385, 470, 405, 490]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [730, 671, 735, 709]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [560, 790, 685, 810]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [40, 744, 145, 776]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [560, 850, 685, 870]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [500, 710, 625, 730]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [500, 735, 625, 755]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [500, 645, 625, 665]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From5"
	      Position		      [135, 425, 260, 445]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting_out"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From6"
	      Position		      [100, 255, 195, 275]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "gear_num_out"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [535, 207, 560, 233]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [265, 735, 385, 755]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [265, 759, 385, 781]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [760, 735, 880, 755]
	      GotoTag		      "shifting_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto3"
	      Position		      [890, 45, 1025, 65]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [900, 110, 1010, 130]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [910, 285, 1020, 305]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto7"
	      Position		      [815, 875, 935, 895]
	      GotoTag		      "gear_num_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [4, 1]
	      Position		      [665, 402, 695, 448]
	      Operator		      "AND"
	      Inputs		      "4"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [310, 419, 340, 451]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [1, 1]
	      Position		      [530, 506, 560, 544]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [600, 510, 630, 540]
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [645, 707, 650, 758]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [255, 112, 285, 143]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [595, 203, 615, 227]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product4"
	      Ports		      [2, 1]
	      Position		      [255, 517, 285, 548]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [220, 317, 250, 348]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [780, 111, 800, 129]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [190, 732, 220, 783]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [380, 105, 410, 135]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [380, 510, 410, 540]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [705, 810, 735, 840]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [675, 675, 705, 705]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [475, 32, 505, 68]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[344, 273, 833, 488]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [380, 43, 410, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [150, 60, 185, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [150, 105, 185, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [230, 38, 260, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [230, 98, 260, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, 70; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [50, 0]
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [725, 102, 745, 138]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [655, 114, 685, 146]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [475, 194, 505, 246]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[441, 362, 916, 657]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand1"
	      Ports		      [3, 1]
	      Position		      [475, 499, 505, 551]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand1"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [200, 125, 230, 145]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability1"
	      Position		      [200, 530, 230, 550]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand\nspd"
	      Ports		      [4, 3]
	      Position		      [115, 84, 145, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand\nspd"
		Location		[29, 163, 760, 833]
		Open			off
		ModelBrowserVisibility	on
		ModelBrowserWidth	281
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"63"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear\nnumber"
		  Position		  [20, 113, 50, 127]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [20, 168, 50, 182]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [20, 223, 50, 237]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [20, 278, 50, 292]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [1095, 305, 1151, 345]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the previous gear, assuming that\nthe gearbox efficiency is c"
"onstant."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [760, 220, 780, 240]
		  Orientation		  "left"
		  Value			  "[1 1]"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant5"
		  Position		  [620, 70, 640, 90]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Demux
		  Name			  "Demux"
		  Ports			  [1, 2]
		  Position		  [980, 172, 1015, 208]
		  Outputs		  "2"
		  BusSelectionMode	  off
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [310, 50, 405, 70]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "locked_up"
		}
		Block {
		  BlockType		  From
		  Name			  "From5"
		  Position		  [165, 223, 275, 247]
		  BackgroundColor	  "gray"
		  ShowName		  off
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "acc_mech_trq_est"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "K_adv"
		  Ports			  [1, 1]
		  Position		  [460, 145, 490, 175]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "K_adv"
		    Location		    [502, 588, 994, 833]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    Position		    [45, 58, 75, 72]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "K_adv=wout/(Tout)^0.5"
		    Position		    [160, 51, 280, 79]
		    FontName		    "Arial"
		    Expr		    "u[2]/u[1]^0.5"
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation"
		    Position		    [305, 50, 335, 80]
		    UpperLimit		    "max(htc_k_adv)"
		    LowerLimit		    "min(htc_k_adv)"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation2"
		    Position		    [105, 50, 135, 80]
		    ShowName		    off
		    UpperLimit		    "inf"
		    LowerLimit		    "eps"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "K_adv"
		    Position		    [385, 58, 415, 72]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Saturation"
		    SrcPort		    1
		    DstBlock		    "K_adv"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "K_adv=wout/(Tout)^0.5"
		    SrcPort		    1
		    DstBlock		    "Saturation"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Saturation2"
		    SrcPort		    1
		    DstBlock		    "K_adv=wout/(Tout)^0.5"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    SrcPort		    1
		    DstBlock		    "Saturation2"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [685, 36, 715, 69]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [1, 1]
		  Position		  [510, 43, 540, 77]
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [445, 45, 475, 75]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux1"
		  Ports			  [2, 1]
		  Position		  [805, 97, 840, 133]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux2"
		  Ports			  [2, 1]
		  Position		  [430, 142, 440, 178]
		  ShowName		  off
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [615, 12, 645, 43]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "SR Look-Up\nTable\nSR=wout/win"
		  Position		  [535, 210, 565, 240]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_sr"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [85, 160, 115, 190]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [1035, 185, 1065, 215]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [755, 170, 785, 200]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "TR Look-Up\nTable\nTR=Tout/Tin"
		  Position		  [535, 125, 565, 155]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_tr"
		}
		Block {
		  BlockType		  Mux
		  Name			  "TR,SR"
		  Ports			  [2, 1]
		  Position		  [695, 157, 730, 193]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  Sum
		  Name			  "est eng\ntrq"
		  Ports			  [2, 1]
		  Position		  [295, 132, 315, 168]
		  ForegroundColor	  "magenta"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [85, 108, 115, 132]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~eng trq\nand spd"
		  Ports			  [2, 1]
		  Position		  [870, 161, 900, 194]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [2, 1]
		  Position		  [170, 260, 200, 295]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [170, 105, 200, 195]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [1105, 103, 1135, 117]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [1100, 193, 1130, 207]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "gb_spd_in_est\n(rad/s)1"
		  Position		  [1100, 238, 1130, 252]
		  ForegroundColor	  "blue"
		  Port			  "3"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 150]
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "TR,SR"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  2
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant5"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  1
		  Points		  [40, 0; 0, -70]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux1"
		  SrcPort		  1
		  Points		  [5, 0; 0, 55]
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~eng trq\nand spd"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Demux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux2"
		  SrcPort		  1
		  DstBlock		  "K_adv"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "K_adv"
		  SrcPort		  1
		  Points		  [15, 0; 0, -5]
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "TR Look-Up\nTable\nTR=Tout/Tin"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 70]
		    DstBlock		    "SR Look-Up\nTable\nSR=wout/win"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "TR Look-Up\nTable\nTR=Tout/Tin"
		  SrcPort		  1
		  Points		  [110, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "SR Look-Up\nTable\nSR=wout/win"
		  SrcPort		  1
		  Points		  [110, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From5"
		  SrcPort		  1
		  DstBlock		  "est eng\ntrq"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [205, 0]
		  Branch {
		    Points		    [380, 0; 0, 5]
		    Branch {
		    DstBlock		    "Mux1"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [295, 0]
		    DstBlock		    "gb_spd_in_est\n(rad/s)1"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [0, -110]
		    DstBlock		    "Mux2"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  Points		  [70, 0; 0, -10]
		  DstBlock		  "est eng\ntrq"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "est eng\ntrq"
		  SrcPort		  1
		  Points		  [65, 0]
		  Branch {
		    DstBlock		    "Mux2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35; 190, 0]
		    Branch {
		    Points		    [0, -95]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [200, 0; 0, -10]
		    DstBlock		    "Mux1"
		    DstPort		    1
		    }
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand spd assuming\nlock"
"up"
	      Ports		      [4, 2]
	      Position		      [115, 489, 145, 521]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand spd assuming\nlo"
"ckup"
		Location		[63, 123, 886, 793]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "new gear\nnumber"
		  Position		  [30, 28, 60, 42]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [30, 83, 60, 97]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [30, 138, 60, 152]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_est"
		  Position		  [30, 218, 60, 232]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [625, 180, 681, 220]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the current gear, assuming that\nthe gearbox efficiency is co"
"nstant."
		    }
		  }
		}
		Block {
		  BlockType		  From
		  Name			  "From5"
		  Position		  [220, 73, 330, 97]
		  BackgroundColor	  "gray"
		  ShowName		  off
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "acc_mech_trq_est"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [130, 180, 160, 210]
		  X0			  "gb_ratio(1)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [95, 75, 125, 105]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [580, 65, 610, 95]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "est eng\ntrq"
		  Ports			  [2, 1]
		  Position		  [385, 57, 405, 93]
		  ForegroundColor	  "magenta"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [95, 23, 125, 47]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 150, 210, 240]
		  Inputs		  "*/*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 20, 210, 110]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [645, 18, 675, 32]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [645, 73, 675, 87]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 130]
		    Branch {
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [-35, 0]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "new gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gb_spd_in_est"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From5"
		  SrcPort		  1
		  DstBlock		  "est eng\ntrq"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  DstBlock		  "est eng\ntrq"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "est eng\ntrq"
		  SrcPort		  1
		  Points		  [0, -50]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [310, 0; 0, -110; 30, 0; 0, -5]
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [840, 108, 870, 132]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [310, 116, 345, 144]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)1"
	      Position		      [310, 521, 345, 549]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "lock-up in\nthis gear"
	      Position		      [165, 313, 195, 337]
	      FontName		      "Arial"
	      InputValues	      "[1:length(htc_lockup)]"
	      OutputValues	      "htc_lockup"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [745, 45, 785, 65]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [845, 279, 875, 311]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[76, 244, 366, 435]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [47, 595, 337, 734]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [48, 850, 371, 995]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [389, 635, 793, 850]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [475, 94, 505, 146]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[431, 171, 906, 466]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [1031, 545, 1271, 627]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [800, 815, 820, 835]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [800, 655, 820, 675]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [800, 700, 820, 720]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "locked up"
	      Position		      [940, 415, 960, 435]
	      FontName		      "Arial"
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      2
	      Points		      [35, 0; 0, 35]
	      Branch {
		Points			[0, 65; 240, 0]
		Branch {
		  Points		  [0, 35]
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
		Branch {
		  Points		  [0, -65]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
	      }
	      Branch {
		DstBlock		"engine\ntorque\ncapability"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "est. engine trq\nand\nspd"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -65]
		  Branch {
		    DstBlock		    "prev gear\nnumber"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto3"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 175]
		DstBlock		"shifting1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [55, 0; 0, 160]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "lock-up in\nthis gear"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, 75]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product4"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability1"
	      SrcPort		      1
	      DstBlock		      "Product4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Product4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "eta_gb"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			2
	      }
	      Branch {
		Points			[0, 405]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -40]
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			3
	      }
	      Branch {
		Points			[0, 365]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [290, 0]
	      Branch {
		Points			[0, 285]
		DstBlock		"Switch1"
		DstPort			2
	      }
	      Branch {
		Points			[0, -120]
		DstBlock		"Switch"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      3
	      Points		      [0, 115; -55, 0; 0, 295]
	      DstBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      2
	      Points		      [35, 0; 0, 25]
	      Branch {
		DstBlock		"engine\ntorque\ncapability1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 55; 265, 0; 0, -55]
		DstBlock		"downshift \ncommand1"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, -95]
		DstBlock		"Logical\nOperator"
		DstPort			3
	      }
	      Branch {
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 100]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [120, 0]
	      Branch {
		Points			[0, 10]
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "locked up"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "downshift \ncommand1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [10, 0; 0, -85]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-165, 0]
	      Branch {
		Points			[0, 55]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[-125, 0]
		Branch {
		  Points		  [0, 25]
		  Branch {
		    Points		    [0, 55]
		    Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 100]
		    Branch {
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 275]
		    DstBlock		    "downshift \ncommand1"
		    DstPort		    1
		    }
		    }
		  }
		  Branch {
		    DstBlock		    "allow downshift?"
		    DstPort		    1
		  }
		}
		Branch {
		  Points		  [-355, 0; 0, 30]
		  DstBlock		  "est. engine trq\nand\nspd"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [5, 0]
	      Branch {
		Points			[40, 0]
		DstBlock		"shifting, out"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Goto2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"gear number, out"
		DstPort			1
	      }
	      Branch {
		Points			[0, 60]
		DstBlock		"Goto7"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From6"
	      SrcPort		      1
	      Points		      [0, 35; -50, 0]
	      Branch {
		DstBlock		"lock-up in\nthis gear"
		DstPort			1
	      }
	      Branch {
		Points			[-50, 0]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [964, 24]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [968, 326]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [962, 149]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [962, 202]
	      Text		      "local GOTO blocks:"
	    }
	    Annotation {
	      Position		      [549, 632]
	      Text		      "gear ratio and shifting pre-muxed"
	    }
	    Annotation {
	      Position		      [910, 795]
	      Text		      "output changes depending\nupon whether "
"speed\ndependent shifting is used"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [35, 25, 65, 75]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -10]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [65, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  3
	  Points		  [15, 0]
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <fc>1"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <fc>2"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  4
	  DstBlock		  "Goto <htc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  1
	  DstBlock		  "Goto <htc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  3
	  Points		  [45, 0]
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 5, 0]
	  Branch {
	    Points		    [0, -75]
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [150, 0]
	    Branch {
	      Points		      [0, -60]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [160, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -35]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [5, 0; 0, -35; 10, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [15, 0; 0, 20; 15, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Annotation {
	  Position		  [232, 108]
	  Text			  "required\nforce (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> conv auto\nSaber custom"
      Ports		      []
      Position		      [627, 38, 689, 91]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> conv auto\nSaber custom"
	Location		[-104, 195, 883, 863]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [590, 370, 610, 390]
	  Value			  "3"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [500, 490, 595, 510]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>1"
	  Position		  [500, 455, 595, 475]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>2"
	  Position		  [500, 420, 595, 440]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [525, 235, 620, 255]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [525, 176, 620, 194]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [525, 275, 620, 295]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [50, 152, 125, 168]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [55, 185, 115, 205]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [40, 116, 125, 134]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [85, 377, 195, 393]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [90, 411, 190, 429]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [505, 516, 590, 534]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [70, 466, 190, 484]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [90, 335, 150, 355]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [310, 130, 370, 150]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [100, 41, 185, 59]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [525, 210, 620, 230]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [85, 436, 200, 454]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [705, 448, 775, 472]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [695, 478, 785, 502]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [715, 521, 765, 539]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [720, 214, 795, 236]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [735, 255, 790, 275]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>"
	  Position		  [720, 292, 795, 308]
	  GotoTag		  "locked_up"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>1"
	  Position		  [720, 184, 795, 206]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [655, 369, 740, 391]
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [450, 126, 535, 144]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [450, 75, 535, 95]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [210, 134, 300, 156]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [250, 166, 340, 184]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [285, 381, 370, 399]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [285, 444, 370, 466]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [250, 40, 360, 60]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [215, 201, 305, 219]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [210, 231, 300, 249]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [420, 15, 530, 35]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [175, 495, 195, 515]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [400, 117, 430, 148]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [400, 67, 430, 98]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [205, 37, 235, 88]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [145, 109, 180, 211]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine\ncontrol"
	  Ports			  [4, 3]
	  Position		  [645, 439, 680, 536]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine\ncontrol"
	    Location		    [41, 356, 699, 934]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [35, 168, 65, 182]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch state"
	      Position		      [35, 33, 65, 47]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [40, 518, 70, 532]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [35, 333, 65, 347]
	      NamePlacement	      "alternate"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [560, 355, 616, 395]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[156, 423, 612, 520]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine control block determine"
"s whether the engine is on, which it is when\n[(the clutch is slipping or eng"
"aged OR idling is allowed) AND the ignition key is on]\nOR\n(the transmission"
" is shifting AND the engine was on during the previous time step).\nThe secon"
"d part involving shifting is to prevent the engine from shutting down\nfor 1 "
"or 2 seconds during shifts."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [105, 70, 125, 90]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "1.1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [125, 111, 200, 129]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [315, 459, 395, 481]
	      Orientation	      "left"
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [55, 230, 75, 250]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [70, 355, 90, 375]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [115, 430, 130, 450]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [455, 535, 475, 555]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [340, 91, 370, 124]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [250, 96, 280, 129]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [405, 101, 435, 134]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [300, 165, 330, 200]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [3, 1]
	      Position		      [210, 324, 240, 376]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [400, 200, 430, 230]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [400, 500, 430, 530]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [340, 500, 370, 530]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [510, 507, 540, 553]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [100, 217, 130, 248]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\nslipping\nor engaged"
	      Position		      [150, 32, 180, 63]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [280, 57, 320, 83]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"key_on"
		Location		[5, 40, 315, 196]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [155, 412, 185, 443]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [115, 332, 145, 363]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [40, 397, 75, 433]
	      ForegroundColor	      "green"
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[59, 74, 434, 236]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [560, 113, 590, 127]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [585, 523, 615, 537]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [560, 63, 590, 77]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "clutch state"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"clutch\nslipping\nor engaged"
		DstPort			1
	      }
	      Branch {
		Points			[0, 185]
		DstBlock		"clutch\ndisengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "clutch\nslipping\nor engaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping\nor engaged"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [40, 0]
	      Branch {
		Points			[0, 95]
		Branch {
		  Points		  [0, 315]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [60, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [50, 0; 0, -60]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-110, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [60, 0]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0; 0, 35]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [15, 0; 0, 165]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		DstBlock		"Logical\nOperator1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [230, 356, 265, 484]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox control\nfor use w/ AT"
	  Ports			  [4, 4]
	  Position		  [640, 184, 675, 296]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox control\nfor use w/ AT"
	    Location		    [433, 403, 931, 703]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "33"
	    Block {
	      BlockType		      Inport
	      Name		      "eta_gb"
	      Position		      [45, 85, 65, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 135, 65, 155]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 180, 65, 200]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 230, 65, 250]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [920, 555, 976, 595]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[430, 234, 888, 441]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [217, 162]
		  Text			  "Lock-up of the HTC occurs when it i"
"s supposed to for the current gear, AND\nthe transmission isn't shifting, AND"
"\nthe lockup wouldn't precipitate an immediate downshift."
		}
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [385, 65, 405, 85]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [305, 375, 325, 395]
	      Orientation	      "left"
	      Value		      "0.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [470, 813, 565, 827]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [400, 678, 495, 692]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [385, 470, 405, 490]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [740, 666, 745, 704]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [570, 785, 695, 805]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [50, 739, 155, 771]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [570, 845, 695, 865]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [510, 705, 635, 725]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [510, 730, 635, 750]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [510, 640, 635, 660]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From5"
	      Position		      [195, 427, 285, 443]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting_out"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From6"
	      Position		      [110, 285, 205, 305]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "gear_num_out"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [535, 207, 560, 233]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [275, 730, 395, 750]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [275, 754, 395, 776]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [790, 854, 880, 876]
	      GotoTag		      "gear_num_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto3"
	      Position		      [780, 744, 870, 766]
	      GotoTag		      "shifting_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [880, 235, 1015, 255]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [905, 65, 1015, 85]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [900, 140, 1010, 160]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [4, 1]
	      Position		      [665, 402, 695, 448]
	      Operator		      "AND"
	      Inputs		      "4"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [315, 419, 345, 451]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [1, 1]
	      Position		      [530, 506, 560, 544]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [600, 510, 630, 540]
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [655, 702, 660, 753]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [255, 112, 285, 143]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [595, 203, 615, 227]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product4"
	      Ports		      [2, 1]
	      Position		      [255, 517, 285, 548]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 317, 330, 348]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [780, 66, 800, 84]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [200, 727, 230, 778]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [380, 105, 410, 135]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [380, 510, 410, 540]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [715, 805, 745, 835]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [685, 670, 715, 700]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [475, 32, 505, 68]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[344, 273, 833, 488]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [380, 43, 410, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [150, 60, 185, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [150, 105, 185, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [230, 38, 260, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [230, 98, 260, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [50, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 70; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [725, 57, 745, 93]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [655, 114, 685, 146]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [475, 194, 505, 246]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[441, 362, 916, 657]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand1"
	      Ports		      [3, 1]
	      Position		      [475, 499, 505, 551]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand1"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [200, 125, 230, 145]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability1"
	      Position		      [200, 530, 230, 550]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand\nspd"
	      Ports		      [4, 3]
	      Position		      [115, 84, 145, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand\nspd"
		Location		[374, 66, 872, 366]
		Open			off
		ModelBrowserVisibility	on
		ModelBrowserWidth	326
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"43"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear\nnumber"
		  Position		  [20, 113, 50, 127]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [20, 168, 50, 182]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [20, 223, 50, 237]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [20, 283, 50, 297]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [1095, 305, 1151, 345]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  on
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the previous gear, assuming that\nthe gearbox efficiency is c"
"onstant."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [760, 220, 780, 240]
		  Orientation		  "left"
		  Value			  "[1 1]"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant5"
		  Position		  [620, 70, 640, 90]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Demux
		  Name			  "Demux"
		  Ports			  [1, 2]
		  Position		  [980, 172, 1015, 208]
		  Outputs		  "2"
		  BusSelectionMode	  off
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [310, 50, 405, 70]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "locked_up"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "K_adv"
		  Ports			  [1, 1]
		  Position		  [460, 145, 490, 175]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "K_adv"
		    Location		    [502, 588, 994, 833]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    Position		    [45, 58, 75, 72]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "K_adv=wout/(Tout)^0.5"
		    Position		    [160, 51, 280, 79]
		    FontName		    "Arial"
		    Expr		    "u[2]/u[1]^0.5"
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation"
		    Position		    [305, 50, 335, 80]
		    UpperLimit		    "max(htc_k_adv)"
		    LowerLimit		    "min(htc_k_adv)"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation2"
		    Position		    [105, 50, 135, 80]
		    ShowName		    off
		    UpperLimit		    "inf"
		    LowerLimit		    "eps"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "K_adv"
		    Position		    [385, 58, 415, 72]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    SrcPort		    1
		    DstBlock		    "Saturation2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Saturation2"
		    SrcPort		    1
		    DstBlock		    "K_adv=wout/(Tout)^0.5"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "K_adv=wout/(Tout)^0.5"
		    SrcPort		    1
		    DstBlock		    "Saturation"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Saturation"
		    SrcPort		    1
		    DstBlock		    "K_adv"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [685, 36, 715, 69]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [1, 1]
		  Position		  [510, 43, 540, 77]
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [445, 45, 475, 75]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux1"
		  Ports			  [2, 1]
		  Position		  [805, 97, 840, 133]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux2"
		  Ports			  [2, 1]
		  Position		  [430, 142, 440, 178]
		  ShowName		  off
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [615, 12, 645, 43]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "SR Look-Up\nTable\nSR=wout/win"
		  Position		  [535, 210, 565, 240]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_sr"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [85, 160, 115, 190]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [1035, 185, 1065, 215]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [755, 170, 785, 200]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "TR Look-Up\nTable\nTR=Tout/Tin"
		  Position		  [535, 125, 565, 155]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_tr"
		}
		Block {
		  BlockType		  Mux
		  Name			  "TR,SR"
		  Ports			  [2, 1]
		  Position		  [695, 157, 730, 193]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "accessories\n(Nm)"
		  Ports			  [0, 1]
		  Position		  [235, 186, 260, 214]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "accessories\n(Nm)"
		    Location		    [433, 403, 931, 703]
		    Open		    off
		    ModelBrowserVisibility  on
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    From
		    Name		    "From <fc>"
		    Position		    [135, 98, 225, 122]
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "fc_acc_trq_r"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [300, 103, 330, 117]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "From <fc>"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "est eng\ntrq"
		  Ports			  [2, 1]
		  Position		  [295, 172, 315, 208]
		  ForegroundColor	  "magenta"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [85, 108, 115, 132]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~eng trq\nand spd"
		  Ports			  [2, 1]
		  Position		  [870, 161, 900, 194]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [2, 1]
		  Position		  [170, 265, 200, 300]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [170, 105, 200, 195]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [1105, 103, 1135, 117]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [1100, 193, 1130, 207]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "gb_spd_in_est\n(rad/s)1"
		  Position		  [1100, 238, 1130, 252]
		  ForegroundColor	  "blue"
		  Port			  "3"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "est eng\ntrq"
		  SrcPort		  1
		  Points		  [0, -40; 65, 0]
		  Branch {
		    Points		    [0, -35; 190, 0]
		    Branch {
		    Points		    [200, 0; 0, -10]
		    DstBlock		    "Mux1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -95]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Mux2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  Points		  [70, 0; 0, 30]
		  DstBlock		  "est eng\ntrq"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "accessories\n(Nm)"
		  SrcPort		  1
		  DstBlock		  "est eng\ntrq"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "SR Look-Up\nTable\nSR=wout/win"
		  SrcPort		  1
		  Points		  [110, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "TR Look-Up\nTable\nTR=Tout/Tin"
		  SrcPort		  1
		  Points		  [110, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "K_adv"
		  SrcPort		  1
		  Points		  [15, 0; 0, -5]
		  Branch {
		    Points		    [0, 70]
		    DstBlock		    "SR Look-Up\nTable\nSR=wout/win"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "TR Look-Up\nTable\nTR=Tout/Tin"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Mux2"
		  SrcPort		  1
		  DstBlock		  "K_adv"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~eng trq\nand spd"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Demux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux1"
		  SrcPort		  1
		  Points		  [5, 0; 0, 55]
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  1
		  Points		  [40, 0; 0, -70]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant5"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  2
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "TR,SR"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 155]
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [0, -5; 205, 0]
		  Branch {
		    Points		    [0, -110]
		    DstBlock		    "Mux2"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [380, 0; 0, 5]
		    Branch {
		    Points		    [295, 0]
		    DstBlock		    "gb_spd_in_est\n(rad/s)1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Mux1"
		    DstPort		    2
		    }
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand spd assuming\nlock"
"up"
	      Ports		      [4, 2]
	      Position		      [115, 489, 145, 521]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand spd assuming\nlo"
"ckup"
		Location		[541, 693, 1242, 977]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "new gear\nnumber"
		  Position		  [30, 28, 60, 42]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [30, 83, 60, 97]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [30, 138, 60, 152]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_est"
		  Position		  [30, 218, 60, 232]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [625, 180, 681, 220]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the current gear, assuming that\nthe gearbox efficiency is co"
"nstant."
		    }
		  }
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [130, 180, 160, 210]
		  X0			  "gb_ratio(1)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [95, 75, 125, 105]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [580, 65, 610, 95]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "accessories\n(Nm)"
		  Ports			  [0, 1]
		  Position		  [325, 87, 355, 123]
		  ForegroundColor	  "magenta"
		  NamePlacement		  "alternate"
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "accessories\n(Nm)"
		    Location		    [304, 377, 530, 497]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    From
		    Name		    "From <fc>"
		    Position		    [30, 29, 120, 61]
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "fc_acc_trq_r"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "T_acc"
		    Position		    [145, 35, 165, 55]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "From <fc>"
		    SrcPort		    1
		    DstBlock		    "T_acc"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "est eng\ntrq"
		  Ports			  [2, 1]
		  Position		  [385, 57, 405, 93]
		  ForegroundColor	  "magenta"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [95, 23, 125, 47]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 150, 210, 240]
		  Inputs		  "*/*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 20, 210, 110]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [645, 18, 675, 32]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [645, 73, 675, 87]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "est eng\ntrq"
		  SrcPort		  1
		  Points		  [0, -50]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  DstBlock		  "est eng\ntrq"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "accessories\n(Nm)"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "est eng\ntrq"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gb_spd_in_est"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "new gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 130]
		    Branch {
		    Points		    [-35, 0]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [310, 0; 0, -110; 30, 0; 0, -5]
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [835, 63, 865, 87]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [310, 116, 345, 144]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)1"
	      Position		      [310, 521, 345, 549]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "lock-up in\nthis gear"
	      Position		      [245, 313, 275, 337]
	      FontName		      "Arial"
	      InputValues	      "[1:length(htc_lockup)]"
	      OutputValues	      "htc_lockup"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [745, 15, 785, 35]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [835, 134, 865, 166]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[76, 244, 366, 435]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [47, 595, 337, 734]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [48, 850, 371, 995]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [389, 635, 793, 850]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [475, 94, 505, 146]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[431, 171, 906, 466]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [1031, 545, 1271, 627]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [810, 810, 830, 830]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [810, 650, 830, 670]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [810, 695, 830, 715]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "locked up"
	      Position		      [940, 415, 960, 435]
	      FontName		      "Arial"
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [10, 0; 0, -85]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "downshift \ncommand1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "locked up"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [120, 0]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[0, 10]
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 100]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Memory"
		DstPort			1
	      }
	      Branch {
		Points			[0, -95]
		DstBlock		"Logical\nOperator"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      2
	      Points		      [35, 0; 0, 25]
	      Branch {
		Points			[0, 55; 265, 0; 0, -55]
		DstBlock		"downshift \ncommand1"
		DstPort			3
	      }
	      Branch {
		DstBlock		"engine\ntorque\ncapability1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      3
	      Points		      [0, 115; -55, 0; 0, 295]
	      DstBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [290, 0]
	      Branch {
		Points			[0, -120]
		DstBlock		"Switch"
		DstPort			2
	      }
	      Branch {
		Points			[0, 285]
		DstBlock		"Switch1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 365]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			3
	      }
	      Branch {
		Points			[0, -40]
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "eta_gb"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 405]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			2
	      }
	      Branch {
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Product4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability1"
	      SrcPort		      1
	      DstBlock		      "Product4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product4"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [55, 0; 0, 160]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -50]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 95]
		  DstBlock		  "Goto4"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-165, 0]
	      Branch {
		Points			[-125, 0]
		Branch {
		  Points		  [-355, 0; 0, 60]
		  DstBlock		  "est. engine trq\nand\nspd"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 25]
		  Branch {
		    DstBlock		    "allow downshift?"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 55]
		    Branch {
		    Points		    [0, 100]
		    Branch {
		    Points		    [0, 305]
		    DstBlock		    "downshift \ncommand1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		    }
		  }
		}
	      }
	      Branch {
		Points			[0, 40]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "est. engine trq\nand\nspd"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      2
	      Points		      [35, 0; 0, 35]
	      Branch {
		DstBlock		"engine\ntorque\ncapability"
		DstPort			1
	      }
	      Branch {
		Points			[0, 65; 240, 0]
		Branch {
		  Points		  [0, -65]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
		Branch {
		  Points		  [0, 35]
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"gear number, out"
		DstPort			1
	      }
	      Branch {
		Points			[0, 45]
		DstBlock		"Goto2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 0]
	      Branch {
		Points			[45, 0]
		DstBlock		"shifting, out"
		DstPort			1
	      }
	      Branch {
		Points			[0, 60]
		DstBlock		"Goto3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "From5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      Labels		      [2, 0]
	      SrcBlock		      "From6"
	      SrcPort		      1
	      Points		      [15, 0; 0, 30]
	      Branch {
		DstBlock		"lock-up in\nthis gear"
		DstPort			1
	      }
	      Branch {
		Points			[-125, 0]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, 75]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "lock-up in\nthis gear"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [559, 627]
	      Text		      "gear ratio and shifting pre-muxed"
	    }
	    Annotation {
	      Position		      [945, 780]
	      Text		      "output changes depending\nupon whether "
"speed\ndependent shifting is used"
	    }
	    Annotation {
	      Position		      [949, 289]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [958, 181]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [967, 44]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [967, 17]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [35, 20, 65, 70]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [60, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  4
	  Points		  [25, 0]
	  DstBlock		  "Goto <htc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  3
	  Points		  [15, 0]
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>1"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <fc>2"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -50]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [190, 0]
	    Branch {
	      Points		      [0, -35]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  1
	  DstBlock		  "Goto <htc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  3
	  Points		  [40, 0]
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [15, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [5, 0; 0, -35]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [229, 122]
	  Text			  "required \nforce (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> conv cvt"
      Ports		      [0, 1]
      Position		      [265, 48, 325, 102]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> conv cvt"
	Location		[21, 74, 833, 723]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"89"
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [650, 235, 670, 255]
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [560, 480, 655, 500]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>1"
	  Position		  [560, 445, 655, 465]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>2"
	  Position		  [555, 410, 650, 430]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>3"
	  Position		  [570, 285, 665, 305]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [630, 99, 715, 121]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [630, 141, 725, 159]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [635, 175, 730, 195]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [570, 320, 665, 340]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [570, 360, 665, 380]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [80, 192, 155, 208]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [80, 225, 140, 245]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [80, 156, 165, 174]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [55, 402, 165, 418]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [60, 436, 160, 454]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [560, 516, 645, 534]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [35, 496, 155, 514]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [60, 365, 120, 385]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [365, 170, 425, 190]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [125, 81, 210, 99]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [630, 71, 720, 89]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [55, 461, 170, 479]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [775, 423, 845, 447]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [765, 468, 855, 492]
	  NamePlacement		  "alternate"
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [780, 506, 830, 524]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [815, 113, 905, 137]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [710, 233, 800, 257]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [780, 274, 865, 296]
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [510, 166, 595, 184]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [460, 115, 545, 135]
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [260, 174, 350, 196]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [335, 206, 425, 224]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [255, 406, 340, 424]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [255, 469, 340, 491]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [290, 80, 400, 100]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [255, 241, 345, 259]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [250, 271, 340, 289]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [455, 40, 565, 60]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [70, 535, 90, 555]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [455, 157, 485, 188]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [410, 107, 440, 138]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [245, 77, 275, 128]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "clutch\ncontrol"
	  Ports			  [3, 1]
	  Position		  [705, 293, 740, 367]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "clutch\ncontrol"
	    Location		    [159, 109, 938, 559]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "96"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 28, 60, 42]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 83, 60, 97]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 193, 55, 207]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [705, 395, 761, 435]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[275, 723, 733, 885]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [85, 108, 120, 132]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [85, 149, 165, 171]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [85, 214, 165, 236]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [85, 280, 120, 300]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [85, 344, 165, 366]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [510, 380, 545, 400]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [600, 135, 660, 165]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [320, 92, 350, 123]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [255, 152, 285, 183]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [510, 325, 540, 355]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [530, 132, 565, 168]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [240, 82, 270, 113]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [200, 202, 230, 233]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [200, 267, 230, 298]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [200, 332, 230, 363]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [390, 42, 420, 73]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [460, 142, 490, 173]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [320, 279, 350, 311]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [415, 330, 450, 365]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [725, 143, 755, 157]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	      Branch {
		Points			[15, 0; 0, 190]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [310, 0]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [185, 149, 220, 251]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "cvt control"
	  Ports			  [4, 1]
	  Position		  [760, 61, 795, 189]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "cvt control"
	    Location		    [2, 43, 966, 766]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "cvt_trq_out_r"
	      Position		      [35, 85, 55, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "cvt_spd_out_r"
	      Position		      [35, 145, 55, 165]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [30, 190, 50, 210]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [30, 290, 50, 310]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [625, 310, 681, 350]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[332, 545, 628, 674]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [147, 12]
		  VerticalAlignment	  "top"
		  Text			  "This CVT control block tries to kee"
"p the engine\noperating along the curve defined in engine \npower/speed space"
" defined by cvt_locus_pwr\nand cv_locus_spd.\n\nUsually, this curve will be t"
"he locus of best\n efficiency points over the range of engine power."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [350, 210, 380, 230]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [165, 240, 195, 260]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [105, 34, 245, 56]
	      BackgroundColor	      "gray"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "acc_mech_pwr_est"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [3, 1]
	      Position		      [225, 89, 255, 121]
	      Inputs		      "**/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [475, 91, 505, 124]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [535, 100, 565, 120]
	      FontName		      "Arial"
	      UpperLimit	      "max(gb_ratio)"
	      LowerLimit	      "min(gb_ratio)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation2"
	      Position		      [360, 90, 390, 110]
	      FontName		      "Arial"
	      UpperLimit	      "max(cvt_locus_pwr)*fc_trq_scale*fc_spd_"
"scale"
	      LowerLimit	      "min(cvt_locus_pwr)*fc_trq_scale*fc_spd_"
"scale"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [165, 192, 195, 223]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Terminator
	      Name		      "Terminator"
	      Position		      [85, 290, 105, 310]
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "desired\nengine\nspeed"
	      Position		      [410, 88, 440, 112]
	      InputValues	      "cvt_locus_pwr*fc_trq_scale*fc_spd_scale"
	      OutputValues	      "cvt_locus_spd*fc_spd_scale+eps"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "est.\nengine\npower"
	      Ports		      [2, 1]
	      Position		      [305, 82, 335, 113]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "output\nspeed"
	      Ports		      [2, 1]
	      Position		      [350, 147, 380, 178]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "pulley ratio\n"
	      Position		      [610, 100, 630, 120]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "output\nspeed"
	      SrcPort		      1
	      Points		      [60, 0; 0, -50]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-10, 0]
	      DstBlock		      "output\nspeed"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      DstBlock		      "est.\nengine\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "desired\nengine\nspeed"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "est.\nengine\npower"
	      SrcPort		      1
	      DstBlock		      "Saturation2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation2"
	      SrcPort		      1
	      DstBlock		      "desired\nengine\nspeed"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "est.\nengine\npower"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "cvt_spd_out_r"
	      SrcPort		      1
	      Points		      [115, 0]
	      Branch {
		DstBlock		"output\nspeed"
		DstPort			1
	      }
	      Branch {
		Points			[0, -50]
		DstBlock		"Product"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "cvt_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Product"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-10, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      DstBlock		      "Terminator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      DstBlock		      "pulley ratio\n"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine\ncontrol"
	  Ports			  [4, 3]
	  Position		  [705, 429, 735, 526]
	  ForegroundColor	  "green"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine\ncontrol"
	    Location		    [231, 146, 856, 725]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "clutch state"
	      Position		      [35, 33, 65, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 188, 60, 202]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [35, 553, 65, 567]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [30, 333, 60, 347]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [560, 245, 616, 285]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[156, 423, 612, 520]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine control block determine"
"s whether the engine is on, which it is when\n[(the clutch is slipping or eng"
"aged OR idling is allowed) AND the ignition key is on]\nOR\n(the transmission"
" is shifting AND the engine was on during the previous time step).\nThe secon"
"d part involving shifting is to prevent the engine from shutting down\nfor 1 "
"or 2 seconds during shifts."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [150, 80, 170, 100]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Value		      "1.1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [120, 129, 215, 151]
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [330, 494, 410, 516]
	      Orientation	      "left"
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [115, 285, 135, 305]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [115, 400, 135, 420]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [95, 466, 120, 484]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [485, 570, 505, 590]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [335, 111, 365, 144]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [265, 116, 295, 149]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [435, 121, 465, 154]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [295, 185, 325, 220]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [3, 1]
	      Position		      [205, 332, 235, 368]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [405, 220, 435, 250]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [430, 535, 460, 565]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [355, 535, 385, 565]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [535, 545, 565, 575]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [110, 222, 140, 253]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\nslipping\nor engaged"
	      Position		      [195, 32, 225, 63]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [275, 61, 310, 89]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"key_on"
		Location		[5, 40, 315, 196]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [145, 452, 175, 483]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [110, 332, 140, 363]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [30, 442, 65, 478]
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[57, 72, 432, 234]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [565, 133, 595, 147]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [590, 553, 620, 567]
	      NamePlacement	      "alternate"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [555, 68, 585, 82]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping\nor engaged"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -20]
	      DstBlock		      "clutch\nslipping\nor engaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch state"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"clutch\nslipping\nor engaged"
		DstPort			1
	      }
	      Branch {
		Points			[0, 190]
		DstBlock		"clutch\ndisengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 95]
		Branch {
		  Points		  [0, 325]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Logical\nOperator1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-120, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [65, 0; 0, -60]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [-20, 0; 0, -50]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      Points		      [-20, 0; 0, -55]
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0; 0, 35]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [10, 0; 0, 200]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [200, 381, 235, 509]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [40, 45, 70, 95]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [815, 323, 845, 337]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [165, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [100, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -5; 25, 0; 0, -60]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -10]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [60, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "cvt control"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "cvt control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  Points		  [0, -15]
	  DstBlock		  "cvt control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "clutch\ncontrol"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    Points		    [0, -45]
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  3
	  Points		  [25, 0]
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>1"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <fc>2"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>3"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [40, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [15, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [85, 0; 0, -50]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [274, 164]
	  Text			  "required\nforce (N)"
	}
	Annotation {
	  Position		  [485, 449]
	  Text			  "shifting is 0 (see above)"
	}
	Annotation {
	  Position		  [460, 292]
	  Text			  "note: shifting is \"0\", see above clutch c"
"ntrl"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> conv cvt\nSaber custom"
      Ports		      [0, 1]
      Position		      [750, 33, 810, 87]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> conv cvt\nSaber custom"
	Location		[8, 74, 995, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"96"
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [630, 265, 650, 285]
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [535, 510, 630, 530]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>1"
	  Position		  [535, 475, 630, 495]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>2"
	  Position		  [535, 440, 630, 460]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>3"
	  Position		  [545, 315, 640, 335]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [550, 54, 635, 76]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [550, 96, 645, 114]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [555, 130, 650, 150]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [545, 350, 640, 370]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [545, 390, 640, 410]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 192, 105, 208]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [25, 225, 85, 245]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [20, 156, 105, 174]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [75, 422, 185, 438]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [80, 456, 180, 474]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [540, 536, 625, 554]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [55, 506, 175, 524]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [75, 380, 135, 400]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [315, 170, 375, 190]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [105, 81, 190, 99]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [550, 26, 640, 44]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [75, 481, 190, 499]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [750, 453, 820, 477]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [740, 498, 830, 522]
	  NamePlacement		  "alternate"
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [755, 536, 805, 554]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [735, 68, 825, 92]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [690, 263, 780, 287]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [755, 304, 840, 326]
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [450, 166, 535, 184]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [450, 115, 535, 135]
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [200, 169, 290, 191]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [230, 201, 320, 219]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [275, 426, 360, 444]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [275, 489, 360, 511]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [270, 80, 380, 100]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [190, 241, 280, 259]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [185, 271, 275, 289]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [400, 50, 510, 70]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [155, 530, 175, 550]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [400, 157, 430, 188]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [400, 107, 430, 138]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [210, 77, 240, 128]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "clutch\ncontrol"
	  Ports			  [3, 1]
	  Position		  [680, 323, 715, 397]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "clutch\ncontrol"
	    Location		    [159, 109, 938, 559]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 28, 60, 42]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 83, 60, 97]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 193, 55, 207]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [705, 395, 761, 435]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[275, 723, 733, 885]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [85, 108, 120, 132]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [85, 149, 165, 171]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [85, 214, 165, 236]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [85, 280, 120, 300]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [85, 344, 165, 366]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [510, 380, 545, 400]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [600, 135, 660, 165]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [320, 92, 350, 123]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [255, 152, 285, 183]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [510, 325, 540, 355]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [530, 132, 565, 168]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [240, 82, 270, 113]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [200, 202, 230, 233]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [200, 267, 230, 298]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [200, 332, 230, 363]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [390, 42, 420, 73]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [460, 142, 490, 173]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [320, 279, 350, 311]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [415, 330, 450, 365]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [725, 143, 755, 157]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [310, 0]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[15, 0; 0, 190]
		DstBlock		"Memory"
		DstPort			1
	      }
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [120, 149, 155, 251]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "cvt control"
	  Ports			  [4, 1]
	  Position		  [680, 16, 715, 144]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "cvt control"
	    Location		    [101, 316, 814, 691]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "cvt_trq_out_r"
	      Position		      [35, 85, 55, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "cvt_spd_out_r"
	      Position		      [35, 145, 55, 165]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [30, 190, 50, 210]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [30, 290, 50, 310]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [625, 310, 681, 350]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[332, 545, 628, 674]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [147, 12]
		  VerticalAlignment	  "top"
		  Text			  "This CVT control block tries to kee"
"p the engine\noperating along the curve defined in engine \npower/speed space"
" defined by cvt_locus_pwr\nand cv_locus_spd.\n\nUsually, this curve will be t"
"he locus of best\n efficiency points over the range of engine power."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [350, 210, 380, 230]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [165, 240, 195, 260]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [3, 1]
	      Position		      [225, 89, 255, 121]
	      Inputs		      "**/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [475, 91, 505, 124]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [535, 100, 565, 120]
	      FontName		      "Arial"
	      UpperLimit	      "max(gb_ratio)"
	      LowerLimit	      "min(gb_ratio)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation2"
	      Position		      [360, 90, 390, 110]
	      FontName		      "Arial"
	      UpperLimit	      "max(cvt_locus_pwr)*fc_trq_scale*fc_spd_"
"scale"
	      LowerLimit	      "min(cvt_locus_pwr)*fc_trq_scale*fc_spd_"
"scale"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [165, 192, 195, 223]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Terminator
	      Name		      "Terminator"
	      Position		      [85, 290, 105, 310]
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "accessories\n(Nm)"
	      Ports		      [0, 1]
	      Position		      [230, 22, 260, 58]
	      ForegroundColor	      "magenta"
	      SourceBlock	      "lib_controls/<vc> conv\nSaber custom/ge"
"arbox\n control/accessories\n(Nm)"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "desired\nengine\nspeed"
	      Position		      [410, 88, 440, 112]
	      InputValues	      "cvt_locus_pwr*fc_trq_scale*fc_spd_scale"
	      OutputValues	      "cvt_locus_spd*fc_spd_scale+eps"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "est.\nengine\npower"
	      Ports		      [2, 1]
	      Position		      [305, 82, 335, 113]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "output\nspeed"
	      Ports		      [2, 1]
	      Position		      [350, 147, 380, 178]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "pulley ratio\n"
	      Position		      [610, 100, 630, 120]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      DstBlock		      "pulley ratio\n"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      DstBlock		      "Terminator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-10, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Product"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "cvt_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "cvt_spd_out_r"
	      SrcPort		      1
	      Points		      [115, 0]
	      Branch {
		DstBlock		"output\nspeed"
		DstPort			1
	      }
	      Branch {
		Points			[0, -50]
		DstBlock		"Product"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "accessories\n(Nm)"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "est.\nengine\npower"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation2"
	      SrcPort		      1
	      DstBlock		      "desired\nengine\nspeed"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "est.\nengine\npower"
	      SrcPort		      1
	      DstBlock		      "Saturation2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "desired\nengine\nspeed"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      DstBlock		      "est.\nengine\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-10, 0]
	      DstBlock		      "output\nspeed"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "output\nspeed"
	      SrcPort		      1
	      Points		      [60, 0; 0, -50]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine\ncontrol"
	  Ports			  [4, 3]
	  Position		  [680, 459, 710, 556]
	  ForegroundColor	  "green"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine\ncontrol"
	    Location		    [231, 146, 856, 725]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "clutch state"
	      Position		      [35, 33, 65, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 188, 60, 202]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [35, 553, 65, 567]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [30, 333, 60, 347]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [560, 245, 616, 285]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[156, 423, 612, 520]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine control block determine"
"s whether the engine is on, which it is when\n[(the clutch is slipping or eng"
"aged OR idling is allowed) AND the ignition key is on]\nOR\n(the transmission"
" is shifting AND the engine was on during the previous time step).\nThe secon"
"d part involving shifting is to prevent the engine from shutting down\nfor 1 "
"or 2 seconds during shifts."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [150, 80, 170, 100]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Value		      "1.1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [120, 129, 215, 151]
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [330, 494, 410, 516]
	      Orientation	      "left"
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [115, 285, 135, 305]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [115, 400, 135, 420]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [95, 466, 120, 484]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [485, 570, 505, 590]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [335, 111, 365, 144]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [265, 116, 295, 149]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [435, 121, 465, 154]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [295, 185, 325, 220]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [3, 1]
	      Position		      [205, 332, 235, 368]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [405, 220, 435, 250]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [430, 535, 460, 565]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [355, 535, 385, 565]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [535, 545, 565, 575]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [110, 222, 140, 253]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\nslipping\nor engaged"
	      Position		      [195, 32, 225, 63]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [275, 61, 310, 89]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"key_on"
		Location		[5, 40, 315, 196]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [145, 452, 175, 483]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [110, 332, 140, 363]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [30, 442, 65, 478]
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[57, 72, 432, 234]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [565, 133, 595, 147]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [590, 553, 620, 567]
	      NamePlacement	      "alternate"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [555, 68, 585, 82]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [10, 0; 0, 200]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0; 0, 35]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      Points		      [-20, 0; 0, -55]
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [-20, 0; 0, -50]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [65, 0; 0, -60]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-120, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Logical\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 95]
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 325]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch state"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 190]
		DstBlock		"clutch\ndisengaged"
		DstPort			1
	      }
	      Branch {
		DstBlock		"clutch\nslipping\nor engaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -20]
	      DstBlock		      "clutch\nslipping\nor engaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping\nor engaged"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [220, 401, 255, 529]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [35, 45, 65, 95]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [790, 353, 820, 367]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [115, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -10; 25, 0]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 10, 0]
	  Branch {
	    Points		    [0, -50]
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [215, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  3
	  Points		  [25, 0]
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine\ncontrol"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "clutch\ncontrol"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    Points		    [0, -45]
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  DstBlock		  "engine\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <fc>1"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <fc>2"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "engine\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>3"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  Points		  [0, -15]
	  DstBlock		  "cvt control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "cvt control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "cvt control"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [65, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [15, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [15, 0; 0, -25]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [215, 165]
	  Text			  "required\nforce (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> ev"
      Ports		      []
      Position		      [100, 649, 160, 699]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> ev"
	Location		[6, 74, 818, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"96"
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [570, 325, 665, 345]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [565, 140, 655, 160]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [565, 181, 650, 199]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [565, 221, 650, 239]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [570, 291, 655, 309]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [570, 355, 665, 375]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [570, 391, 665, 409]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [35, 157, 110, 173]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [25, 190, 85, 210]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [25, 121, 110, 139]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [190, 322, 300, 338]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [195, 356, 295, 374]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [320, 170, 380, 190]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [175, 416, 295, 434]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [215, 285, 275, 305]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [80, 46, 165, 64]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [565, 111, 650, 129]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [190, 381, 305, 399]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [750, 122, 825, 148]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [760, 160, 825, 180]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [765, 195, 825, 215]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [745, 345, 835, 365]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>\n<pb><sdo>"
	  Position		  [690, 446, 740, 464]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [680, 39, 765, 61]
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [465, 166, 550, 184]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [460, 80, 545, 100]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [205, 139, 295, 161]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [200, 161, 290, 179]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [390, 326, 475, 344]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [390, 389, 475, 411]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [235, 45, 345, 65]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [195, 206, 285, 224]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [190, 236, 280, 254]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [420, 20, 530, 40]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [245, 475, 265, 495]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [410, 157, 440, 188]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [410, 72, 440, 103]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [190, 42, 220, 93]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [130, 109, 165, 211]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Constant
	  Name			  "engaged"
	  Position		  [610, 40, 630, 60]
	  Value			  "3"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [335, 301, 370, 429]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox control\nfor series \nHV and EV"
	  Ports			  [4, 3]
	  Position		  [680, 115, 720, 220]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox control\nfor series \nHV and EV"
	    Location		    [6, 74, 993, 742]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "77"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 130, 65, 150]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 250, 65, 270]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [895, 615, 951, 655]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [330, 95, 350, 115]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [450, 548, 545, 562]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [380, 413, 475, 427]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [720, 401, 725, 439]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn"
	      Position		      [155, 20, 185, 40]
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [85, 180, 115, 200]
	      Orientation	      "up"
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [550, 520, 675, 540]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [30, 474, 135, 506]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [550, 580, 675, 600]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [490, 440, 615, 460]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [490, 465, 615, 485]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [490, 375, 615, 395]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [480, 237, 505, 263]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [255, 465, 375, 485]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [255, 489, 375, 511]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [815, 265, 950, 285]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [840, 95, 950, 115]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [840, 170, 950, 190]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "MOTOR\ntorque\ncapability"
	      Position		      [190, 210, 220, 230]
	      Orientation	      "up"
	      FontName		      "Arial"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [635, 437, 640, 488]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [225, 142, 255, 173]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [540, 233, 560, 257]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [510, 307, 540, 333]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [90, 20, 120, 40]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [725, 96, 745, 114]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [180, 462, 210, 513]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 135, 355, 165]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [695, 540, 725, 570]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [665, 405, 695, 435]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [420, 42, 450, 78]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[328, 265, 817, 480]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [670, 87, 690, 123]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [600, 144, 630, 176]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [415, 224, 445, 276]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 253, 170, 277]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 308, 430, 332]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [790, 93, 820, 117]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [225, 250, 255, 280]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[230, 189, 818, 698]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested motor speed is repl"
"aced by an estimate of the\nengine's previous speed whenever the vehicle miss"
"ed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [395, 110, 425, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [465, 120, 495, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [370, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [30, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [275, 151, 295, 169]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [690, 20, 730, 40]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [265, 310, 300, 330]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(1)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [790, 164, 820, 196]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[164, 210, 454, 401]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [415, 124, 445, 176]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[324, 355, 799, 650]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 132, 170, 168]
	      FontName		      "Arial"
	      Inputs		      "3"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [790, 545, 810, 565]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [790, 385, 810, 405]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [790, 430, 810, 450]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"MOTOR\ntorque\ncapability"
		DstPort			1
	      }
	      Branch {
		Points			[55, 0]
		Branch {
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
		Branch {
		  Points		  [0, -100]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Fcn"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [115, 0]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[0, 10]
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "gb_spd_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [55, 0; 0, 180]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-160, 0; 0, -50]
	      Branch {
		DstBlock		"Fcn1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "MOTOR\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn"
	      SrcPort		      1
	      Points		      [10, 0; 0, 85; -75, 0; 0, 35]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [230, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 100]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, -75]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 95]
		  Branch {
		    Points		    [0, 45]
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto4"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-160, 0]
	      Branch {
		Points			[-130, 0; 0, 30]
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 75]
		  Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 100]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 65]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 10]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [889, 314]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [908, 211]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [902, 79]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [902, 47]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "key_on"
	  Ports			  [0, 1]
	  Position		  [620, 440, 660, 470]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskType		  "Repeating table"
	  MaskDescription	  "Repeating table.\nEnter values of time and "
"output for first cycle."
	  MaskHelp		  "Repeats cycle given in table. Time values s"
"hould be monotonically increasing."
	  MaskPromptString	  "Time values:|Output values:"
	  MaskStyleString	  "edit,edit"
	  MaskTunableValueString  "on,on"
	  MaskCallbackString	  "|"
	  MaskEnableString	  "on,on"
	  MaskVisibilityString	  "on,on"
	  MaskToolTipString	  "on,on"
	  MaskInitialization	  "period = max(@1); t = @1; y = @2;"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "vc_key_on(:,1)|vc_key_on(:,2)"
	  MaskVariableAliases	  ","
	  System {
	    Name		    "key_on"
	    Location		    [5, 42, 298, 124]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [15, 25, 35, 45]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [80, 25, 120, 45]
	      Expr		      "rem(u[1],period)"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [180, 23, 220, 47]
	      InputValues	      "t"
	      OutputValues	      "y"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "out_1"
	      Position		      [255, 25, 275, 45]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      DstBlock		      "out_1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      DstBlock		      "Fcn1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      DstBlock		      "Look-Up Table"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [690, 302, 720, 403]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [222, 101, 762, 449]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [25, 295, 45, 315]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [30, 30, 50, 50]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [30, 160, 50, 180]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [25, 235, 45, 255]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [170, 123, 200, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [75, 233, 105, 257]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [445, 275, 501, 315]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [85, 79, 155, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [130, 253, 170, 267]
	      ShowName		      off
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [360, 196, 385, 214]
	      ShowName		      off
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [430, 24, 520, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [309, 210, 341, 245]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [110, 25, 140, 55]
	      X0		      "ess_module_num*mean(ess_voc(:,1))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [245, 37, 275, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [190, 34, 210, 61]
	      ShowName		      off
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [190, 237, 220, 268]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [365, 17, 395, 48]
	      ShowName		      off
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [250, 157, 280, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [405, 156, 435, 214]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [330, 51, 350, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [265, 247, 295, 278]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [470, 175, 490, 195]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -20]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [30, 0; 0, 105]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [5, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [10, 0; 0, 0]
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [185, 0; 0, -35]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [10, -35]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0; 0, 0]
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	      Branch {
		Points			[0, -25]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [30, 15, 60, 65]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 10; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [220, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [150, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -50]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "key_on"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>\n<pb><sdo>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  Points		  [0, -10]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "engaged"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  Points		  [25, 0]
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -10]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [40, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  1
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [40, 0; 0, -70]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [222, 130]
	  Text			  "force\nrequired (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> fuel cell"
      Ports		      []
      Position		      [109, 561, 164, 611]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> fuel cell"
	Location		[18, 74, 1005, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"97"
	Block {
	  BlockType		  From
	  Name			  "From <cs>"
	  Position		  [550, 356, 635, 374]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [550, 40, 645, 60]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [550, 220, 630, 240]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [550, 256, 630, 274]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [550, 291, 640, 309]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [550, 65, 645, 85]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [550, 102, 640, 118]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>2"
	  Position		  [550, 137, 640, 153]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [25, 212, 100, 228]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [35, 245, 95, 265]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [15, 176, 100, 194]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [225, 342, 335, 358]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [230, 376, 330, 394]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [205, 305, 265, 325]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [210, 431, 330, 449]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [295, 215, 355, 235]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [75, 101, 160, 119]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [550, 191, 630, 209]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [225, 401, 340, 419]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [750, 197, 825, 223]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>\n<mc><pb>"
	  Position		  [730, 431, 780, 449]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [755, 271, 825, 289]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [755, 236, 825, 254]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [705, 80, 770, 100]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [735, 354, 805, 376]
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [450, 211, 535, 229]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [445, 135, 530, 155]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [185, 189, 275, 211]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [210, 221, 300, 239]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [425, 346, 510, 364]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [425, 409, 510, 431]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [225, 100, 335, 120]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [290, 246, 380, 264]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [285, 276, 375, 294]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [395, 70, 505, 90]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [275, 470, 295, 490]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [395, 202, 425, 233]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [395, 127, 425, 158]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [180, 97, 210, 148]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [125, 169, 160, 271]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [370, 321, 405, 449]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox control\nfor series \nHV and EV"
	  Ports			  [4, 3]
	  Position		  [660, 190, 700, 295]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox control\nfor series \nHV and EV"
	    Location		    [10, 74, 997, 742]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 130, 65, 150]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 250, 65, 270]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [870, 600, 926, 640]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [330, 95, 350, 115]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [450, 548, 545, 562]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [380, 413, 475, 427]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [720, 401, 725, 439]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn"
	      Position		      [155, 20, 185, 40]
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [85, 180, 115, 200]
	      Orientation	      "up"
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [550, 520, 675, 540]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [30, 474, 135, 506]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [550, 580, 675, 600]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [490, 440, 615, 460]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [490, 465, 615, 485]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [490, 375, 615, 395]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [480, 237, 505, 263]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [255, 465, 375, 485]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [255, 489, 375, 511]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [810, 255, 945, 275]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [835, 95, 945, 115]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [840, 170, 950, 190]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "MOTOR\ntorque\ncapability"
	      Position		      [190, 210, 220, 230]
	      Orientation	      "up"
	      FontName		      "Arial"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [635, 437, 640, 488]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [225, 142, 255, 173]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [540, 233, 560, 257]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [510, 307, 540, 333]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [90, 20, 120, 40]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [725, 96, 745, 114]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [180, 462, 210, 513]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 135, 355, 165]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [695, 540, 725, 570]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [665, 405, 695, 435]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [420, 42, 450, 78]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[328, 265, 817, 480]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [670, 87, 690, 123]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [600, 144, 630, 176]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [415, 224, 445, 276]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 253, 170, 277]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 308, 430, 332]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [785, 93, 815, 117]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [225, 250, 255, 280]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[230, 189, 818, 698]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested motor speed is repl"
"aced by an estimate of the\nengine's previous speed whenever the vehicle miss"
"ed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [395, 110, 425, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [465, 120, 495, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [370, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [30, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [275, 151, 295, 169]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [690, 20, 730, 40]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [265, 310, 300, 330]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(1)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [785, 164, 815, 196]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[164, 210, 454, 401]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [415, 124, 445, 176]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[324, 355, 799, 650]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 132, 170, 168]
	      FontName		      "Arial"
	      Inputs		      "3"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [790, 545, 810, 565]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [790, 385, 810, 405]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [790, 430, 810, 450]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"MOTOR\ntorque\ncapability"
		DstPort			1
	      }
	      Branch {
		Points			[55, 0]
		Branch {
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
		Branch {
		  Points		  [0, -100]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Fcn"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [115, 0]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[0, 10]
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "gb_spd_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [55, 0; 0, 180]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-160, 0; 0, -50]
	      Branch {
		DstBlock		"Fcn1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "MOTOR\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn"
	      SrcPort		      1
	      Points		      [10, 0; 0, 85; -75, 0; 0, 35]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [230, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 100]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, -75]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 85]
		  Branch {
		    Points		    [0, 55]
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto4"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-160, 0]
	      Branch {
		Points			[-130, 0; 0, 30]
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 75]
		  Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 100]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 65]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 10]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [884, 304]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [903, 211]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [887, 74]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [877, 42]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "key_on"
	  Ports			  [0, 1]
	  Position		  [660, 425, 700, 455]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskType		  "Repeating table"
	  MaskDescription	  "Repeating table.\nEnter values of time and "
"output for first cycle."
	  MaskHelp		  "Repeats cycle given in table. Time values s"
"hould be monotonically increasing."
	  MaskPromptString	  "Time values:|Output values:"
	  MaskStyleString	  "edit,edit"
	  MaskTunableValueString  "on,on"
	  MaskCallbackString	  "|"
	  MaskEnableString	  "on,on"
	  MaskVisibilityString	  "on,on"
	  MaskToolTipString	  "on,on"
	  MaskInitialization	  "period = max(@1); t = @1; y = @2;"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "vc_key_on(:,1)|vc_key_on(:,2)"
	  MaskVariableAliases	  ","
	  System {
	    Name		    "key_on"
	    Location		    [5, 42, 298, 124]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [15, 25, 35, 45]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [80, 25, 120, 45]
	      Expr		      "rem(u[1],period)"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [180, 23, 220, 47]
	      InputValues	      "t"
	      OutputValues	      "y"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "out_1"
	      Position		      [255, 25, 275, 45]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      DstBlock		      "out_1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      DstBlock		      "Fcn1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      DstBlock		      "Look-Up Table"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [660, 37, 690, 138]
	  NamePlacement		  "alternate"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [217, 176, 880, 618]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [110, 25, 140, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "series 'clutch'\ncontrol"
	  Ports			  [1, 1]
	  Position		  [665, 346, 700, 384]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "series 'clutch'\ncontrol"
	    Location		    [291, 163, 780, 437]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [35, 33, 65, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [420, 220, 476, 260]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[315, 744, 770, 896]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "There is no clutch, per se, in the "
"series hybrid vehicle, that is connected to\nthe engine.  This clutch control"
" is provided to tell the fuel converter (a.k.a. engine)\nwhen it can spin up "
"freely.  The fuel converter spins up or down when the 'clutch' is\ndisengaged"
", and provides torque when the 'clutch' is engaged (signal==3).\n\nHere, the "
"fuel converter spins up when the engine has been off within the\npast 0.5 s ("
"or one time step, whichever is greater).  At all other times, the fuel\nconve"
"rter provides torque to the generator."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [45, 190, 65, 210]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [385, 105, 405, 125]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [385, 15, 405, 35]
	      Orientation	      "left"
	      Value		      "3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [120, 50, 150, 80]
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [115, 220, 145, 250]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [180, 192, 210, 223]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [380, 55, 410, 85]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [275, 55, 305, 85]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [115, 130, 145, 160]
	      DelayTime		      "0.5"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [180, 41, 210, 74]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [180, 121, 210, 154]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [445, 63, 475, 77]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 25]
		Branch {
		  Points		  [0, 45]
		  Branch {
		    Points		    [70, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[70, 0]
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "clutch\nstate"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [30, 15, 60, 65]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>2"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <cs>"
	  SrcPort		  1
	  DstBlock		  "series 'clutch'\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "series 'clutch'\ncontrol"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "key_on"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>\n<mc><pb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [215, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -55]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [85, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  1
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [110, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [105, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [45, 0; 0, -45]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> insight"
      Ports		      [0, 1]
      Position		      [100, 334, 165, 386]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> insight"
	Location		[2, 74, 998, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"94"
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [360, 45, 455, 65]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [355, 407, 450, 423]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [75, 151, 165, 169]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [75, 176, 170, 194]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [70, 210, 165, 230]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [350, 256, 445, 274]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [355, 387, 450, 403]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [360, 80, 455, 100]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [365, 109, 455, 131]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>2"
	  Position		  [360, 144, 450, 166]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>3"
	  Position		  [350, 219, 440, 241]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 402, 105, 418]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [35, 460, 95, 480]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [20, 366, 105, 384]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [15, 537, 125, 553]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [20, 571, 120, 589]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [15, 621, 135, 639]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [75, 116, 165, 134]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [15, 596, 130, 614]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [260, 112, 335, 138]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [575, 370, 640, 390]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [570, 405, 650, 425]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [575, 441, 625, 459]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [250, 150, 340, 170]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [255, 201, 335, 219]
	  NamePlacement		  "alternate"
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [545, 95, 635, 115]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [580, 236, 650, 254]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [250, 481, 335, 499]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [250, 360, 335, 380]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [235, 384, 325, 406]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [190, 406, 280, 424]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [215, 541, 300, 559]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [215, 604, 300, 626]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [230, 290, 340, 310]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [260, 431, 350, 449]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [185, 446, 275, 464]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [330, 320, 440, 340]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [50, 670, 70, 690]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [195, 472, 225, 503]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [200, 352, 230, 383]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [185, 287, 215, 338]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [130, 359, 165, 461]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine on\n(insight)"
	  Ports			  [5, 3]
	  Position		  [495, 359, 530, 471]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine on\n(insight)"
	    Location		    [551, 278, 1448, 1055]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq_clutch_out"
	      Position		      [40, 18, 70, 32]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "spd_clutch_out"
	      Position		      [175, 13, 205, 27]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [380, 598, 410, 612]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [170, 568, 200, 582]
	      NamePlacement	      "alternate"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch\nstate"
	      Position		      [30, 523, 60, 537]
	      NamePlacement	      "alternate"
	      Port		      "5"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      " "
	      Position		      [185, 369, 230, 391]
	      Value		      "fc_tstat"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "  "
	      Position		      [260, 210, 285, 230]
	      Value		      "-0.1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "    "
	      Position		      [215, 260, 235, 280]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "  2"
	      Position		      [335, 60, 355, 80]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [215, 306, 275, 324]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)1"
	      Position		      [530, 101, 590, 119]
	      ShowName		      off
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES1"
	      Ports		      []
	      Position		      [695, 95, 751, 135]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES1"
		Location		[454, 317, 835, 559]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [192, 12]
		  VerticalAlignment	  "top"
		  Text			  "The engine of the Insight will only"
" shutdown under the following conditions:\n1) engine is warm\nand\n2) SOC is "
"greater than the low SOC setpoint\nand\n3) vehicle is decelerating or stopped"
"\nand\n4) vehicle speed is less than cs_electric_decel_spd and engine is \nal"
"lowed to shut down during decel (ie.clutch disengaged)\nand\n5) the vehicle i"
"s not shifting gears\nand \n6) the key is in on position\nand\n7) engine is n"
"ot disabled (this is not a standard INSIGHT feature)\n\nNOTE: Test for decel "
"set to -0.1 to prevent engine disable at constant speed"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [365, 554, 445, 576]
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [35, 545, 55, 565]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [175, 590, 195, 610]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [130, 655, 150, 675]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [655, 595, 675, 615]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Derivative
	      Name		      "Derivative"
	      Position		      [195, 190, 225, 220]
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [140, 289, 185, 311]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <fc>"
	      Position		      [95, 350, 180, 370]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>2"
	      Position		      [150, 416, 220, 434]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>4"
	      Position		      [25, 125, 110, 145]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [260, 365, 305, 395]
	      Gain		      "vc_fc_warm_tmp_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [3, 1]
	      Position		      [305, 556, 335, 614]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator11"
	      Ports		      [1, 1]
	      Position		      [605, 313, 635, 347]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "7"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator12"
	      Ports		      [1, 1]
	      Position		      [465, 393, 495, 427]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "7"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator13"
	      Ports		      [3, 1]
	      Position		      [670, 269, 695, 341]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator14"
	      Ports		      [2, 1]
	      Position		      [380, 205, 410, 240]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator15"
	      Ports		      [2, 1]
	      Position		      [385, 120, 415, 155]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator16"
	      Ports		      [2, 1]
	      Position		      [470, 115, 500, 150]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator17"
	      Ports		      [1, 1]
	      Position		      [485, 458, 515, 492]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "7"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [250, 428, 280, 457]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [6, 1]
	      Position		      [550, 185, 575, 470]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "6"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [315, 500, 345, 530]
	      Orientation	      "left"
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [325, 292, 355, 323]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [330, 352, 360, 383]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Roll Stop"
	      Position		      [160, 149, 275, 171]
	      Value		      "cs_electric_decel_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [555, 570, 585, 600]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [480, 558, 510, 612]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [725, 579, 750, 611]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Terminator
	      Name		      "Terminator"
	      Position		      [110, 15, 130, 35]
	    }
	    Block {
	      BlockType		      Terminator
	      Name		      "Terminator1"
	      Position		      [275, 15, 295, 35]
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "accel ?"
	      Position		      [315, 197, 345, 228]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "allow engine to shut off \nat low vehic"
"le speed "
	      Position		      [160, 80, 270, 100]
	      Value		      "cs_decel_fc_off"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [110, 522, 140, 553]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "idling allowed?\n1=yes, 0=shut down"
	      Position		      [350, 465, 460, 485]
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [530, 34, 585, 66]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on"
		Location		[7, 74, 412, 245]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [190, 642, 220, 673]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [245, 567, 275, 598]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT second"
	      Ports		      [0, 1]
	      Position		      [50, 602, 85, 638]
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:|Look ahead "
"how far (s):"
	      MaskStyleString	      "edit,edit,edit"
	      MaskTunableValueString  "on,on,on"
	      MaskCallbackString      "||"
	      MaskEnableString	      "on,on,on"
	      MaskVisibilityString    "on,on,on"
	      MaskToolTipString	      "on,on,on"
	      MaskVariables	      "t=@1;y=@2;dt=@3;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)|1"
	      MaskVariableAliases     ",,"
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT second"
		Location		[404, 231, 779, 393]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)+dt"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "spd less than \nsetpoint?"
	      Position		      [315, 127, 345, 158]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "veh stopped"
	      Position		      [395, 47, 425, 78]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "veh stopped "
	      Position		      [265, 247, 295, 278]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [740, 318, 770, 332]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [790, 588, 820, 602]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [700, 43, 730, 57]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "From <fc>"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>4"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"spd less than \nsetpoint?"
		DstPort			1
	      }
	      Branch {
		Points			[0, -80]
		DstBlock		"veh stopped"
		DstPort			1
	      }
	      Branch {
		Points			[0, 70]
		Branch {
		  DstBlock		  "Derivative"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 50]
		  DstBlock		  "veh stopped "
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      " "
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      Points		      [0, -5]
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Roll Stop"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "spd less than \nsetpoint?"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator11"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator11"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      3
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 1]
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [55, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 230]
		DstBlock		"Logical\nOperator13"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)1"
	      SrcPort		      1
	      Points		      [40, 0; 0, 195]
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      Points		      [175, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [160, 0; 0, -20]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator13"
	      SrcPort		      1
	      Points		      [0, 20; 5, 0]
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 190]
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 80]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator15"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator16"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "allow engine to shut off \nat low vehic"
"le speed "
	      SrcPort		      1
	      Points		      [95, 0]
	      DstBlock		      "Logical\nOperator15"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "veh stopped"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Logical\nOperator16"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "  2"
	      SrcPort		      1
	      DstBlock		      "veh stopped"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd less than \nsetpoint?"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator15"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator16"
	      SrcPort		      1
	      Points		      [0, 20; 30, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "trq_clutch_out"
	      SrcPort		      1
	      DstBlock		      "Terminator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "spd_clutch_out"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Terminator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "veh stopped "
	      SrcPort		      1
	      Points		      [65, 0]
	      DstBlock		      "Logical\nOperator14"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "    "
	      SrcPort		      1
	      DstBlock		      "veh stopped "
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "accel ?"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator14"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator14"
	      SrcPort		      1
	      Points		      [110, 0; 0, 35]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Derivative"
	      SrcPort		      1
	      DstBlock		      "accel ?"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "  "
	      SrcPort		      1
	      DstBlock		      "accel ?"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator12"
	      SrcPort		      1
	      Points		      [35, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      5
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nstate"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      Points		      [20, 0; 0, -10]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [145, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [65, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT second"
	      SrcPort		      1
	      Points		      [75, 0; 0, 30]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>2"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [45, 0; 0, -35]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-75, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "idling allowed?\n1=yes, 0=shut down"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator17"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator17"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      6
	    }
	    Annotation {
	      Position		      [415, 349]
	      Text		      "engine on if \nengine cold"
	    }
	    Annotation {
	      Position		      [420, 289]
	      Text		      "engine on if \nSOC < cs_lo_soc"
	    }
	    Annotation {
	      Position		      [405, 439]
	      Text		      "engine remains on \nwhile shifting and "
"\nengine was on"
	    }
	    Annotation {
	      Position		      [568, 133]
	      Text		      "engine not disabled?"
	    }
	    Annotation {
	      Position		      [422, 171]
	      Text		      "engine on if speed \ngreater than setpo"
"int"
	    }
	    Annotation {
	      Position		      [462, 246]
	      Text		      "engine on if\n accelerating or \ncoasti"
"ng"
	    }
	    Annotation {
	      Position		      [591, 320]
	      Text		      "off"
	    }
	    Annotation {
	      Position		      [650, 323]
	      Text		      "on"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [155, 516, 190, 644]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [490, 45, 520, 165]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [91, 74, 773, 525]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "parallel clutch\ncontrol"
	  Ports			  [4, 1]
	  Position		  [495, 235, 530, 315]
	  ForegroundColor	  "gray"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "parallel clutch\ncontrol"
	    Location		    [89, 104, 1002, 726]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 18, 60, 32]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 58, 60, 72]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 168, 55, 182]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [30, 388, 60, 402]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [835, 565, 891, 605]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[317, 742, 775, 942]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged\n\nBut the clutch is always disengaged when the"
" engine is off or was off within the past 0.5 s."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [40, 535, 60, 555]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [145, 83, 180, 107]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [145, 124, 225, 146]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [145, 189, 225, 211]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [145, 255, 180, 275]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [145, 319, 225, 341]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [570, 355, 605, 375]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [790, 175, 810, 195]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [660, 110, 720, 140]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [380, 67, 410, 98]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [315, 127, 345, 158]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual Switch"
	      Ports		      [2, 1]
	      Position		      [410, 387, 440, 423]
	      ForegroundColor	      "gray"
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [570, 300, 600, 330]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [170, 415, 200, 445]
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [170, 565, 200, 595]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [590, 107, 625, 143]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 57, 330, 88]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [260, 177, 290, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [260, 242, 290, 273]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [260, 307, 290, 338]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [235, 537, 265, 568]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [790, 120, 820, 150]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [330, 400, 360, 430]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [170, 475, 200, 505]
	      DelayTime		      "0.2"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [450, 17, 480, 48]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [520, 117, 550, 148]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [380, 254, 410, 286]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [235, 386, 265, 419]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [235, 466, 265, 499]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [475, 305, 510, 340]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [80, 160, 110, 190]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 217, 812, 726]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 115, 400, 145]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [855, 128, 885, 142]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 180]
		DstBlock		"Memory"
		DstPort			1
	      }
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Manual Switch"
	      SrcPort		      1
	      Points		      [315, 0; 0, -270]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Manual Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		Points			[0, -20; 250, 0]
		DstBlock		"Manual Switch"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		Branch {
		  Points		  [0, 30]
		  Branch {
		    Points		    [75, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [70, 0]
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -40]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "pre-TX parallel\ngearbox control"
	  Ports			  [4, 3]
	  Position		  [190, 122, 225, 223]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "pre-TX parallel\ngearbox control"
	    Location		    [16, 74, 1193, 776]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 320, 65, 340]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 175, 65, 195]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [890, 605, 946, 645]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [330, 40, 350, 60]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [525, 200, 545, 220]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [445, 608, 540, 622]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [375, 473, 470, 487]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [525, 285, 545, 305]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [715, 461, 720, 499]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [545, 580, 670, 600]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [25, 534, 130, 566]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [545, 640, 670, 660]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [485, 500, 610, 520]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [485, 525, 610, 545]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [485, 435, 610, 455]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [470, 302, 495, 328]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [250, 525, 370, 545]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [250, 549, 370, 571]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [810, 370, 945, 390]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [820, 185, 930, 205]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [830, 260, 940, 280]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [630, 497, 635, 548]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [225, 87, 255, 118]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [510, 367, 540, 393]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [80, 175, 110, 195]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [710, 186, 730, 204]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [175, 522, 205, 573]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 80, 355, 110]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [520, 235, 550, 265]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [520, 155, 550, 185]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [690, 600, 720, 630]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [660, 465, 690, 495]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To WS"
	      Position		      [360, 339, 400, 361]
	      BackgroundColor	      "red"
	      VariableName	      "spd"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [420, 232, 450, 268]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[328, 265, 817, 480]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow upshift?"
	      Ports		      [4, 1]
	      Position		      [420, 152, 450, 188]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow upshift?"
		Location		[132, 265, 847, 659]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 25, 55, 45]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [35, 145, 55, 165]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [35, 105, 55, 125]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "prev Pout/Pin"
		  Position		  [35, 185, 55, 205]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES1"
		  Ports			  []
		  Position		  [645, 340, 701, 380]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES1"
		    Location		    [229, 259, 576, 405]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [172, 12]
		    VerticalAlignment	    "top"
		    Text		    "This block prevents an upshift if"
" it the engine is not on and\nthe upshift would make the motor power low enou"
"gh that it\ncould not provide the required input power.  However, an upshift"
"\nis allowed if to stay in the current gear would put the motor\nbeyond 95% o"
"f its maximum speed.\n\nThis block is to be used in pretransmission parallel "
"hybrids\n(where the engine and motor torques are combined on the\nengine side"
" of the transmission) ONLY."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [110, 75, 130, 95]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [100, 347, 375, 373]
		  Value			  "max(mc_map_spd)*mc_spd_scale/tc_mc_"
"to_fc_ratio*.95"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [15, 232, 80, 258]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "engine_on"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [3, 1]
		  Position		  [615, 53, 645, 97]
		  Operator		  "OR"
		  Inputs		  "3"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [125, 230, 155, 260]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [310, 37, 340, 68]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [540, 42, 570, 73]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [395, 287, 425, 318]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [165, 29, 205, 61]
		  FontName		  "Arial"
		  UpperLimit		  "gb_gears_num"
		  LowerLimit		  "1"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [105, 27, 135, 58]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "est. req'd\ninput pwr\n(W)"
		  Ports			  [3, 1]
		  Position		  [310, 109, 340, 141]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio"
		  Position		  [245, 33, 275, 57]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [250, 258, 280, 282]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "motor\ntorque\ncapability"
		  Position		  [380, 45, 410, 65]
		  FontName		  "Arial"
		  InputValues		  "mc_map_spd*mc_spd_scale"
		  OutputValues		  "mc_max_trq*mc_trq_scale*mc_overtrq_"
"factor+eps"
		}
		Block {
		  BlockType		  Product
		  Name			  "motor (input to gb)\npwr capability"
		  Ports			  [2, 1]
		  Position		  [455, 32, 485, 63]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "req'd input spd\nif no gear change"
		  Ports			  [2, 1]
		  Position		  [310, 276, 340, 309]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [675, 65, 695, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "req'd input spd\nif no gear change"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [170, 0]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  Points		  [150, 0]
		  Branch {
		    Points		    [0, 185]
		    DstBlock		    "req'd input spd\nif no gear chang"
"e"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "est. req'd\ninput pwr\n(W)"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 235]
		    DstBlock		    "gear ratio1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "req'd input spd\nif no gear change"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Saturation"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  DstBlock		  "gear ratio"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear ratio"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "motor\ntorque\ncapability"
		  SrcPort		  1
		  DstBlock		  "motor (input to gb)\npwr capability"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "motor\ntorque\ncapability"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "motor (input to gb)\npwr capabili"
"ty"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "motor (input to gb)\npwr capability"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "est. req'd\ninput pwr\n(W)"
		  SrcPort		  1
		  Points		  [175, 0; 0, -60]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [215, 0; 0, -30]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "prev Pout/Pin"
		  SrcPort		  1
		  Points		  [225, 0; 0, -60]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [430, 0; 0, -170]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [655, 177, 675, 213]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [585, 189, 615, 221]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [420, 289, 450, 341]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [185, 205, 215, 225]
	      Orientation	      "up"
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 323, 170, 347]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 368, 430, 392]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [770, 183, 800, 207]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [275, 320, 305, 350]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 217, 812, 726]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [275, 96, 295, 114]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [670, 35, 710, 55]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [205, 370, 240, 390]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(gb_num_init)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [775, 254, 805, 286]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[166, 208, 456, 399]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [420, 64, 450, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[324, 355, 799, 650]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 77, 170, 113]
	      FontName		      "Arial"
	      Inputs		      "*//"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [785, 605, 805, 625]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [785, 445, 805, 465]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [785, 490, 805, 510]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 10]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 15]
		DstBlock		"To WS"
		DstPort			1
	      }
	      Branch {
		Points			[10, 0]
		Branch {
		  Points		  [30, 0]
		  Branch {
		    Points		    [30, 0]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    3
		  }
		  Branch {
		    Points		    [0, -230]
		    DstBlock		    "upshift\n command"
		    DstPort		    3
		  }
		}
		Branch {
		  Points		  [0, -80; -145, 0]
		  DstBlock		  "engine\ntorque\ncapability"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "allow upshift?"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 220]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	      Branch {
		Points			[20, 0]
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [230, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-75, 0; 0, -40]
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	      Branch {
		Points			[0, -235]
		DstBlock		"~gb_trq_in_r"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		DstBlock		"~gb_trq_in_r"
		DstPort			1
	      }
	      Branch {
		Points			[0, 80]
		DstBlock		"allow upshift?"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			1
	      }
	      Branch {
		Points			[0, -155]
		DstBlock		"allow upshift?"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [0, -75]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, -90]
		DstBlock		"~gb_trq_in_r"
		DstPort			2
	      }
	      Branch {
		DstBlock		"allow upshift?"
		DstPort			4
	      }
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-30, 0]
	      Branch {
		Points			[0, 140]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[-240, 0; 0, 205]
		Branch {
		  Points		  [0, -170]
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 75]
		    Branch {
		    Points		    [0, 145]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "allow upshift?"
		    DstPort		    1
		    }
		  }
		}
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 75]
		Branch {
		  Points		  [0, 110]
		  Branch {
		    DstBlock		    "Goto4"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 0]
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -150]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0; 0, 25]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, -90]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [897, 127]
	      Text		      "local GOTO blocks:"
	    }
	    Annotation {
	      Position		      [887, 159]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [888, 301]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [879, 434]
	      Text		      "default gear number\ncalculation"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [50, 15, 80, 65]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [610, 266, 640, 284]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  Points		  [0, -10]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  Points		  [5, 0]
	  Branch {
	    Points		    [0, -30]
	    Branch {
	      DstBlock		      "braking strategy"
	      DstPort		      1
	    }
	    Branch {
	      Points		      [225, 0; 0, 90]
	      DstBlock		      "engine on\n(insight)"
	      DstPort		      4
	    }
	  }
	  Branch {
	    DstBlock		    "config traction control"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    Points		    [0, 25]
	    Branch {
	      Points		      [0, 35]
	      DstBlock		      "front and rear\nbrake controller\n(achi"
"evable)"
	      DstPort		      1
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	  }
	  Branch {
	    DstBlock		    "config traction control"
	    DstPort		    3
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [5, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      Points		      [0, 105]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [0, 5]
	  Branch {
	    Points		    [0, 20; -35, 0]
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>2"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "parallel clutch\ncontrol"
	  SrcPort		  1
	  Points		  [20, 0]
	  Branch {
	    Points		    [0, -30]
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 0]
	    Branch {
	      DstBlock		      "clutch\nstate"
	      DstPort		      1
	    }
	    Branch {
	      Points		      [0, 230; -75, 0]
	      DstBlock		      "engine on\n(insight)"
	      DstPort		      5
	    }
	  }
	}
	Line {
	  SrcBlock		  "engine on\n(insight)"
	  SrcPort		  1
	  Points		  [0, 0]
	  Branch {
	    DstBlock		    "Goto <fc>"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -35; -55, 0]
	    DstBlock		    "parallel clutch\ncontrol"
	    DstPort		    4
	  }
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  Points		  [5, 0]
	  Branch {
	    Points		    [0, -110]
	    DstBlock		    "parallel clutch\ncontrol"
	    DstPort		    3
	  }
	  Branch {
	    DstBlock		    "engine on\n(insight)"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "engine on\n(insight)"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine on\n(insight)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine on\n(insight)"
	  SrcPort		  3
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  Points		  [20, 0]
	  Branch {
	    DstBlock		    "parallel clutch\ncontrol"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [0, 110]
	    DstBlock		    "engine on\n(insight)"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <mc>3"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  2
	  Points		  [5, 0]
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [75, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [30, 0; 0, -50]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> par"
      Ports		      [0, 1]
      Position		      [100, 144, 165, 196]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> par"
	Location		[190, 107, 1002, 777]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"94"
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [540, 30, 635, 50]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [540, 472, 635, 488]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [185, 61, 275, 79]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [185, 86, 280, 104]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [180, 120, 275, 140]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [570, 251, 665, 269]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [540, 452, 635, 468]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>6"
	  Position		  [570, 282, 665, 298]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>7"
	  Position		  [540, 416, 635, 434]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>8"
	  Position		  [570, 317, 665, 333]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [540, 65, 635, 85]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [545, 94, 635, 116]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>2"
	  Position		  [545, 129, 635, 151]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>3"
	  Position		  [570, 224, 660, 246]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 317, 105, 333]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [30, 350, 90, 370]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [30, 281, 115, 299]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [50, 477, 160, 493]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [55, 511, 155, 529]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [540, 501, 625, 519]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [35, 566, 155, 584]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [540, 536, 625, 554]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [55, 445, 115, 465]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [300, 315, 360, 335]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>9"
	  Position		  [40, 206, 125, 224]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [185, 26, 275, 44]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [50, 536, 165, 554]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [370, 47, 445, 73]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [760, 435, 825, 455]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [755, 470, 835, 490]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [760, 506, 810, 524]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [355, 85, 445, 105]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [365, 121, 445, 139]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [725, 80, 815, 100]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [780, 236, 850, 254]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [460, 311, 545, 329]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [455, 240, 540, 260]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [190, 304, 280, 326]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [265, 331, 355, 349]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [250, 481, 335, 499]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [250, 544, 335, 566]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [235, 205, 345, 225]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [200, 366, 290, 384]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [195, 396, 285, 414]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [400, 185, 510, 205]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [115, 595, 135, 615]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [405, 302, 435, 333]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [405, 232, 435, 263]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [190, 202, 220, 253]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [130, 279, 165, 381]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine on\n(parallel hybrid)"
	  Ports			  [5, 3]
	  Position		  [680, 424, 715, 536]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine on\n(parallel hybrid)"
	    Location		    [67, 74, 1001, 722]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "80"
	    Block {
	      BlockType		      Inport
	      Name		      "trq req'd\nout of clutch\n(N*m)"
	      Position		      [35, 13, 65, 27]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "spd req'd\nout of clutch\n(N*m)1"
	      Position		      [25, 103, 55, 117]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [415, 553, 445, 567]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [160, 523, 190, 537]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch\nstate"
	      Position		      [100, 468, 130, 482]
	      Port		      "5"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [165, 271, 225, 289]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)1"
	      Position		      [115, 376, 190, 394]
	      Value		      "cs_off_trq_frac"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)2"
	      Position		      [745, 105, 785, 125]
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)3"
	      Position		      [520, 322, 570, 338]
	      Value		      "fc_tstat"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES1"
	      Ports		      []
	      Position		      [830, 60, 886, 100]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES1"
		Location		[296, 542, 726, 743]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [212, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine state computer keeps th"
"e engine on if:\n[\n1) key is on, AND\n2) (trq is too high AND speed is too h"
"igh for idle) OR engine is allowed to idle, AND\n3) vehicle speed >= cs_elect"
"ric_launch_spd [ in m/s ], AND\n4) req'd trq > (cs_off_trq_frac * max_trq_at_"
"spd) OR SOC<cs_lo_soc\n]\nOR\n[ engine was previously on AND the transmission"
" is shifting ]\n\nThe last condition is added to prevent the engine from unre"
"alistically\nshutting down for a second or two during a shift."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [110, 27, 145, 43]
	      ShowName		      off
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [325, 77, 395, 93]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant10"
	      Position		      [170, 232, 300, 248]
	      ShowName		      off
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [95, 66, 210, 84]
	      ShowName		      off
	      Value		      "cs_electric_decel_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [140, 117, 210, 133]
	      ShowName		      off
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [400, 509, 480, 531]
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [155, 480, 175, 500]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [215, 535, 235, 555]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [155, 585, 175, 605]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [740, 550, 760, 570]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [240, 389, 270, 411]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [635, 370, 655, 390]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [105, 254, 150, 276]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>1"
	      Position		      [105, 148, 190, 172]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>2"
	      Position		      [585, 243, 655, 257]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>3"
	      Position		      [440, 470, 525, 490]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_pwr"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>4"
	      Position		      [515, 286, 585, 304]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [585, 318, 615, 342]
	      Gain		      "vc_fc_warm_tmp_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [390, 390, 420, 420]
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [3, 1]
	      Position		      [340, 511, 370, 569]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator11"
	      Ports		      [1, 1]
	      Position		      [350, 235, 380, 255]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator12"
	      Ports		      [3, 1]
	      Position		      [810, 154, 840, 186]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator13"
	      Ports		      [2, 1]
	      Position		      [685, 298, 715, 327]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [425, 41, 445, 74]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [365, 31, 395, 64]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [2, 1]
	      Position		      [285, 21, 305, 54]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [3, 1]
	      Position		      [585, 125, 615, 235]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [3, 1]
	      Position		      [385, 322, 405, 358]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [680, 243, 710, 272]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [5, 1]
	      Position		      [755, 161, 785, 219]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "5"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [2, 1]
	      Position		      [520, 160, 545, 195]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [205, 175, 235, 205]
	      InputValues	      "[cs_lo_soc cs_hi_soc cs_hi_soc+eps]"
	      OutputValues	      "[cs_electric_launch_spd_lo cs_electric_"
"launch_spd_hi cs_electric_launch_spd_hi]"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual \nSwitch"
	      Ports		      [2, 1]
	      Position		      [695, 397, 725, 433]
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [685, 340, 715, 370]
	      Orientation	      "left"
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [235, 347, 265, 378]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [465, 427, 495, 458]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [510, 397, 540, 428]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [275, 153, 300, 182]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [290, 324, 315, 351]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [255, 257, 285, 288]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [290, 379, 315, 406]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [635, 459, 660, 486]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [635, 289, 660, 316]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [635, 409, 660, 436]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [595, 525, 625, 555]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [555, 427, 600, 463]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time Steps (#)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskVariables	      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "3"
	      System {
		Name			"Subsystem"
		Location		[137, 366, 771, 685]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [50, 110, 70, 130]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [75, 210, 95, 230]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [75, 274, 115, 296]
		  FontName		  "Arial"
		  Value			  "n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [380, 224, 420, 246]
		  FontName		  "Arial"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>2"
		  Position		  [120, 88, 190, 102]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "shifting"
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [295, 100, 315, 120]
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [135, 235, 165, 265]
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [170, 30, 200, 60]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [505, 109, 525, 136]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [210, 271, 230, 289]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [250, 187, 280, 218]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [440, 105, 460, 125]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [170, 210, 190, 230]
		  ShowName		  off
		  IconShape		  "round"
		  Inputs		  "|+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [305, 190, 335, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [450, 190, 480, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch2"
		  Position		  [235, 95, 265, 125]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch3"
		  Position		  [115, 30, 145, 60]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  VariableTransportDelay
		  Name			  "Variable\nTransport Delay"
		  Position		  [375, 137, 405, 168]
		  MaximumDelay		  "n"
		  InitialInput		  "0"
		  MaximumPoints		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [550, 115, 570, 135]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "From <vc>2"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -15; -120, 0; 0, -35]
		    DstBlock		    "Switch3"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 15]
		    DstBlock		    "Switch2"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -30; -120, 0]
		    DstBlock		    "Switch3"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Switch3"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Switch3"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch2"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  Points		  [0, -75]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [80, 0]
		    Branch {
		    Points		    [0, -10]
		    DstBlock		    "Switch1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Switch1"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [0, -45]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [55, 0]
		    DstBlock		    "Switch"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -25]
		    Branch {
		    Points		    [0, -15; 175, 0]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Variable\nTransport Delay"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [515, 513, 545, 567]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [810, 534, 835, 566]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [400, 239, 430, 281]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [445, 294, 475, 336]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "T>~0"
	      Position		      [170, 12, 200, 43]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace"
	      Position		      [325, 181, 480, 199]
	      VariableName	      "cs_electric_launch_spd_probe"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [210, 467, 240, 498]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [575, 29, 630, 61]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on"
		Location		[5, 42, 410, 213]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup"
	      Position		      [115, 343, 145, 367]
	      NamePlacement	      "alternate"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup1"
	      Position		      [455, 393, 485, 417]
	      NamePlacement	      "alternate"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale*mc_overtrq_fact"
"or"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [210, 572, 240, 603]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [275, 522, 305, 553]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [70, 542, 105, 578]
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[57, 72, 432, 234]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "spd>set point"
	      Position		      [235, 52, 265, 83]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "w>idle"
	      Position		      [275, 102, 305, 133]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [875, 163, 905, 177]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [865, 543, 895, 557]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [765, 38, 795, 52]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator12"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 185]
		Branch {
		  Points		  [0, 165; -55, 0]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)2"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Product"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      Points		      [70, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "T>~0"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [10, 0; 0, -80]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "trq req'd\nout of clutch\n(N*m)"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"T>~0"
		DstPort			1
	      }
	      Branch {
		Points			[0, 310]
		Branch {
		  Points		  [0, 120]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -35]
	      Branch {
		DstBlock		"Logical\nOperator7"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Logical\nOperator13"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator13"
	      SrcPort		      1
	      Points		      [10, 0; 0, -125]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)3"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      3
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 0]
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [85, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 105; 70, 0; 0, 20]
		DstBlock		"Logical\nOperator12"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [105, 0; 0, 85]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      Points		      [30, 0; 0, -100]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			2
	      }
	      Branch {
		DstBlock		"To Workspace"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant10"
	      SrcPort		      1
	      Points		      [0, 20; 25, 0]
	      Branch {
		Points			[0, 40]
		Branch {
		  DstBlock		  "Switch4"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 15]
		  DstBlock		  "Switch4"
		  DstPort		  2
		}
	      }
	      Branch {
		DstBlock		"Switch3"
		DstPort			2
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Logical\nOperator11"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"Switch3"
		DstPort			3
	      }
	      Branch {
		Points			[0, 55]
		DstBlock		"Logical\nOperator6"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator11"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		Points			[0, -75]
		DstBlock		"Look-Up Table"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [70, 0; 0, -275]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [75, 0; 0, 20]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [80, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [80, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nstate"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"max_torque\n lookup1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"Product3"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual \nSwitch"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      5
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "w>idle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "w>idle"
	      SrcPort		      1
	      Points		      [0, -65]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd req'd\nout of clutch\n(N*m)1"
	      SrcPort		      1
	      Points		      [35, 0]
	      Branch {
		Points			[0, 245]
		Branch {
		  DstBlock		  "max_torque\n lookup"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 80; 230, 0]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -30]
		    DstBlock		    "Gain1"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		DstBlock		"w>idle"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      DstBlock		      "spd>set point"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd>set point"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "T>~0"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>1"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		DstBlock		"spd>set point"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "From <vc>3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [70, 0; 0, 15]
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"Relational\nOperator4"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator6"
		DstPort			1
	      }
	    }
	    Annotation {
	      Position		      [740, 494]
	      Text		      "engine not suppressed if \ness insuffic"
"ient "
	    }
	    Annotation {
	      Position		      [423, 147]
	      Text		      "engine not \nsuppressed for\nelectric l"
"aunch"
	    }
	    Annotation {
	      Position		      [496, 72]
	      Text		      "engine not shut off\n rather than idle"
	    }
	    Annotation {
	      Position		      [578, 374]
	      Text		      "engine on if engine on \npreviously and"
" engine \nnot warm"
	    }
	    Annotation {
	      Position		      [666, 217]
	      Text		      "engine not shut \ndown during shifts"
	    }
	    Annotation {
	      Position		      [800, 394]
	      Text		      "engine not suppressed\nif mc insufficie"
"nt "
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [195, 456, 230, 584]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [670, 30, 700, 150]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [87, 76, 769, 527]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "parallel clutch\ncontrol"
	  Ports			  [4, 1]
	  Position		  [715, 240, 750, 320]
	  ForegroundColor	  "gray"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "parallel clutch\ncontrol"
	    Location		    [87, 106, 1000, 728]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "82"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 18, 60, 32]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 58, 60, 72]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 168, 55, 182]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [30, 388, 60, 402]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [835, 565, 891, 605]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[315, 744, 773, 944]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged\n\nBut the clutch is always disengaged when the"
" engine is off or was off within the past 0.5 s."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [40, 535, 60, 555]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [145, 83, 180, 107]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [145, 124, 225, 146]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [145, 189, 225, 211]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [145, 255, 180, 275]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [145, 319, 225, 341]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [570, 355, 605, 375]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [790, 175, 810, 195]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [660, 110, 720, 140]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [380, 67, 410, 98]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [315, 127, 345, 158]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual Switch"
	      Ports		      [2, 1]
	      Position		      [410, 387, 440, 423]
	      ForegroundColor	      "gray"
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [570, 300, 600, 330]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [170, 415, 200, 445]
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [170, 565, 200, 595]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [590, 107, 625, 143]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 57, 330, 88]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [260, 177, 290, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [260, 242, 290, 273]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [260, 307, 290, 338]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [235, 537, 265, 568]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [790, 120, 820, 150]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [330, 400, 360, 430]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [170, 475, 200, 505]
	      DelayTime		      "0.2"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [450, 17, 480, 48]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [520, 117, 550, 148]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [380, 254, 410, 286]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [235, 386, 265, 419]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [235, 466, 265, 499]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [475, 305, 510, 340]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [80, 160, 110, 190]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 217, 812, 726]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 115, 400, 145]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [855, 128, 885, 142]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -40]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [70, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 30]
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [75, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, -20; 250, 0]
		DstBlock		"Manual Switch"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Manual Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual Switch"
	      SrcPort		      1
	      Points		      [315, 0; 0, -270]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	      Branch {
		Points			[0, 180]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "pre-TX parallel\ngearbox control"
	  Ports			  [4, 3]
	  Position		  [300, 42, 335, 143]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "pre-TX parallel\ngearbox control"
	    Location		    [12, 74, 1189, 776]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "77"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 320, 65, 340]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 175, 65, 195]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [890, 605, 946, 645]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [330, 40, 350, 60]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [525, 200, 545, 220]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [445, 608, 540, 622]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [375, 473, 470, 487]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [525, 285, 545, 305]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [715, 461, 720, 499]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [545, 580, 670, 600]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [25, 534, 130, 566]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [545, 640, 670, 660]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [485, 500, 610, 520]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [485, 525, 610, 545]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [485, 435, 610, 455]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [470, 302, 495, 328]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [250, 525, 370, 545]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [250, 549, 370, 571]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [810, 370, 945, 390]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [820, 185, 930, 205]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [830, 260, 940, 280]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [630, 497, 635, 548]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [225, 87, 255, 118]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [510, 367, 540, 393]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [80, 175, 110, 195]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [710, 186, 730, 204]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [175, 522, 205, 573]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 80, 355, 110]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [520, 235, 550, 265]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [520, 155, 550, 185]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [690, 600, 720, 630]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [660, 465, 690, 495]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To WS"
	      Position		      [360, 339, 400, 361]
	      BackgroundColor	      "red"
	      VariableName	      "spd"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [420, 232, 450, 268]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[328, 265, 817, 480]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow upshift?"
	      Ports		      [4, 1]
	      Position		      [420, 152, 450, 188]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow upshift?"
		Location		[132, 265, 847, 659]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 25, 55, 45]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [35, 145, 55, 165]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [35, 105, 55, 125]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "prev Pout/Pin"
		  Position		  [35, 185, 55, 205]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES1"
		  Ports			  []
		  Position		  [645, 340, 701, 380]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES1"
		    Location		    [229, 259, 576, 405]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [172, 12]
		    VerticalAlignment	    "top"
		    Text		    "This block prevents an upshift if"
" it the engine is not on and\nthe upshift would make the motor power low enou"
"gh that it\ncould not provide the required input power.  However, an upshift"
"\nis allowed if to stay in the current gear would put the motor\nbeyond 95% o"
"f its maximum speed.\n\nThis block is to be used in pretransmission parallel "
"hybrids\n(where the engine and motor torques are combined on the\nengine side"
" of the transmission) ONLY."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [110, 75, 130, 95]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [100, 347, 375, 373]
		  Value			  "max(mc_map_spd)*mc_spd_scale/tc_mc_"
"to_fc_ratio*.95"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [15, 232, 80, 258]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "engine_on"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [3, 1]
		  Position		  [615, 53, 645, 97]
		  Operator		  "OR"
		  Inputs		  "3"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [125, 230, 155, 260]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [310, 37, 340, 68]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [540, 42, 570, 73]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [395, 287, 425, 318]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [165, 29, 205, 61]
		  FontName		  "Arial"
		  UpperLimit		  "gb_gears_num"
		  LowerLimit		  "1"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [105, 27, 135, 58]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "est. req'd\ninput pwr\n(W)"
		  Ports			  [3, 1]
		  Position		  [310, 109, 340, 141]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio"
		  Position		  [245, 33, 275, 57]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [250, 258, 280, 282]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "motor\ntorque\ncapability"
		  Position		  [380, 45, 410, 65]
		  FontName		  "Arial"
		  InputValues		  "mc_map_spd*mc_spd_scale"
		  OutputValues		  "mc_max_trq*mc_trq_scale*mc_overtrq_"
"factor+eps"
		}
		Block {
		  BlockType		  Product
		  Name			  "motor (input to gb)\npwr capability"
		  Ports			  [2, 1]
		  Position		  [455, 32, 485, 63]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "req'd input spd\nif no gear change"
		  Ports			  [2, 1]
		  Position		  [310, 276, 340, 309]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [675, 65, 695, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [430, 0; 0, -170]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev Pout/Pin"
		  SrcPort		  1
		  Points		  [225, 0; 0, -60]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [215, 0; 0, -30]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "est. req'd\ninput pwr\n(W)"
		  SrcPort		  1
		  Points		  [175, 0; 0, -60]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "motor (input to gb)\npwr capability"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "motor (input to gb)\npwr capabili"
"ty"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "motor\ntorque\ncapability"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "motor\ntorque\ncapability"
		  SrcPort		  1
		  DstBlock		  "motor (input to gb)\npwr capability"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear ratio"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  DstBlock		  "gear ratio"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Saturation"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "req'd input spd\nif no gear change"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 235]
		    DstBlock		    "gear ratio1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  Points		  [150, 0]
		  Branch {
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "est. req'd\ninput pwr\n(W)"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [0, 185]
		    DstBlock		    "req'd input spd\nif no gear chang"
"e"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [170, 0]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "req'd input spd\nif no gear change"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [655, 177, 675, 213]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [585, 189, 615, 221]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [420, 289, 450, 341]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [185, 205, 215, 225]
	      Orientation	      "up"
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 323, 170, 347]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 368, 430, 392]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [770, 183, 800, 207]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [275, 320, 305, 350]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 217, 812, 726]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [275, 96, 295, 114]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [670, 35, 710, 55]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [205, 370, 240, 390]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(gb_num_init)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [775, 254, 805, 286]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[166, 208, 456, 399]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [420, 64, 450, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[324, 355, 799, 650]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 77, 170, 113]
	      FontName		      "Arial"
	      Inputs		      "*//"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [785, 605, 805, 625]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [785, 445, 805, 465]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [785, 490, 805, 510]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, -90]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0; 0, 25]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, -150]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 110]
		  Branch {
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto4"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-30, 0]
	      Branch {
		Points			[-240, 0; 0, 205]
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -170]
		  Branch {
		    Points		    [0, 75]
		    Branch {
		    DstBlock		    "allow upshift?"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 145]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"allow upshift?"
		DstPort			4
	      }
	      Branch {
		Points			[0, -90]
		DstBlock		"~gb_trq_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [0, -75]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, -155]
		DstBlock		"allow upshift?"
		DstPort			3
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, 80]
		DstBlock		"allow upshift?"
		DstPort			2
	      }
	      Branch {
		DstBlock		"~gb_trq_in_r"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-75, 0; 0, -40]
	      Branch {
		Points			[0, -235]
		DstBlock		"~gb_trq_in_r"
		DstPort			3
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [230, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[20, 0]
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 220]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "allow upshift?"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[10, 0]
		Branch {
		  Points		  [0, -80; -145, 0]
		  DstBlock		  "engine\ntorque\ncapability"
		  DstPort		  1
		}
		Branch {
		  Points		  [30, 0]
		  Branch {
		    Points		    [0, -230]
		    DstBlock		    "upshift\n command"
		    DstPort		    3
		  }
		  Branch {
		    Points		    [30, 0]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    3
		  }
		}
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"To WS"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 10]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [879, 434]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [888, 301]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [887, 159]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [897, 127]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [50, 25, 80, 75]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [815, 273, 845, 287]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>2"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  3
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>7"
	  SrcPort		  1
	  Points		  [25, 0]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [135, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -45]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [190, 0]
	    Branch {
	      Points		      [0, -35]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      Points		      [0, 20]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>3"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>6"
	  SrcPort		  1
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>8"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "parallel clutch\ncontrol"
	  SrcPort		  1
	  Points		  [10, 0]
	  Branch {
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  Points		  [-5, 0]
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>9"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  Points		  [60, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  1
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [15, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [30, 0; 0, -35]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [207, 289]
	  Text			  "force\nrequired (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> par Adaptive"
      Ports		      [0, 1]
      Position		      [470, 319, 535, 371]
      BackgroundColor	      "blue"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> par Adaptive"
	Location		[10, 74, 997, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [525, 45, 620, 65]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [540, 472, 635, 488]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_trq_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [160, 81, 250, 99]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [160, 106, 255, 124]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [155, 140, 250, 160]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [525, 276, 620, 294]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [530, 342, 625, 358]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>6"
	  Position		  [530, 382, 625, 398]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>7"
	  Position		  [525, 242, 620, 258]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>8"
	  Position		  [525, 147, 620, 163]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [525, 80, 620, 100]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [525, 109, 615, 131]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 332, 105, 348]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [25, 365, 85, 385]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [20, 296, 105, 314]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [130, 472, 240, 488]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [135, 506, 235, 524]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [285, 330, 345, 350]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [120, 561, 240, 579]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [140, 435, 200, 455]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [25, 221, 110, 239]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [160, 46, 250, 64]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [130, 531, 245, 549]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [725, 470, 790, 490]
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [330, 100, 420, 120]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [335, 136, 415, 154]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>2"
	  Position		  [330, 65, 420, 85]
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [710, 95, 800, 115]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [730, 251, 800, 269]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [435, 326, 520, 344]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [430, 255, 515, 275]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [190, 314, 280, 336]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [205, 341, 295, 359]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [330, 476, 415, 494]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [330, 539, 415, 561]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [230, 220, 340, 240]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [195, 381, 285, 399]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [190, 411, 280, 429]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [405, 200, 515, 220]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [220, 610, 240, 630]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [380, 317, 410, 348]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [380, 247, 410, 278]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [185, 217, 215, 268]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [125, 284, 160, 386]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine on\n(Adaptive)"
	  Ports			  [1, 1]
	  Position		  [655, 458, 690, 502]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine on\n(Adaptive)"
	    Location		    [66, 260, 985, 674]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq req'd\nof engine"
	      Position		      [45, 268, 75, 282]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      ")"
	      Position		      [300, 300, 320, 320]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES1"
	      Ports		      []
	      Position		      [840, 350, 896, 390]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES1"
		Location		[301, 688, 731, 889]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [212, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine state computer keeps th"
"e engine on if:\n[\n1) (trq is too high AND speed is too high for idle) OR en"
"gine is allowed to idle, AND\n2) key is on, AND\n3) vehicle speed >= cs_elect"
"ric_launch_spd [ in m/s ], AND\n4) req'd trq > (cs_off_trq_frac * max_trq_at_"
"spd) OR SOC<cs_lo_soc\n]\nOR\n[ engine was previously on AND the transmission"
" is shifting ]\n\nThe last condition is added to prevent the engine from unre"
"alistically\nshutting down for a second or two during a shift."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [205, 38, 275, 62]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [185, 144, 280, 166]
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [205, 103, 275, 127]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>2"
	      Position		      [585, 88, 670, 112]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <fc><mc>"
	      Position		      [700, 371, 750, 389]
	      GotoTag		      "key_on"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [420, 131, 450, 164]
	      Operator		      "OR"
	      Inputs		      "2"
	      Port {
		PortNumber		1
		Name			"engine not shut off rather than idle"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [365, 36, 395, 69]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [3, 1]
	      Position		      [670, 162, 700, 298]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [705, 75, 735, 110]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [2, 1]
	      Position		      [755, 205, 785, 240]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [780, 40, 810, 70]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [170, 260, 200, 290]
	      ShowName		      off
	      X0		      "1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [350, 267, 380, 298]
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "T>~0"
	      Position		      [305, 17, 335, 48]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [185, 194, 240, 226]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on"
		Location		[5, 40, 315, 196]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on1"
	      Ports		      [0, 1]
	      Position		      [515, 369, 570, 401]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on1"
		Location		[5, 42, 410, 213]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      From
	      Name		      "spd req'd\nout of clutch\n(N*m)"
	      Position		      [40, 82, 105, 98]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "w_cl_out"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "speed\ncommand"
	      Ports		      [1]
	      Position		      [860, 261, 890, 299]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"speed\ncommand"
		Location		[260, 214, 966, 433]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "engine\non"
		  Position		  [25, 158, 55, 172]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [630, 165, 686, 205]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [156, 423, 612, 520]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "This engine control block determi"
"nes whether the engine is on, which it is when\n[(the clutch is slipping or e"
"ngaged OR idling is allowed) AND the ignition key is on]\nOR\n(the transmissi"
"on is shifting AND the engine was on during the previous time step).\nThe sec"
"ond part involving shifting is to prevent the engine from shutting down\nfor "
"1 or 2 seconds during shifts."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [275, 49, 355, 71]
		  Orientation		  "left"
		  Value			  "vc_launch_spd"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant7"
		  Position		  [500, 135, 520, 155]
		  Orientation		  "left"
		  ShowName		  off
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <fc>"
		  Position		  [35, 107, 130, 123]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "fc_spd_out_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [40, 31, 130, 49]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "clutch_state"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>"
		  Position		  [40, 70, 130, 90]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "v_ave_req"
		}
		Block {
		  BlockType		  Goto
		  Name			  "Goto <fc>1"
		  Position		  [610, 94, 690, 116]
		  GotoTag		  "spd_command"
		  TagVisibility		  "global"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [395, 90, 425, 120]
		  UpperLimit		  "inf"
		  LowerLimit		  "vc_idle_spd"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [300, 90, 330, 120]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [495, 90, 525, 120]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "setpoint"
		  Ports			  [2, 1]
		  Position		  [190, 56, 220, 94]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "setpoint"
		    Location		    [331, 296, 799, 644]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "clutch\nstate"
		    Position		    [15, 13, 45, 27]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "v_ave_req"
		    Position		    [20, 123, 50, 137]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant4"
		    Position		    [215, 75, 235, 95]
		    Orientation		    "left"
		    ShowName		    off
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant5"
		    Position		    [215, 190, 235, 210]
		    Orientation		    "left"
		    ShowName		    off
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant6"
		    Position		    [215, 310, 235, 330]
		    Orientation		    "left"
		    ShowName		    off
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "Logical\nOperator10"
		    Ports		    [3, 1]
		    Position		    [305, 122, 335, 158]
		    ShowName		    off
		    Operator		    "AND"
		    Inputs		    "3"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "clutch\ndisengaged"
		    Position		    [210, 12, 240, 43]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "moving next\ntime"
		    Position		    [210, 242, 240, 273]
		    Operator		    ">"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "not\nmoving"
		    Position		    [210, 122, 240, 153]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "repeated cycle:\n speed required "
"at\nend of NEXT second"
		    Ports		    [0, 1]
		    Position		    [130, 232, 165, 268]
		    FontName		    "Arial"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "Repeating table"
		    MaskDescription	    "Repeating table.\nEnter values of"
" time and output for first cycle."
		    MaskHelp		    "Repeats cycle given in table. Tim"
"e values should be monotonically increasing."
		    MaskPromptString	    "Time values:|Output values:|Look "
"ahead how far (s):"
		    MaskStyleString	    "edit,edit,edit"
		    MaskTunableValueString  "on,on,on"
		    MaskCallbackString	    "||"
		    MaskEnableString	    "on,on,on"
		    MaskVisibilityString    "on,on,on"
		    MaskToolTipString	    "on,on,on"
		    MaskVariables	    "t=@1;y=@2;dt=@3;"
		    MaskInitialization	    "period = max(t);"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "cyc_mph(:,1)|cyc_mph(:,2)|1"
		    MaskVariableAliases	    ",,"
		    System {
		    Name		    "repeated cycle:\n speed required "
"at\nend of NEXT second"
		    Location		    [402, 233, 777, 395]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [45, 60, 65, 80]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "Fcn1"
		    Position		    [110, 60, 150, 80]
		    Expr		    "rem(u[1],period)+dt"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "Look-Up Table"
		    Position		    [210, 58, 250, 82]
		    InputValues		    "t"
		    OutputValues	    "y"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [285, 60, 305, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Fcn1"
		    SrcPort		    1
		    DstBlock		    "Look-Up Table"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    DstBlock		    "Fcn1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Look-Up Table"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "output"
		    Position		    [360, 133, 390, 147]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Logical\nOperator10"
		    SrcPort		    1
		    DstBlock		    "output"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "v_ave_req"
		    SrcPort		    1
		    DstBlock		    "not\nmoving"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "clutch\nstate"
		    SrcPort		    1
		    DstBlock		    "clutch\ndisengaged"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant4"
		    SrcPort		    1
		    Points		    [-20, 0; 0, -50]
		    DstBlock		    "clutch\ndisengaged"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant5"
		    SrcPort		    1
		    Points		    [-20, 0; 0, -55]
		    DstBlock		    "not\nmoving"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "repeated cycle:\n speed required "
"at\nend of NEXT second"
		    SrcPort		    1
		    DstBlock		    "moving next\ntime"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant6"
		    SrcPort		    1
		    Points		    [-20, 0; 0, -55]
		    DstBlock		    "moving next\ntime"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "clutch\ndisengaged"
		    SrcPort		    1
		    DstBlock		    "Logical\nOperator10"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "not\nmoving"
		    SrcPort		    1
		    DstBlock		    "Logical\nOperator10"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "moving next\ntime"
		    SrcPort		    1
		    DstBlock		    "Logical\nOperator10"
		    DstPort		    3
		    }
		  }
		}
		Line {
		  SrcBlock		  "engine\non"
		  SrcPort		  1
		  Points		  [400, 0; 0, -60]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <fc>"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  Points		  [40, 0]
		  DstBlock		  "setpoint"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <wh>"
		  SrcPort		  1
		  Points		  [40, 0]
		  DstBlock		  "setpoint"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "setpoint"
		  SrcPort		  1
		  Points		  [20, 0; 0, 30]
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Saturation"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0; 0, 35]
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  Points		  [20, 0; 0, -10]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Goto <fc>1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant7"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
	      }
	    }
	    Block {
	      BlockType		      From
	      Name		      "trq req'd\nout of clutch\n(N*m)"
	      Position		      [35, 16, 115, 34]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "T_cl_out"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "w>idle"
	      Position		      [305, 82, 335, 113]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [860, 218, 890, 232]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 0]
	      SrcBlock		      "key_on1"
	      SrcPort		      1
	      Points		      [110, 0]
	      DstBlock		      "Goto <fc><mc>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "trq req'd\nof engine"
	      SrcPort		      1
	      DstBlock		      "Memory1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [270, 0]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "trq req'd\nout of clutch\n(N*m)"
	      SrcPort		      1
	      DstBlock		      "T>~0"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      ")"
	      SrcPort		      1
	      Points		      [5, 0; 0, -20]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd req'd\nout of clutch\n(N*m)"
	      SrcPort		      1
	      DstBlock		      "w>idle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "T>~0"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "T>~0"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-90, 0; 0, 30]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 0]
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [410, 0]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      Name		      "engine not shut off rather than idle"
	      Labels		      [3, 0]
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [25, 0; 0, 35]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "w>idle"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "w>idle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[0, 55]
		DstBlock		"speed\ncommand"
		DstPort			1
	      }
	      Branch {
		Points			[15, 0]
		Branch {
		  Points		  [0, -170]
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "engine on"
		  DstPort		  1
		}
	      }
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [275, 451, 310, 579]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [655, 45, 685, 165]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [89, 74, 771, 525]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "parallel clutch\ncontrol"
	  Ports			  [4, 1]
	  Position		  [655, 255, 690, 335]
	  ForegroundColor	  "gray"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "parallel clutch\ncontrol"
	    Location		    [82, 224, 995, 846]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 18, 60, 32]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 58, 60, 72]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 168, 55, 182]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [30, 388, 60, 402]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [835, 565, 891, 605]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[315, 744, 773, 944]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged\n\nBut the clutch is always disengaged when the"
" engine is off or was off within the past 0.5 s."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [40, 535, 60, 555]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [145, 83, 180, 107]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [145, 124, 225, 146]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [145, 189, 225, 211]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [145, 255, 180, 275]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [145, 319, 225, 341]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [570, 355, 605, 375]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [790, 175, 810, 195]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [660, 110, 720, 140]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [380, 67, 410, 98]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [315, 127, 345, 158]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual Switch"
	      Ports		      [2, 1]
	      Position		      [410, 387, 440, 423]
	      ForegroundColor	      "gray"
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [570, 300, 600, 330]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [170, 415, 200, 445]
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [170, 565, 200, 595]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [590, 107, 625, 143]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 57, 330, 88]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [260, 177, 290, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [260, 242, 290, 273]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [260, 307, 290, 338]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [235, 537, 265, 568]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [790, 120, 820, 150]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [330, 400, 360, 430]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [170, 475, 200, 505]
	      DelayTime		      "0.2"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [450, 17, 480, 48]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [520, 117, 550, 148]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [380, 254, 410, 286]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [235, 386, 265, 419]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [235, 466, 265, 499]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [475, 305, 510, 340]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [80, 160, 110, 190]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 217, 812, 726]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 115, 400, 145]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [855, 128, 885, 142]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -40]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [70, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 30]
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [75, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, -20; 250, 0]
		DstBlock		"Manual Switch"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Manual Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual Switch"
	      SrcPort		      1
	      Points		      [315, 0; 0, -270]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	      Branch {
		Points			[0, 180]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "pre-TX parallel\ngearbox control"
	  Ports			  [4, 3]
	  Position		  [275, 58, 310, 157]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "pre-TX parallel\ngearbox control"
	    Location		    [8, 74, 995, 742]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 320, 65, 340]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 175, 65, 195]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [875, 615, 931, 655]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [330, 40, 350, 60]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [525, 200, 545, 220]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [435, 588, 530, 602]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [365, 453, 460, 467]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [525, 285, 545, 305]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [705, 441, 710, 479]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [535, 560, 660, 580]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [15, 514, 120, 546]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [535, 620, 660, 640]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [475, 480, 600, 500]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [475, 505, 600, 525]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [475, 415, 600, 435]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [470, 302, 495, 328]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [240, 505, 360, 525]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [240, 529, 360, 551]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [805, 370, 940, 390]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [825, 185, 935, 205]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [830, 260, 940, 280]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [620, 477, 625, 528]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [225, 87, 255, 118]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [510, 367, 540, 393]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [80, 175, 110, 195]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [710, 186, 730, 204]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [165, 502, 195, 553]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 80, 355, 110]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [520, 235, 550, 265]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [520, 155, 550, 185]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [680, 580, 710, 610]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [650, 445, 680, 475]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To WS"
	      Position		      [360, 339, 400, 361]
	      BackgroundColor	      "red"
	      VariableName	      "spd"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [420, 232, 450, 268]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[328, 265, 817, 480]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow upshift?"
	      Ports		      [4, 1]
	      Position		      [420, 152, 450, 188]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow upshift?"
		Location		[132, 265, 847, 659]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 25, 55, 45]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [35, 145, 55, 165]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [35, 105, 55, 125]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "prev Pout/Pin"
		  Position		  [35, 185, 55, 205]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES1"
		  Ports			  []
		  Position		  [645, 340, 701, 380]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES1"
		    Location		    [229, 259, 576, 405]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [172, 12]
		    VerticalAlignment	    "top"
		    Text		    "This block prevents an upshift if"
" it the engine is not on and\nthe upshift would make the motor power low enou"
"gh that it\ncould not provide the required input power.  However, an upshift"
"\nis allowed if to stay in the current gear would put the motor\nbeyond 95% o"
"f its maximum speed.\n\nThis block is to be used in pretransmission parallel "
"hybrids\n(where the engine and motor torques are combined on the\nengine side"
" of the transmission) ONLY."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [110, 75, 130, 95]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [100, 347, 375, 373]
		  Value			  "max(mc_map_spd)*mc_spd_scale/tc_mc_"
"to_fc_ratio*.95"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [15, 232, 80, 258]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "engine_on"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [3, 1]
		  Position		  [615, 53, 645, 97]
		  Operator		  "OR"
		  Inputs		  "3"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [125, 230, 155, 260]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [310, 37, 340, 68]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [540, 42, 570, 73]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [395, 287, 425, 318]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [165, 29, 205, 61]
		  FontName		  "Arial"
		  UpperLimit		  "gb_gears_num"
		  LowerLimit		  "1"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [105, 27, 135, 58]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "est. req'd\ninput pwr\n(W)"
		  Ports			  [3, 1]
		  Position		  [310, 109, 340, 141]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio"
		  Position		  [245, 33, 275, 57]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [250, 258, 280, 282]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "motor\ntorque\ncapability"
		  Position		  [380, 45, 410, 65]
		  FontName		  "Arial"
		  InputValues		  "mc_map_spd*mc_spd_scale"
		  OutputValues		  "mc_max_trq*mc_trq_scale*mc_overtrq_"
"factor+eps"
		}
		Block {
		  BlockType		  Product
		  Name			  "motor (input to gb)\npwr capability"
		  Ports			  [2, 1]
		  Position		  [455, 32, 485, 63]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "req'd input spd\nif no gear change"
		  Ports			  [2, 1]
		  Position		  [310, 276, 340, 309]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [675, 65, 695, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [430, 0; 0, -170]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev Pout/Pin"
		  SrcPort		  1
		  Points		  [225, 0; 0, -60]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [215, 0; 0, -30]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "est. req'd\ninput pwr\n(W)"
		  SrcPort		  1
		  Points		  [175, 0; 0, -60]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "motor (input to gb)\npwr capability"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "motor (input to gb)\npwr capabili"
"ty"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "motor\ntorque\ncapability"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "motor\ntorque\ncapability"
		  SrcPort		  1
		  DstBlock		  "motor (input to gb)\npwr capability"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear ratio"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  DstBlock		  "gear ratio"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Saturation"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "req'd input spd\nif no gear change"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 235]
		    DstBlock		    "gear ratio1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  Points		  [150, 0]
		  Branch {
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "est. req'd\ninput pwr\n(W)"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [0, 185]
		    DstBlock		    "req'd input spd\nif no gear chang"
"e"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [170, 0]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "req'd input spd\nif no gear change"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [655, 177, 675, 213]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [585, 189, 615, 221]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [420, 289, 450, 341]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [185, 205, 215, 225]
	      Orientation	      "up"
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 323, 170, 347]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 368, 430, 392]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [775, 183, 805, 207]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [275, 320, 305, 350]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 217, 812, 726]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [275, 96, 295, 114]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [670, 35, 710, 55]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [205, 370, 240, 390]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(gb_num_init)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [775, 254, 805, 286]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[166, 208, 456, 399]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [420, 64, 450, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[324, 355, 799, 650]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 77, 170, 113]
	      FontName		      "Arial"
	      Inputs		      "*//"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [775, 585, 795, 605]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [775, 425, 795, 445]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [775, 470, 795, 490]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, -90]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0; 0, 25]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, -150]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Labels		  [1, 0]
		  Points		  [0, 110]
		  Branch {
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto4"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-30, 0]
	      Branch {
		Points			[-240, 0; 0, 205]
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -170]
		  Branch {
		    Points		    [0, 75]
		    Branch {
		    DstBlock		    "allow upshift?"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 145]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"allow upshift?"
		DstPort			4
	      }
	      Branch {
		Points			[0, -90]
		DstBlock		"~gb_trq_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [0, -75]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, -155]
		DstBlock		"allow upshift?"
		DstPort			3
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, 80]
		DstBlock		"allow upshift?"
		DstPort			2
	      }
	      Branch {
		DstBlock		"~gb_trq_in_r"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-75, 0; 0, -40]
	      Branch {
		Points			[0, -235]
		DstBlock		"~gb_trq_in_r"
		DstPort			3
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [230, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[20, 0]
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 220]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "allow upshift?"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[10, 0]
		Branch {
		  Points		  [0, -80; -145, 0]
		  DstBlock		  "engine\ntorque\ncapability"
		  DstPort		  1
		}
		Branch {
		  Points		  [30, 0]
		  Branch {
		    Points		    [0, -230]
		    DstBlock		    "upshift\n command"
		    DstPort		    3
		  }
		  Branch {
		    Points		    [30, 0]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    3
		  }
		}
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"To WS"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [45, 0]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [879, 414]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [888, 301]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [877, 154]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [857, 102]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [50, 30, 80, 80]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [765, 288, 795, 302]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine on\n(Adaptive)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine on\n(Adaptive)"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>8"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 10]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 10; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [195, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -45]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "parallel clutch\ncontrol"
	  SrcPort		  1
	  Points		  [20, 0]
	  Branch {
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  Points		  [0, -45]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>6"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>7"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [55, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [15, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [5, 0; 0, -55]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> par auto"
      Ports		      [0, 1]
      Position		      [265, 144, 330, 196]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> par auto"
	Location		[6, 74, 993, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"93"
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [580, 70, 675, 90]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [570, 537, 665, 553]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [165, 136, 255, 154]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [155, 46, 250, 64]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [160, 165, 255, 185]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [575, 301, 670, 319]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [570, 507, 665, 523]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>6"
	  Position		  [575, 337, 670, 353]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>7"
	  Position		  [570, 471, 665, 489]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [580, 105, 675, 125]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [585, 134, 675, 156]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>2"
	  Position		  [575, 273, 665, 287]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>3"
	  Position		  [585, 173, 675, 187]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 357, 105, 373]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [25, 390, 85, 410]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [20, 321, 105, 339]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [170, 502, 280, 518]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [175, 536, 275, 554]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [570, 571, 655, 589]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [150, 586, 270, 604]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [570, 606, 655, 624]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [185, 470, 245, 490]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [290, 335, 350, 355]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>9"
	  Position		  [20, 246, 105, 264]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From par cntrl"
	  Position		  [575, 376, 670, 394]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [165, 96, 255, 114]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [170, 561, 285, 579]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [790, 500, 855, 520]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [785, 535, 865, 555]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [790, 571, 840, 589]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [380, 75, 470, 95]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [380, 116, 460, 134]
	  NamePlacement		  "alternate"
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>"
	  Position		  [385, 162, 460, 178]
	  GotoTag		  "locked_up"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>1"
	  Position		  [385, 29, 460, 51]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [765, 120, 855, 140]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [785, 276, 855, 294]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [440, 331, 525, 349]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [435, 280, 520, 300]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [185, 334, 275, 356]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [200, 366, 290, 384]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [370, 506, 455, 524]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [370, 569, 455, 591]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [230, 245, 340, 265]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [195, 406, 285, 424]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [190, 436, 280, 454]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [405, 215, 515, 235]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [240, 615, 260, 635]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [390, 322, 420, 353]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [385, 272, 415, 303]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [185, 242, 215, 293]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [125, 309, 160, 411]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine on\n(parallel hybrid)"
	  Ports			  [5, 3]
	  Position		  [710, 489, 745, 601]
	  ForegroundColor	  "green"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine on\n(parallel hybrid)"
	    Location		    [53, 75, 987, 723]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq req'd\nout of clutch\n(N*m)"
	      Position		      [35, 13, 65, 27]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "spd req'd\nout of clutch\n(N*m)1"
	      Position		      [30, 78, 60, 92]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [415, 553, 445, 567]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [160, 523, 190, 537]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch\nstate"
	      Position		      [100, 468, 130, 482]
	      Port		      "5"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [165, 271, 225, 289]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)1"
	      Position		      [115, 376, 190, 394]
	      Value		      "cs_off_trq_frac"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)2"
	      Position		      [745, 105, 785, 125]
	      ForegroundColor	      "green"
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)3"
	      Position		      [520, 322, 570, 338]
	      Value		      "fc_tstat"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES1"
	      Ports		      []
	      Position		      [830, 60, 886, 100]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES1"
		Location		[296, 542, 726, 743]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [212, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine state computer keeps th"
"e engine on if:\n[\n1) key is on, AND\n2) (trq is too high AND speed is too h"
"igh for idle) OR engine is allowed to idle, AND\n3) vehicle speed >= cs_elect"
"ric_launch_spd [ in m/s ], AND\n4) req'd trq > (cs_off_trq_frac * max_trq_at_"
"spd) OR SOC<cs_lo_soc\n]\nOR\n[ engine was previously on AND the transmission"
" is shifting ]\n\nThe last condition is added to prevent the engine from unre"
"alistically\nshutting down for a second or two during a shift."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [110, 27, 145, 43]
	      ShowName		      off
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [325, 82, 395, 98]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant10"
	      Position		      [170, 232, 300, 248]
	      ShowName		      off
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [95, 61, 210, 79]
	      ShowName		      off
	      Value		      "cs_electric_decel_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [105, 117, 175, 133]
	      ShowName		      off
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [400, 509, 480, 531]
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [155, 480, 175, 500]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [215, 535, 235, 555]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [155, 585, 175, 605]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [740, 550, 760, 570]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [240, 389, 270, 411]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [625, 370, 645, 390]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [105, 254, 150, 276]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>1"
	      Position		      [105, 148, 190, 172]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>2"
	      Position		      [585, 243, 655, 257]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>3"
	      Position		      [335, 475, 420, 495]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_pwr"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>4"
	      Position		      [515, 286, 585, 304]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [585, 318, 615, 342]
	      Gain		      "vc_fc_warm_tmp_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [380, 390, 410, 420]
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [3, 1]
	      Position		      [340, 511, 370, 569]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator11"
	      Ports		      [1, 1]
	      Position		      [350, 235, 380, 255]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator12"
	      Ports		      [3, 1]
	      Position		      [810, 154, 840, 186]
	      ForegroundColor	      "green"
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator13"
	      Ports		      [2, 1]
	      Position		      [685, 298, 715, 327]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [425, 31, 445, 64]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [330, 21, 360, 54]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [2, 1]
	      Position		      [285, 16, 305, 49]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [3, 1]
	      Position		      [585, 125, 615, 235]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [3, 1]
	      Position		      [385, 322, 405, 358]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [680, 243, 710, 272]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [5, 1]
	      Position		      [755, 160, 785, 220]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "5"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [2, 1]
	      Position		      [520, 160, 545, 195]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [205, 175, 235, 205]
	      InputValues	      "[cs_lo_soc cs_hi_soc cs_hi_soc+eps]"
	      OutputValues	      "[cs_electric_launch_spd_lo cs_electric_"
"launch_spd_hi cs_electric_launch_spd_hi]"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual \nSwitch"
	      Ports		      [2, 1]
	      Position		      [685, 397, 715, 433]
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [685, 340, 715, 370]
	      Orientation	      "left"
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [235, 347, 265, 378]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [345, 432, 375, 463]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [500, 397, 530, 428]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [275, 153, 300, 182]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [290, 324, 315, 351]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [255, 257, 285, 288]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [290, 379, 315, 406]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [530, 444, 555, 471]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [635, 289, 660, 316]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [625, 409, 650, 436]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [595, 525, 625, 555]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [435, 432, 480, 468]
	      ForegroundColor	      "green"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time Steps (#)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskVariables	      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "3"
	      System {
		Name			"Subsystem"
		Location		[137, 366, 771, 685]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [50, 110, 70, 130]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [75, 210, 95, 230]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [75, 274, 115, 296]
		  FontName		  "Arial"
		  Value			  "n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [380, 224, 420, 246]
		  FontName		  "Arial"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>2"
		  Position		  [120, 88, 190, 102]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "shifting"
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [295, 100, 315, 120]
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [135, 235, 165, 265]
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [170, 30, 200, 60]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [505, 109, 525, 136]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [210, 271, 230, 289]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [250, 187, 280, 218]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [440, 105, 460, 125]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [170, 210, 190, 230]
		  ShowName		  off
		  IconShape		  "round"
		  Inputs		  "|+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [305, 190, 335, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [450, 190, 480, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch2"
		  Position		  [235, 95, 265, 125]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch3"
		  Position		  [115, 30, 145, 60]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  VariableTransportDelay
		  Name			  "Variable\nTransport Delay"
		  Position		  [375, 137, 405, 168]
		  MaximumDelay		  "n"
		  InitialInput		  "0"
		  MaximumPoints		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [550, 115, 570, 135]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "From <vc>2"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -15; -120, 0; 0, -35]
		    DstBlock		    "Switch3"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 15]
		    DstBlock		    "Switch2"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -30; -120, 0]
		    DstBlock		    "Switch3"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Switch3"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Switch3"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch2"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  Points		  [0, -75]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [80, 0]
		    Branch {
		    Points		    [0, -10]
		    DstBlock		    "Switch1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Switch1"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [0, -45]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [55, 0]
		    DstBlock		    "Switch"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -25]
		    Branch {
		    Points		    [0, -15; 175, 0]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Variable\nTransport Delay"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [515, 513, 545, 567]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [810, 534, 835, 566]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [400, 239, 430, 281]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [445, 294, 475, 336]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "T>~0"
	      Position		      [170, 12, 200, 43]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace"
	      Position		      [325, 181, 480, 199]
	      VariableName	      "cs_electric_launch_spd_probe"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [210, 467, 240, 498]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [575, 29, 630, 61]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on"
		Location		[5, 42, 410, 213]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup"
	      Position		      [115, 343, 145, 367]
	      NamePlacement	      "alternate"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup1"
	      Position		      [445, 393, 475, 417]
	      NamePlacement	      "alternate"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale*mc_overtrq_fact"
"or"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [210, 572, 240, 603]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [275, 522, 305, 553]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [70, 542, 105, 578]
	      ForegroundColor	      "green"
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[57, 72, 432, 234]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "spd>set point"
	      Position		      [235, 47, 265, 78]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "w>idle"
	      Position		      [275, 102, 305, 133]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [875, 163, 905, 177]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [865, 543, 895, 557]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [765, 38, 795, 52]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator12"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 185]
		Branch {
		  Points		  [0, 165; -55, 0]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)2"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Product"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      Points		      [70, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "w>idle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "T>~0"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [5, 0; 0, -80]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "trq req'd\nout of clutch\n(N*m)"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"T>~0"
		DstPort			1
	      }
	      Branch {
		Points			[0, 310]
		Branch {
		  Points		  [0, 125]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "w>idle"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd req'd\nout of clutch\n(N*m)1"
	      SrcPort		      1
	      Points		      [0, 25; 30, 0]
	      Branch {
		Points			[0, 245]
		Branch {
		  DstBlock		  "max_torque\n lookup"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 85; 230, 0]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Gain1"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		DstBlock		"w>idle"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -35]
	      Branch {
		DstBlock		"Logical\nOperator7"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Logical\nOperator13"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator13"
	      SrcPort		      1
	      Points		      [10, 0; 0, -125]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)3"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      3
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 0]
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [85, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 105; 70, 0; 0, 20]
		DstBlock		"Logical\nOperator12"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [105, 0; 0, 95]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      Points		      [30, 0; 0, -100]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			2
	      }
	      Branch {
		DstBlock		"To Workspace"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant10"
	      SrcPort		      1
	      Points		      [0, 20; 25, 0]
	      Branch {
		Points			[0, 40]
		Branch {
		  DstBlock		  "Switch4"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 15]
		  DstBlock		  "Switch4"
		  DstPort		  2
		}
	      }
	      Branch {
		DstBlock		"Switch3"
		DstPort			2
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Logical\nOperator11"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"Switch3"
		DstPort			3
	      }
	      Branch {
		Points			[0, 55]
		DstBlock		"Logical\nOperator6"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator11"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		Points			[0, -75]
		DstBlock		"Look-Up Table"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [75, 0; 0, 20]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [80, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nstate"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>3"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [175, 0; 0, -260]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [80, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      DstBlock		      "spd>set point"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd>set point"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "T>~0"
	      SrcPort		      1
	      Points		      [65, 0]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>1"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		DstBlock		"spd>set point"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"max_torque\n lookup1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"Product3"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [70, 0; 0, 15]
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual \nSwitch"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      5
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"Relational\nOperator4"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15; 100, 0]
		DstBlock		"Relational\nOperator6"
		DstPort			1
	      }
	    }
	    Annotation {
	      Position		      [785, 464]
	      Text		      "engine not suppressed if \ness insuffic"
"ient "
	    }
	    Annotation {
	      Position		      [423, 147]
	      Text		      "engine not \nsuppressed for\nelectric l"
"aunch"
	    }
	    Annotation {
	      Position		      [496, 72]
	      Text		      "engine not shut off\n rather than idle"
	    }
	    Annotation {
	      Position		      [563, 379]
	      Text		      "engine on if engine on \npreviously and"
" engine \nnot warm"
	    }
	    Annotation {
	      Position		      [666, 217]
	      Text		      "engine not shut \ndown during shifts"
	    }
	    Annotation {
	      Position		      [800, 404]
	      Text		      "engine not suppressed\nif mc insufficie"
"nt "
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [310, 481, 345, 609]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox control\nfor use w/ AT"
	  Ports			  [4, 4]
	  Position		  [310, 54, 345, 166]
	  ForegroundColor	  "magenta"
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox control\nfor use w/ AT"
	    Location		    [6, 74, 977, 726]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "eta_gb"
	      Position		      [45, 85, 65, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 135, 65, 155]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 180, 65, 200]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 230, 65, 250]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [910, 790, 966, 830]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[430, 234, 888, 441]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [217, 162]
		  Text			  "Lock-up of the HTC occurs when it i"
"s supposed to for the current gear, AND\nthe transmission isn't shifting, AND"
"\nthe lockup wouldn't precipitate an immediate downshift."
		}
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [385, 65, 405, 85]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [320, 375, 340, 395]
	      Orientation	      "left"
	      Value		      "0.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [435, 783, 530, 797]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [365, 648, 460, 662]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [385, 470, 405, 490]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [705, 636, 710, 674]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [535, 755, 660, 775]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [15, 709, 120, 741]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [535, 815, 660, 835]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [475, 675, 600, 695]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [475, 700, 600, 720]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [475, 610, 600, 630]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From5"
	      Position		      [105, 250, 195, 270]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "gear_num_out"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From6"
	      Position		      [185, 425, 275, 445]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting_out"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [535, 207, 560, 233]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [240, 700, 360, 720]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [240, 724, 360, 746]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [735, 700, 855, 720]
	      GotoTag		      "shifting_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto3"
	      Position		      [840, 195, 945, 215]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [935, 65, 1045, 85]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [935, 140, 1045, 160]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto7"
	      Position		      [790, 840, 910, 860]
	      GotoTag		      "gear_num_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [4, 1]
	      Position		      [665, 402, 695, 448]
	      Operator		      "AND"
	      Inputs		      "4"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [320, 419, 350, 451]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [1, 1]
	      Position		      [530, 506, 560, 544]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [600, 510, 630, 540]
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [620, 672, 625, 723]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [255, 112, 285, 143]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [595, 203, 615, 227]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product4"
	      Ports		      [2, 1]
	      Position		      [255, 517, 285, 548]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [315, 317, 345, 348]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [780, 66, 800, 84]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [165, 697, 195, 748]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [380, 105, 410, 135]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [380, 510, 410, 540]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [680, 775, 710, 805]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [650, 640, 680, 670]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [475, 32, 505, 68]
	      ForegroundColor	      "blue"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[342, 275, 831, 490]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [380, 43, 410, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [150, 60, 185, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [150, 105, 185, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [230, 38, 260, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [230, 98, 260, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [50, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 70; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [725, 57, 745, 93]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [655, 114, 685, 146]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [475, 194, 505, 246]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[441, 362, 916, 657]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand1"
	      Ports		      [3, 1]
	      Position		      [475, 499, 505, 551]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand1"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [200, 125, 230, 145]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability1"
	      Position		      [200, 530, 230, 550]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand\nspd"
	      Ports		      [4, 3]
	      Position		      [115, 84, 145, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand\nspd"
		Location		[46, 549, 1231, 942]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear\nnumber"
		  Position		  [20, 113, 50, 127]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [20, 168, 50, 182]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [20, 223, 50, 237]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [20, 283, 50, 297]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [1095, 305, 1151, 345]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the previous gear, assuming that\nthe gearbox efficiency is c"
"onstant."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [760, 220, 780, 240]
		  Orientation		  "left"
		  Value			  "[1 1]"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant5"
		  Position		  [620, 70, 640, 90]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Demux
		  Name			  "Demux"
		  Ports			  [1, 2]
		  Position		  [980, 172, 1015, 208]
		  Outputs		  "2"
		  BusSelectionMode	  off
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [310, 50, 405, 70]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "locked_up"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "K_adv"
		  Ports			  [1, 1]
		  Position		  [340, 145, 370, 175]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "K_adv"
		    Location		    [502, 588, 994, 833]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    Position		    [45, 58, 75, 72]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "K_adv=wout/(Tout)^0.5"
		    Position		    [160, 51, 280, 79]
		    FontName		    "Arial"
		    Expr		    "u[2]/u[1]^0.5"
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation"
		    Position		    [305, 50, 335, 80]
		    UpperLimit		    "max(htc_k_adv)"
		    LowerLimit		    "min(htc_k_adv)"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation2"
		    Position		    [105, 50, 135, 80]
		    ShowName		    off
		    UpperLimit		    "inf"
		    LowerLimit		    "eps"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "K_adv"
		    Position		    [385, 58, 415, 72]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    SrcPort		    1
		    DstBlock		    "Saturation2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Saturation2"
		    SrcPort		    1
		    DstBlock		    "K_adv=wout/(Tout)^0.5"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "K_adv=wout/(Tout)^0.5"
		    SrcPort		    1
		    DstBlock		    "Saturation"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Saturation"
		    SrcPort		    1
		    DstBlock		    "K_adv"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [685, 36, 715, 69]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [1, 1]
		  Position		  [510, 43, 540, 77]
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [445, 45, 475, 75]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux1"
		  Ports			  [2, 1]
		  Position		  [805, 97, 840, 133]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux2"
		  Ports			  [2, 1]
		  Position		  [310, 142, 320, 178]
		  ShowName		  off
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [615, 12, 645, 43]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "SR Look-Up\nTable\nSR=wout/win"
		  Position		  [415, 210, 445, 240]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_sr"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [85, 160, 115, 190]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [1035, 185, 1065, 215]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [755, 170, 785, 200]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "TR Look-Up\nTable\nTR=Tout/Tin"
		  Position		  [415, 125, 445, 155]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_tr"
		}
		Block {
		  BlockType		  Mux
		  Name			  "TR,SR"
		  Ports			  [2, 1]
		  Position		  [695, 157, 730, 193]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [85, 108, 115, 132]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~eng trq\nand spd"
		  Ports			  [2, 1]
		  Position		  [870, 161, 900, 194]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [2, 1]
		  Position		  [170, 265, 200, 300]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [170, 105, 200, 195]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [1105, 103, 1135, 117]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [1100, 193, 1130, 207]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "gb_spd_in_est\n(rad/s)1"
		  Position		  [1100, 238, 1130, 252]
		  ForegroundColor	  "blue"
		  Port			  "3"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [90, 0]
		  Branch {
		    DstBlock		    "Mux2"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [495, 0]
		    Branch {
		    Points		    [295, 0]
		    DstBlock		    "gb_spd_in_est\n(rad/s)1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Mux1"
		    DstPort		    2
		    }
		  }
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  Points		  [85, 0]
		  Branch {
		    Points		    [0, -45; 290, 0]
		    Branch {
		    Points		    [0, -85]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Mux1"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Mux2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "SR Look-Up\nTable\nSR=wout/win"
		  SrcPort		  1
		  Points		  [230, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "TR Look-Up\nTable\nTR=Tout/Tin"
		  SrcPort		  1
		  Points		  [230, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "K_adv"
		  SrcPort		  1
		  Points		  [15, 0; 0, -5]
		  Branch {
		    Points		    [0, 70]
		    DstBlock		    "SR Look-Up\nTable\nSR=wout/win"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "TR Look-Up\nTable\nTR=Tout/Tin"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Mux2"
		  SrcPort		  1
		  DstBlock		  "K_adv"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~eng trq\nand spd"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Demux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux1"
		  SrcPort		  1
		  Points		  [5, 0; 0, 55]
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  1
		  Points		  [40, 0; 0, -70]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant5"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  2
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "TR,SR"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 155]
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand spd assuming\nlock"
"up"
	      Ports		      [4, 2]
	      Position		      [115, 489, 145, 521]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand spd assuming\nlo"
"ckup"
		Location		[73, 443, 774, 727]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "new gear\nnumber"
		  Position		  [30, 28, 60, 42]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [30, 83, 60, 97]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [30, 138, 60, 152]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_est"
		  Position		  [30, 218, 60, 232]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [625, 180, 681, 220]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the current gear, assuming that\nthe gearbox efficiency is co"
"nstant."
		    }
		  }
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [130, 180, 160, 210]
		  X0			  "gb_ratio(1)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [95, 75, 125, 105]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [580, 65, 610, 95]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [95, 23, 125, 47]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 150, 210, 240]
		  Inputs		  "*/*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 20, 210, 110]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [645, 18, 675, 32]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [645, 73, 675, 87]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [90, 0; 0, -110; 250, 0; 0, -5]
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  Points		  [340, 0; 0, -5; 20, 0; 0, -35]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_est"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "new gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 130]
		    Branch {
		    Points		    [-35, 0]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [870, 63, 900, 87]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [310, 116, 345, 144]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)1"
	      Position		      [310, 521, 345, 549]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "lock-up in\nthis gear"
	      Position		      [260, 313, 290, 337]
	      FontName		      "Arial"
	      InputValues	      "[1:length(htc_lockup)]"
	      OutputValues	      "htc_lockup"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [745, 15, 785, 35]
	      Orientation	      "left"
	      ForegroundColor	      "magenta"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [845, 134, 875, 166]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[76, 244, 366, 435]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [47, 595, 337, 734]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [48, 850, 371, 995]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [389, 635, 793, 850]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [475, 94, 505, 146]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[433, 169, 908, 464]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [1031, 545, 1271, 627]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [775, 780, 795, 800]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [775, 620, 795, 640]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [775, 665, 795, 685]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "locked up"
	      Position		      [940, 415, 960, 435]
	      FontName		      "Arial"
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      2
	      Points		      [35, 0; 0, 35]
	      Branch {
		Points			[0, 65; 240, 0]
		Branch {
		  Points		  [0, 35]
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
		Branch {
		  Points		  [0, -65]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
	      }
	      Branch {
		DstBlock		"engine\ntorque\ncapability"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "est. engine trq\nand\nspd"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-165, 0]
	      Branch {
		Points			[0, 40]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[-125, 0]
		Branch {
		  Points		  [0, 25]
		  Branch {
		    Points		    [0, 55]
		    Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 100]
		    Branch {
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 305]
		    DstBlock		    "downshift \ncommand1"
		    DstPort		    1
		    }
		    }
		  }
		  Branch {
		    DstBlock		    "allow downshift?"
		    DstPort		    1
		  }
		}
		Branch {
		  Points		  [-355, 0; 0, 60]
		  DstBlock		  "est. engine trq\nand\nspd"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[20, 0]
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -50]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 55]
		  DstBlock		  "Goto3"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [55, 0; 0, 160]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [0, 75]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product4"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability1"
	      SrcPort		      1
	      DstBlock		      "Product4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Product4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "eta_gb"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			2
	      }
	      Branch {
		Points			[0, 405]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -40]
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			3
	      }
	      Branch {
		Points			[0, 365]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [290, 0]
	      Branch {
		Points			[0, 285]
		DstBlock		"Switch1"
		DstPort			2
	      }
	      Branch {
		Points			[0, -120]
		DstBlock		"Switch"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      3
	      Points		      [0, 115; -55, 0; 0, 295]
	      DstBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      2
	      Points		      [35, 0; 0, 25]
	      Branch {
		DstBlock		"engine\ntorque\ncapability1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 55; 265, 0; 0, -55]
		DstBlock		"downshift \ncommand1"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, -95]
		DstBlock		"Logical\nOperator"
		DstPort			3
	      }
	      Branch {
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 100]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [120, 0]
	      Branch {
		Points			[0, 10]
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "locked up"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "downshift \ncommand1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [10, 0; 0, -85]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "lock-up in\nthis gear"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From6"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [5, 0; 0, 0]
	      Branch {
		Points			[40, 0]
		DstBlock		"shifting, out"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Goto2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"gear number, out"
		DstPort			1
	      }
	      Branch {
		Points			[0, 60]
		DstBlock		"Goto7"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From5"
	      SrcPort		      1
	      Points		      [0, 65]
	      Branch {
		DstBlock		"lock-up in\nthis gear"
		DstPort			1
	      }
	      Branch {
		Points			[-100, 0]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			1
	      }
	    }
	    Annotation {
	      Position		      [997, 104]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [885, 760]
	      Text		      "output changes depending\nupon whether "
"speed\ndependent shifting is used"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [710, 70, 740, 190]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [91, 74, 773, 525]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "parallel clutch\ncontrol"
	  Ports			  [4, 1]
	  Position		  [710, 280, 745, 360]
	  ForegroundColor	  "gray"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "parallel clutch\ncontrol"
	    Location		    [15, 107, 928, 729]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 18, 60, 32]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 58, 60, 72]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 168, 55, 182]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [30, 388, 60, 402]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [835, 565, 891, 605]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[315, 744, 773, 944]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged\n\nBut the clutch is always disengaged when the"
" engine is off or was off within the past 0.5 s."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [40, 535, 60, 555]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [145, 83, 180, 107]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [145, 124, 225, 146]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [145, 189, 225, 211]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [145, 255, 180, 275]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [145, 319, 225, 341]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [570, 355, 605, 375]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [790, 175, 810, 195]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [660, 110, 720, 140]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [380, 67, 410, 98]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [315, 127, 345, 158]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual Switch"
	      Ports		      [2, 1]
	      Position		      [410, 387, 440, 423]
	      ForegroundColor	      "gray"
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [570, 300, 600, 330]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [170, 415, 200, 445]
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [170, 565, 200, 595]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [590, 107, 625, 143]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 57, 330, 88]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [260, 177, 290, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [260, 242, 290, 273]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [260, 307, 290, 338]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [235, 537, 265, 568]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [790, 120, 820, 150]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [330, 400, 360, 430]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [170, 475, 200, 505]
	      DelayTime		      "0.2"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [450, 17, 480, 48]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [520, 117, 550, 148]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [380, 254, 410, 286]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [235, 386, 265, 419]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [235, 466, 265, 499]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [475, 305, 510, 340]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [80, 160, 110, 190]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[224, 217, 812, 726]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 115, 400, 145]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [855, 128, 885, 142]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -40]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [70, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 30]
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [75, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, -20; 250, 0]
		DstBlock		"Manual Switch"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Manual Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual Switch"
	      SrcPort		      1
	      Points		      [315, 0; 0, -270]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	      Branch {
		Points			[0, 180]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [50, 15, 80, 65]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [820, 313, 850, 327]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>3"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  Points		  [40, 0]
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "gearbox control\nfor use w/ AT"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  4
	  Points		  [20, 0]
	  DstBlock		  "Goto <htc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 10; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [200, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>9"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  Points		  [45, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [135, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -55]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  3
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  Points		  [0, 10]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>7"
	  SrcPort		  1
	  Points		  [25, 0]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [35, 0]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "parallel clutch\ncontrol"
	  SrcPort		  1
	  Points		  [20, 0]
	  Branch {
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <mc>2"
	  SrcPort		  1
	  Points		  [0, 10]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>6"
	  SrcPort		  1
	  Points		  [0, -15]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From par cntrl"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "Goto <htc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  2
	  Points		  [15, 0]
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [15, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [20, 0; 0, -30]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> par auto s/a"
      Ports		      []
      Position		      [180, 144, 245, 196]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> par auto s/a"
	Location		[6, 74, 993, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"92"
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [605, 185, 635, 215]
	  Value			  "3"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux"
	  Ports			  [1, 2]
	  Position		  [690, 261, 695, 299]
	  BackgroundColor	  "black"
	  ShowName		  off
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [585, 25, 680, 45]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [570, 307, 665, 323]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [185, 101, 275, 119]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [185, 16, 280, 34]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [185, 125, 280, 145]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>6"
	  Position		  [570, 269, 670, 291]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "tc_trq_spd_in_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [585, 60, 680, 80]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [590, 89, 680, 111]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>2"
	  Position		  [590, 124, 680, 146]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 347, 105, 363]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [25, 380, 85, 400]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [20, 311, 105, 329]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [205, 492, 315, 508]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [210, 526, 310, 544]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [575, 341, 660, 359]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [180, 581, 300, 599]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [570, 376, 655, 394]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [225, 455, 285, 475]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [75, 236, 160, 254]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>9"
	  Position		  [295, 345, 355, 365]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [190, 66, 280, 84]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [205, 551, 320, 569]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [790, 265, 855, 285]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [790, 300, 870, 320]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [800, 336, 850, 354]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [405, 65, 495, 85]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [415, 96, 495, 114]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>"
	  Position		  [415, 132, 490, 148]
	  GotoTag		  "locked_up"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <htc>1"
	  Position		  [415, 19, 490, 41]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [770, 75, 860, 95]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [765, 191, 835, 209]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [435, 341, 520, 359]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [430, 270, 515, 290]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [180, 329, 270, 351]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [230, 361, 320, 379]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [405, 496, 490, 514]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [405, 559, 490, 581]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [230, 235, 340, 255]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [190, 396, 280, 414]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [185, 426, 275, 444]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [400, 205, 510, 225]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [275, 610, 295, 630]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [380, 332, 410, 363]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [380, 262, 410, 293]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [185, 232, 215, 283]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [125, 304, 160, 406]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine on\n(parallel hybrid)"
	  Ports			  [5, 3]
	  Position		  [715, 254, 750, 366]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine on\n(parallel hybrid)"
	    Location		    [57, 74, 991, 722]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq req'd\nout of clutch\n(N*m)"
	      Position		      [35, 13, 65, 27]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "spd req'd\nout of clutch\n(N*m)1"
	      Position		      [30, 78, 60, 92]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [415, 553, 445, 567]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [160, 523, 190, 537]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch\nstate"
	      Position		      [100, 468, 130, 482]
	      Port		      "5"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [165, 271, 225, 289]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)1"
	      Position		      [115, 376, 190, 394]
	      Value		      "cs_off_trq_frac"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)2"
	      Position		      [745, 105, 785, 125]
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)3"
	      Position		      [520, 322, 570, 338]
	      Value		      "fc_tstat"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES1"
	      Ports		      []
	      Position		      [830, 60, 886, 100]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES1"
		Location		[296, 542, 726, 743]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [212, 12]
		  VerticalAlignment	  "top"
		  Text			  "This engine state computer keeps th"
"e engine on if:\n[\n1) key is on, AND\n2) (trq is too high AND speed is too h"
"igh for idle) OR engine is allowed to idle, AND\n3) vehicle speed >= cs_elect"
"ric_launch_spd [ in m/s ], AND\n4) req'd trq > (cs_off_trq_frac * max_trq_at_"
"spd) OR SOC<cs_lo_soc\n]\nOR\n[ engine was previously on AND the transmission"
" is shifting ]\n\nThe last condition is added to prevent the engine from unre"
"alistically\nshutting down for a second or two during a shift."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [110, 27, 145, 43]
	      ShowName		      off
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [325, 82, 395, 98]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant10"
	      Position		      [170, 232, 300, 248]
	      ShowName		      off
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [95, 61, 210, 79]
	      ShowName		      off
	      Value		      "cs_electric_decel_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [105, 117, 175, 133]
	      ShowName		      off
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [400, 509, 480, 531]
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [155, 480, 175, 500]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [215, 535, 235, 555]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [155, 585, 175, 605]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [740, 550, 760, 570]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [240, 389, 270, 411]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [625, 370, 645, 390]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [105, 254, 150, 276]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>1"
	      Position		      [105, 148, 190, 172]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>2"
	      Position		      [585, 243, 655, 257]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>3"
	      Position		      [335, 475, 420, 495]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_pwr"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>4"
	      Position		      [515, 286, 585, 304]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [585, 318, 615, 342]
	      Gain		      "vc_fc_warm_tmp_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [380, 390, 410, 420]
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [3, 1]
	      Position		      [340, 511, 370, 569]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator11"
	      Ports		      [1, 1]
	      Position		      [350, 235, 380, 255]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator12"
	      Ports		      [3, 1]
	      Position		      [810, 154, 840, 186]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator13"
	      Ports		      [2, 1]
	      Position		      [685, 298, 715, 327]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [425, 31, 445, 64]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [330, 21, 360, 54]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [2, 1]
	      Position		      [285, 16, 305, 49]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [3, 1]
	      Position		      [585, 125, 615, 235]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [3, 1]
	      Position		      [385, 322, 405, 358]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [680, 243, 710, 272]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [5, 1]
	      Position		      [755, 160, 785, 220]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "5"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [2, 1]
	      Position		      [520, 160, 545, 195]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [205, 175, 235, 205]
	      InputValues	      "[cs_lo_soc cs_hi_soc cs_hi_soc+eps]"
	      OutputValues	      "[cs_electric_launch_spd_lo cs_electric_"
"launch_spd_hi cs_electric_launch_spd_hi]"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual \nSwitch"
	      Ports		      [2, 1]
	      Position		      [685, 397, 715, 433]
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [685, 340, 715, 370]
	      Orientation	      "left"
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [235, 347, 265, 378]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [345, 432, 375, 463]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [500, 397, 530, 428]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [275, 153, 300, 182]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [290, 324, 315, 351]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [255, 257, 285, 288]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [290, 379, 315, 406]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [530, 444, 555, 471]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [635, 289, 660, 316]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [625, 409, 650, 436]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [595, 525, 625, 555]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [435, 432, 480, 468]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time Steps (#)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskVariables	      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "3"
	      System {
		Name			"Subsystem"
		Location		[137, 366, 771, 685]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [50, 110, 70, 130]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [75, 210, 95, 230]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [75, 274, 115, 296]
		  FontName		  "Arial"
		  Value			  "n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [380, 224, 420, 246]
		  FontName		  "Arial"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>2"
		  Position		  [120, 88, 190, 102]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "shifting"
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [295, 100, 315, 120]
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [135, 235, 165, 265]
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [170, 30, 200, 60]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [505, 109, 525, 136]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [210, 271, 230, 289]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [250, 187, 280, 218]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [440, 105, 460, 125]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [170, 210, 190, 230]
		  ShowName		  off
		  IconShape		  "round"
		  Inputs		  "|+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [305, 190, 335, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [450, 190, 480, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch2"
		  Position		  [235, 95, 265, 125]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch3"
		  Position		  [115, 30, 145, 60]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  VariableTransportDelay
		  Name			  "Variable\nTransport Delay"
		  Position		  [375, 137, 405, 168]
		  MaximumDelay		  "n"
		  InitialInput		  "0"
		  MaximumPoints		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [550, 115, 570, 135]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "From <vc>2"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -15; -120, 0; 0, -35]
		    DstBlock		    "Switch3"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 15]
		    DstBlock		    "Switch2"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -30; -120, 0]
		    DstBlock		    "Switch3"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Switch3"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Switch3"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch2"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  Points		  [0, -75]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [80, 0]
		    Branch {
		    Points		    [0, -10]
		    DstBlock		    "Switch1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Switch1"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [0, -45]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [55, 0]
		    DstBlock		    "Switch"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, -25]
		    Branch {
		    Points		    [0, -15; 175, 0]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Variable\nTransport Delay"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [515, 513, 545, 567]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [810, 534, 835, 566]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [400, 239, 430, 281]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [445, 294, 475, 336]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "T>~0"
	      Position		      [170, 12, 200, 43]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace"
	      Position		      [325, 181, 480, 199]
	      VariableName	      "cs_electric_launch_spd_probe"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [210, 467, 240, 498]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [575, 29, 630, 61]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on"
		Location		[5, 42, 410, 213]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup"
	      Position		      [115, 343, 145, 367]
	      NamePlacement	      "alternate"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup1"
	      Position		      [445, 393, 475, 417]
	      NamePlacement	      "alternate"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale*mc_overtrq_fact"
"or"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [210, 572, 240, 603]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [275, 522, 305, 553]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [70, 542, 105, 578]
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[57, 72, 432, 234]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "spd>set point"
	      Position		      [235, 47, 265, 78]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "w>idle"
	      Position		      [275, 102, 305, 133]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [875, 163, 905, 177]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [865, 543, 895, 557]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [765, 38, 795, 52]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator12"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 185]
		Branch {
		  Points		  [0, 165; -55, 0]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)2"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Product"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      Points		      [70, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "w>idle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "T>~0"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [5, 0; 0, -80]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "trq req'd\nout of clutch\n(N*m)"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"T>~0"
		DstPort			1
	      }
	      Branch {
		Points			[0, 310]
		Branch {
		  Points		  [0, 125]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "w>idle"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd req'd\nout of clutch\n(N*m)1"
	      SrcPort		      1
	      Points		      [0, 25; 30, 0]
	      Branch {
		Points			[0, 245]
		Branch {
		  DstBlock		  "max_torque\n lookup"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 85; 230, 0]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Gain1"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		DstBlock		"w>idle"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -35]
	      Branch {
		DstBlock		"Logical\nOperator7"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Logical\nOperator13"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator13"
	      SrcPort		      1
	      Points		      [10, 0; 0, -125]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)3"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      3
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 0]
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [85, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 105; 70, 0; 0, 20]
		DstBlock		"Logical\nOperator12"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [105, 0; 0, 95]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      Points		      [30, 0; 0, -100]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			2
	      }
	      Branch {
		DstBlock		"To Workspace"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant10"
	      SrcPort		      1
	      Points		      [0, 20; 25, 0]
	      Branch {
		Points			[0, 40]
		Branch {
		  DstBlock		  "Switch4"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 15]
		  DstBlock		  "Switch4"
		  DstPort		  2
		}
	      }
	      Branch {
		DstBlock		"Switch3"
		DstPort			2
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Logical\nOperator11"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"Switch3"
		DstPort			3
	      }
	      Branch {
		Points			[0, 55]
		DstBlock		"Logical\nOperator6"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator11"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		Points			[0, -75]
		DstBlock		"Look-Up Table"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [75, 0; 0, 20]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [80, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nstate"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>3"
	      SrcPort		      1
	      Points		      [90, 0]
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [175, 0; 0, -260]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [80, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      DstBlock		      "spd>set point"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd>set point"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "T>~0"
	      SrcPort		      1
	      Points		      [65, 0]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>1"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		DstBlock		"spd>set point"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"max_torque\n lookup1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"Product3"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [70, 0; 0, 15]
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual \nSwitch"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      5
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"Relational\nOperator4"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15; 100, 0]
		DstBlock		"Relational\nOperator6"
		DstPort			1
	      }
	    }
	    Annotation {
	      Position		      [785, 464]
	      Text		      "engine not suppressed if \ness insuffic"
"ient "
	    }
	    Annotation {
	      Position		      [423, 147]
	      Text		      "engine not \nsuppressed for\nelectric l"
"aunch"
	    }
	    Annotation {
	      Position		      [496, 72]
	      Text		      "engine not shut off\n rather than idle"
	    }
	    Annotation {
	      Position		      [563, 379]
	      Text		      "engine on if engine on \npreviously and"
" engine \nnot warm"
	    }
	    Annotation {
	      Position		      [666, 217]
	      Text		      "engine not shut \ndown during shifts"
	    }
	    Annotation {
	      Position		      [800, 404]
	      Text		      "engine not suppressed\nif mc insufficie"
"nt "
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [350, 476, 385, 604]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  Ports			  [4, 4]
	  Position		  [340, 34, 375, 146]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox control\nfor use w/ AT \nin paral"
"lel sa"
	    Location		    [12, 74, 983, 726]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "eta_gb"
	      Position		      [45, 85, 65, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 135, 65, 155]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 180, 65, 200]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 230, 65, 250]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [905, 865, 961, 905]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[430, 234, 888, 441]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [217, 162]
		  Text			  "Lock-up of the HTC occurs when it i"
"s supposed to for the current gear, AND\nthe transmission isn't shifting, AND"
"\nthe lockup wouldn't precipitate an immediate downshift."
		}
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [385, 65, 405, 85]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [305, 375, 325, 395]
	      Orientation	      "left"
	      Value		      "0.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [470, 863, 565, 877]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [400, 728, 495, 742]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [385, 470, 405, 490]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [740, 716, 745, 754]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [570, 835, 695, 855]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [50, 789, 155, 821]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [570, 895, 695, 915]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [510, 755, 635, 775]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [510, 780, 635, 800]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [510, 690, 635, 710]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From5"
	      Position		      [105, 260, 195, 280]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "gear_num_out"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From6"
	      Position		      [190, 420, 280, 440]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting_out"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [535, 207, 560, 233]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain2"
	      Position		      [180, 185, 195, 215]
	      FontName		      "Arial"
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain3"
	      Position		      [265, 185, 280, 215]
	      FontName		      "Arial"
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain4"
	      Position		      [215, 625, 230, 655]
	      FontName		      "Arial"
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain5"
	      Position		      [300, 625, 315, 655]
	      FontName		      "Arial"
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [275, 780, 395, 800]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [275, 804, 395, 826]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [770, 780, 890, 800]
	      GotoTag		      "shifting_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto3"
	      Position		      [840, 195, 945, 215]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [890, 65, 1000, 85]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [890, 140, 1000, 160]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto7"
	      Position		      [825, 920, 945, 940]
	      GotoTag		      "gear_num_out"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [4, 1]
	      Position		      [665, 402, 695, 448]
	      Operator		      "AND"
	      Inputs		      "4"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [315, 414, 345, 446]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [1, 1]
	      Position		      [530, 506, 560, 544]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [600, 510, 630, 540]
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [655, 752, 660, 803]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [240, 82, 270, 113]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [595, 203, 615, 227]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product4"
	      Ports		      [2, 1]
	      Position		      [260, 517, 290, 548]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 317, 330, 348]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [780, 66, 800, 84]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [200, 777, 230, 828]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [380, 105, 410, 135]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [380, 510, 410, 540]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [715, 855, 745, 885]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [685, 720, 715, 750]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [475, 32, 505, 68]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[346, 271, 835, 486]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [380, 43, 410, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [150, 60, 185, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [150, 105, 185, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [230, 38, 260, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [230, 98, 260, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [50, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 70; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [725, 57, 745, 93]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [655, 114, 685, 146]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [475, 194, 505, 246]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[441, 362, 916, 657]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand1"
	      Ports		      [3, 1]
	      Position		      [475, 499, 505, 551]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand1"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [180, 125, 210, 145]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability1"
	      Position		      [200, 530, 230, 550]
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand\nspd"
	      Ports		      [4, 3]
	      Position		      [115, 84, 145, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand\nspd"
		Location		[-51, 261, 973, 654]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear\nnumber"
		  Position		  [20, 113, 50, 127]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [20, 168, 50, 182]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [20, 223, 50, 237]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [20, 283, 50, 297]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [1095, 305, 1151, 345]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the previous gear, assuming that\nthe gearbox efficiency is c"
"onstant."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [760, 220, 780, 240]
		  Orientation		  "left"
		  Value			  "[1 1]"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant5"
		  Position		  [620, 70, 640, 90]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Demux
		  Name			  "Demux"
		  Ports			  [1, 2]
		  Position		  [980, 172, 1015, 208]
		  Outputs		  "2"
		  BusSelectionMode	  off
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [310, 50, 405, 70]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "locked_up"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "K_adv"
		  Ports			  [1, 1]
		  Position		  [340, 145, 370, 175]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "K_adv"
		    Location		    [502, 588, 994, 833]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    Position		    [45, 58, 75, 72]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "K_adv=wout/(Tout)^0.5"
		    Position		    [160, 51, 280, 79]
		    FontName		    "Arial"
		    Expr		    "u[2]/u[1]^0.5"
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation"
		    Position		    [305, 50, 335, 80]
		    UpperLimit		    "max(htc_k_adv)"
		    LowerLimit		    "min(htc_k_adv)"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation2"
		    Position		    [105, 50, 135, 80]
		    ShowName		    off
		    UpperLimit		    "inf"
		    LowerLimit		    "eps"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "K_adv"
		    Position		    [385, 58, 415, 72]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Req'd output\ntrq and spd\n(Nm), "
"(rad/s)"
		    SrcPort		    1
		    DstBlock		    "Saturation2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Saturation2"
		    SrcPort		    1
		    DstBlock		    "K_adv=wout/(Tout)^0.5"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "K_adv=wout/(Tout)^0.5"
		    SrcPort		    1
		    DstBlock		    "Saturation"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Saturation"
		    SrcPort		    1
		    DstBlock		    "K_adv"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [685, 36, 715, 69]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [1, 1]
		  Position		  [510, 43, 540, 77]
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [445, 45, 475, 75]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux1"
		  Ports			  [2, 1]
		  Position		  [805, 97, 840, 133]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux2"
		  Ports			  [2, 1]
		  Position		  [310, 142, 320, 178]
		  ShowName		  off
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [615, 12, 645, 43]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "SR Look-Up\nTable\nSR=wout/win"
		  Position		  [415, 210, 445, 240]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_sr"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [85, 160, 115, 190]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [1035, 185, 1065, 215]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [755, 170, 785, 200]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "TR Look-Up\nTable\nTR=Tout/Tin"
		  Position		  [415, 125, 445, 155]
		  InputValues		  "htc_k_adv"
		  OutputValues		  "htc_tr"
		}
		Block {
		  BlockType		  Mux
		  Name			  "TR,SR"
		  Ports			  [2, 1]
		  Position		  [695, 157, 730, 193]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [85, 108, 115, 132]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~eng trq\nand spd"
		  Ports			  [2, 1]
		  Position		  [870, 161, 900, 194]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [2, 1]
		  Position		  [170, 265, 200, 300]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [170, 105, 200, 195]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [1105, 103, 1135, 117]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [1100, 193, 1130, 207]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "gb_spd_in_est\n(rad/s)1"
		  Position		  [1100, 238, 1130, 252]
		  ForegroundColor	  "blue"
		  Port			  "3"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [90, 0]
		  Branch {
		    DstBlock		    "Mux2"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [495, 0]
		    Branch {
		    Points		    [295, 0]
		    DstBlock		    "gb_spd_in_est\n(rad/s)1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Mux1"
		    DstPort		    2
		    }
		  }
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  Points		  [85, 0]
		  Branch {
		    Points		    [0, -45; 290, 0]
		    Branch {
		    Points		    [0, -85]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Mux1"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Mux2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "SR Look-Up\nTable\nSR=wout/win"
		  SrcPort		  1
		  Points		  [230, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "TR Look-Up\nTable\nTR=Tout/Tin"
		  SrcPort		  1
		  Points		  [230, 0]
		  DstBlock		  "TR,SR"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "K_adv"
		  SrcPort		  1
		  Points		  [15, 0; 0, -5]
		  Branch {
		    Points		    [0, 70]
		    DstBlock		    "SR Look-Up\nTable\nSR=wout/win"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "TR Look-Up\nTable\nTR=Tout/Tin"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Mux2"
		  SrcPort		  1
		  DstBlock		  "K_adv"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~eng trq\nand spd"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Demux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux1"
		  SrcPort		  1
		  Points		  [5, 0; 0, 55]
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  1
		  Points		  [40, 0; 0, -70]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant5"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  2
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "~eng trq\nand spd"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "TR,SR"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 155]
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "est. engine trq\nand spd assuming\nlock"
"up"
	      Ports		      [4, 2]
	      Position		      [115, 489, 145, 521]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"est. engine trq\nand spd assuming\nlo"
"ckup"
		Location		[77, 439, 778, 723]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "new gear\nnumber"
		  Position		  [30, 28, 60, 42]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  " prev eta_gb"
		  Position		  [30, 83, 60, 97]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [30, 138, 60, 152]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_est"
		  Position		  [30, 218, 60, 232]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [625, 180, 681, 220]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [231, 257, 689, 321]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [227, 12]
		    VerticalAlignment	    "top"
		    Text		    "Estimate engine torque and speed "
"associated with the current gear, assuming that\nthe gearbox efficiency is co"
"nstant."
		    }
		  }
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [130, 180, 160, 210]
		  X0			  "gb_ratio(1)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [95, 75, 125, 105]
		  UpperLimit		  "1"
		  LowerLimit		  "0.7"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [580, 65, 610, 95]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [95, 23, 125, 47]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_spd_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 150, 210, 240]
		  Inputs		  "*/*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "~gb_trq_in_r"
		  Ports			  [3, 1]
		  Position		  [180, 20, 210, 110]
		  Inputs		  "//*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng trq\n(Nm)"
		  Position		  [645, 18, 675, 32]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Block {
		  BlockType		  Outport
		  Name			  "est eng spd\n(rad/s)"
		  Position		  [645, 73, 675, 87]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "~gb_spd_in_r"
		  SrcPort		  1
		  Points		  [90, 0; 0, -110; 250, 0; 0, -5]
		  DstBlock		  "Saturation2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "~gb_trq_in_r"
		  SrcPort		  1
		  Points		  [340, 0; 0, -5; 20, 0; 0, -35]
		  DstBlock		  "est eng trq\n(Nm)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_est"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "~gb_spd_in_r"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  DstBlock		  "est eng spd\n(rad/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "new gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 130]
		    Branch {
		    Points		    [-35, 0]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "~gb_spd_in_r"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "~gb_trq_in_r"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  " prev eta_gb"
		  SrcPort		  1
		  DstBlock		  "Saturation1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "~gb_trq_in_r"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [840, 63, 870, 87]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [310, 116, 345, 144]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)1"
	      Position		      [310, 521, 345, 549]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "lock-up in\nthis gear"
	      Position		      [245, 313, 275, 337]
	      FontName		      "Arial"
	      InputValues	      "[1:length(htc_lockup)]"
	      OutputValues	      "htc_lockup"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "motor\ntorque\ncapability"
	      Position		      [215, 190, 245, 210]
	      FontName		      "Arial"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale*mc_overtrq_fact"
"or+eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "motor\ntorque\ncapability1"
	      Position		      [250, 630, 280, 650]
	      FontName		      "Arial"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale*mc_overtrq_fact"
"or+eps"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [745, 15, 785, 35]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [835, 134, 865, 166]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[76, 244, 366, 435]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [47, 595, 337, 734]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [48, 850, 371, 995]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [389, 635, 793, 850]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "torque\nsummation"
	      Ports		      [2, 1]
	      Position		      [240, 132, 260, 168]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "torque\nsummation1"
	      Ports		      [2, 1]
	      Position		      [265, 567, 285, 603]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [475, 94, 505, 146]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[433, 169, 908, 464]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [1031, 545, 1271, 627]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [810, 860, 830, 880]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [810, 700, 830, 720]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [810, 745, 830, 765]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "locked up"
	      Position		      [730, 415, 750, 435]
	      FontName		      "Arial"
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [10, 0; 0, -85]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "downshift \ncommand1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "locked up"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [120, 0]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[0, 10]
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 100]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Memory"
		DstPort			1
	      }
	      Branch {
		Points			[0, -95]
		DstBlock		"Logical\nOperator"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      2
	      Points		      [35, 0; 0, 25]
	      Branch {
		DstBlock		"engine\ntorque\ncapability1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  Points		  [0, 50; 265, 0; 0, -125]
		  DstBlock		  "downshift \ncommand1"
		  DstPort		  3
		}
		Branch {
		  Points		  [15, 0]
		  DstBlock		  "Gain4"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      3
	      Points		      [0, 115; -55, 0; 0, 295]
	      DstBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [290, 0]
	      Branch {
		Points			[0, -120]
		DstBlock		"Switch"
		DstPort			2
	      }
	      Branch {
		Points			[0, 285]
		DstBlock		"Switch1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 365]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			3
	      }
	      Branch {
		Points			[0, -40]
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "eta_gb"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 405]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			2
	      }
	      Branch {
		DstBlock		"est. engine trq\nand\nspd"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand spd assuming\nlock"
"up"
	      SrcPort		      1
	      Points		      [95, 0]
	      DstBlock		      "Product4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product4"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [55, 0; 0, 160]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      Points		      [10, 0; 0, 30]
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -50]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 55]
		  DstBlock		  "Goto3"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-165, 0]
	      Branch {
		Points			[-125, 0]
		Branch {
		  Points		  [-355, 0; 0, 60]
		  DstBlock		  "est. engine trq\nand\nspd"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 25]
		  Branch {
		    DstBlock		    "allow downshift?"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 55]
		    Branch {
		    Points		    [0, 100]
		    Branch {
		    Points		    [0, 305]
		    DstBlock		    "downshift \ncommand1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		    }
		  }
		}
	      }
	      Branch {
		Points			[0, 40]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "est. engine trq\nand\nspd"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "est. engine trq\nand\nspd"
	      SrcPort		      2
	      Points		      [15, 0; 0, 35]
	      Branch {
		DstBlock		"engine\ntorque\ncapability"
		DstPort			1
	      }
	      Branch {
		Points			[0, 65]
		Branch {
		  Points		  [0, 35; 260, 0; 0, -35]
		  Branch {
		    Points		    [0, -65]
		    DstBlock		    "upshift\n command"
		    DstPort		    3
		  }
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    3
		  }
		}
		Branch {
		  DstBlock		  "Gain2"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, 5]
	      DstBlock		      "torque\nsummation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "torque\nsummation"
	      SrcPort		      1
	      Points		      [0, -25; -40, 0]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability1"
	      SrcPort		      1
	      Points		      [5, 0; 0, 35]
	      DstBlock		      "torque\nsummation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "torque\nsummation1"
	      SrcPort		      1
	      Points		      [0, -20; -45, 0]
	      DstBlock		      "Product4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Gain2"
	      SrcPort		      1
	      DstBlock		      "motor\ntorque\ncapability"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "motor\ntorque\ncapability"
	      SrcPort		      1
	      DstBlock		      "Gain3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain3"
	      SrcPort		      1
	      Points		      [0, -20; -60, 0]
	      DstBlock		      "torque\nsummation"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Gain4"
	      SrcPort		      1
	      DstBlock		      "motor\ntorque\ncapability1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "motor\ntorque\ncapability1"
	      SrcPort		      1
	      DstBlock		      "Gain5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain5"
	      SrcPort		      1
	      Points		      [0, -25; -75, 0; 0, -20]
	      DstBlock		      "torque\nsummation1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [5, 0; 0, 0]
	      Branch {
		Points			[40, 0]
		DstBlock		"shifting, out"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Goto2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"gear number, out"
		DstPort			1
	      }
	      Branch {
		Points			[0, 60]
		DstBlock		"Goto7"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, 75]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "lock-up in\nthis gear"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From6"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From5"
	      SrcPort		      1
	      Points		      [0, 55]
	      Branch {
		DstBlock		"lock-up in\nthis gear"
		DstPort			1
	      }
	      Branch {
		Points			[-100, 0]
		DstBlock		"est. engine trq\nand spd assuming\nlo"
"ckup"
		DstPort			1
	      }
	    }
	    Annotation {
	      Position		      [559, 677]
	      Text		      "gear ratio and shifting pre-muxed"
	    }
	    Annotation {
	      Position		      [920, 840]
	      Text		      "output changes depending\nupon whether "
"speed\ndependent shifting is used"
	    }
	    Annotation {
	      Position		      [884, 269]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [947, 104]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [947, 12]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [715, 25, 745, 145]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [91, 74, 773, 525]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [30, 15, 60, 65]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [195, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  1
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>2"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  3
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine on\n(parallel hybrid)"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  2
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [0, -20]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>6"
	  SrcPort		  1
	  DstBlock		  "Demux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [0, -20; 25, 0; 0, -15]
	  DstBlock		  "engine on\n(parallel hybrid)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  Points		  [45, 0]
	  DstBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  Points		  [40, 0]
	  DstBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -55]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>9"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  Points		  [45, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "Goto <htc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor use w/ AT \nin paralle"
"l sa"
	  SrcPort		  4
	  Points		  [20, 0]
	  DstBlock		  "Goto <htc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [25, 0; 0, -30]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [217, 318]
	  Text			  "force\nrequired (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> par balanced"
      Ports		      [0, 1]
      Position		      [475, 223, 540, 277]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> par balanced"
	Location		[16, 74, 1003, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"96"
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [545, 35, 640, 55]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [540, 497, 635, 513]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>1"
	  Position		  [545, 557, 640, 573]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [170, 71, 260, 89]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [170, 96, 265, 114]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [165, 130, 260, 150]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [525, 261, 620, 279]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [540, 472, 635, 488]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>6"
	  Position		  [525, 297, 620, 313]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>7"
	  Position		  [540, 426, 635, 444]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>8"
	  Position		  [530, 332, 625, 348]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [545, 70, 640, 90]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [545, 99, 635, 121]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>2"
	  Position		  [530, 237, 605, 253]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>3"
	  Position		  [545, 137, 620, 153]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [30, 307, 105, 323]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [25, 340, 85, 360]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [20, 271, 105, 289]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [120, 487, 230, 503]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [125, 521, 225, 539]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [70, 201, 155, 219]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [105, 576, 225, 594]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [545, 536, 630, 554]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [125, 450, 185, 470]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [295, 300, 355, 320]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [170, 36, 260, 54]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [120, 546, 235, 564]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [345, 52, 420, 78]
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [760, 460, 825, 480]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [755, 495, 835, 515]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [760, 531, 810, 549]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [335, 90, 425, 110]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [345, 126, 425, 144]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [725, 85, 815, 105]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [745, 236, 815, 254]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [425, 296, 510, 314]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [425, 235, 510, 255]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [190, 289, 280, 311]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [210, 321, 300, 339]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [320, 491, 405, 509]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [320, 554, 405, 576]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [230, 195, 340, 215]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [185, 356, 275, 374]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [180, 386, 270, 404]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [405, 180, 515, 200]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [200, 620, 220, 640]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [375, 287, 405, 318]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [375, 227, 405, 258]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [185, 197, 215, 248]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [125, 264, 160, 366]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine on\n(balanced parallel hybrid)"
	  Ports			  [5, 3]
	  Position		  [675, 449, 710, 561]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine on\n(balanced parallel hybrid)"
	    Location		    [6, 74, 1010, 726]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq req'd\nout of clutch\n(N*m)"
	      Position		      [35, 13, 65, 27]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "spd req'd\nout of clutch\n(N*m)1"
	      Position		      [30, 103, 60, 117]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [475, 588, 505, 602]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [210, 558, 240, 572]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch\nstate"
	      Position		      [165, 503, 195, 517]
	      Port		      "5"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [165, 256, 225, 274]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)1"
	      Position		      [115, 391, 190, 409]
	      Value		      "cs_lo_trq_frac"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)2"
	      Position		      [835, 15, 875, 35]
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)3"
	      Position		      [635, 247, 685, 263]
	      Value		      "fc_tstat"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)4"
	      Position		      [165, 295, 295, 315]
	      ShowName		      off
	      Value		      "0.5*(cs_lo_soc+cs_hi_soc)"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)5"
	      Position		      [415, 286, 475, 304]
	      ShowName		      off
	      Value		      "cs_hi_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES1"
	      Ports		      []
	      Position		      [970, 60, 1026, 100]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES1"
		Location		[293, 235, 742, 405]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [212, 12]
		  VerticalAlignment	  "top"
		  Text			  "Engine is on if,\n1) engine was on "
"previously and engine is not warm\n2) engine was on and is shifting\n3) batte"
"ry power is insufficient\n4) (speed is less than electric launch speed OR soc"
" is less than \nlo soc unless charge depleting) AND\nsoc is less than hi soc "
"AND\ntrq frac is greater than lo trq frac OR soc is less than mean of hi and "
"\nlo soc unless charge depleting AND\n(trq is too high AND speed is too high "
"for idle) OR engine is allowed to idle\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [110, 27, 145, 43]
	      ShowName		      off
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [350, 82, 420, 98]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant10"
	      Position		      [170, 222, 300, 238]
	      ShowName		      off
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [105, 66, 220, 84]
	      ShowName		      off
	      Value		      "cs_electric_decel_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [140, 117, 210, 133]
	      ShowName		      off
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [460, 544, 540, 566]
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [220, 515, 240, 535]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [265, 570, 285, 590]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [145, 610, 165, 630]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [705, 585, 725, 605]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [205, 409, 235, 431]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [755, 375, 775, 395]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [105, 239, 150, 261]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>1"
	      Position		      [105, 143, 190, 167]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>2"
	      Position		      [725, 178, 795, 192]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>3"
	      Position		      [440, 490, 525, 510]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_pwr"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>4"
	      Position		      [630, 211, 700, 229]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [700, 243, 730, 267]
	      Gain		      "vc_fc_warm_tmp_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [510, 395, 540, 425]
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [3, 1]
	      Position		      [400, 546, 430, 604]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator11"
	      Ports		      [1, 1]
	      Position		      [345, 220, 375, 240]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator12"
	      Ports		      [3, 1]
	      Position		      [950, 164, 980, 196]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator13"
	      Ports		      [2, 1]
	      Position		      [810, 223, 840, 252]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [445, 31, 465, 64]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [380, 21, 410, 54]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [2, 1]
	      Position		      [295, 21, 315, 54]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [4, 1]
	      Position		      [590, 103, 620, 242]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "4"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [3, 1]
	      Position		      [375, 382, 395, 418]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [820, 178, 850, 207]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [5, 1]
	      Position		      [885, 169, 915, 231]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "5"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [2, 1]
	      Position		      [500, 155, 525, 190]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [205, 170, 235, 200]
	      InputValues	      "[cs_lo_soc cs_hi_soc cs_hi_soc+eps]"
	      OutputValues	      "[cs_electric_launch_spd_lo cs_electric_"
"launch_spd_hi cs_electric_launch_spd_hi]"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual \nSwitch"
	      Ports		      [2, 1]
	      Position		      [815, 402, 845, 438]
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [815, 265, 845, 295]
	      Orientation	      "left"
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [215, 357, 245, 388]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [445, 442, 475, 473]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [630, 402, 660, 433]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [275, 148, 300, 177]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [265, 324, 290, 351]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [255, 242, 285, 273]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [260, 394, 285, 421]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [630, 454, 655, 481]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [750, 214, 775, 241]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [315, 282, 345, 313]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator7"
	      Position		      [525, 272, 555, 303]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator8"
	      Position		      [755, 414, 780, 441]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [655, 560, 685, 590]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [540, 442, 585, 478]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time Steps (#)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskVariables	      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "3"
	      System {
		Name			"Subsystem"
		Location		[137, 366, 771, 685]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [50, 110, 70, 130]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [75, 210, 95, 230]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [75, 274, 115, 296]
		  FontName		  "Arial"
		  Value			  "n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [380, 224, 420, 246]
		  FontName		  "Arial"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>2"
		  Position		  [120, 88, 190, 102]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "shifting"
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [295, 100, 315, 120]
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [135, 235, 165, 265]
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [170, 30, 200, 60]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [505, 109, 525, 136]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [210, 271, 230, 289]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [250, 187, 280, 218]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [440, 105, 460, 125]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [170, 210, 190, 230]
		  ShowName		  off
		  IconShape		  "round"
		  Inputs		  "|+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [305, 190, 335, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [450, 190, 480, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch2"
		  Position		  [235, 95, 265, 125]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch3"
		  Position		  [115, 30, 145, 60]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  VariableTransportDelay
		  Name			  "Variable\nTransport Delay"
		  Position		  [375, 137, 405, 168]
		  MaximumDelay		  "n"
		  InitialInput		  "0"
		  MaximumPoints		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [550, 115, 570, 135]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Variable\nTransport Delay"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25]
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -15; 175, 0]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [55, 0]
		    DstBlock		    "Switch"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -45]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [80, 0]
		    Branch {
		    DstBlock		    "Switch1"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -10]
		    DstBlock		    "Switch1"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  Points		  [0, -75]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Switch2"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch3"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Switch3"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -30; -120, 0]
		    DstBlock		    "Switch3"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <vc>2"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, 15]
		    DstBlock		    "Switch2"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -15; -120, 0; 0, -35]
		    DstBlock		    "Switch3"
		    DstPort		    2
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [575, 548, 605, 602]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [775, 569, 800, 601]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [400, 224, 430, 266]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [425, 339, 455, 381]
	      Threshold		      "eps"
	      Port {
		PortNumber		1
		Name			"engine not suppressed\n for low torqu"
"e"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "T>~0"
	      Position		      [170, 12, 200, 43]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace"
	      Position		      [325, 176, 480, 194]
	      VariableName	      "cs_electric_launch_spd_probe"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [280, 502, 310, 533]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [745, 44, 800, 76]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on"
		Location		[5, 42, 410, 213]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup1"
	      Position		      [575, 398, 605, 422]
	      NamePlacement	      "alternate"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale*mc_overtrq_fact"
"or"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [165, 353, 195, 377]
	      NamePlacement	      "alternate"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [205, 597, 235, 628]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [340, 557, 370, 588]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [75, 542, 110, 578]
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[57, 72, 432, 234]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "spd>set point"
	      Position		      [245, 52, 275, 83]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "w>idle"
	      Position		      [295, 102, 325, 133]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [1010, 173, 1040, 187]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [830, 578, 860, 592]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [890, 53, 920, 67]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "(--)4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [0, 60]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd req'd\nout of clutch\n(N*m)1"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"w>idle"
		DstPort			1
	      }
	      Branch {
		Points			[0, 255]
		Branch {
		  DstBlock		  "max_torque lookup"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 85; 315, 0]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -40]
		    DstBlock		    "Gain1"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "w>idle"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "trq req'd\nout of clutch\n(N*m)"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 310]
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 135]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
	      }
	      Branch {
		DstBlock		"T>~0"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "T>~0"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "w>idle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      Points		      [5, 0; 0, -25]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      Points		      [0, -5]
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Product"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			2
	      }
	      Branch {
		DstBlock		"To Workspace"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		Points			[0, -65]
		DstBlock		"Look-Up Table"
		DstPort			1
	      }
	      Branch {
		Points			[0, 40; 120, 0]
		Branch {
		  DstBlock		  "Relational\nOperator6"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -10]
		  DstBlock		  "Relational\nOperator7"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator11"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant10"
	      SrcPort		      1
	      Points		      [0, 15; 20, 0]
	      Branch {
		DstBlock		"Switch3"
		DstPort			2
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Logical\nOperator11"
		DstPort			1
	      }
	      Branch {
		Points			[0, 25; 55, 0; 0, 75]
		Branch {
		  DstBlock		  "Switch4"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 15]
		  DstBlock		  "Switch4"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [105, 0]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator7"
	      SrcPort		      1
	      Points		      [5, 0; 0, -100]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      3
	    }
	    Line {
	      Name		      "engine not suppressed\n for low torque"
	      Labels		      [0, 0]
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      Points		      [115, 0]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "(--)5"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>3"
	      SrcPort		      1
	      Points		      [85, 0]
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [145, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [70, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [75, 0]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nstate"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "spd>set point"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "T>~0"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      DstBlock		      "spd>set point"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>1"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, -95]
		DstBlock		"spd>set point"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      Points		      [245, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [0, -5]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "(--)2"
	      SrcPort		      1
	      Points		      [55, 0]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator12"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	      Branch {
		Points			[5, 0; 0, 100]
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 275; -235, 0]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      3
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 0]
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [50, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 30; 70, 0; 0, 90]
		DstBlock		"Logical\nOperator12"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [205, 0; 0, -260]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)3"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -35]
	      Branch {
		Points			[0, -45]
		DstBlock		"Logical\nOperator7"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Logical\nOperator13"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator13"
	      SrcPort		      1
	      Points		      [15, 0; 0, -40]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"max_torque\n lookup1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"Product3"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [70, 0; 0, 15]
	      DstBlock		      "Relational\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator8"
	      SrcPort		      1
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual \nSwitch"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      5
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Relational\nOperator4"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15; 140, 0]
		DstBlock		"Relational\nOperator8"
		DstPort			1
	      }
	    }
	    Annotation {
	      Position		      [521, 72]
	      Text		      "engine not shut off\n rather than idle"
	    }
	    Annotation {
	      Position		      [730, 489]
	      Text		      "engine not suppressed if \ness insuffic"
"ient \nunless disabled"
	    }
	    Annotation {
	      Position		      [393, 142]
	      Text		      "engine not \nsuppressed for\nelectric l"
"aunch"
	    }
	    Annotation {
	      Position		      [930, 409]
	      Text		      "engine not suppressed\nif mc insufficie"
"nt "
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [265, 466, 300, 594]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [670, 35, 700, 155]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [77, 42, 759, 493]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "parallel clutch\ncontrol"
	  Ports			  [4, 1]
	  Position		  [670, 240, 705, 320]
	  ForegroundColor	  "gray"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "parallel clutch\ncontrol"
	    Location		    [83, 74, 996, 696]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 18, 60, 32]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 58, 60, 72]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 168, 55, 182]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [30, 388, 60, 402]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [835, 565, 891, 605]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[315, 744, 773, 944]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged\n\nBut the clutch is always disengaged when the"
" engine is off or was off within the past 0.5 s."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [40, 535, 60, 555]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [145, 83, 180, 107]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [145, 124, 225, 146]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [145, 189, 225, 211]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [145, 255, 180, 275]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [145, 319, 225, 341]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [570, 355, 605, 375]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [790, 175, 810, 195]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [660, 110, 720, 140]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [380, 67, 410, 98]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [315, 127, 345, 158]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual Switch"
	      Ports		      [2, 1]
	      Position		      [410, 387, 440, 423]
	      ForegroundColor	      "gray"
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [570, 300, 600, 330]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [170, 415, 200, 445]
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [170, 565, 200, 595]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [590, 107, 625, 143]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 57, 330, 88]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [260, 177, 290, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [260, 242, 290, 273]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [260, 307, 290, 338]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [235, 537, 265, 568]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [790, 120, 820, 150]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [330, 400, 360, 430]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [170, 475, 200, 505]
	      DelayTime		      "0.2"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [450, 17, 480, 48]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [520, 117, 550, 148]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [380, 254, 410, 286]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [235, 386, 265, 419]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [235, 466, 265, 499]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [475, 305, 510, 340]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [80, 160, 110, 190]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[222, 219, 810, 728]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 105, 400, 135]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [0, 5]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [855, 128, 885, 142]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -40]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [70, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [30, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 30]
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [75, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, -20; 250, 0]
		DstBlock		"Manual Switch"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Manual Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual Switch"
	      SrcPort		      1
	      Points		      [315, 0; 0, -270]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	      Branch {
		Points			[0, 180]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "pre-TX parallel\ngearbox control"
	  Ports			  [4, 3]
	  Position		  [285, 48, 320, 147]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "pre-TX parallel\ngearbox control"
	    Location		    [12, 74, 999, 742]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 320, 65, 340]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 175, 65, 195]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [875, 605, 931, 645]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [330, 40, 350, 60]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [525, 200, 545, 220]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [455, 593, 550, 607]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [385, 458, 480, 472]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [525, 285, 545, 305]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [725, 446, 730, 484]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [555, 565, 680, 585]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [35, 519, 140, 551]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [555, 625, 680, 645]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [495, 485, 620, 505]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [495, 510, 620, 530]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [495, 420, 620, 440]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [470, 302, 495, 328]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto"
	      Position		      [260, 510, 380, 530]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [260, 534, 380, 556]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [805, 325, 940, 345]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [835, 185, 945, 205]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [830, 260, 940, 280]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [640, 482, 645, 533]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [225, 87, 255, 118]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [510, 367, 540, 393]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [80, 175, 110, 195]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [710, 186, 730, 204]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [185, 507, 215, 558]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 80, 355, 110]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [520, 235, 550, 265]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [520, 155, 550, 185]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [700, 585, 730, 615]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [670, 450, 700, 480]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To WS"
	      Position		      [360, 339, 400, 361]
	      BackgroundColor	      "red"
	      VariableName	      "spd"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [420, 232, 450, 268]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[328, 265, 817, 480]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow upshift?"
	      Ports		      [4, 1]
	      Position		      [420, 152, 450, 188]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow upshift?"
		Location		[132, 265, 847, 659]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 25, 55, 45]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_trq_out_r"
		  Position		  [35, 145, 55, 165]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_out_r"
		  Position		  [35, 105, 55, 125]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "prev Pout/Pin"
		  Position		  [35, 185, 55, 205]
		  Port			  "4"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES1"
		  Ports			  []
		  Position		  [645, 340, 701, 380]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES1"
		    Location		    [229, 259, 576, 405]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [172, 12]
		    VerticalAlignment	    "top"
		    Text		    "This block prevents an upshift if"
" it the engine is not on and\nthe upshift would make the motor power low enou"
"gh that it\ncould not provide the required input power.  However, an upshift"
"\nis allowed if to stay in the current gear would put the motor\nbeyond 95% o"
"f its maximum speed.\n\nThis block is to be used in pretransmission parallel "
"hybrids\n(where the engine and motor torques are combined on the\nengine side"
" of the transmission) ONLY."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [110, 75, 130, 95]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [100, 347, 375, 373]
		  Value			  "max(mc_map_spd)*mc_spd_scale/tc_mc_"
"to_fc_ratio*.95"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>"
		  Position		  [15, 232, 80, 258]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "engine_on"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [3, 1]
		  Position		  [615, 53, 645, 97]
		  Operator		  "OR"
		  Inputs		  "3"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [125, 230, 155, 260]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [310, 37, 340, 68]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [540, 42, 570, 73]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [395, 287, 425, 318]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [165, 29, 205, 61]
		  FontName		  "Arial"
		  UpperLimit		  "gb_gears_num"
		  LowerLimit		  "1"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [105, 27, 135, 58]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "est. req'd\ninput pwr\n(W)"
		  Ports			  [3, 1]
		  Position		  [310, 109, 340, 141]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio"
		  Position		  [245, 33, 275, 57]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "gear ratio1"
		  Position		  [250, 258, 280, 282]
		  FontName		  "Arial"
		  InputValues		  "[1:length(gb_ratio)]"
		  OutputValues		  "gb_ratio"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "motor\ntorque\ncapability"
		  Position		  [380, 45, 410, 65]
		  FontName		  "Arial"
		  InputValues		  "mc_map_spd*mc_spd_scale"
		  OutputValues		  "mc_max_trq*mc_trq_scale*mc_overtrq_"
"factor+eps"
		}
		Block {
		  BlockType		  Product
		  Name			  "motor (input to gb)\npwr capability"
		  Ports			  [2, 1]
		  Position		  [455, 32, 485, 63]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "req'd input spd\nif no gear change"
		  Ports			  [2, 1]
		  Position		  [310, 276, 340, 309]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [675, 65, 695, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [430, 0; 0, -170]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <vc>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev Pout/Pin"
		  SrcPort		  1
		  Points		  [225, 0; 0, -60]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "gb_trq_out_r"
		  SrcPort		  1
		  Points		  [215, 0; 0, -30]
		  DstBlock		  "est. req'd\ninput pwr\n(W)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "est. req'd\ninput pwr\n(W)"
		  SrcPort		  1
		  Points		  [175, 0; 0, -60]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "motor (input to gb)\npwr capability"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -15]
		    DstBlock		    "motor (input to gb)\npwr capabili"
"ty"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "motor\ntorque\ncapability"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "motor\ntorque\ncapability"
		  SrcPort		  1
		  DstBlock		  "motor (input to gb)\npwr capability"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear ratio"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  DstBlock		  "gear ratio"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Saturation"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "gear ratio1"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "req'd input spd\nif no gear change"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 235]
		    DstBlock		    "gear ratio1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "gb_spd_out_r"
		  SrcPort		  1
		  Points		  [150, 0]
		  Branch {
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "est. req'd\ninput pwr\n(W)"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [0, 185]
		    DstBlock		    "req'd input spd\nif no gear chang"
"e"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [170, 0]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "req'd input spd\nif no gear change"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [655, 177, 675, 213]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [585, 189, 615, 221]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [420, 289, 450, 341]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "engine\ntorque\ncapability"
	      Position		      [185, 205, 215, 225]
	      Orientation	      "up"
	      FontName		      "Arial"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 323, 170, 347]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 368, 430, 392]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [775, 183, 805, 207]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [275, 320, 305, 350]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[222, 219, 810, 728]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 110, 400, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [275, 96, 295, 114]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [670, 35, 710, 55]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_num_init"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [205, 370, 240, 390]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(gb_num_init)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [775, 254, 805, 286]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[164, 210, 454, 401]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [420, 64, 450, 116]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[324, 355, 799, 650]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 77, 170, 113]
	      FontName		      "Arial"
	      Inputs		      "*//"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [795, 590, 815, 610]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [795, 430, 815, 450]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [795, 475, 815, 495]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "engine\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, -90]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0; 0, 25]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Labels			[1, 0]
		Points			[0, 0]
		Branch {
		  Points		  [0, -150]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 65]
		  Branch {
		    Points		    [0, 45]
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto4"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-30, 0]
	      Branch {
		Points			[-240, 0; 0, 205]
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -170]
		  Branch {
		    Points		    [0, 75]
		    Branch {
		    DstBlock		    "allow upshift?"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 145]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 140]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"allow upshift?"
		DstPort			4
	      }
	      Branch {
		Points			[0, -90]
		DstBlock		"~gb_trq_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [0, -75]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, -155]
		DstBlock		"allow upshift?"
		DstPort			3
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, 80]
		DstBlock		"allow upshift?"
		DstPort			2
	      }
	      Branch {
		DstBlock		"~gb_trq_in_r"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-75, 0; 0, -40]
	      Branch {
		Points			[0, -235]
		DstBlock		"~gb_trq_in_r"
		DstPort			3
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [230, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[20, 0]
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 220]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "allow upshift?"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[10, 0]
		Branch {
		  Points		  [0, -80; -145, 0]
		  DstBlock		  "engine\ntorque\ncapability"
		  DstPort		  1
		}
		Branch {
		  Points		  [30, 0]
		  Branch {
		    Points		    [0, -230]
		    DstBlock		    "upshift\n command"
		    DstPort		    3
		  }
		  Branch {
		    Points		    [30, 0]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    3
		  }
		}
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"To WS"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [45, 0]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [889, 374]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [888, 301]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [887, 164]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [887, 127]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [40, 20, 70, 70]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [780, 273, 810, 287]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>3"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "engine on\n(balanced parallel hybrid)"
	  SrcPort		  3
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine on\n(balanced parallel hybrid)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine on\n(balanced parallel hybrid)"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>1"
	  SrcPort		  1
	  Points		  [0, -20]
	  DstBlock		  "engine on\n(balanced parallel hybrid)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [0, -20]
	  DstBlock		  "engine on\n(balanced parallel hybrid)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "engine on\n(balanced parallel hybrid)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>7"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "engine on\n(balanced parallel hybrid)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "engine on\n(balanced parallel hybrid)"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "parallel clutch\ncontrol"
	  SrcPort		  1
	  Points		  [20, 0]
	  Branch {
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <mc>2"
	  SrcPort		  1
	  Points		  [45, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>6"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>8"
	  SrcPort		  1
	  Points		  [25, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "pre-TX parallel\ngearbox control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -45]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [190, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  Points		  [60, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  1
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pre-TX parallel\ngearbox control"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [15, 0; 0, -50]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [213, 279]
	  Text			  "force\nrequired (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> par cvt"
      Ports		      [0, 1]
      Position		      [105, 239, 170, 291]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> par cvt"
	Location		[-33, 99, 779, 769]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"93"
	Block {
	  BlockType		  Constant
	  Name			  "Constant2"
	  Position		  [640, 40, 665, 60]
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [570, 95, 665, 115]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>"
	  Position		  [565, 502, 660, 518]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_spd_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>1"
	  Position		  [570, 572, 665, 588]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "clutch_state"
	}
	Block {
	  BlockType		  From
	  Name			  "From <fc>2"
	  Position		  [570, 372, 665, 388]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [210, 66, 300, 84]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [205, 101, 300, 119]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [205, 135, 300, 155]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>4"
	  Position		  [570, 306, 665, 324]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>5"
	  Position		  [565, 482, 660, 498]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>6"
	  Position		  [570, 271, 665, 289]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>7"
	  Position		  [580, 196, 675, 214]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>8"
	  Position		  [565, 446, 660, 464]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>9"
	  Position		  [570, 352, 665, 368]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_cl_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [570, 130, 665, 150]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [575, 159, 665, 181]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [40, 327, 115, 343]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [40, 360, 100, 380]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [40, 291, 125, 309]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [180, 472, 290, 488]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [185, 506, 285, 524]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [570, 546, 655, 564]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [165, 561, 285, 579]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [180, 435, 240, 455]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [300, 305, 360, 325]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [50, 216, 135, 234]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [210, 31, 300, 49]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [180, 531, 295, 549]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>"
	  Position		  [785, 465, 850, 485]
	  NamePlacement		  "alternate"
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>1"
	  Position		  [780, 500, 860, 520]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [795, 536, 845, 554]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [405, 85, 495, 105]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [700, 41, 780, 59]
	  NamePlacement		  "alternate"
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [755, 145, 845, 165]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [775, 291, 845, 309]
	  NamePlacement		  "alternate"
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [445, 301, 530, 319]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [440, 250, 525, 270]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [195, 309, 285, 331]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [265, 336, 355, 354]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [380, 476, 465, 494]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [380, 539, 465, 561]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [240, 215, 350, 235]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [205, 376, 295, 394]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [200, 406, 290, 424]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [405, 185, 515, 205]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [275, 600, 295, 620]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [390, 292, 420, 323]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [390, 242, 420, 273]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [195, 212, 225, 263]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [140, 279, 175, 381]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "cvt control"
	  Ports			  [4, 1]
	  Position		  [325, 26, 360, 159]
	  BackgroundColor	  "red"
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "cvt control"
	    Location		    [2, 74, 927, 502]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "81"
	    Block {
	      BlockType		      Inport
	      Name		      "cvt_trq_out_r"
	      Position		      [35, 85, 55, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "cvt_spd_out_r"
	      Position		      [25, 180, 45, 200]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [90, 105, 110, 125]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [50, 270, 70, 290]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [815, 205, 871, 245]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[336, 545, 670, 719]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [147, 12]
		  VerticalAlignment	  "top"
		  Text			  "This CVT control block determines t"
"he \noperating mode of the vehicle\nand the best gear ratio for that operatin"
"g mode.  \nFor more info on the operating mode selection see \nblock notes in"
" mode selector.\n\nThe gear ratio is based on the pwr required and an \nIdeal"
" Operating Line for each mode.  This IOL typically\nputs the component in its"
" most efficient operating point\n for the given power request.\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [105, 215, 135, 235]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [140, 155, 170, 175]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [420, 255, 450, 275]
	      Value		      "3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>3"
	      Position		      [245, 65, 330, 85]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <vc>,<cs>"
	      Position		      [570, 41, 650, 59]
	      GotoTag		      "mode"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Mode Selector"
	      Ports		      [3, 1]
	      Position		      [380, 77, 445, 133]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"Mode Selector"
		Location		[111, 173, 808, 503]
		Open			off
		ModelBrowserVisibility	on
		ModelBrowserWidth	200
		ScreenColor		"automatic"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "SOC"
		  Position		  [35, 23, 65, 37]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "trq req"
		  Position		  [55, 78, 85, 92]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "pwr req"
		  Position		  [60, 178, 90, 192]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Fcn
		  Name			  "1=> motor regen\n2=> motor only\n3="
"> engine only\n4=> engine and motor"
		  Position		  [365, 115, 425, 145]
		  Expr			  "u[2]*1+u[1]*u[4]*!u[2]*2+((!u[1]*!u"
"[2]+!u[3]*!u[4])>0)*3+u[1]*u[3]*4"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [570, 35, 626, 75]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [271, 245, 588, 489]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [147, 12]
		    VerticalAlignment	    "top"
		    Text		    "This block determines the operati"
"ng mode of the parallel\nhybrid vehicle equipped with a CVT:\nMode 1: motor o"
"nly regen \nif trq request is negative\nMode 2: motor only driving \nif soc i"
"s greater than lo soc \nand \npwr req is less than min engine pwr frac\nMode3"
": engine primary with motor assist \nif pwr request between min and max pwr f"
"ractions \nor \nif soc less than low soc\nMode4: engine and motor combined sy"
"stem\nif pwr req greater than max engine pwr frac"
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [105, 90, 135, 110]
		  Value			  "-1e-3"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>3"
		  Position		  [340, 209, 440, 231]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "engine_on_cmd"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator8"
		  Ports			  [2, 1]
		  Position		  [510, 211, 540, 244]
		  ShowName		  off
		  Operator		  "OR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [510, 255, 535, 285]
		  Orientation		  "left"
		  X0			  "cyc_mph(1,2)>0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [455, 204, 480, 236]
		  X0			  "cyc_mph(1,2)>0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [4, 1]
		  Position		  [340, 75, 345, 180]
		  ShowName		  off
		  Inputs		  "4"
		  DisplayOption		  "bar"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [115, 161, 145, 194]
		  Inputs		  "/*"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator5"
		  Position		  [160, 77, 190, 108]
		  ShowName		  off
		  Operator		  "<"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator6"
		  Position		  [280, 177, 310, 208]
		  ShowName		  off
		  Operator		  "<"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator7"
		  Position		  [290, 122, 320, 153]
		  ShowName		  off
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator9"
		  Position		  [210, 22, 240, 53]
		  ShowName		  off
		  Operator		  ">"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [470, 90, 495, 110]
		  FontName		  "Arial"
		  UpperLimit		  "4"
		  LowerLimit		  "1"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation2"
		  Position		  [470, 145, 495, 165]
		  FontName		  "Arial"
		  UpperLimit		  "2"
		  LowerLimit		  "1"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch4"
		  Position		  [580, 109, 610, 151]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Constant
		  Name			  "cs_fc_max_pwr"
		  Position		  [165, 140, 265, 160]
		  Value			  "cs_fc_max_pwr_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "cs_fc_min_pwr"
		  Position		  [160, 195, 260, 215]
		  Value			  "cs_fc_min_pwr_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "cs_lo_soc"
		  Position		  [90, 36, 165, 54]
		  Value			  "cs_lo_soc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "fc_max_pwr"
		  Position		  [55, 244, 330, 266]
		  Orientation		  "left"
		  Value			  "max(fc_map_spd*fc_spd_scale.*fc_max"
"_trq*fc_trq_scale)"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Outport
		  Name			  "Mode"
		  Position		  [620, 153, 650, 167]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  Points		  [65, 0]
		  DstBlock		  "Switch4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "1=> motor regen\n2=> motor only\n3="
"> engine only\n4=> engine and motor"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 25]
		    DstBlock		    "Saturation2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -30]
		    DstBlock		    "Saturation1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Switch4"
		  SrcPort		  1
		  Points		  [0, 30]
		  DstBlock		  "Mode"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation2"
		  SrcPort		  1
		  Points		  [65, 0]
		  DstBlock		  "Switch4"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -50]
		    DstBlock		    "Relational\nOperator7"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [110, 0]
		    DstBlock		    "Relational\nOperator6"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "1=> motor regen\n2=> motor only\n3="
"> engine only\n4=> engine and motor"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator6"
		  SrcPort		  1
		  Points		  [5, 0; 0, -30]
		  DstBlock		  "Mux"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "Relational\nOperator7"
		  SrcPort		  1
		  DstBlock		  "Mux"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Relational\nOperator9"
		  SrcPort		  1
		  Points		  [80, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "cs_fc_max_pwr"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Relational\nOperator7"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "cs_fc_min_pwr"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator6"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "fc_max_pwr"
		  SrcPort		  1
		  Points		  [0, -85]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "pwr req"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator8"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -100]
		    DstBlock		    "Switch4"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator8"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <vc>3"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [-10, 0]
		  DstBlock		  "Logical\nOperator8"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator5"
		  SrcPort		  1
		  Points		  [90, 0; 0, 20]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator5"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "trq req"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator5"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "SOC"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator9"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "cs_lo_soc"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator9"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [195, 86, 225, 119]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [770, 111, 800, 144]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [255, 166, 285, 199]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [530, 242, 560, 273]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [820, 120, 850, 140]
	      FontName		      "Arial"
	      UpperLimit	      "max(gb_ratio)"
	      LowerLimit	      "min(gb_ratio)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Speed Interp"
	      Ports		      [2, 1]
	      Position		      [685, 91, 735, 144]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"Speed Interp"
		Location		[503, 202, 845, 504]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"automatic"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "Mode"
		  Position		  [170, 15, 200, 30]
		  Orientation		  "down"
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "pwr req"
		  Position		  [80, 13, 110, 27]
		  Orientation		  "left"
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  MultiPortSwitch
		  Name			  "Multiport\nSwitch"
		  Ports			  [5, 1]
		  Position		  [215, 33, 230, 217]
		  Inputs		  "4"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation3"
		  Position		  [55, 50, 85, 70]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_fc_mc_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_fc_mc_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation6"
		  Position		  [55, 160, 85, 180]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_mc_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_mc_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation7"
		  Position		  [55, 105, 85, 125]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_fc_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_fc_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation8"
		  Position		  [55, 215, 85, 235]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_mc_gen_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_mc_gen_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired engine spd\nengine and moto"
"r"
		  Position		  [130, 48, 160, 72]
		  InputValues		  "ptc_fc_mc_iol_pwr_vec"
		  OutputValues		  "ptc_fc_mc_iol_spd_vec"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired engine spd\nengine only"
		  Position		  [130, 103, 160, 127]
		  InputValues		  "ptc_fc_iol_pwr_vec"
		  OutputValues		  "ptc_fc_iol_spd_vec"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired motor spd\nmotor only"
		  Position		  [130, 158, 160, 182]
		  InputValues		  "ptc_mc_iol_pwr_vec"
		  OutputValues		  "ptc_mc_iol_spd_vec"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired motor spd\nmotor only regen"
		  Position		  [130, 213, 160, 237]
		  InputValues		  "fliplr(ptc_mc_gen_iol_pwr_vec)"
		  OutputValues		  "fliplr(ptc_mc_gen_iol_spd_vec)"
		}
		Block {
		  BlockType		  Outport
		  Name			  "input spd"
		  Position		  [255, 118, 285, 132]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "desired engine spd\nengine and moto"
"r"
		  SrcPort		  1
		  Points		  [10, 0; 0, 135]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  5
		}
		Line {
		  SrcBlock		  "desired engine spd\nengine only"
		  SrcPort		  1
		  Points		  [20, 0; 0, 45]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "desired motor spd\nmotor only"
		  SrcPort		  1
		  Points		  [30, 0; 0, -45]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "desired motor spd\nmotor only regen"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "pwr req"
		  SrcPort		  1
		  Points		  [-35, 0; 0, 40]
		  Branch {
		    Points		    [0, 55]
		    Branch {
		    Points		    [0, 55]
		    Branch {
		    DstBlock		    "Saturation8"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Saturation6"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "Saturation7"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Saturation3"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Mode"
		  SrcPort		  1
		  Points		  [0, 20]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Multiport\nSwitch"
		  SrcPort		  1
		  DstBlock		  "input spd"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation3"
		  SrcPort		  1
		  DstBlock		  "desired engine spd\nengine and moto"
"r"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation7"
		  SrcPort		  1
		  DstBlock		  "desired engine spd\nengine only"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation8"
		  SrcPort		  1
		  DstBlock		  "desired motor spd\nmotor only regen"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation6"
		  SrcPort		  1
		  DstBlock		  "desired motor spd\nmotor only"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [140, 107, 170, 138]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum1"
	      Ports		      [2, 1]
	      Position		      [550, 122, 580, 153]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Terminator
	      Name		      "Terminator"
	      Position		      [105, 270, 125, 290]
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace1"
	      Position		      [685, 165, 745, 195]
	      VariableName	      "cvt_pwr_r"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace57"
	      Position		      [485, 60, 555, 80]
	      VariableName	      "cs_mode"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "chg pwr req'd\n(W)"
	      Ports		      [0, 1]
	      Position		      [485, 115, 515, 145]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"chg pwr req'd\n(W)"
		Location		[312, 140, 791, 383]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [50, 48, 195, 72]
		  Value			  "cs_charge_pwr*fc_trq_scale"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <ess>1"
		  Position		  [65, 94, 110, 116]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "SOC"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Goal"
		  Position		  [20, 134, 155, 156]
		  Value			  "(cs_lo_soc+cs_hi_soc)/2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [280, 52, 310, 83]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [230, 142, 260, 173]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Range"
		  Position		  [20, 174, 155, 196]
		  Value			  "(cs_hi_soc-cs_lo_soc)/2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [330, 55, 360, 85]
		  UpperLimit		  "inf"
		  LowerLimit		  "-inf"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [180, 97, 210, 128]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "add'l pwr req'd\n(W)"
		  Position		  [395, 63, 425, 77]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  DstBlock		  "add'l pwr req'd\n(W)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Saturation"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Range"
		  SrcPort		  1
		  Points		  [55, 0]
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Goal"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <ess>1"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "mod pwr req"
	      Ports		      [1, 1]
	      Position		      [320, 125, 350, 175]
	      BackgroundColor	      "red"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"mod pwr req"
		Location		[202, 74, 955, 744]
		Open			off
		ModelBrowserVisibility	on
		ModelBrowserWidth	200
		ScreenColor		"automatic"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "In1"
		  Position		  [210, 43, 240, 57]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [100, 70, 225, 100]
		  ShowName		  off
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "acc_mech_pwr_est"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [265, 31, 280, 104]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [305, 63, 335, 77]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "In1"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "mode 3 ?"
	      Position		      [625, 134, 655, 176]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "mode 3 or 4?"
	      Position		      [480, 179, 510, 221]
	      Threshold		      "2.5"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "output\nspeed"
	      Ports		      [2, 1]
	      Position		      [170, 202, 200, 233]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "pulley ratio\n"
	      Position		      [885, 120, 905, 140]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "From <vc>3"
	      SrcPort		      1
	      Points		      [0, 10]
	      DstBlock		      "Mode Selector"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 30]
		DstBlock		"mode 3 or 4?"
		DstPort			3
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"mod pwr req"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "cvt_spd_out_r"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"Product2"
		DstPort			2
	      }
	      Branch {
		Points			[0, 20]
		DstBlock		"output\nspeed"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 70]
		DstBlock		"Product2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Mode Selector"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-10, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Product"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "cvt_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "mode 3 ?"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"To Workspace1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Speed Interp"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [35, 0; 0, -105]
	      DstBlock		      "mode 3 ?"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum1"
	      SrcPort		      1
	      DstBlock		      "mode 3 ?"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "mode 3 or 4?"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Sum1"
		DstPort			2
	      }
	      Branch {
		Points			[50, 0; 0, -30]
		DstBlock		"mode 3 ?"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "chg pwr req'd\n(W)"
	      SrcPort		      1
	      DstBlock		      "Sum1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "mod pwr req"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Mode Selector"
		DstPort			3
	      }
	      Branch {
		Points			[0, 35]
		DstBlock		"mode 3 or 4?"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Mode Selector"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Speed Interp"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		Branch {
		  DstBlock		  "To Workspace57"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -20]
		  DstBlock		  "Goto <vc>,<cs>"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 95]
		Branch {
		  DstBlock		  "mode 3 or 4?"
		  DstPort		  2
		}
		Branch {
		  Points		  [0, 50]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "output\nspeed"
	      SrcPort		      1
	      Points		      [0, 90; 550, 0]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Speed Interp"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      DstBlock		      "pulley ratio\n"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "output\nspeed"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      DstBlock		      "Terminator"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "engine on\n(parallel CVT hybrid)"
	  Ports			  [5, 3]
	  Position		  [705, 454, 740, 566]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "engine on\n(parallel CVT hybrid)"
	    Location		    [15, 74, 1005, 712]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq req'd\nout of clutch\n(N*m)"
	      Position		      [25, 13, 55, 27]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "spd req'd\nout of clutch\n(N*m)1"
	      Position		      [20, 113, 50, 127]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "fc_spd_out_r"
	      Position		      [435, 573, 465, 587]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "v_ave_req"
	      Position		      [170, 543, 200, 557]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "clutch\nstate"
	      Position		      [115, 488, 145, 502]
	      Port		      "5"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [155, 271, 215, 289]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)1"
	      Position		      [105, 376, 180, 394]
	      Value		      "cs_off_trq_frac"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)2"
	      Position		      [790, 20, 830, 40]
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)4"
	      Position		      [510, 322, 560, 338]
	      Value		      "fc_tstat"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [100, 27, 135, 43]
	      ShowName		      off
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [340, 87, 410, 103]
	      ShowName		      off
	      Value		      "vc_idle_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant10"
	      Position		      [160, 232, 290, 248]
	      ShowName		      off
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [775, 75, 795, 95]
	      Value		      "2"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant12"
	      Position		      [80, 66, 195, 84]
	      ShowName		      off
	      Value		      "cs_electric_decel_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [110, 127, 180, 143]
	      ShowName		      off
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [420, 529, 500, 551]
	      ShowName		      off
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [170, 500, 190, 520]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [220, 555, 240, 575]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [115, 600, 135, 620]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [670, 570, 690, 590]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [230, 389, 260, 411]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [680, 390, 700, 410]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [95, 254, 140, 276]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>1"
	      Position		      [95, 148, 180, 172]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>2"
	      Position		      [575, 243, 645, 257]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>3"
	      Position		      [385, 485, 470, 505]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_pwr"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>4"
	      Position		      [690, 60, 760, 80]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "mode"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>5"
	      Position		      [505, 286, 575, 304]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [575, 318, 605, 342]
	      Gain		      "vc_fc_warm_tmp_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [400, 390, 430, 420]
	      Gain		      "tc_mc_to_fc_ratio"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <fc>1"
	      Position		      [930, 220, 1015, 240]
	      GotoTag		      "engine_on_cmd"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [3, 1]
	      Position		      [350, 531, 380, 589]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator11"
	      Ports		      [1, 1]
	      Position		      [340, 235, 370, 255]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator12"
	      Ports		      [4, 1]
	      Position		      [890, 127, 915, 203]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "4"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator14"
	      Ports		      [2, 1]
	      Position		      [675, 298, 705, 327]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator15"
	      Ports		      [2, 1]
	      Position		      [510, 160, 535, 195]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [2, 1]
	      Position		      [430, 31, 450, 64]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [370, 31, 400, 64]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [2, 1]
	      Position		      [290, 21, 310, 54]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [3, 1]
	      Position		      [575, 125, 605, 235]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [3, 1]
	      Position		      [375, 322, 395, 358]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [670, 243, 700, 272]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [5, 1]
	      Position		      [815, 178, 845, 242]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "5"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [195, 175, 225, 205]
	      InputValues	      "[cs_lo_soc cs_hi_soc cs_hi_soc+eps]"
	      OutputValues	      "[cs_electric_launch_spd_lo cs_electric_"
"launch_spd_hi cs_electric_launch_spd_hi]"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual \nSwitch"
	      Ports		      [2, 1]
	      Position		      [740, 407, 770, 443]
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [675, 340, 705, 370]
	      Orientation	      "left"
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [225, 347, 255, 378]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [395, 442, 425, 473]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [520, 397, 550, 428]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [265, 153, 290, 182]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [280, 324, 305, 351]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [245, 257, 275, 288]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [280, 379, 305, 406]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [705, 459, 730, 486]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [625, 289, 650, 316]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [825, 64, 850, 91]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator7"
	      Position		      [630, 409, 655, 436]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [615, 545, 645, 575]
	      UpperLimit	      "max(fc_map_spd)*fc_spd_scale"
	      LowerLimit	      "vc_idle_spd*vc_idle_bool"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [485, 442, 530, 478]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time Steps (#)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskVariables	      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "3"
	      System {
		Name			"Subsystem"
		Location		[137, 366, 771, 685]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [50, 110, 70, 130]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [75, 210, 95, 230]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [75, 274, 115, 296]
		  FontName		  "Arial"
		  Value			  "n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [380, 224, 420, 246]
		  FontName		  "Arial"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <vc>2"
		  Position		  [120, 88, 190, 102]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "shifting"
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [295, 100, 315, 120]
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [135, 235, 165, 265]
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [170, 30, 200, 60]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [505, 109, 525, 136]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [210, 271, 230, 289]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [250, 187, 280, 218]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [440, 105, 460, 125]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [170, 210, 190, 230]
		  ShowName		  off
		  IconShape		  "round"
		  Inputs		  "|+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [305, 190, 335, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [450, 190, 480, 220]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch2"
		  Position		  [235, 95, 265, 125]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch3"
		  Position		  [115, 30, 145, 60]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  VariableTransportDelay
		  Name			  "Variable\nTransport Delay"
		  Position		  [375, 137, 405, 168]
		  MaximumDelay		  "n"
		  InitialInput		  "0"
		  MaximumPoints		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [550, 115, 570, 135]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Variable\nTransport Delay"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25]
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -15; 175, 0]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [55, 0]
		    DstBlock		    "Switch"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -45]
		    DstBlock		    "Variable\nTransport Delay"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [80, 0]
		    Branch {
		    DstBlock		    "Switch1"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -10]
		    DstBlock		    "Switch1"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  Points		  [0, -75]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Switch2"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch3"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Switch3"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Switch2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -30; -120, 0]
		    DstBlock		    "Switch3"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From <vc>2"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, 15]
		    DstBlock		    "Switch2"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -15; -120, 0; 0, -35]
		    DstBlock		    "Switch3"
		    DstPort		    2
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [535, 533, 565, 587]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [740, 554, 765, 586]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [390, 239, 420, 281]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [435, 294, 465, 336]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "T>~0"
	      Position		      [160, 12, 190, 43]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace"
	      Position		      [315, 181, 470, 199]
	      VariableName	      "cs_electric_launch_spd_probe"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Structure"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch\ndisengaged"
	      Position		      [220, 487, 250, 518]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "key_on"
	      Ports		      [0, 1]
	      Position		      [655, 114, 710, 146]
	      NamePlacement	      "alternate"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Repeating table"
	      MaskDescription	      "Repeating table.\nEnter values of time "
"and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table. Time valu"
"es should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskInitialization      "period = max(@1); t = @1; y = @2;"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "vc_key_on(:,1)|vc_key_on(:,2)"
	      MaskVariableAliases     ","
	      Port {
		PortNumber		1
		Name			"ignition key is on"
		TestPoint		off
		LinearAnalysisOutput	off
		LinearAnalysisInput	off
		RTWStorageClass		"Auto"
	      }
	      System {
		Name			"key_on"
		Location		[5, 42, 410, 213]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 60, 150, 80]
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [210, 58, 250, 82]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [285, 60, 305, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  DstBlock		  "Fcn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup"
	      Position		      [105, 343, 135, 367]
	      NamePlacement	      "alternate"
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque\n lookup1"
	      Position		      [465, 393, 495, 417]
	      NamePlacement	      "alternate"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale*mc_overtrq_fact"
"or"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "moving next\ntime"
	      Position		      [165, 587, 195, 618]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "not\nmoving"
	      Position		      [280, 542, 310, 573]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      Ports		      [0, 1]
	      Position		      [45, 532, 80, 568]
	      FontName		      "Arial"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Forward looking repeating table"
	      MaskDescription	      "Forward looking repeating table.\nEnter"
" values of time and output for first cycle."
	      MaskHelp		      "Repeats cycle given in table with a one"
" time step forward offset. Time values should be monotonically increasing."
	      MaskPromptString	      "Time values:|Output values:"
	      MaskStyleString	      "edit,edit"
	      MaskTunableValueString  "on,on"
	      MaskCallbackString      "|"
	      MaskEnableString	      "on,on"
	      MaskVisibilityString    "on,on"
	      MaskToolTipString	      "on,on"
	      MaskVariables	      "t=@1;y=@2;"
	      MaskInitialization      "period = max(t);"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cyc_mph(:,1)|cyc_mph(:,2)"
	      MaskVariableAliases     ","
	      System {
		Name			"repeated cycle:\n speed required at\n"
"end of NEXT step"
		Location		[57, 72, 432, 234]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [45, 60, 65, 80]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn1"
		  Position		  [110, 25, 150, 45]
		  ForegroundColor	  "green"
		  Expr			  "rem(u[1],period)"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "Look-Up Table"
		  Position		  [260, 33, 300, 57]
		  InputValues		  "t"
		  OutputValues		  "y"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [90, 85, 120, 115]
		  ForegroundColor	  "green"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 62, 180, 93]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 26, 235, 59]
		  ForegroundColor	  "green"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [335, 35, 355, 55]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Look-Up Table"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Look-Up Table"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Fcn1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0; 0, -15]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Fcn1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "spd>set point"
	      Position		      [235, 52, 265, 83]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "w>idle"
	      Position		      [295, 102, 325, 133]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine on"
	      Position		      [950, 158, 980, 172]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "spd command\n (rad/s)"
	      Position		      [795, 563, 825, 577]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "key on"
	      Position		      [815, 123, 845, 137]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator12"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"engine on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 190]
		Branch {
		  Points		  [0, 175; -200, 0]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Memory"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "(--)2"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      Points		      [5, 0; 0, 75]
	      DstBlock		      "Logical\nOperator12"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Product"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      Points		      [70, 0]
	      DstBlock		      "Logical\nOperator15"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [95, 0]
	      DstBlock		      "w>idle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "T>~0"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [70, 0; 0, -60]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "trq req'd\nout of clutch\n(N*m)"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"T>~0"
		DstPort			1
	      }
	      Branch {
		Points			[0, 310]
		Branch {
		  Points		  [0, 135]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "w>idle"
	      SrcPort		      1
	      Points		      [5, 0; 0, -65]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd req'd\nout of clutch\n(N*m)1"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[0, 235]
		Branch {
		  DstBlock		  "max_torque\n lookup"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 95; 270, 0]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -45]
		    DstBlock		    "Gain1"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[195, 0]
		DstBlock		"w>idle"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      Points		      [190, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -35]
	      Branch {
		DstBlock		"Logical\nOperator7"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Logical\nOperator14"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator14"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>5"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator14"
	      SrcPort		      1
	      Points		      [75, 0; 0, -105]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)4"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [105, 0]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator15"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      Points		      [30, 0; 0, -100]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator15"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			2
	      }
	      Branch {
		DstBlock		"To Workspace"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant10"
	      SrcPort		      1
	      Points		      [0, 20; 25, 0]
	      Branch {
		Points			[0, 40]
		Branch {
		  DstBlock		  "Switch4"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 15]
		  DstBlock		  "Switch4"
		  DstPort		  2
		}
	      }
	      Branch {
		DstBlock		"Switch3"
		DstPort			2
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Logical\nOperator11"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"Switch3"
		DstPort			3
	      }
	      Branch {
		Points			[0, 55]
		DstBlock		"Logical\nOperator6"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator11"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		Points			[0, -75]
		DstBlock		"Look-Up Table"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      Name		      "ignition key is on"
	      Labels		      [0, 0]
	      SrcBlock		      "key_on"
	      SrcPort		      1
	      Points		      [85, 0]
	      Branch {
		DstBlock		"key on"
		DstPort			1
	      }
	      Branch {
		Points			[0, 45]
		DstBlock		"Logical\nOperator12"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "From <vc>4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      Points		      [0, -15; 20, 0]
	      Branch {
		DstBlock		"Logical\nOperator12"
		DstPort			4
	      }
	      Branch {
		Points			[0, 35]
		DstBlock		"Goto <fc>1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nstate"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "spd command\n (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "v_ave_req"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "not\nmoving"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "repeated cycle:\n speed required at\nen"
"d of NEXT step"
	      SrcPort		      1
	      Points		      [55, 0; 0, 45]
	      DstBlock		      "moving next\ntime"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "moving next\ntime"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [80, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "not\nmoving"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "moving next\ntime"
	      SrcPort		      1
	      Points		      [135, 0]
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "fc_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>3"
	      SrcPort		      1
	      Points		      [215, 0]
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [60, 0; 0, -255]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [15, 0; 0, 15]
	      DstBlock		      "Relational\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "max_torque\n lookup1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"max_torque\n lookup1"
		DstPort			1
	      }
	      Branch {
		Points			[0, 15]
		DstBlock		"Product3"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      Points		      [75, 0]
	      Branch {
		Points			[80, 0]
		DstBlock		"Relational\nOperator4"
		DstPort			1
	      }
	      Branch {
		Points			[0, -45]
		DstBlock		"Relational\nOperator7"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator7"
	      SrcPort		      1
	      Points		      [0, 10]
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual \nSwitch"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      5
	    }
	    Line {
	      SrcBlock		      "Constant12"
	      SrcPort		      1
	      DstBlock		      "spd>set point"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "spd>set point"
	      SrcPort		      1
	      Points		      [0, -25]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "T>~0"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <vc>1"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, -100]
		DstBlock		"spd>set point"
		DstPort			1
	      }
	    }
	    Annotation {
	      Position		      [820, 499]
	      Text		      "engine not suppressed if \ness insuffic"
"ient "
	    }
	    Annotation {
	      Position		      [413, 147]
	      Text		      "engine not \nsuppressed for\nelectric l"
"aunch"
	    }
	    Annotation {
	      Position		      [501, 72]
	      Text		      "engine not shut off\n rather than idle"
	    }
	    Annotation {
	      Position		      [603, 374]
	      Text		      "engine on if engine on \npreviously and"
" engine \nnot warm"
	    }
	    Annotation {
	      Position		      [656, 217]
	      Text		      "engine not shut \ndown during shifts"
	    }
	    Annotation {
	      Position		      [860, 409]
	      Text		      "engine not suppressed\nif mc insufficie"
"nt "
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [325, 451, 360, 579]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [700, 95, 730, 215]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [81, 74, 763, 525]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "parallel clutch\ncontrol"
	  Ports			  [4, 1]
	  Position		  [700, 295, 735, 375]
	  ForegroundColor	  "gray"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "parallel clutch\ncontrol"
	    Location		    [95, 74, 1008, 696]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [30, 18, 60, 32]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_in_r"
	      Position		      [30, 58, 60, 72]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_in_r"
	      Position		      [25, 168, 55, 182]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [30, 388, 60, 402]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [835, 565, 891, 605]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[315, 744, 773, 944]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This clutch control block determine"
"s the clutch state given the req'd clutch output torque \nand speed (labelled"
" as gearbox input torque and speed), and the gear number history.\n          "
"                conditions                                                   "
"                    clutch state\ngear is being shifted OR (trq <~ 0 AND (eng"
"ine is                                     1 == disengaged\nclutched to avoid"
" compression braking OR spd < idle))                                         "
"                     \n\n(trq >~ 0) AND (spd < launch speed) AND clutch      "
"                                 2 == slipping     \nwas not engaged during p"
"revious time step                                                            "
"     \n\nneither of above sets of conditions are met                         "
"                 3 == engaged\n\nBut the clutch is always disengaged when the"
" engine is off or was off within the past 0.5 s."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [40, 535, 60, 555]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [145, 83, 180, 107]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [145, 124, 225, 146]
	      Value		      "vc_clutch_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [145, 189, 225, 211]
	      Value		      "vc_idle_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [145, 255, 180, 275]
	      Value		      "1e-3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [145, 319, 225, 341]
	      Value		      "vc_launch_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [570, 355, 605, 375]
	      Orientation	      "left"
	      Value		      "2.5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [790, 175, 810, 195]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      Position		      [660, 110, 720, 140]
	      Expr		      "u[1]+2*u[2]*(1-u[1])*(1-u[3])+3*u[3]*(1"
"-u[1])"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [380, 67, 410, 98]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [315, 127, 345, 158]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual Switch"
	      Ports		      [2, 1]
	      Position		      [410, 387, 440, 423]
	      ForegroundColor	      "gray"
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [570, 300, 600, 330]
	      Orientation	      "left"
	      X0		      "1+(2*(cyc_mph(1,2)>0))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [170, 415, 200, 445]
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [170, 565, 200, 595]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [590, 107, 625, 143]
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [300, 57, 330, 88]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [260, 177, 290, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [260, 242, 290, 273]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [260, 307, 290, 338]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [235, 537, 265, 568]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [790, 120, 820, 150]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [330, 400, 360, 430]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [170, 475, 200, 505]
	      DelayTime		      "0.2"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\ndisengaged"
	      Ports		      [2, 1]
	      Position		      [450, 17, 480, 48]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nengaged"
	      Ports		      [2, 1]
	      Position		      [520, 117, 550, 148]
	      Operator		      "NOR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping"
	      Ports		      [3, 1]
	      Position		      [380, 254, 410, 286]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [235, 386, 265, 419]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [235, 466, 265, 499]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      Position		      [475, 305, 510, 340]
	      Orientation	      "left"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [80, 160, 110, 190]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[228, 213, 816, 722]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested engine speed is rep"
"laced by an estimate of the\nengine's previous speed whenever the vehicle mis"
"sed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [370, 115, 400, 145]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [445, 120, 475, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [350, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [10, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [855, 128, 885, 142]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      Points		      [40, 0; 0, -55]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 140]
		DstBlock		"Relational\nOperator3"
		DstPort			1
	      }
	      Branch {
		Points			[105, 0; 0, 10]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		Points			[0, 35]
		Branch {
		  Points		  [0, 30]
		  Branch {
		    Points		    [75, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 30]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	      Branch {
		Points			[0, -20; 250, 0]
		DstBlock		"Manual Switch"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nengaged"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "clutch\ndisengaged"
	      SrcPort		      1
	      Points		      [10, 0; 0, 40]
	      Branch {
		Points			[0, 50]
		DstBlock		"clutch\nengaged"
		DstPort			1
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping"
	      SrcPort		      1
	      Points		      [80, 0; 0, -95]
	      Branch {
		Points			[0, -35]
		DstBlock		"clutch\nengaged"
		DstPort			2
	      }
	      Branch {
		Points			[80, 0]
		DstBlock		"Mux"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-30, 0; 0, -35]
	      DstBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch was NOT\nfully engaged\nduring l"
"ast time step"
	      SrcPort		      1
	      Points		      [-120, 0; 0, -45]
	      DstBlock		      "clutch\nslipping"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [90, 0; 0, -15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gb_trq_in_r"
	      SrcPort		      1
	      Points		      [70, 0]
	      Branch {
		Points			[0, 185]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      DstBlock		      "clutch\ndisengaged"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -40]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Manual Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual Switch"
	      SrcPort		      1
	      Points		      [315, 0; 0, -270]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn:\n1 if clutch disengaged\n2 if clut"
"ch slipping\n3 if clutch engaged"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"clutch\nstate"
		DstPort			1
	      }
	      Branch {
		Points			[0, 180]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [45, 20, 75, 70]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [810, 328, 840, 342]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "engine on\n(parallel CVT hybrid)"
	  SrcPort		  2
	  DstBlock		  "Goto <fc>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>"
	  SrcPort		  1
	  DstBlock		  "engine on\n(parallel CVT hybrid)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "engine on\n(parallel CVT hybrid)"
	  SrcPort		  3
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>1"
	  SrcPort		  1
	  Points		  [0, -30]
	  DstBlock		  "engine on\n(parallel CVT hybrid)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "engine on\n(parallel CVT hybrid)"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>8"
	  SrcPort		  1
	  Points		  [0, 15]
	  DstBlock		  "engine on\n(parallel CVT hybrid)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>5"
	  SrcPort		  1
	  DstBlock		  "engine on\n(parallel CVT hybrid)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [0, -25]
	  DstBlock		  "engine on\n(parallel CVT hybrid)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "parallel clutch\ncontrol"
	  SrcPort		  1
	  Points		  [20, 0]
	  Branch {
	    DstBlock		    "Goto <sdo>"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "clutch\nstate"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <gb>6"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <fc>2"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>4"
	  SrcPort		  1
	  Points		  [0, 10]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>9"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "parallel clutch\ncontrol"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 5]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>7"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "Constant2"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "cvt control"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "cvt control"
	  SrcPort		  1
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 10]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [195, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -55]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  Points		  [-5, 0]
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [65, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [0, -45]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> prius"
      Ports		      []
      Position		      [110, 728, 167, 772]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> prius"
	Location		[26, 74, 1013, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  SubSystem
	  Name			  "Coordinated\n Controller"
	  Ports			  [2, 2]
	  Position		  [630, 19, 670, 106]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Coordinated\n Controller"
	    Location		    [165, 237, 663, 530]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "(Trq and speed req'd\n from ring gear)"
"\nNm, rad/s"
	      Position		      [40, 30, 60, 50]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "soc"
	      Position		      [25, 215, 45, 235]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [360, 240, 416, 280]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "Hybrid Main Control"
		}
	      }
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [105, 22, 125, 58]
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [195, 72, 225, 103]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace2"
	      Position		      [315, 23, 400, 37]
	      ShowName		      off
	      VariableName	      "pgr_pwr_out_r"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "battery charge demand"
	      Ports		      [1, 1]
	      Position		      [90, 210, 150, 240]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"battery charge demand"
		Location		[139, 177, 804, 484]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "SOC"
		  Position		  [80, 113, 110, 127]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  From
		  Name			  "From<ess>"
		  Position		  [145, 188, 220, 212]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "bus_voltage"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [270, 185, 300, 215]
		  X0			  "300"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [2, 1]
		  Position		  [360, 107, 390, 138]
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [150, 97, 180, 128]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  ToWorkspace
		  Name			  "To Workspace2"
		  Position		  [550, 138, 635, 152]
		  ShowName		  off
		  VariableName		  "vc_p_ch_r"
		  MaxDataPoints		  "inf"
		  Decimation		  "1"
		  SampleTime		  "-1"
		  SaveFormat		  "Array"
		}
		Block {
		  BlockType		  Gain
		  Name			  "curve fit"
		  Position		  [200, 100, 235, 130]
		  Gain			  "88"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "I"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Gain
		  Name			  "gen/mot.\neff."
		  Position		  [455, 109, 490, 141]
		  Gain			  "1/0.85"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Constant
		  Name			  "target soc"
		  Position		  [15, 12, 85, 38]
		  Value			  "cs_target_soc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Outport
		  Name			  "Pch"
		  Position		  [585, 198, 615, 212]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "curve fit"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "target soc"
		  SrcPort		  1
		  Points		  [0, 80]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "SOC"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  Name			  "I"
		  SrcBlock		  "curve fit"
		  SrcPort		  1
		  DstBlock		  "Product2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gen/mot.\neff."
		  SrcPort		  1
		  Points		  [10, 0; 0, 80; 60, 0]
		  Branch {
		    Points		    [0, -30; -30, 0]
		    DstBlock		    "To Workspace2"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Pch"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  DstBlock		  "gen/mot.\neff."
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<ess>"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [25, 0; 0, -70]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "max engine\nefficiency point"
	      Ports		      [3, 2]
	      Position		      [295, 71, 350, 169]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"max engine\nefficiency point"
		Location		[63, 115, 889, 575]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "pwr requested"
		  Position		  [35, 90, 55, 110]
		  FontName		  "Arial"
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "req ring\n speed(rad/s)"
		  Position		  [65, 270, 85, 290]
		  FontName		  "Arial"
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "Pch"
		  Position		  [25, 205, 45, 225]
		  FontName		  "Arial"
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [765, 195, 785, 215]
		  ShowName		  off
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [770, 255, 790, 275]
		  ShowName		  off
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Goto
		  Name			  "Goto <fc>"
		  Position		  [350, 60, 415, 80]
		  NamePlacement		  "alternate"
		  GotoTag		  "engine_on"
		  TagVisibility		  "global"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Max fc spd (rad/s)"
		  Ports			  [1, 1]
		  Position		  [140, 254, 170, 306]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "Max fc spd (rad/s)"
		    Location		    [511, 357, 849, 467]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "mc spd"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "<fc max rpm"
		    Position		    [185, 31, 215, 49]
		    UpperLimit		    "4000*2*pi/60"
		    LowerLimit		    "0"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "f(gc max spd,veh spd)"
		    Position		    [95, 25, 155, 55]
		    Expr		    "tx_pg_r/(tx_pg_r + tx_pg_s)*u + t"
"x_pg_s/(tx_pg_r + tx_pg_s)*cs_max_gc_spd"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Max fc spd\nrad/s"
		    Position		    [250, 33, 280, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "<fc max rpm"
		    SrcPort		    1
		    DstBlock		    "Max fc spd\nrad/s"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "mc spd"
		    SrcPort		    1
		    DstBlock		    "f(gc max spd,veh spd)"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "f(gc max spd,veh spd)"
		    SrcPort		    1
		    DstBlock		    "<fc max rpm"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Min fc spd(rad/s)"
		  Ports			  [1, 1]
		  Position		  [140, 330, 170, 380]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "Min fc spd(rad/s)"
		    Location		    [319, 369, 760, 548]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "mc spd"
		    Position		    [15, 88, 45, 102]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [75, 39, 155, 61]
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "vc_idle_spd"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant3"
		    Position		    [195, 139, 230, 161]
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    MinMax
		    Name		    "MinMax1"
		    Ports		    [2, 1]
		    Position		    [200, 72, 230, 103]
		    ShowName		    off
		    Function		    "max"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch2"
		    Position		    [290, 95, 320, 125]
		    ShowName		    off
		    Threshold		    "0"
		    }
		    Block {
		    BlockType		    ToWorkspace
		    Name		    "To Workspace3"
		    Position		    [345, 34, 415, 46]
		    NamePlacement	    "alternate"
		    ShowName		    off
		    VariableName	    "fc_min_spd"
		    MaxDataPoints	    "inf"
		    Decimation		    "1"
		    SampleTime		    "-1"
		    SaveFormat		    "Array"
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "f(gc max spd,veh spd)"
		    Position		    [80, 80, 140, 110]
		    Expr		    "tx_pg_r/(tx_pg_r + tx_pg_s)*u + t"
"x_pg_s/(tx_pg_r + tx_pg_s)*cs_min_gc_spd"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "min fc spd\nrad/s"
		    Position		    [355, 98, 385, 112]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch2"
		    SrcPort		    1
		    Points		    [0, -5; 10, 0]
		    Branch {
		    Points		    [-5, 0]
		    DstBlock		    "To Workspace3"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "min fc spd\nrad/s"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Constant3"
		    SrcPort		    1
		    Points		    [40, 0]
		    DstBlock		    "Switch2"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "MinMax1"
		    SrcPort		    1
		    Points		    [40, 0]
		    DstBlock		    "Switch2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [25, 0]
		    DstBlock		    "MinMax1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "f(gc max spd,veh spd)"
		    SrcPort		    1
		    Points		    [30, 0]
		    Branch {
		    Points		    [0, 15]
		    DstBlock		    "Switch2"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "MinMax1"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "mc spd"
		    SrcPort		    1
		    DstBlock		    "f(gc max spd,veh spd)"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax1"
		  Ports			  [2, 1]
		  Position		  [440, 217, 470, 248]
		  ShowName		  off
		  Function		  "max"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax2"
		  Ports			  [2, 1]
		  Position		  [570, 157, 600, 188]
		  ShowName		  off
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax3"
		  Ports			  [2, 1]
		  Position		  [385, 207, 415, 238]
		  ShowName		  off
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [490, 147, 520, 178]
		  ShowName		  off
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [885, 336, 915, 369]
		  ShowName		  off
		  Inputs		  "**"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [255, 176, 285, 209]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [815, 170, 845, 200]
		  ShowName		  off
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch2"
		  Position		  [815, 225, 845, 255]
		  ShowName		  off
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Terminator
		  Name			  "Terminator"
		  Position		  [295, 65, 315, 85]
		}
		Block {
		  BlockType		  ToWorkspace
		  Name			  "To Workspace2"
		  Position		  [320, 155, 410, 165]
		  NamePlacement		  "alternate"
		  ShowName		  off
		  VariableName		  "fc_pwr_out_r"
		  MaxDataPoints		  "inf"
		  Decimation		  "1"
		  SampleTime		  "-1"
		  SaveFormat		  "Array"
		}
		Block {
		  BlockType		  ToWorkspace
		  Name			  "To Workspace3"
		  Position		  [860, 395, 950, 405]
		  NamePlacement		  "alternate"
		  ShowName		  off
		  VariableName		  "fc_pwr_out_r2"
		  MaxDataPoints		  "inf"
		  Decimation		  "1"
		  SampleTime		  "-1"
		  SaveFormat		  "Array"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "at least\n idle speed"
		  Ports			  [2, 2]
		  Position		  [695, 167, 725, 218]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "at least\n idle speed"
		    Location		    [448, 427, 886, 618]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trq"
		    Position		    [25, 23, 55, 37]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "spd"
		    Position		    [20, 98, 50, 112]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [30, 139, 110, 161]
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "vc_idle_spd"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    MinMax
		    Name		    "MinMax4"
		    Ports		    [2, 1]
		    Position		    [145, 97, 175, 128]
		    ShowName		    off
		    Function		    "max"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [115, 42, 145, 73]
		    ShowName		    off
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product1"
		    Ports		    [2, 1]
		    Position		    [200, 52, 230, 83]
		    ShowName		    off
		    Inputs		    "*/"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [200, 127, 230, 158]
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [275, 25, 305, 55]
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "trq1"
		    Position		    [340, 33, 370, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "spd1"
		    Position		    [340, 108, 370, 122]
		    Port		    "2"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Product1"
		    SrcPort		    1
		    Points		    [0, -20]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Product1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trq"
		    SrcPort		    1
		    Points		    [25, 0]
		    Branch {
		    Points		    [0, 20]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "spd"
		    SrcPort		    1
		    Points		    [45, 0]
		    Branch {
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "MinMax4"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "trq1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    Points		    [0, -50; 25, 0]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [15, 0; 0, -5]
		    Branch {
		    Points		    [0, 5]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "MinMax4"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "MinMax4"
		    SrcPort		    1
		    Points		    [5, 0]
		    Branch {
		    Points		    [0, 0]
		    Branch {
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "spd1"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "cranking?"
		  Ports			  [1, 1]
		  Position		  [180, 17, 210, 73]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "cranking?"
		    Location		    [174, 245, 787, 647]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "need engine on?"
		    Position		    [40, 113, 70, 127]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "constant"
		    Position		    [80, 246, 165, 274]
		    ShowName		    off
		    Value		    "cs_eng_min_spd"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "constant1"
		    Position		    [60, 196, 145, 224]
		    ShowName		    off
		    Value		    "cs_eng_min_spd"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "logical\n operator"
		    Ports		    [2, 1]
		    Position		    [260, 139, 290, 186]
		    ShowName		    off
		    Operator		    "AND"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "pwr"
		    Position		    [200, 207, 230, 238]
		    Operator		    "<"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "cranking?"
		    Position		    [455, 118, 485, 132]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "constant1"
		    SrcPort		    1
		    Points		    [35, 0]
		    DstBlock		    "pwr"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "constant"
		    SrcPort		    1
		    Points		    [0, -30]
		    DstBlock		    "pwr"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "pwr"
		    SrcPort		    1
		    Points		    [10, 0]
		    DstBlock		    "logical\n operator"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "need engine on?"
		    SrcPort		    1
		    Points		    [30, 0; 0, 30]
		    DstBlock		    "logical\n operator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "logical\n operator"
		    SrcPort		    1
		    Points		    [115, 0; 0, -40]
		    DstBlock		    "cranking?"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "fuel on?"
		  Ports			  [2, 1]
		  Position		  [245, 45, 275, 100]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "fuel on?"
		    Location		    [164, 253, 777, 655]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "cranking?"
		    Position		    [40, 78, 70, 92]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "need engine on?1"
		    Position		    [50, 223, 80, 237]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "logical\n operator"
		    Ports		    [2, 1]
		    Position		    [225, 164, 255, 211]
		    ShowName		    off
		    Operator		    "AND"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "logical\noperator1"
		    Ports		    [1, 1]
		    Position		    [170, 158, 200, 192]
		    ShowName		    off
		    Operator		    "NOT"
		    Inputs		    "1"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "fuel on? "
		    Position		    [480, 138, 510, 152]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "logical\n operator"
		    SrcPort		    1
		    Points		    [205, 0]
		    DstBlock		    "fuel on? "
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "cranking?"
		    SrcPort		    1
		    Points		    [0, 30; 80, 0]
		    DstBlock		    "logical\noperator1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "need engine on?1"
		    SrcPort		    1
		    Points		    [125, 0]
		    DstBlock		    "logical\n operator"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "logical\noperator1"
		    SrcPort		    1
		    DstBlock		    "logical\n operator"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "max engine\nif pwr\nreq>limit"
		  Ports			  [4, 2]
		  Position		  [635, 166, 665, 219]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "max engine\nif pwr\nreq>limit"
		    Location		    [227, 421, 657, 706]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "pwr req"
		    Position		    [90, 100, 120, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "trq req"
		    Position		    [20, 88, 50, 102]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "spd req"
		    Position		    [20, 173, 50, 187]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "max fc spd"
		    Position		    [20, 133, 50, 147]
		    Port		    "4"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch3"
		    Position		    [200, 70, 230, 100]
		    ShowName		    off
		    Threshold		    "25000"
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch4"
		    Position		    [205, 140, 235, 170]
		    ShowName		    off
		    Threshold		    "25000"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "max_torque"
		    Position		    [90, 23, 120, 47]
		    InputValues		    "fc_map_spd*fc_spd_scale"
		    OutputValues	    "fc_max_trq*fc_trq_scale"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "trq"
		    Position		    [255, 78, 285, 92]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "spd"
		    Position		    [255, 148, 285, 162]
		    Port		    "2"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "pwr req"
		    SrcPort		    1
		    Points		    [60, 0]
		    Branch {
		    Points		    [0, 45]
		    DstBlock		    "Switch4"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Switch3"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Switch4"
		    SrcPort		    1
		    DstBlock		    "spd"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch3"
		    SrcPort		    1
		    DstBlock		    "trq"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trq req"
		    SrcPort		    1
		    DstBlock		    "Switch3"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "max_torque"
		    SrcPort		    1
		    Points		    [0, 40]
		    DstBlock		    "Switch3"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "max fc spd"
		    SrcPort		    1
		    Points		    [20, 0]
		    Branch {
		    DstBlock		    "max_torque"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [115, 0]
		    DstBlock		    "Switch4"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "spd req"
		    SrcPort		    1
		    Points		    [135, 0]
		    DstBlock		    "Switch4"
		    DstPort		    3
		    }
		  }
		}
		Block {
		  BlockType		  Lookup
		  Name			  "max_torque lookup"
		  Position		  [520, 183, 550, 207]
		  InputValues		  "fc_map_spd*fc_spd_scale"
		  OutputValues		  "fc_max_trq*fc_trq_scale"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "need engine on?"
		  Ports			  [1, 1]
		  Position		  [110, 73, 140, 127]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "need engine on?"
		    Location		    [313, 238, 926, 640]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "pwr requested"
		    Position		    [35, 33, 65, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "0=Engine on\n1=ZEV mode"
		    Ports		    [4, 1]
		    Position		    [355, 92, 385, 138]
		    Operator		    "AND"
		    Inputs		    "4"
		    }
		    Block {
		    BlockType		    From
		    Name		    "From <ess>"
		    Position		    [40, 178, 85, 202]
		    NamePlacement	    "alternate"
		    ShowName		    off
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "SOC"
		    }
		    Block {
		    BlockType		    From
		    Name		    "From <ess>1"
		    Position		    [20, 249, 95, 281]
		    NamePlacement	    "alternate"
		    ShowName		    off
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "fc_clt_tmp"
		    }
		    Block {
		    BlockType		    From
		    Name		    "From <veh>"
		    Position		    [30, 99, 95, 121]
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "v_prev"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "SOC high enough?"
		    Ports		    [1, 1]
		    Position		    [155, 165, 185, 215]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "SOC high enough?"
		    Location		    [334, 398, 549, 502]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [50, 28, 80, 42]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "(--)"
		    Position		    [5, 66, 85, 84]
		    ShowName		    off
		    Value		    "cs_eng_on_soc"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "SOC"
		    Position		    [105, 27, 135, 58]
		    Operator		    ">"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [160, 38, 190, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "SOC"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "SOC"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "(--)"
		    SrcPort		    1
		    DstBlock		    "SOC"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "coolant temp high enough?"
		    Ports		    [1, 1]
		    Position		    [190, 240, 220, 290]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "coolant temp high enough?"
		    Location		    [198, 312, 553, 428]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [45, 13, 75, 27]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "coolant temp limit (deg C)"
		    Position		    [35, 70, 115, 90]
		    Value		    "cs_clt_tmp"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "speed"
		    Position		    [230, 12, 260, 43]
		    Operator		    ">="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [310, 23, 340, 37]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "speed"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "speed"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "coolant temp limit (deg C)"
		    SrcPort		    1
		    Points		    [60, 0; 0, -45]
		    DstBlock		    "speed"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "has engine been\noff long enough?"
		    Ports		    [1, 1]
		    Position		    [395, 190, 425, 240]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "has engine been\noff long enough?"
		    Location		    [443, 409, 816, 608]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [15, 93, 45, 107]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant3"
		    Position		    [155, 107, 175, 123]
		    NamePlacement	    "alternate"
		    ShowName		    off
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant4"
		    Position		    [155, 52, 175, 68]
		    ShowName		    off
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant5"
		    Position		    [160, 136, 245, 154]
		    ShowName		    off
		    Value		    "cs_min_off_time"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [65, 85, 95, 115]
		    X0			    "0"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator3"
		    Position		    [270, 92, 300, 123]
		    ShowName		    off
		    Operator		    ">="
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shut \ndown"
		    Ports		    [1, 1]
		    Position		    [115, 83, 145, 117]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "just shut \ndown"
		    Location		    [71, 150, 410, 293]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "state"
		    Position		    [15, 20, 35, 40]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "Logical\nOperator"
		    Ports		    [2, 1]
		    Position		    [220, 23, 250, 47]
		    FontName		    "Arial"
		    Operator		    "AND"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "Logical\nOperator1"
		    Ports		    [1, 1]
		    Position		    [135, 18, 165, 42]
		    FontName		    "Arial"
		    Operator		    "NOT"
		    Inputs		    "1"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [135, 85, 170, 105]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "trigger"
		    Position		    [295, 25, 315, 45]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Logical\nOperator"
		    SrcPort		    1
		    DstBlock		    "trigger"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [30, 0]
		    DstBlock		    "Logical\nOperator"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "state"
		    SrcPort		    1
		    Points		    [50, 0]
		    Branch {
		    Points		    [0, 65]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Logical\nOperator1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Logical\nOperator1"
		    SrcPort		    1
		    DstBlock		    "Logical\nOperator"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [195, 79, 235, 121]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "0"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [265, 331, 787, 595]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [105, 155, 125, 175]
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [15, 0]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [195, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [325, 103, 355, 117]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator3"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant5"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Relational\nOperator3"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant3"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator3"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shut \ndown"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant4"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "just shut \ndown"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Reference
		    Name		    "key_on"
		    Ports		    [0, 1]
		    Position		    [385, 29, 440, 61]
		    NamePlacement	    "alternate"
		    SourceBlock		    "lib_controls/<vc> par/engine on\n"
"(parallel hybrid)/key_on"
		    SourceType		    "Repeating table"
		    MaskParam1		    "vc_key_on(:,1)"
		    MaskParam2		    "vc_key_on(:,2)"
		    Port {
		    PortNumber		    1
		    Name		    "ignition key is on"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		    }
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "logical\n operator"
		    Ports		    [3, 1]
		    Position		    [465, 91, 495, 139]
		    ShowName		    off
		    Operator		    "AND"
		    Inputs		    "3"
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "logical\noperator1"
		    Ports		    [1, 1]
		    Position		    [410, 98, 440, 132]
		    ShowName		    off
		    Operator		    "NOT"
		    Inputs		    "1"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "pwr low enough?"
		    Ports		    [1, 1]
		    Position		    [155, 15, 185, 65]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "pwr low enough?"
		    Location		    [419, 336, 689, 435]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [50, 28, 80, 42]
		    ShowName		    off
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "constant"
		    Position		    [25, 61, 95, 89]
		    ShowName		    off
		    Value		    "cs_min_pwr"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "pwr"
		    Position		    [160, 27, 190, 58]
		    Operator		    "<"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [215, 48, 245, 62]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "pwr"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "constant"
		    SrcPort		    1
		    Points		    [0, -25]
		    DstBlock		    "pwr"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "pwr"
		    SrcPort		    1
		    Points		    [0, 10]
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "spd low enough?"
		    Ports		    [1, 1]
		    Position		    [155, 85, 185, 135]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "spd low enough?"
		    Location		    [194, 308, 549, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [45, 13, 75, 27]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "<__m/s"
		    Position		    [25, 69, 200, 91]
		    Value		    "cs_electric_launch_spd"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "speed"
		    Position		    [230, 12, 260, 43]
		    Operator		    "<"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [310, 23, 340, 37]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "speed"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "speed"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "<__m/s"
		    SrcPort		    1
		    Points		    [0, -45]
		    DstBlock		    "speed"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "fc on=1"
		    Position		    [540, 108, 570, 122]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "logical\n operator"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    Points		    [0, 195; -170, 0; 0, -95]
		    DstBlock		    "has engine been\noff long enough?"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "fc on=1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "From <ess>1"
		    SrcPort		    1
		    DstBlock		    "coolant temp high enough?"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "coolant temp high enough?"
		    SrcPort		    1
		    Points		    [60, 0; 0, -135]
		    DstBlock		    "0=Engine on\n1=ZEV mode"
		    DstPort		    4
		    }
		    Line {
		    SrcBlock		    "0=Engine on\n1=ZEV mode"
		    SrcPort		    1
		    DstBlock		    "logical\noperator1"
		    DstPort		    1
		    }
		    Line {
		    Labels		    [2, 0]
		    SrcBlock		    "SOC high enough?"
		    SrcPort		    1
		    Points		    [80, 0; 0, -70]
		    DstBlock		    "0=Engine on\n1=ZEV mode"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "From <ess>"
		    SrcPort		    1
		    DstBlock		    "SOC high enough?"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From <veh>"
		    SrcPort		    1
		    DstBlock		    "spd low enough?"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "pwr requested"
		    SrcPort		    1
		    DstBlock		    "pwr low enough?"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "spd low enough?"
		    SrcPort		    1
		    DstBlock		    "0=Engine on\n1=ZEV mode"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "pwr low enough?"
		    SrcPort		    1
		    Points		    [80, 0; 0, 60]
		    DstBlock		    "0=Engine on\n1=ZEV mode"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "has engine been\noff long enough?"
		    SrcPort		    1
		    Points		    [20, 0]
		    DstBlock		    "logical\n operator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "logical\noperator1"
		    SrcPort		    1
		    DstBlock		    "logical\n operator"
		    DstPort		    2
		    }
		    Line {
		    Name		    "ignition key is on"
		    Labels		    [0, 0]
		    SrcBlock		    "key_on"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "logical\n operator"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "spd opt"
		  Ports			  [1, 1]
		  Position		  [315, 190, 345, 240]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "spd opt"
		    Location		    [121, 234, 554, 443]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "pwr req"
		    Position		    [15, 45, 45, 65]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    From
		    Name		    "From <ess>"
		    Position		    [75, 137, 145, 163]
		    NamePlacement	    "alternate"
		    ShowName		    off
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "fc_spd_prev"
		    }
		    Block {
		    BlockType		    Goto
		    Name		    "Goto <vc>"
		    Position		    [280, 137, 410, 163]
		    NamePlacement	    "alternate"
		    GotoTag		    "inertia_effect_fc_guess"
		    TagVisibility	    "global"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product2"
		    Ports		    [2, 1]
		    Position		    [165, 27, 195, 58]
		    ShowName		    off
		    Inputs		    "**"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [235, 27, 265, 58]
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "effect of inertia\n guess (Nm)"
		    Ports		    [2, 1]
		    Position		    [175, 106, 205, 144]
		    FontName		    "Arial"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "effect of inertia\n guess (Nm)"
		    Location		    [245, 92, 674, 342]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "req'd spd\n(rad/s)"
		    Position		    [60, 80, 80, 100]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "prev spd"
		    Position		    [60, 130, 80, 150]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [40, 175, 60, 195]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [120, 19, 180, 41]
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "fc_inertia"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [95, 210, 130, 230]
		    FontName		    "Arial"
		    X0			    "-0.1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product1"
		    Ports		    [3, 1]
		    Position		    [285, 77, 315, 113]
		    Inputs		    "**/"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [115, 85, 135, 105]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [160, 180, 180, 200]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "(Nm)"
		    Position		    [385, 85, 405, 105]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    Points		    [40, 0; 0, -85]
		    DstBlock		    "Product1"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "req'd spd\n(rad/s)"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "prev spd"
		    SrcPort		    1
		    Points		    [5, 0; 0, -40]
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Product1"
		    SrcPort		    1
		    DstBlock		    "(Nm)"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [5, 0; 0, -25]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [40, 0; 0, 55]
		    DstBlock		    "Product1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "fc spd opt"
		    Position		    [65, 43, 95, 67]
		    InputValues		    "cs_fc_pwr_opt"
		    OutputValues	    "cs_fc_spd_opt"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "fc spd opt1"
		    Position		    [300, 33, 330, 57]
		    InputValues		    "cs_fc_pwr_opt"
		    OutputValues	    "cs_fc_spd_opt"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "spd opt"
		    Position		    [350, 38, 380, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "effect of inertia\n guess (Nm)"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Goto <vc>"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -45; -75, 0]
		    DstBlock		    "Product2"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "pwr req"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, -40; 170, 0]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "fc spd opt"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Product2"
		    SrcPort		    1
		    Points		    [20, 0]
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    DstBlock		    "fc spd opt1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "fc spd opt1"
		    SrcPort		    1
		    DstBlock		    "spd opt"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From <ess>"
		    SrcPort		    1
		    Points		    [0, -15]
		    DstBlock		    "effect of inertia\n guess (Nm)"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "fc spd opt"
		    SrcPort		    1
		    Points		    [5, 0]
		    Branch {
		    Points		    [0, -20]
		    DstBlock		    "Product2"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 60]
		    DstBlock		    "effect of inertia\n guess (Nm)"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "fc_trq_request"
		  Position		  [905, 175, 925, 195]
		  FontName		  "Arial"
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "fc_spd_request1"
		  Position		  [900, 230, 920, 250]
		  FontName		  "Arial"
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "fuel on?"
		  SrcPort		  1
		  DstBlock		  "Terminator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "need engine on?"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, 20; 150, 0; 0, -10; 35, 0]
		    Branch {
		    DstBlock		    "Goto <fc>"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [435, 0; 0, 75; 20, 0]
		    Branch {
		    Points		    [0, 55]
		    DstBlock		    "Switch2"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Switch1"
		    DstPort		    2
		    }
		    }
		  }
		  Branch {
		    Points		    [15, 0]
		    Branch {
		    Points		    [65, 0]
		    DstBlock		    "fuel on?"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "cranking?"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "cranking?"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "fuel on?"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "pwr requested"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 55]
		    Branch {
		    Points		    [185, 0; 0, -20; 345, 0; 0, 35]
		    DstBlock		    "max engine\nif pwr\nreq>limit"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "need engine on?"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Max fc spd (rad/s)"
		  SrcPort		  1
		  Points		  [195, 0; 0, -15]
		  Branch {
		    Points		    [250, 0]
		    DstBlock		    "max engine\nif pwr\nreq>limit"
		    DstPort		    4
		  }
		  Branch {
		    DstBlock		    "MinMax3"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "max engine\nif pwr\nreq>limit"
		  SrcPort		  2
		  DstBlock		  "at least\n idle speed"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "max engine\nif pwr\nreq>limit"
		  SrcPort		  1
		  DstBlock		  "at least\n idle speed"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "at least\n idle speed"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "at least\n idle speed"
		  SrcPort		  2
		  Points		  [0, 25]
		  DstBlock		  "Switch2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Switch2"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Switch2"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Product1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 0]
		    DstBlock		    "fc_spd_request1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, 175]
		    DstBlock		    "Product1"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "fc_trq_request"
		    DstPort		    1
		  }
		}
		Line {
		  Labels		  [2, 0]
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [5, 0; 0, 30; -80, 0]
		  DstBlock		  "To Workspace3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "MinMax2"
		  SrcPort		  1
		  DstBlock		  "max engine\nif pwr\nreq>limit"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, -20]
		    Branch {
		    Points		    [135, 0; 0, -20]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "To Workspace2"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "spd opt"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "spd opt"
		  SrcPort		  1
		  DstBlock		  "MinMax3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Min fc spd(rad/s)"
		  SrcPort		  1
		  Points		  [250, 0]
		  DstBlock		  "MinMax1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "MinMax3"
		  SrcPort		  1
		  DstBlock		  "MinMax1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "max_torque lookup"
		  SrcPort		  1
		  DstBlock		  "MinMax2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "MinMax2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "MinMax1"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [30, 0]
		    Branch {
		    Points		    [95, 0; 0, -35]
		    DstBlock		    "max engine\nif pwr\nreq>limit"
		    DstPort		    3
		    }
		    Branch {
		    DstBlock		    "max_torque lookup"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Product"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Pch"
		  SrcPort		  1
		  Points		  [190, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "req ring\n speed(rad/s)"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, 75]
		    DstBlock		    "Min fc spd(rad/s)"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Max fc spd (rad/s)"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "fc trq request"
	      Position		      [420, 85, 440, 105]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "fc spd request"
	      Position		      [420, 135, 440, 155]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -60]
		DstBlock		"To Workspace2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"max engine\nefficiency point"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "max engine\nefficiency point"
	      SrcPort		      2
	      DstBlock		      "fc spd request"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max engine\nefficiency point"
	      SrcPort		      1
	      DstBlock		      "fc trq request"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "battery charge demand"
	      SrcPort		      1
	      Points		      [120, 0; 0, -75]
	      DstBlock		      "max engine\nefficiency point"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "soc"
	      SrcPort		      1
	      DstBlock		      "battery charge demand"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [40, 0; 0, 50]
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 70; 40, 0]
	      Branch {
		DstBlock		"max engine\nefficiency point"
		DstPort			2
	      }
	      Branch {
		Points			[0, -25]
		DstBlock		"Product1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "(Trq and speed req'd\n from ring gear)"
"\nNm, rad/s"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [525, 235, 620, 255]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>1"
	  Position		  [525, 400, 620, 420]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>2"
	  Position		  [495, 74, 540, 96]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "SOC"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gc>"
	  Position		  [530, 479, 620, 501]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gc>1"
	  Position		  [530, 440, 625, 460]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_gc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [530, 275, 625, 295]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [530, 314, 620, 336]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <pgs>"
	  Position		  [480, 29, 605, 51]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "pgs_trq_spd_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [25, 237, 100, 253]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [20, 270, 80, 290]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [15, 201, 100, 219]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [165, 382, 275, 398]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [170, 416, 270, 434]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [180, 350, 240, 370]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [145, 471, 265, 489]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [280, 230, 340, 250]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [15, 126, 100, 144]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [165, 441, 280, 459]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc><mc>"
	  Position		  [685, 161, 735, 179]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gc>"
	  Position		  [690, 440, 780, 460]
	  GotoTag		  "P_gc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [690, 275, 780, 295]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <pgs>2"
	  Position		  [700, 28, 805, 52]
	  NamePlacement		  "alternate"
	  GotoTag		  "fc_trq_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <pgs>3"
	  Position		  [700, 73, 805, 97]
	  NamePlacement		  "alternate"
	  GotoTag		  "fc_spd_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [420, 226, 505, 244]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [420, 160, 505, 180]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [180, 219, 270, 241]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [230, 251, 320, 269]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [365, 386, 450, 404]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [365, 449, 450, 471]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [225, 125, 335, 145]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [190, 286, 280, 304]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [185, 316, 275, 334]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [370, 100, 480, 120]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [250, 525, 270, 545]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [370, 217, 400, 248]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [370, 152, 400, 183]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [180, 122, 210, 173]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [120, 194, 155, 296]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [310, 361, 345, 489]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "key_on"
	  Ports			  [0, 1]
	  Position		  [570, 154, 625, 186]
	  NamePlacement		  "alternate"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskType		  "Repeating table"
	  MaskDescription	  "Repeating table.\nEnter values of time and "
"output for first cycle."
	  MaskHelp		  "Repeats cycle given in table. Time values s"
"hould be monotonically increasing."
	  MaskPromptString	  "Time values:|Output values:"
	  MaskStyleString	  "edit,edit"
	  MaskTunableValueString  "on,on"
	  MaskCallbackString	  "|"
	  MaskEnableString	  "on,on"
	  MaskVisibilityString	  "on,on"
	  MaskToolTipString	  "on,on"
	  MaskInitialization	  "period = max(@1); t = @1; y = @2;"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "vc_key_on(:,1)|vc_key_on(:,2)"
	  MaskVariableAliases	  ","
	  System {
	    Name		    "key_on"
	    Location		    [5, 42, 410, 213]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [45, 60, 65, 80]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [110, 60, 150, 80]
	      Expr		      "rem(u[1],period)"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [210, 58, 250, 82]
	      InputValues	      "t"
	      OutputValues	      "y"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "out_1"
	      Position		      [285, 60, 305, 80]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      DstBlock		      "out_1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      DstBlock		      "Fcn1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      DstBlock		      "Look-Up Table"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "prius generator\n controller logic"
	  Ports			  [3, 1]
	  Position		  [635, 390, 665, 510]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "prius generator\n controller logic"
	    Location		    [67, 100, 765, 565]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 290, 60, 310]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [110, 288, 140, 312]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "gc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "gc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "true if motor\nshould be\nshut down"
	      Position		      [230, 292, 260, 323]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [185, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -45]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "prius motor\n controller logic"
	  Ports			  [3, 1]
	  Position		  [635, 225, 665, 345]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "prius motor\n controller logic"
	    Location		    [67, 100, 765, 565]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 290, 60, 310]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [110, 288, 140, 312]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 25, 145, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "true if motor\nshould be\nshut down"
	      Position		      [230, 292, 260, 323]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [185, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -45]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [25, 15, 55, 65]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Line {
	  SrcBlock		  "prius motor\n controller logic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  DstBlock		  "prius motor\n controller logic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "prius motor\n controller logic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  DstBlock		  "prius motor\n controller logic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "prius generator\n controller logic"
	  SrcPort		  1
	  DstBlock		  "Goto <gc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gc>"
	  SrcPort		  1
	  DstBlock		  "prius generator\n controller logic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gc>1"
	  SrcPort		  1
	  DstBlock		  "prius generator\n controller logic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <ess>1"
	  SrcPort		  1
	  DstBlock		  "prius generator\n controller logic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <pgs>"
	  SrcPort		  1
	  DstBlock		  "Coordinated\n Controller"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Coordinated\n Controller"
	  SrcPort		  2
	  DstBlock		  "Goto <pgs>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <ess>2"
	  SrcPort		  1
	  DstBlock		  "Coordinated\n Controller"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Coordinated\n Controller"
	  SrcPort		  1
	  DstBlock		  "Goto <pgs>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "key_on"
	  SrcPort		  1
	  DstBlock		  "Goto <fc><mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [190, 0]
	    Branch {
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -50]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [50, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [15, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [10, 0; 0, -60]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [213, 201]
	  Text			  "force required (N)"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "<vc> series"
      Ports		      []
      Position		      [105, 450, 166, 498]
      BackgroundColor	      "yellow"
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_vc.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"<vc> series"
	Location		[10, 74, 997, 742]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  From
	  Name			  "From <cs>"
	  Position		  [530, 396, 615, 414]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [525, 40, 620, 60]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "bus_voltage"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>1"
	  Position		  [545, 235, 625, 255]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>2"
	  Position		  [545, 271, 625, 289]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "eta_gb"
	}
	Block {
	  BlockType		  From
	  Name			  "From <gb>3"
	  Position		  [540, 306, 630, 324]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "slip_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>"
	  Position		  [525, 65, 620, 85]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "P_mc_in_1lim"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>1"
	  Position		  [525, 102, 615, 118]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_mc_out_r"
	}
	Block {
	  BlockType		  From
	  Name			  "From <mc>2"
	  Position		  [525, 137, 615, 153]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "shifting"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [25, 212, 100, 228]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [20, 245, 80, 265]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [15, 176, 100, 194]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [110, 367, 220, 383]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [115, 401, 215, 419]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [110, 325, 170, 345]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [90, 461, 210, 479]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [285, 205, 345, 225]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>7"
	  Position		  [75, 101, 160, 119]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<gb>"
	  Position		  [540, 206, 620, 224]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "T_gb_out"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [110, 426, 225, 444]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [710, 217, 785, 243]
	  NamePlacement		  "alternate"
	  GotoTag		  "gear_number"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>\n<mc><pb>"
	  Position		  [720, 476, 770, 494]
	  GotoTag		  "key_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>"
	  Position		  [715, 291, 785, 309]
	  GotoTag		  "shifting"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <gb>1"
	  Position		  [715, 256, 785, 274]
	  GotoTag		  "gear_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <mc>"
	  Position		  [695, 80, 760, 100]
	  GotoTag		  "P_mc_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>"
	  Position		  [715, 394, 785, 416]
	  GotoTag		  "clutch_state"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <sdo>1"
	  Position		  [435, 201, 520, 219]
	  GotoTag		  "slip_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>"
	  Position		  [430, 135, 515, 155]
	  NamePlacement		  "alternate"
	  GotoTag		  "F_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [185, 194, 275, 216]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [255, 226, 345, 244]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [310, 371, 395, 389]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [310, 434, 395, 456]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [225, 100, 335, 120]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>6"
	  Position		  [185, 261, 275, 279]
	  GotoTag		  "wt_rear_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>7"
	  Position		  [180, 291, 270, 309]
	  GotoTag		  "front_traction_ratio"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>8"
	  Position		  [395, 70, 505, 90]
	  GotoTag		  "F_rear_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Ground
	  Name			  "Ground"
	  Position		  [180, 520, 200, 540]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [380, 192, 410, 223]
	  Operator		  "~="
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [380, 127, 410, 158]
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Reference
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [180, 97, 210, 148]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/SubSystem/braking strategy"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [120, 169, 155, 271]
	  BackgroundColor	  "darkGreen"
	  AttributesFormatString  "%<BlockChoice>"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "lib_controls/SubSystem/config traction cont"
"rol"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control 2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
" 2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control 2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control 2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [255, 346, 290, 474]
	  SourceBlock		  "lib_controls/SubSystem/front and rear\nbrak"
"e controller\n(achievable)"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "gearbox control\nfor series \nHV and EV"
	  Ports			  [4, 3]
	  Position		  [650, 209, 690, 316]
	  FontName		  "Arial"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "gearbox control\nfor series \nHV and EV"
	    Location		    [12, 74, 999, 742]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "gb_trq_out_r"
	      Position		      [45, 130, 65, 150]
	      FontName		      "Arial"
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "gb_spd_out_r"
	      Position		      [45, 250, 65, 270]
	      FontName		      "Arial"
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "prev.\nPout/Pin"
	      Position		      [45, 20, 65, 40]
	      FontName		      "Arial"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tires are at\ntraction limit"
	      Position		      [45, 75, 65, 95]
	      FontName		      "Arial"
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [875, 590, 931, 630]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 687, 388]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "This gearbox control block computes"
" the current gear number given the gearbox's\nreq'd output torque and speed a"
"nd an estimate its efficiency.  Upshifts occur, given a\ncertain engine speed"
",  when the estimated engine load falls below the upshift curve\nin engine sp"
"eed/load space, and downshifts likewise occur when estimated engine\nload ris"
"es above the downshift curve.  Separate upshift and downshift curves are\ndef"
"ined for each gear.  An upshift may not be immediately followed by a downshif"
"t.\nIf the tires are about to slip, don't upshift unless the engine would be "
"at max. speed.\nEnforce this rule by setting the load to 1 when the tires are"
" about to slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [330, 95, 350, 115]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant14"
	      Position		      [460, 538, 555, 552]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant15"
	      Position		      [390, 403, 485, 417]
	      ForegroundColor	      "red"
	      Value		      "tx_speed_dep"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [730, 391, 735, 429]
	      BackgroundColor	      "black"
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn"
	      Position		      [155, 20, 185, 40]
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [85, 180, 115, 200]
	      Orientation	      "up"
	      FontName		      "Arial"
	      Expr		      "1/u"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [560, 510, 685, 530]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <logic>2"
	      Position		      [40, 464, 145, 496]
	      ForegroundColor	      "red"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [560, 570, 685, 590]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_num"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [500, 430, 625, 450]
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_gear_ratio"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From3"
	      Position		      [500, 455, 625, 475]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "def_shifting"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From4"
	      Position		      [500, 365, 625, 385]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "spd_dep_muxed"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [480, 237, 505, 263]
	      FontName		      "Arial"
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto1"
	      Position		      [265, 455, 385, 475]
	      NamePlacement	      "alternate"
	      GotoTag		      "spd_dep_muxed"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto2"
	      Position		      [265, 479, 385, 501]
	      GotoTag		      "spd_dep_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto4"
	      Position		      [810, 250, 945, 270]
	      GotoTag		      "def_gear_num"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto5"
	      Position		      [835, 95, 945, 115]
	      GotoTag		      "def_gear_ratio"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto6"
	      Position		      [835, 170, 945, 190]
	      NamePlacement	      "alternate"
	      GotoTag		      "def_shifting"
	      TagVisibility	      "local"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "MOTOR\ntorque\ncapability"
	      Position		      [190, 210, 220, 230]
	      Orientation	      "up"
	      FontName		      "Arial"
	      InputValues	      "mc_map_spd*mc_spd_scale"
	      OutputValues	      "mc_max_trq*mc_trq_scale+eps"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [645, 427, 650, 478]
	      ShowName		      off
	      Inputs		      "2"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [225, 142, 255, 173]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [540, 233, 560, 257]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [510, 307, 540, 333]
	      Orientation	      "left"
	      RisingSlewLimit	      "1/(gb_shift_delay+eps)"
	      FallingSlewLimit	      "-1/(gb_shift_delay+eps)"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [90, 20, 120, 40]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0.2"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation1"
	      Position		      [725, 96, 745, 114]
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Speed Dependent Shifting"
	      Ports		      [1, 2]
	      Position		      [190, 452, 220, 503]
	      SourceBlock	      "lib_controls/SubSystem/Speed Dependent "
"Shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [325, 135, 355, 165]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [705, 530, 735, 560]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [675, 395, 705, 425]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "allow downshift?"
	      Ports		      [1, 1]
	      Position		      [420, 42, 450, 78]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"allow downshift?"
		Location		[328, 265, 817, 480]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gearnum"
		  Position		  [35, 35, 55, 55]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [375, 43, 405, 67]
		  FontName		  "Arial"
		  Operator		  "NOR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [145, 60, 180, 80]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [145, 105, 180, 125]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [225, 38, 255, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [225, 98, 255, 122]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "allow shift"
		  Position		  [445, 45, 465, 65]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "allow shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gearnum"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [15, 0; 0, -15]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 30; -60, 0]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "current\ngear\nnumber"
	      Ports		      [2, 1]
	      Position		      [670, 87, 690, 123]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "delta\ngear\nnumber"
	      Position		      [600, 144, 630, 176]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "downshift \ncommand"
	      Ports		      [3, 1]
	      Position		      [415, 224, 445, 276]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"downshift \ncommand"
		Location		[431, 372, 906, 667]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 98, 75, 112]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  ">"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [240, 100, 270, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_dnshift_spd|gb_dnshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [55, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "gb_spd_in_r"
	      Ports		      [2, 1]
	      Position		      [150, 253, 170, 277]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio"
	      Position		      [400, 308, 430, 332]
	      Orientation	      "left"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio1"
	      Position		      [785, 93, 815, 117]
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "gearbox speed\nestimator"
	      Ports		      [1, 1]
	      Position		      [225, 250, 255, 280]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"gearbox speed\nestimator"
		Location		[232, 187, 820, 696]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gb_spd_in_r\nif no gear change"
		  Position		  [45, 18, 75, 32]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [515, 345, 571, 385]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [497, 485, 832, 570]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [167, 41]
		    Text		    "The requested motor speed is repl"
"aced by an estimate of the\nengine's previous speed whenever the vehicle miss"
"ed the trace\n by more than 1 mph on the last time step."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 240, 185, 260]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [315, 165, 335, 185]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [230, 360, 250, 380]
		  Orientation		  "left"
		  Value			  "1"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [230, 460, 250, 480]
		  Orientation		  "left"
		  Value			  "0.11"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [195, 40, 285, 70]
		  Orientation		  "left"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "gb_spd_in_a"
		}
		Block {
		  BlockType		  From
		  Name			  "From <cyc>"
		  Position		  [30, 304, 120, 336]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "cyc_mph_r"
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [30, 99, 85, 131]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "mpha"
		}
		Block {
		  BlockType		  From
		  Name			  "From <wh>/\ntire slip model (m/s)"
		  Position		  [30, 184, 120, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "veh_spd_a_rec"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [150, 97, 190, 133]
		  Gain			  "0.447"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical"
		  Ports			  [2, 1]
		  Position		  [375, 317, 405, 348]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [395, 110, 425, 140]
		  X0			  "cyc_mph(1,2)*0.447/wh_radius*fd_rat"
"io*gb_ratio(gb_num_init)"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [310, 310, 340, 340]
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [3, 1]
		  Position		  [215, 99, 245, 131]
		  Inputs		  "**/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational"
		  Position		  [225, 307, 255, 338]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational1"
		  Position		  [225, 412, 255, 443]
		  Operator		  "<="
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [160, 192, 190, 223]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [160, 297, 190, 328]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [310, 110, 340, 140]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [465, 120, 495, 150]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [165, 408, 185, 432]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [240, 561, 480, 665]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [25, 25, 45, 45]
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [75, 53, 105, 77]
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum4"
		    Ports		    [2, 1]
		    Position		    [130, 27, 160, 58]
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 38, 215, 52]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum4"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [545, 128, 575, 142]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Product"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  Labels		  [1, 0]
		  SrcBlock		  "From <wh>/\ntire slip model (m/s)"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -25; 155, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <cyc>"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Relational"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  DstBlock		  "Memory"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gb_spd_in_r\nif no gear change"
		  SrcPort		  1
		  Points		  [370, 0]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, 50]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  DstBlock		  "Relational1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Logical"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Logical"
		  SrcPort		  1
		  Points		  [30, 0; 0, -200]
		  DstBlock		  "Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational1"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Logical"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational1"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "load=T/\n(maxT\nat spd)"
	      Position		      [275, 151, 295, 169]
	      FontName		      "Arial"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nnumber"
	      Position		      [690, 20, 730, 40]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev gear\nratio"
	      Position		      [265, 310, 300, 330]
	      Orientation	      "left"
	      FontName		      "Arial"
	      X0		      "gb_ratio(1)"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [785, 164, 815, 196]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"shifting1"
		Location		[164, 210, 454, 401]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "gear\nnumber"
		  Position		  [15, 50, 35, 70]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [20, 131, 120, 159]
		  FontName		  "Arial"
		  Value			  "gb_shift_delay-1e-6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [185, 53, 215, 77]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "time since last shift"
		  Ports			  [1, 1]
		  Position		  [65, 43, 125, 77]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('time since\\nlast shift')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "time since last shift"
		    Location		    [16, 396, 306, 535]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [10, 60, 30, 80]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "just shifted"
		    Ports		    [1, 1]
		    Position		    [60, 57, 110, 83]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('just\\nshifted')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "just shifted"
		    Location		    [140, 214, 463, 359]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "timer"
		    Ports		    [1, 1]
		    Position		    [140, 55, 175, 85]
		    ShowName		    off
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskDisplay		    "disp('timer')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [225, 60, 245, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "just shifted"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "just shifted"
		    SrcPort		    1
		    DstBlock		    "timer"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "timer"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [250, 55, 270, 75]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "gear\nnumber"
		  SrcPort		  1
		  DstBlock		  "time since last shift"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0; 0, -75]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "time since last shift"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "upshift\n command"
	      Ports		      [3, 1]
	      Position		      [415, 124, 445, 176]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"upshift\n command"
		Location		[324, 355, 799, 650]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "prev gear number"
		  Position		  [45, 103, 75, 117]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine load"
		  Position		  [45, 38, 75, 52]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "engine speed"
		  Position		  [45, 133, 75, 147]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [2, 1]
		  Position		  [130, 107, 165, 143]
		  Inputs		  "2"
		  DisplayOption		  "none"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [350, 38, 380, 62]
		  FontName		  "Arial"
		  Operator		  "<"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "load fraction"
		  Ports			  [1, 1]
		  Position		  [245, 100, 275, 150]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskType		  "Gear Selector"
		  MaskDescription	  "This block will perform a linear in"
"terplation (extrapolation outside of bounds) to determine the shift point loa"
"d fraction associated with the current gear number and speed. \n\nThe Speeds "
"parameter should be defined as an array of vectors containing speeds for each"
" gear number.  The Load Fractions parameter should be defined as a array of v"
"ectors containing load fractions indexed by the speeds in the Speeds paramete"
"r for each gear number."
		  MaskHelp		  "Reference the base workspace variab"
"les - gb_**shift_spd and gb_**shift_load  where ** is either up for upshift c"
"onditions or dn for downshift conditions.\n\nOr define the arrays as follows:"
"\n\n{[spd1 spd2 spd3 spd4]; [spd1 spd2 spd3 spd4]; ...}\n\n{[load1 load2 load"
"3 load4]; [load1 load2 load3 load4]; ...}\n\nwhere each array contains one ro"
"w for each gear in the gearbox.  Speeds should be defined in rad/s and loads "
"as a decimal fraction.\n\n"
		  MaskPromptString	  "Speeds:|Load Fractions:"
		  MaskStyleString	  "edit,edit"
		  MaskTunableValueString  "on,on"
		  MaskCallbackString	  "|"
		  MaskEnableString	  "on,on"
		  MaskVisibilityString	  "on,on"
		  MaskToolTipString	  "on,on"
		  MaskVariables		  "spd=@1;load=@2;"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  MaskValueString	  "gb_upshift_spd|gb_upshift_load"
		  MaskVariableAliases	  ","
		  System {
		    Name		    "load fraction"
		    Location		    [464, 440, 704, 522]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 33, 55, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [80, 25, 160, 55]
		    FunctionName	    "sfun_gearbox"
		    Parameters		    "load, spd"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [185, 33, 215, 47]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "command"
		  Position		  [420, 43, 450, 57]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "load fraction"
		  SrcPort		  1
		  Points		  [50, 0; 0, -70]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "engine load"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "prev gear number"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "load fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "engine speed"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  DstBlock		  "command"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "~gb_trq_in_r"
	      Ports		      [3, 1]
	      Position		      [150, 132, 170, 168]
	      FontName		      "Arial"
	      Inputs		      "3"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number, out"
	      Position		      [800, 535, 820, 555]
	      FontName		      "Arial"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio, out"
	      Position		      [800, 375, 820, 395]
	      FontName		      "Arial"
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "shifting, out"
	      Position		      [800, 420, 820, 440]
	      FontName		      "Arial"
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "gearbox speed\nestimator"
	      SrcPort		      1
	      Points		      [60, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"MOTOR\ntorque\ncapability"
		DstPort			1
	      }
	      Branch {
		Points			[55, 0]
		Branch {
		  DstBlock		  "downshift \ncommand"
		  DstPort		  3
		}
		Branch {
		  Points		  [0, -100]
		  DstBlock		  "upshift\n command"
		  DstPort		  3
		}
	      }
	    }
	    Line {
	      SrcBlock		      "gb_spd_in_r"
	      SrcPort		      1
	      DstBlock		      "gearbox speed\nestimator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current\ngear\nnumber"
	      SrcPort		      1
	      DstBlock		      "Saturation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Fcn"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev.\nPout/Pin"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_trq_out_r"
	      SrcPort		      1
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "upshift\n command"
	      SrcPort		      1
	      Points		      [115, 0]
	      Branch {
		DstBlock		"delta\ngear\nnumber"
		DstPort			1
	      }
	      Branch {
		Points			[0, 10]
		DstBlock		"delta\ngear\nnumber"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio"
	      SrcPort		      1
	      DstBlock		      "prev gear\nratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "gear ratio"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gb_spd_out_r"
	      SrcPort		      1
	      DstBlock		      "gb_spd_in_r"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "downshift \ncommand"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [10, 0; 0, -75]
	      DstBlock		      "delta\ngear\nnumber"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "allow downshift?"
	      SrcPort		      1
	      Points		      [55, 0; 0, 180]
	      DstBlock		      "Product3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "prev gear\nratio"
	      SrcPort		      1
	      Points		      [-160, 0; 0, -50]
	      Branch {
		DstBlock		"Fcn1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"gb_spd_in_r"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "delta\ngear\nnumber"
	      SrcPort		      1
	      Points		      [15, 0; 0, -45]
	      DstBlock		      "current\ngear\nnumber"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "MOTOR\ntorque\ncapability"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      DstBlock		      "load=T/\n(maxT\nat spd)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "~gb_trq_in_r"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn"
	      SrcPort		      1
	      Points		      [10, 0; 0, 85; -75, 0; 0, 35]
	      DstBlock		      "~gb_trq_in_r"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "load=T/\n(maxT\nat spd)"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "tires are at\ntraction limit"
	      SrcPort		      1
	      Points		      [230, 0; 0, 65]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"upshift\n command"
		DstPort			2
	      }
	      Branch {
		Points			[0, 100]
		DstBlock		"downshift \ncommand"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, -75]
		  DstBlock		  "prev gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "gear ratio1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 75]
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 80]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Rate Limiter"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Goto4"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "prev gear\nnumber"
	      SrcPort		      1
	      Points		      [-160, 0]
	      Branch {
		Points			[-130, 0; 0, 30]
		Branch {
		  DstBlock		  "allow downshift?"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 75]
		  Branch {
		    DstBlock		    "upshift\n command"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 100]
		    DstBlock		    "downshift \ncommand"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		Points			[0, 65]
		DstBlock		"current\ngear\nnumber"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant14"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant15"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From4"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From3"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <logic>2"
	      SrcPort		      1
	      DstBlock		      "Speed Dependent Shifting"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      1
	      DstBlock		      "Goto1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Speed Dependent Shifting"
	      SrcPort		      2
	      DstBlock		      "Goto2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "gear ratio, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 10]
	      DstBlock		      "shifting, out"
	      DstPort		      1
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "gear number, out"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear ratio1"
	      SrcPort		      1
	      DstBlock		      "Goto5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Goto6"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [889, 304]
	      Text		      "default gear number\ncalculation"
	    }
	    Annotation {
	      Position		      [893, 211]
	      Text		      "default shifting\ncalculation"
	    }
	    Annotation {
	      Position		      [882, 74]
	      Text		      "default gear ratio\ncalculation"
	    }
	    Annotation {
	      Position		      [887, 42]
	      Text		      "local GOTO blocks:"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "key_on"
	  Ports			  [0, 1]
	  Position		  [650, 470, 690, 500]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskType		  "Repeating table"
	  MaskDescription	  "Repeating table.\nEnter values of time and "
"output for first cycle."
	  MaskHelp		  "Repeats cycle given in table. Time values s"
"hould be monotonically increasing."
	  MaskPromptString	  "Time values:|Output values:"
	  MaskStyleString	  "edit,edit"
	  MaskTunableValueString  "on,on"
	  MaskCallbackString	  "|"
	  MaskEnableString	  "on,on"
	  MaskVisibilityString	  "on,on"
	  MaskToolTipString	  "on,on"
	  MaskInitialization	  "period = max(@1); t = @1; y = @2;"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "vc_key_on(:,1)|vc_key_on(:,2)"
	  MaskVariableAliases	  ","
	  System {
	    Name		    "key_on"
	    Location		    [7, 74, 300, 156]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [15, 25, 35, 45]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Fcn1"
	      Position		      [80, 25, 120, 45]
	      Expr		      "rem(u[1],period)"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up Table"
	      Position		      [180, 23, 220, 47]
	      InputValues	      "t"
	      OutputValues	      "y"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "out_1"
	      Position		      [255, 25, 275, 45]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Look-Up Table"
	      SrcPort		      1
	      DstBlock		      "out_1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      DstBlock		      "Fcn1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Fcn1"
	      SrcPort		      1
	      DstBlock		      "Look-Up Table"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "motor controller\nlogic"
	  Ports			  [4, 1]
	  Position		  [650, 37, 680, 138]
	  NamePlacement		  "alternate"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "motor controller\nlogic"
	    Location		    [219, 174, 882, 616]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "bus voltage"
	      Position		      [40, 30, 60, 50]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd input\npower (W)"
	      Position		      [40, 160, 60, 180]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "req'd output\nspd (rad/s)"
	      Position		      [40, 280, 60, 300]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "shifting"
	      Position		      [40, 385, 60, 405]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [205, 123, 235, 147]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs1"
	      Position		      [105, 278, 135, 302]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [590, 385, 646, 425]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[263, 139, 778, 219]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [257, 40]
		  Text			  "This block models a motor/controlle"
"r's logic, modulating the power input requirement as follows:\n- enforcing th"
"e maximum current limit of the motor/controller\n- shutting the motor off if "
"the average speed over the time step ==0\n- shutting the motor off if the tra"
"nsmission is shifting."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [95, 79, 165, 101]
	      FontName		      "Arial"
	      Value		      "mc_max_crrnt"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [140, 348, 175, 372]
	      FontName		      "Arial"
	      Value		      "0.001"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [500, 232, 520, 258]
	      Orientation	      "left"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto <sdo>"
	      Position		      [555, 24, 645, 46]
	      GotoTag		      "mc_crrnt_limited"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [434, 240, 466, 275]
	      Orientation	      "up"
	      NamePlacement	      "alternate"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [110, 25, 140, 55]
	      X0		      "ess_module_num*mean(ess_voc(1,:))"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [270, 37, 300, 68]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [210, 36, 230, 54]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [230, 282, 260, 313]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [490, 17, 520, 48]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Sign"
	      Ports		      [1, 1]
	      Position		      [270, 157, 300, 183]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Sign"
	      MaskDescription	      "y = sign(x)"
	      MaskHelp		      "Sign Function:\\n\\t\\t\\ty = 1 if x > "
"0\\n\\t\\t\\ty = 0 if x = 0\\n\\t\\t\\ty = -1 if x < 0"
	      MaskDisplay	      "plot(-50,-50,50,50,[-50,50],[0,0],[0,0]"
",[-50,50],[-40,0],[-30,-30],[0,40],[30,30])"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Sign"
		Location		[159, 417, 467, 586]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [35, 30, 55, 50]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [65, 105, 85, 125]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [140, 32, 170, 63]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [140, 92, 170, 123]
		  Operator		  "<"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [215, 64, 235, 91]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [265, 70, 285, 90]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0; 0, 20]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [0, -60]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [495, 180, 525, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "current-limited\npower"
	      Ports		      [2, 1]
	      Position		      [365, 51, 385, 69]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "true if motor\nshould be\nshut down"
	      Ports		      [2, 1]
	      Position		      [385, 292, 415, 323]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd input\npower (W)1"
	      Position		      [590, 185, 610, 205]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Abs1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "true if motor\nshould be\nshut down"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [290, 0; 0, -80]
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, -40]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [20, 0; 0, -40]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sign"
	      SrcPort		      1
	      Points		      [20, 0; 0, -105]
	      DstBlock		      "current-limited\npower"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd input\npower (W)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "current-limited\npower"
	      SrcPort		      1
	      Points		      [60, 0; 0, 125]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -20]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"current-limited\npower"
		DstPort			1
	      }
	      Branch {
		Points			[0, -15]
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Goto <sdo>"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "true if motor\nshould be\nshut down"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "req'd output\nspd (rad/s)"
	      SrcPort		      1
	      DstBlock		      "Abs1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "bus voltage"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd input\npower (W)"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		Points			[0, -35]
		DstBlock		"Abs"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sign"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "series 'clutch'\ncontrol"
	  Ports			  [1, 1]
	  Position		  [650, 386, 685, 424]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "series 'clutch'\ncontrol"
	    Location		    [295, 159, 784, 433]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "engine on"
	      Position		      [35, 33, 65, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [420, 220, 476, 260]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[315, 744, 770, 896]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [227, 12]
		  VerticalAlignment	  "top"
		  Text			  "There is no clutch, per se, in the "
"series hybrid vehicle, that is connected to\nthe engine.  This clutch control"
" is provided to tell the fuel converter (a.k.a. engine)\nwhen it can spin up "
"freely.  The fuel converter spins up or down when the 'clutch' is\ndisengaged"
", and provides torque when the 'clutch' is engaged (signal==3).\n\nHere, the "
"fuel converter spins up when the engine has been off within the\npast 0.5 s ("
"or one time step, whichever is greater).  At all other times, the fuel\nconve"
"rter provides torque to the generator."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [45, 190, 65, 210]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [385, 105, 405, 125]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [385, 15, 405, 35]
	      Orientation	      "left"
	      Value		      "3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [120, 50, 150, 80]
	      X0		      "cyc_mph(1,2)>0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [115, 220, 145, 250]
	      X0		      "-1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [180, 192, 210, 223]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [380, 55, 410, 85]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [275, 55, 305, 85]
	      Threshold		      "0.5"
	    }
	    Block {
	      BlockType		      TransportDelay
	      Name		      "Transport\nDelay"
	      Position		      [115, 130, 145, 160]
	      DelayTime		      "0.5"
	      InitialInput	      "0"
	      BufferSize	      "1024"
	      PadeOrder		      "0"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping1"
	      Ports		      [2, 1]
	      Position		      [180, 41, 210, 74]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "clutch\nslipping2"
	      Ports		      [2, 1]
	      Position		      [180, 121, 210, 154]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "clutch\nstate"
	      Position		      [445, 63, 475, 77]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "engine on"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 25]
		Branch {
		  Points		  [0, 45]
		  Branch {
		    Points		    [70, 0]
		    DstBlock		    "clutch\nslipping2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[70, 0]
		DstBlock		"clutch\nslipping1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 35]
		DstBlock		"Memory2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping2"
	      SrcPort		      1
	      Points		      [25, 0; 0, -60]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Transport\nDelay"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "clutch\nslipping1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "clutch\nstate"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      DstBlock		      "clutch\nslipping1"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  Reference
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [40, 15, 70, 65]
	  SourceBlock		  "lib_controls/SubSystem/sim stop\nsubsystem"
	  SourceType		  "SubSystem"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	}
	Line {
	  SrcBlock		  "motor controller\nlogic"
	  SrcPort		  1
	  DstBlock		  "Goto <mc>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <mc>"
	  SrcPort		  1
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <mc>1"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <mc>2"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "motor controller\nlogic"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <gb>2"
	  SrcPort		  1
	  Points		  [0, -5]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <gb>1"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From<gb>"
	  SrcPort		  1
	  Points		  [0, 10]
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <gb>3"
	  SrcPort		  1
	  DstBlock		  "gearbox control\nfor series \nHV and EV"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "series 'clutch'\ncontrol"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <cs>"
	  SrcPort		  1
	  DstBlock		  "series 'clutch'\ncontrol"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "key_on"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>\n<mc><pb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [0, -10]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [65, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>7"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  2
	  Points		  [130, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -55]
	    DstBlock		    "Goto <wh>8"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  1
	  Points		  [0, 5; 5, 0]
	  Branch {
	    DstBlock		    "braking strategy"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [170, 0]
	    Branch {
	      Points		      [0, -35]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      Points		      [0, 15]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  2
	  Points		  [0, 5]
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  3
	  Points		  [0, 15]
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <sdo>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "config traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  3
	  DstBlock		  "Goto <gb>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  2
	  DstBlock		  "Goto <gb>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "gearbox control\nfor series \nHV and EV"
	  SrcPort		  1
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  4
	  Points		  [10, 0]
	  DstBlock		  "Goto <wh>6"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "config traction control"
	  SrcPort		  5
	  Points		  [5, 0]
	  DstBlock		  "Goto <wh>7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Ground"
	  SrcPort		  1
	  Points		  [25, 0; 0, -70]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "Adaptive\ncontrol strategy\n<cs>"
      Ports		      [1, 1]
      Position		      [580, 319, 610, 351]
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"Adaptive\ncontrol strategy\n<cs>"
	Location		[202, 74, 955, 744]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [35, 113, 65, 127]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Delta SOC\nexpected\nfrom regen"
	  Ports			  [1, 1]
	  Position		  [135, 172, 165, 208]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Delta SOC\nexpected\nfrom regen"
	    Location		    [72, 664, 662, 948]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq and spd req'd\ninto clutch\n(N*m, r"
"ad/s)"
	      Position		      [50, 188, 80, 202]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      " \n"
	      Position		      [90, 26, 165, 54]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "  "
	      Position		      [325, 208, 350, 232]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      " 2"
	      Position		      [200, 153, 225, 177]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Delta\nSOC"
	      Ports		      [2, 1]
	      Position		      [265, 48, 290, 77]
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<mc>1"
	      Position		      [105, 135, 190, 165]
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "mc_trq_out_a"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [300, 162, 330, 193]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [210, 29, 240, 51]
	      X0		      "ess_init_soc"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Regen \n(Tmc<0, \nbut Tfc<=0)"
	      Position		      [375, 165, 405, 195]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Regen flag conditions"
	      Position		      [195, 198, 220, 222]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [240, 187, 270, 218]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [240, 142, 270, 173]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [315, 100, 345, 130]
	      ShowName		      off
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [435, 164, 500, 196]
	      ShowName		      off
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time (s)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskInitialization      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cs_regen_avg_time"
	      System {
		Name			"Subsystem"
		Location		[137, 550, 582, 766]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [30, 55, 50, 75]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "1/average time"
		  Position		  [255, 154, 295, 176]
		  FontName		  "Arial"
		  Value			  "1/n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [80, 55, 100, 75]
		  ShowName		  off
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [340, 66, 360, 84]
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [225, 60, 245, 80]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  TransportDelay
		  Name			  "Transport\nDelay"
		  Position		  [155, 90, 195, 120]
		  DelayTime		  "n"
		  InitialInput		  "0"
		  BufferSize		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [390, 65, 410, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "1/average time"
		  SrcPort		  1
		  Points		  [15, 0; 0, -85]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Transport\nDelay"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Selector
	      Name		      "trq"
	      Ports		      [1, 1]
	      Position		      [155, 180, 185, 210]
	      InputType		      "Vector"
	      ElementSrc	      "Internal"
	      Elements		      "1"
	      RowSrc		      "Internal"
	      Rows		      "1"
	      ColumnSrc		      "Internal"
	      Columns		      "1"
	      InputPortWidth	      "2"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Delta SOC\nregen"
	      Position		      [535, 173, 565, 187]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Delta\nSOC"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Regen \n(Tmc<0, \nbut Tfc<=0)"
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      Labels		      [0, 0]
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      DstBlock		      "Delta SOC\nregen"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Regen \n(Tmc<0, \nbut Tfc<=0)"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " \n"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 30]
		DstBlock		"Delta\nSOC"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Memory1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Delta\nSOC"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Regen \n(Tmc<0, \nbut Tfc<=0)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "trq and spd req'd\ninto clutch\n(N*m, r"
"ad/s)"
	      SrcPort		      1
	      DstBlock		      "trq"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "  "
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Regen \n(Tmc<0, \nbut Tfc<=0)"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "trq"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Regen flag conditions"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " 2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From<mc>1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Finds operation \npoint - energy/emissions "
"\nweighting"
	  Ports			  [2, 1]
	  Position		  [260, 145, 330, 205]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Finds operation \npoint - energy/emission"
"s \nweighting"
	    Location		    [39, 135, 564, 657]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq and spd req'd\ninto clutch\n(N*m, r"
"ad/s)"
	      Position		      [45, 23, 75, 37]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "Delta SOC\nexpected from\nregen"
	      Position		      [40, 98, 70, 112]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<cyc>"
	      Position		      [25, 200, 90, 220]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "cyc_mph_r"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<ess>"
	      Position		      [25, 379, 100, 401]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_tmp"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<ex>"
	      Position		      [20, 309, 95, 331]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ex_cat_tmp"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<fc>"
	      Position		      [20, 259, 95, 281]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<mc>2"
	      Position		      [35, 165, 80, 185]
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [115, 305, 130, 335]
	      X0		      "amb_tmp"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [115, 255, 130, 285]
	      X0		      "amb_tmp"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory2"
	      Position		      [120, 375, 135, 405]
	      X0		      "amb_tmp"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Minimize the \nenergy used \nand emissi"
"ons"
	      Ports		      [1, 1]
	      Position		      [320, 201, 370, 249]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"Minimize the \nenergy used \nand emis"
"sions"
		Location		[202, 74, 955, 744]
		Open			off
		ModelBrowserVisibility	on
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "input\nvector"
		  Position		  [20, 198, 50, 212]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "  1"
		  Position		  [265, 118, 290, 142]
		  ShowName		  off
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Demux
		  Name			  "Demux"
		  Ports			  [1, 8]
		  Position		  [75, 117, 90, 293]
		  ShowName		  off
		  Outputs		  "8"
		  BusSelectionMode	  off
		}
		Block {
		  BlockType		  From
		  Name			  "From"
		  Position		  [15, 320, 130, 340]
		  BackgroundColor	  "cyan"
		  ShowName		  off
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "acc_elec_pwr_est"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [1, 1]
		  Position		  [190, 75, 220, 105]
		  Orientation		  "down"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Min. Energy/emis"
		  Ports			  [9, 2, 1]
		  Position		  [180, 131, 230, 299]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  on
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "Min. Energy/emis"
		    Location		    [349, 95, 950, 765]
		    Open		    off
		    ModelBrowserVisibility  on
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "81"
		    Block {
		    BlockType		    Inport
		    Name		    "Treq"
		    Position		    [30, 33, 60, 47]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "wreq"
		    Position		    [25, 128, 55, 142]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "DeltaSOC\nregen"
		    Position		    [30, 318, 60, 332]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "SOC"
		    Position		    [30, 388, 60, 402]
		    Port		    "4"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "cyc_mph_r"
		    Position		    [40, 583, 70, 597]
		    Port		    "5"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "fc_clt_tmp"
		    Position		    [40, 653, 70, 667]
		    Port		    "6"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "ex_cat_tmp"
		    Position		    [35, 483, 65, 497]
		    Port		    "7"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "ess_tmp"
		    Position		    [40, 793, 70, 807]
		    Port		    "8"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "Elect\nAux \nLoad\nPower"
		    Position		    [25, 168, 55, 182]
		    Port		    "9"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    EnablePort
		    Name		    "Enable"
		    Ports		    []
		    Position		    [310, 15, 330, 35]
		    StatesWhenEnabling	    "held"
		    ShowOutputPort	    off
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    ">0"
		    Position		    [200, 645, 230, 675]
		    UpperLimit		    "inf"
		    LowerLimit		    "0"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "CO temp eff"
		    Position		    [155, 458, 185, 482]
		    InputValues		    "ex_cat_tmp_range"
		    OutputValues	    "ex_cat_co_frac"
		    }
		    Block {
		    BlockType		    Demux
		    Name		    "Demux"
		    Ports		    [1, 2]
		    Position		    [485, 406, 495, 464]
		    ShowName		    off
		    Outputs		    "2"
		    BusSelectionMode	    off
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "HC temp eff"
		    Position		    [155, 418, 185, 442]
		    InputValues		    "ex_cat_tmp_range"
		    OutputValues	    "ex_cat_hc_frac"
		    }
		    Block {
		    BlockType		    Mux
		    Name		    "Mux2"
		    Ports		    [14, 1]
		    Position		    [295, 55, 300, 810]
		    ShowName		    off
		    Inputs		    "14"
		    DisplayOption	    "none"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "NOx temp eff"
		    Position		    [155, 498, 185, 522]
		    InputValues		    "ex_cat_tmp_range"
		    OutputValues	    "ex_cat_nox_frac"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "PM temp eff"
		    Position		    [155, 543, 185, 567]
		    InputValues		    "ex_cat_tmp_range"
		    OutputValues	    "ex_cat_pm_frac"
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-Function"
		    Ports		    [1, 1]
		    Position		    [335, 418, 455, 452]
		    FunctionName	    "minimum_energy9"
		    Parameters		    "tc_mc_to_fc_ratio,fc_map_spd,fc_m"
"ap_trq,fc_max_trq,fc_fuel_map,fc_nox_map,fc_pm_map,fc_hc_map,fc_co_map,fc_fue"
"l_lhv,fc_fuel_den,fc_trq_scale,fc_spd_scale,ex_cat_lim,K_Energy,K_Emis,mpg_de"
"sired,hc_desired,co_desired,nox_desired,pm_desired,mc_max_trq,mc_map_spd,mc_m"
"ap_trq,mc_eff_map,mc_trq_scale,mc_spd_scale,fc_eff_map"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "Scale\nFactor"
		    Position		    [175, 710, 205, 740]
		    InputValues		    "cs_soc_range"
		    OutputValues	    "cs_scale_factor"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    Ports		    [5, 2]
		    Position		    [190, 110, 225, 170]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    Location		    [39, 135, 1046, 695]
		    Open		    off
		    ModelBrowserVisibility  on
		    ModelBrowserWidth	    246
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "78"
		    Block {
		    BlockType		    Inport
		    Name		    "Treq\n"
		    Position		    [25, 28, 55, 42]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "wreq"
		    Position		    [25, 88, 55, 102]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "SOC"
		    Position		    [395, 238, 425, 252]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "Tess"
		    Position		    [385, 293, 415, 307]
		    Port		    "4"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "Electrical Aux Loads\n(Power, W)"
		    Position		    [445, 383, 475, 397]
		    Port		    "5"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "1/(#points-1)"
		    Position		    [865, 421, 900, 449]
		    Gain		    "1/9"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Display
		    Name		    "Display1"
		    Ports		    [1]
		    Position		    [830, 327, 940, 353]
		    Format		    "short"
		    Decimation		    "1"
		    Floating		    off
		    SampleTime		    "-1"
		    }
		    Block {
		    BlockType		    Display
		    Name		    "Display2"
		    Ports		    [1]
		    Position		    [845, 107, 955, 133]
		    Format		    "short"
		    Decimation		    "1"
		    Floating		    off
		    SampleTime		    "-1"
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "Fcn"
		    Position		    [595, 115, 630, 135]
		    Expr		    "1/u"
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "Fcn1"
		    Position		    [560, 275, 595, 295]
		    ShowName		    off
		    Expr		    "1/u"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Pavailable"
		    Ports		    [2, 1]
		    Position		    [600, 183, 630, 207]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Pchg max"
		    Ports		    [2, 1]
		    Position		    [615, 298, 645, 322]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [310, 72, 340, 103]
		    ShowName		    off
		    Operator		    "<"
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation1"
		    Position		    [95, 395, 115, 415]
		    Orientation		    "down"
		    ShowName		    off
		    UpperLimit		    "max(fc_map_spd*fc_spd_scale)"
		    LowerLimit		    "min(fc_map_spd*fc_spd_scale)"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [220, 442, 250, 473]
		    ShowName		    off
		    IconShape		    "rectangular"
		    Inputs		    "-+"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [810, 417, 840, 448]
		    ShowName		    off
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum2"
		    Ports		    [2, 1]
		    Position		    [565, 367, 595, 398]
		    ShowName		    off
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Tavailable"
		    Ports		    [2, 1]
		    Position		    [670, 178, 700, 202]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Tavailable\nchg"
		    Ports		    [2, 1]
		    Position		    [670, 293, 700, 317]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Tinit,\nlimited"
		    Position		    [390, 75, 420, 105]
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    MinMax
		    Name		    "Tlim by Tmotor, \nTreq, or Pavail"
		    Ports		    [2, 1]
		    Position		    [745, 167, 775, 198]
		    Function		    "min"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Tm ->Tfc"
		    Position		    [245, 83, 270, 107]
		    Gain		    "tc_mc_to_fc_ratio"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Treq ->Tm"
		    Position		    [315, 23, 340, 47]
		    Gain		    "1/tc_mc_to_fc_ratio"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "max Tfc"
		    Position		    [150, 415, 180, 445]
		    InputValues		    "fc_map_spd*fc_spd_scale"
		    OutputValues	    "fc_max_trq*fc_trq_scale"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "max Tm"
		    Position		    [185, 80, 215, 110]
		    InputValues		    "mc_map_spd*mc_spd_scale"
		    OutputValues	    "mc_max_trq*mc_trq_scale"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "max pack\npwr (W)1"
		    Ports		    [2, 1]
		    Position		    [455, 231, 485, 264]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "max pack\npwr (W)1"
		    Location		    [428, 325, 1250, 676]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "SOC"
		    Position		    [50, 25, 70, 45]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "ess_mod_tmp"
		    Position		    [45, 110, 65, 130]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "#bty"
		    Position		    [195, 173, 285, 197]
		    Orientation		    "left"
		    Value		    "ess_module_num"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [282, 200, 368, 220]
		    Orientation		    "up"
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "mc_min_volts"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [335, 90, 370, 110]
		    Orientation		    "left"
		    Value		    "0.001"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [645, 190, 680, 210]
		    Orientation		    "left"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant7"
		    Position		    [435, 60, 475, 80]
		    ShowName		    off
		    Value		    "ess_on"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Gain"
		    Position		    [320, 142, 350, 168]
		    ShowName		    off
		    FontName		    "Arial"
		    Gain		    "0.5"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    MinMax
		    Name		    "MinMax1"
		    Ports		    [3, 1]
		    Position		    [385, 149, 415, 181]
		    ShowName		    off
		    Function		    "max"
		    Inputs		    "3"
		    }
		    Block {
		    BlockType		    Mux
		    Name		    "Mux"
		    Ports		    [3, 1]
		    Position		    [475, 123, 495, 157]
		    FontName		    "Arial"
		    Inputs		    "3"
		    DisplayOption	    "none"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [225, 118, 255, 142]
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product1"
		    Ports		    [2, 1]
		    Position		    [225, 223, 255, 247]
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "Rdis\n(ohms)"
		    Ports		    [2, 1]
		    Position		    [140, 228, 170, 252]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "2-D Table Lookup"
		    MaskDescription	    "Two Dimensional Table Lookup\nThe"
" first input corresponds to X Index and the second input corresponds to the Y"
" Index"
		    MaskHelp		    "This block returns a linearly int"
"erpolated intersection from the table using the X index (which corresponds to"
" the rows of the table) and the Y index (which corresponds to the columns of "
"the table).  Extrapolation is used."
		    MaskPromptString	    "X Index|Y Index|Table"
		    MaskStyleString	    "edit,edit,edit"
		    MaskTunableValueString  "on,on,on"
		    MaskCallbackString	    "||"
		    MaskEnableString	    "on,on,on"
		    MaskVisibilityString    "on,on,on"
		    MaskToolTipString	    "on,on,on"
		    MaskInitialization	    "xindex=@1; yindex=@2; table=@3; s"
"ftab2chk(xindex,yindex,table);"
		    MaskDisplay		    "plot(-10,-10,110,110,[90,50,10],["
"90,40,30],[90,50,10],[50,26,20],[90,50,10],[22,13,10])"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "ess_tmp|ess_soc|ess_r_dis"
		    MaskVariableAliases	    ",,"
		    System {
		    Name		    "Rdis\n(ohms)"
		    Location		    [316, 263, 598, 417]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "x0"
		    Position		    [20, 25, 40, 45]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "y0"
		    Position		    [20, 80, 40, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Mux
		    Name		    "Mux"
		    Ports		    [2, 1]
		    Position		    [90, 46, 120, 79]
		    Inputs		    "2"
		    DisplayOption	    "none"
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-function"
		    Ports		    [1, 1]
		    Position		    [140, 52, 190, 78]
		    FunctionName	    "sftable2"
		    Parameters		    "xindex, yindex, table"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "table out"
		    Position		    [215, 55, 235, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "y0"
		    SrcPort		    1
		    Points		    [20, 0; 0, -20]
		    DstBlock		    "Mux"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "S-function"
		    SrcPort		    1
		    DstBlock		    "table out"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "x0"
		    SrcPort		    1
		    Points		    [20, 0; 0, 20]
		    DstBlock		    "Mux"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Mux"
		    SrcPort		    1
		    DstBlock		    "S-function"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [340, 27, 370, 58]
		    Operator		    ">"
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [645, 140, 675, 170]
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "VOC\n(V)"
		    Ports		    [2, 1]
		    Position		    [145, 113, 175, 137]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "2-D Table Lookup"
		    MaskDescription	    "Two Dimensional Table Lookup\nThe"
" first input corresponds to X Index and the second input corresponds to the Y"
" Index"
		    MaskHelp		    "This block returns a linearly int"
"erpolated intersection from the table using the X index (which corresponds to"
" the rows of the table) and the Y index (which corresponds to the columns of "
"the table).  Extrapolation is used."
		    MaskPromptString	    "X Index|Y Index|Table"
		    MaskStyleString	    "edit,edit,edit"
		    MaskTunableValueString  "on,on,on"
		    MaskCallbackString	    "||"
		    MaskEnableString	    "on,on,on"
		    MaskVisibilityString    "on,on,on"
		    MaskToolTipString	    "on,on,on"
		    MaskInitialization	    "xindex=@1; yindex=@2; table=@3; s"
"ftab2chk(xindex,yindex,table);"
		    MaskDisplay		    "plot(-10,-10,110,110,[90,50,10],["
"90,40,30],[90,50,10],[50,26,20],[90,50,10],[22,13,10])"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "ess_tmp|ess_soc|ess_voc"
		    MaskVariableAliases	    ",,"
		    System {
		    Name		    "VOC\n(V)"
		    Location		    [316, 263, 598, 417]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "x0"
		    Position		    [20, 25, 40, 45]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "y0"
		    Position		    [20, 80, 40, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Mux
		    Name		    "Mux"
		    Ports		    [2, 1]
		    Position		    [90, 46, 120, 79]
		    Inputs		    "2"
		    DisplayOption	    "none"
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-function"
		    Ports		    [1, 1]
		    Position		    [140, 52, 190, 78]
		    FunctionName	    "sftable2"
		    Parameters		    "xindex, yindex, table"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "table out"
		    Position		    [215, 55, 235, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "y0"
		    SrcPort		    1
		    Points		    [20, 0; 0, -20]
		    DstBlock		    "Mux"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "S-function"
		    SrcPort		    1
		    DstBlock		    "table out"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "x0"
		    SrcPort		    1
		    Points		    [20, 0; 0, 20]
		    DstBlock		    "Mux"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Mux"
		    SrcPort		    1
		    DstBlock		    "S-function"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "and"
		    Ports		    [2, 1]
		    Position		    [505, 37, 535, 68]
		    NamePlacement	    "alternate"
		    ShowName		    off
		    Operator		    "AND"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "max power corresponding\nto minim"
"um voltage"
		    Position		    [520, 131, 615, 159]
		    FontName		    "Arial"
		    Expr		    "(u[1]-u[2])*u[2]/u[3]"
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "min ess V"
		    Position		    [195, 277, 360, 303]
		    Value		    "ess_module_num*ess_min_volts"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "max ess\ndischarge\npwr"
		    Position		    [730, 145, 750, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "max ess\ndischarge\npwr"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "SOC"
		    SrcPort		    1
		    Points		    [45, 0]
		    Branch {
		    Points		    [0, 95]
		    Branch {
		    DstBlock		    "VOC\n(V)"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, 115]
		    DstBlock		    "Rdis\n(ohms)"
		    DstPort		    2
		    }
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [-10, 0]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "max power corresponding\nto minim"
"um voltage"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "#bty"
		    SrcPort		    1
		    Points		    [-10, 0]
		    Branch {
		    Points		    [0, 45]
		    DstBlock		    "Product1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -50]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Rdis\n(ohms)"
		    SrcPort		    1
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "VOC\n(V)"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product1"
		    SrcPort		    1
		    Points		    [200, 0]
		    DstBlock		    "Mux"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    Points		    [0, 5; 40, 0]
		    Branch {
		    Points		    [0, 20]
		    DstBlock		    "Gain"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [160, 0]
		    DstBlock		    "Mux"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "MinMax1"
		    SrcPort		    1
		    Points		    [0, -25]
		    DstBlock		    "Mux"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Gain"
		    SrcPort		    1
		    DstBlock		    "MinMax1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Mux"
		    SrcPort		    1
		    Points		    [0, 5]
		    DstBlock		    "max power corresponding\nto minim"
"um voltage"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [25, 0; 0, -30]
		    DstBlock		    "MinMax1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    Points		    [-5, 0]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "ess_mod_tmp"
		    SrcPort		    1
		    Points		    [40, 0]
		    Branch {
		    DstBlock		    "VOC\n(V)"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 115]
		    DstBlock		    "Rdis\n(ohms)"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "min ess V"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "MinMax1"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "and"
		    SrcPort		    1
		    Points		    [90, 0]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "and"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant7"
		    SrcPort		    1
		    Points		    [10, 0]
		    DstBlock		    "and"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "min pack\npwr (W)"
		    Ports		    [2, 1]
		    Position		    [450, 302, 480, 333]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "min pack\npwr (W)"
		    Location		    [53, 618, 864, 970]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "SOC"
		    Position		    [30, 25, 50, 45]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "Tess"
		    Position		    [20, 105, 40, 125]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "#bty"
		    Position		    [140, 173, 230, 197]
		    Orientation		    "left"
		    Value		    "ess_module_num"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Mux
		    Name		    "Mux5"
		    Ports		    [3, 1]
		    Position		    [420, 146, 440, 234]
		    Inputs		    "3"
		    DisplayOption	    "none"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "P=i*Vmax"
		    Ports		    [2, 1]
		    Position		    [605, 173, 635, 197]
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [170, 123, 200, 147]
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product1"
		    Ports		    [2, 1]
		    Position		    [170, 223, 200, 247]
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "Rchg\n(ohms)"
		    Ports		    [2, 1]
		    Position		    [85, 228, 115, 252]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "2-D Table Lookup"
		    MaskDescription	    "Two Dimensional Table Lookup\nThe"
" first input corresponds to X Index and the second input corresponds to the Y"
" Index"
		    MaskHelp		    "This block returns a linearly int"
"erpolated intersection from the table using the X index (which corresponds to"
" the rows of the table) and the Y index (which corresponds to the columns of "
"the table).  Extrapolation is used."
		    MaskPromptString	    "X Index|Y Index|Table"
		    MaskStyleString	    "edit,edit,edit"
		    MaskTunableValueString  "on,on,on"
		    MaskCallbackString	    "||"
		    MaskEnableString	    "on,on,on"
		    MaskVisibilityString    "on,on,on"
		    MaskToolTipString	    "on,on,on"
		    MaskInitialization	    "xindex=@1; yindex=@2; table=@3; s"
"ftab2chk(xindex,yindex,table);"
		    MaskDisplay		    "plot(-10,-10,110,110,[90,50,10],["
"90,40,30],[90,50,10],[50,26,20],[90,50,10],[22,13,10])"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "ess_tmp|ess_soc|ess_r_chg"
		    MaskVariableAliases	    ",,"
		    System {
		    Name		    "Rchg\n(ohms)"
		    Location		    [316, 263, 598, 417]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "x0"
		    Position		    [20, 25, 40, 45]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "y0"
		    Position		    [20, 80, 40, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Mux
		    Name		    "Mux"
		    Ports		    [2, 1]
		    Position		    [90, 46, 120, 79]
		    Inputs		    "2"
		    DisplayOption	    "none"
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-function"
		    Ports		    [1, 1]
		    Position		    [140, 52, 190, 78]
		    FunctionName	    "sftable2"
		    Parameters		    "xindex, yindex, table"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "table out"
		    Position		    [215, 55, 235, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "y0"
		    SrcPort		    1
		    Points		    [20, 0; 0, -20]
		    DstBlock		    "Mux"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "S-function"
		    SrcPort		    1
		    DstBlock		    "table out"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "x0"
		    SrcPort		    1
		    Points		    [20, 0; 0, 20]
		    DstBlock		    "Mux"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Mux"
		    SrcPort		    1
		    DstBlock		    "S-function"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "VOC\n(V)"
		    Ports		    [2, 1]
		    Position		    [85, 118, 115, 142]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "2-D Table Lookup"
		    MaskDescription	    "Two Dimensional Table Lookup\nThe"
" first input corresponds to X Index and the second input corresponds to the Y"
" Index"
		    MaskHelp		    "This block returns a linearly int"
"erpolated intersection from the table using the X index (which corresponds to"
" the rows of the table) and the Y index (which corresponds to the columns of "
"the table).  Extrapolation is used."
		    MaskPromptString	    "X Index|Y Index|Table"
		    MaskStyleString	    "edit,edit,edit"
		    MaskTunableValueString  "on,on,on"
		    MaskCallbackString	    "||"
		    MaskEnableString	    "on,on,on"
		    MaskVisibilityString    "on,on,on"
		    MaskToolTipString	    "on,on,on"
		    MaskInitialization	    "xindex=@1; yindex=@2; table=@3; s"
"ftab2chk(xindex,yindex,table);"
		    MaskDisplay		    "plot(-10,-10,110,110,[90,50,10],["
"90,40,30],[90,50,10],[50,26,20],[90,50,10],[22,13,10])"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "ess_tmp|ess_soc|ess_voc"
		    MaskVariableAliases	    ",,"
		    System {
		    Name		    "VOC\n(V)"
		    Location		    [316, 263, 598, 417]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "x0"
		    Position		    [20, 25, 40, 45]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "y0"
		    Position		    [20, 80, 40, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Mux
		    Name		    "Mux"
		    Ports		    [2, 1]
		    Position		    [90, 46, 120, 79]
		    Inputs		    "2"
		    DisplayOption	    "none"
		    }
		    Block {
		    BlockType		    "S-Function"
		    Name		    "S-function"
		    Ports		    [1, 1]
		    Position		    [140, 52, 190, 78]
		    FunctionName	    "sftable2"
		    Parameters		    "xindex, yindex, table"
		    PortCounts		    "[]"
		    SFunctionModules	    "''"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "table out"
		    Position		    [215, 55, 235, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "y0"
		    SrcPort		    1
		    Points		    [20, 0; 0, -20]
		    DstBlock		    "Mux"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "S-function"
		    SrcPort		    1
		    DstBlock		    "table out"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "x0"
		    SrcPort		    1
		    Points		    [20, 0; 0, 20]
		    DstBlock		    "Mux"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Mux"
		    SrcPort		    1
		    DstBlock		    "S-function"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "ess max voltage*#batts"
		    Position		    [235, 180, 400, 200]
		    FontName		    "Arial"
		    Value		    "ess_max_volts*ess_module_num"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "iabs min=(Voc-Vmax)/R"
		    Position		    [465, 178, 545, 202]
		    Expr		    "(u(1)-u(2))/u(3)"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "max ess\ncharge\npwr\n(neg #)"
		    Position		    [725, 175, 745, 195]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Tess"
		    SrcPort		    1
		    Points		    [5, 0]
		    Branch {
		    Points		    [0, 120]
		    DstBlock		    "Rchg\n(ohms)"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [20, 0]
		    DstBlock		    "VOC\n(V)"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "SOC"
		    SrcPort		    1
		    Points		    [10, 0; 0, 100]
		    Branch {
		    DstBlock		    "VOC\n(V)"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, 110]
		    DstBlock		    "Rchg\n(ohms)"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "ess max voltage*#batts"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, -80; 155, 0; 0, 70]
		    DstBlock		    "P=i*Vmax"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Mux5"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    Points		    [180, 0; 0, 25]
		    DstBlock		    "Mux5"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "P=i*Vmax"
		    SrcPort		    1
		    DstBlock		    "max ess\ncharge\npwr\n(neg #)"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "iabs min=(Voc-Vmax)/R"
		    SrcPort		    1
		    DstBlock		    "P=i*Vmax"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Mux5"
		    SrcPort		    1
		    DstBlock		    "iabs min=(Voc-Vmax)/R"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product1"
		    SrcPort		    1
		    Points		    [200, 0]
		    DstBlock		    "Mux5"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "VOC\n(V)"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Rchg\n(ohms)"
		    SrcPort		    1
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "#bty"
		    SrcPort		    1
		    Points		    [-10, 0; 0, 0]
		    Branch {
		    Points		    [0, -45]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, 45]
		    DstBlock		    "Product1"
		    DstPort		    1
		    }
		    }
		    }
		    }
		    Block {
		    BlockType		    Lookup2D
		    Name		    "motor/controller\nefficiency\nmap"
" (W)"
		    Position		    [470, 130, 530, 170]
		    RowIndex		    "mc_map_spd*mc_spd_scale"
		    ColumnIndex		    "mc_map_trq*mc_trq_scale"
		    OutputValues	    "mc_eff_map*mc_spd_scale*mc_trq_sc"
"ale"
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "neg"
		    Position		    [270, 398, 295, 422]
		    Gain		    "-1"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    MinMax
		    Name		    "pick value\nclosest to\nzero"
		    Ports		    [3, 1]
		    Position		    [730, 424, 760, 456]
		    Function		    "max"
		    Inputs		    "3"
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "to motor"
		    Position		    [270, 448, 295, 472]
		    Gain		    "1/tc_mc_to_fc_ratio"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "wfc ->wm"
		    Position		    [130, 83, 155, 107]
		    Gain		    "tc_mc_to_fc_ratio"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Tinit\nmotor"
		    Position		    [810, 178, 840, 192]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "dT"
		    Position		    [920, 428, 950, 442]
		    Port		    "2"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Tlim by Tmotor, \nTreq, or Pavail"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, -65]
		    DstBlock		    "Display2"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Tinit\nmotor"
		    DstPort		    1
		    }
		    }
		    }
		    Line {
		    SrcBlock		    "pick value\nclosest to\nzero"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, -100]
		    DstBlock		    "Display1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "min pack\npwr (W)"
		    SrcPort		    1
		    Points		    [65, 0]
		    DstBlock		    "Sum2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum2"
		    SrcPort		    1
		    DstBlock		    "Pchg max"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Tess"
		    SrcPort		    1
		    Points		    [5, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "min pack\npwr (W)"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [15, 0]
		    DstBlock		    "max pack\npwr (W)1"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "max Tfc"
		    SrcPort		    1
		    Points		    [20, 0]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "to motor"
		    SrcPort		    1
		    Points		    [10, 0; 0, -10]
		    DstBlock		    "pick value\nclosest to\nzero"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Pchg max"
		    SrcPort		    1
		    DstBlock		    "Tavailable\nchg"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Tavailable\nchg"
		    SrcPort		    1
		    Points		    [10, 0]
		    DstBlock		    "pick value\nclosest to\nzero"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Tavailable"
		    SrcPort		    1
		    DstBlock		    "Tlim by Tmotor, \nTreq, or Pavail"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "neg"
		    SrcPort		    1
		    Points		    [10, 0; 0, 30]
		    DstBlock		    "pick value\nclosest to\nzero"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "Tinit,\nlimited"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "motor/controller\nefficiency\nmap"
" (W)"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    DstBlock		    "Fcn1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [40, 0]
		    DstBlock		    "Pavailable"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Treq ->Tm"
		    SrcPort		    1
		    Points		    [20, 0; 0, 45]
		    DstBlock		    "Tinit,\nlimited"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "SOC"
		    SrcPort		    1
		    Points		    [5, 0]
		    Branch {
		    DstBlock		    "min pack\npwr (W)"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "max pack\npwr (W)1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Fcn1"
		    SrcPort		    1
		    DstBlock		    "Pchg max"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Fcn"
		    SrcPort		    1
		    Points		    [20, 0; 0, 60]
		    Branch {
		    DstBlock		    "Tavailable\nchg"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Tavailable"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "1/(#points-1)"
		    SrcPort		    1
		    DstBlock		    "dT"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "1/(#points-1)"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Pavailable"
		    SrcPort		    1
		    DstBlock		    "Tavailable"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Tinit,\nlimited"
		    SrcPort		    1
		    Points		    [20, 0]
		    Branch {
		    Points		    [245, 0; 0, 85]
		    DstBlock		    "Tlim by Tmotor, \nTreq, or Pavail"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 70]
		    DstBlock		    "motor/controller\nefficiency\nmap"
" (W)"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "max pack\npwr (W)1"
		    SrcPort		    1
		    Points		    [95, 0]
		    DstBlock		    "Pavailable"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "wfc ->wm"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    Points		    [0, 45; 265, 0]
		    Branch {
		    Points		    [0, -15]
		    DstBlock		    "Fcn"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "motor/controller\nefficiency\nmap"
" (W)"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "max Tm"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Saturation1"
		    SrcPort		    1
		    Points		    [0, 10]
		    DstBlock		    "max Tfc"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    DstBlock		    "to motor"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Treq\n"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    Points		    [0, 430]
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [210, 0]
		    Branch {
		    DstBlock		    "Treq ->Tm"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 45]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    }
		    }
		    Line {
		    SrcBlock		    "wreq"
		    SrcPort		    1
		    Points		    [45, 0]
		    Branch {
		    DstBlock		    "Saturation1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "wfc ->wm"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Tm ->Tfc"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "max Tm"
		    SrcPort		    1
		    Points		    [5, 0]
		    Branch {
		    Points		    [0, 30]
		    Branch {
		    Points		    [150, 0]
		    DstBlock		    "Tinit,\nlimited"
		    DstPort		    3
		    }
		    Branch {
		    Points		    [0, 285]
		    DstBlock		    "neg"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "Tm ->Tfc"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Electrical Aux Loads\n(Power, W)"
		    SrcPort		    1
		    DstBlock		    "Sum2"
		    DstPort		    2
		    }
		    Annotation {
		    Position		    [454, 526]
		    Text		    "Note: Electrical Aux Loads are th"
"e estimated load on the power bus (after efficiency conversions)"
		    }
		    }
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "lambda\n(non-negative)"
		    Position		    [130, 649, 160, 671]
		    Expr		    "(fc_tstat-u)/(fc_tstat-20)"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "limit\nTreq"
		    Ports		    [2, 1]
		    Position		    [100, 30, 135, 70]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "limit\nTreq"
		    Location		    [262, 147, 1269, 707]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "Treq\n"
		    Position		    [25, 18, 55, 32]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "wreq"
		    Position		    [20, 113, 50, 127]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    MinMax
		    Name		    "MinMax"
		    Ports		    [2, 1]
		    Position		    [330, 52, 360, 83]
		    ShowName		    off
		    Function		    "min"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    Saturate
		    Name		    "Saturation1"
		    Position		    [50, 65, 70, 85]
		    Orientation		    "up"
		    ShowName		    off
		    UpperLimit		    "max(fc_map_spd*fc_spd_scale)"
		    LowerLimit		    "min(fc_map_spd*fc_spd_scale)"
		    LinearizeAsGain	    on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [255, 72, 285, 103]
		    ShowName		    off
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Tm ->Tfc"
		    Position		    [200, 108, 225, 132]
		    Gain		    "tc_mc_to_fc_ratio"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "max Tfc"
		    Position		    [105, 40, 135, 70]
		    InputValues		    "fc_map_spd*fc_spd_scale"
		    OutputValues	    "fc_max_trq*fc_trq_scale"
		    }
		    Block {
		    BlockType		    Lookup
		    Name		    "max Tm"
		    Position		    [140, 105, 170, 135]
		    InputValues		    "mc_map_spd*mc_spd_scale"
		    OutputValues	    "mc_max_trq*mc_trq_scale"
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "wfc ->wm"
		    Position		    [85, 108, 110, 132]
		    Gain		    "tc_mc_to_fc_ratio"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Treq"
		    Position		    [390, 63, 420, 77]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Saturation1"
		    SrcPort		    1
		    Points		    [0, -5]
		    DstBlock		    "max Tfc"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "MinMax"
		    SrcPort		    1
		    DstBlock		    "Treq"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [25, 0]
		    DstBlock		    "MinMax"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Treq\n"
		    SrcPort		    1
		    Points		    [255, 0]
		    DstBlock		    "MinMax"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "max Tfc"
		    SrcPort		    1
		    Points		    [100, 0]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Tm ->Tfc"
		    SrcPort		    1
		    Points		    [10, 0]
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "wreq"
		    SrcPort		    1
		    Points		    [5, 0]
		    Branch {
		    DstBlock		    "Saturation1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "wfc ->wm"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "max Tm"
		    SrcPort		    1
		    DstBlock		    "Tm ->Tfc"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "wfc ->wm"
		    SrcPort		    1
		    DstBlock		    "max Tm"
		    DstPort		    1
		    }
		    Annotation {
		    Position		    [395, 139]
		    Text		    "Limit Treq\nto max motor \nand en"
"gine can\n supply together"
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Tfc"
		    Position		    [530, 413, 560, 427]
		    Port		    "1"
		    OutputWhenDisabled	    "reset"
		    InitialOutput	    "0"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Impact"
		    Position		    [530, 443, 560, 457]
		    Port		    "2"
		    OutputWhenDisabled	    "reset"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Mux2"
		    SrcPort		    1
		    DstBlock		    "S-Function"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "lambda\n(non-negative)"
		    SrcPort		    1
		    DstBlock		    ">0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "SOC"
		    SrcPort		    1
		    Points		    [20, 0]
		    Branch {
		    Points		    [0, -15]
		    Branch {
		    Points		    [0, -240]
		    DstBlock		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    DstPort		    3
		    }
		    Branch {
		    Points		    [195, 0]
		    DstBlock		    "Mux2"
		    DstPort		    6
		    }
		    }
		    Branch {
		    Points		    [0, 330]
		    DstBlock		    "Scale\nFactor"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "DeltaSOC\nregen"
		    SrcPort		    1
		    Points		    [215, 0]
		    DstBlock		    "Mux2"
		    DstPort		    5
		    }
		    Line {
		    SrcBlock		    "ex_cat_tmp"
		    SrcPort		    1
		    Points		    [55, 0]
		    Branch {
		    Points		    [0, 20]
		    Branch {
		    Points		    [0, 45]
		    DstBlock		    "PM temp eff"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "NOx temp eff"
		    DstPort		    1
		    }
		    }
		    Branch {
		    Points		    [0, -20]
		    Branch {
		    Points		    [0, -40]
		    DstBlock		    "HC temp eff"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "CO temp eff"
		    DstPort		    1
		    }
		    }
		    }
		    Line {
		    SrcBlock		    "fc_clt_tmp"
		    SrcPort		    1
		    DstBlock		    "lambda\n(non-negative)"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "wreq"
		    SrcPort		    1
		    Points		    [20, 0]
		    Branch {
		    Points		    [0, 105]
		    DstBlock		    "Mux2"
		    DstPort		    4
		    }
		    Branch {
		    Points		    [0, -75]
		    DstBlock		    "limit\nTreq"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [95, 0]
		    DstBlock		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "limit\nTreq"
		    SrcPort		    1
		    Points		    [15, 0; 0, 65]
		    Branch {
		    Points		    [0, 70]
		    DstBlock		    "Mux2"
		    DstPort		    3
		    }
		    Branch {
		    Points		    [20, 0]
		    DstBlock		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Treq"
		    SrcPort		    1
		    DstBlock		    "limit\nTreq"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    SrcPort		    2
		    Points		    [0, -25]
		    DstBlock		    "Mux2"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    SrcPort		    1
		    Points		    [50, 0]
		    DstBlock		    "Mux2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "HC temp eff"
		    SrcPort		    1
		    Points		    [90, 0]
		    DstBlock		    "Mux2"
		    DstPort		    7
		    }
		    Line {
		    SrcBlock		    "CO temp eff"
		    SrcPort		    1
		    Points		    [90, 0]
		    DstBlock		    "Mux2"
		    DstPort		    8
		    }
		    Line {
		    SrcBlock		    "NOx temp eff"
		    SrcPort		    1
		    Points		    [90, 0]
		    DstBlock		    "Mux2"
		    DstPort		    9
		    }
		    Line {
		    SrcBlock		    "PM temp eff"
		    SrcPort		    1
		    Points		    [10, 0; 0, -5; 80, 0]
		    DstBlock		    "Mux2"
		    DstPort		    10
		    }
		    Line {
		    SrcBlock		    "ess_tmp"
		    SrcPort		    1
		    Points		    [25, 0; 0, -5]
		    Branch {
		    Points		    [0, -645]
		    DstBlock		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    DstPort		    4
		    }
		    Branch {
		    Points		    [0, -5]
		    DstBlock		    "Mux2"
		    DstPort		    14
		    }
		    }
		    Line {
		    SrcBlock		    "Scale\nFactor"
		    SrcPort		    1
		    Points		    [0, 10]
		    DstBlock		    "Mux2"
		    DstPort		    13
		    }
		    Line {
		    SrcBlock		    ">0"
		    SrcPort		    1
		    Points		    [0, 20]
		    DstBlock		    "Mux2"
		    DstPort		    12
		    }
		    Line {
		    SrcBlock		    "cyc_mph_r"
		    SrcPort		    1
		    Points		    [0, 35]
		    DstBlock		    "Mux2"
		    DstPort		    11
		    }
		    Line {
		    SrcBlock		    "S-Function"
		    SrcPort		    1
		    DstBlock		    "Demux"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Demux"
		    SrcPort		    2
		    DstBlock		    "Impact"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Demux"
		    SrcPort		    1
		    DstBlock		    "Tfc"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Elect\nAux \nLoad\nPower"
		    SrcPort		    1
		    Points		    [0, -15]
		    DstBlock		    "Tinit motor,\n(limited by\nmax Tm"
"otor and ess)\nand dT"
		    DstPort		    5
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Zero T/w/spd\ncase"
		  Ports			  [2, 1]
		  Position		  [150, 19, 185, 61]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "Zero T/w/spd\ncase"
		    Location		    [303, 314, 600, 496]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "Treq"
		    Position		    [30, 23, 60, 37]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "wreq"
		    Position		    [30, 68, 60, 82]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    " "
		    Position		    [80, 78, 105, 102]
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    " 2"
		    Position		    [85, 33, 110, 57]
		    ShowName		    off
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Logic
		    Name		    "Logical\nOperator"
		    Ports		    [2, 1]
		    Position		    [185, 64, 215, 106]
		    ShowName		    off
		    Operator		    "OR"
		    Inputs		    "2"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [125, 67, 155, 98]
		    ShowName		    off
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator1"
		    Position		    [125, 22, 155, 53]
		    ShowName		    off
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "zero req\nflag"
		    Position		    [245, 78, 275, 92]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    " 2"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Logical\nOperator"
		    SrcPort		    1
		    DstBlock		    "zero req\nflag"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "wreq"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Treq"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    Points		    [10, 0]
		    DstBlock		    "Logical\nOperator"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator1"
		    SrcPort		    1
		    Points		    [10, 0]
		    DstBlock		    "Logical\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    " "
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		  }
		}
		Block {
		  BlockType		  Switch
		  Name			  "Zero Treq\nor wreq case"
		  Position		  [315, 150, 345, 180]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  ToWorkspace
		  Name			  "total fuel used (gal)1"
		  Position		  [295, 251, 365, 269]
		  ShowName		  off
		  FontName		  "Arial"
		  VariableName		  "cs_Impact"
		  MaxDataPoints		  "inf"
		  Decimation		  "1"
		  SampleTime		  "0"
		  SaveFormat		  "Array"
		}
		Block {
		  BlockType		  Outport
		  Name			  "Tfc"
		  Position		  [385, 158, 415, 172]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  enable
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  8
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  8
		}
		Line {
		  SrcBlock		  "Min. Energy/emis"
		  SrcPort		  2
		  DstBlock		  "total fuel used (gal)1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Zero Treq\nor wreq case"
		  SrcPort		  1
		  DstBlock		  "Tfc"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "  1"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Zero Treq\nor wreq case"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Min. Energy/emis"
		  SrcPort		  1
		  DstBlock		  "Zero Treq\nor wreq case"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, -105]
		    DstBlock		    "Zero T/w/spd\ncase"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Min. Energy/emis"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  2
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, -105]
		    DstBlock		    "Zero T/w/spd\ncase"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Min. Energy/emis"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  7
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  7
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  6
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  6
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  5
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  5
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  4
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "Demux"
		  SrcPort		  3
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "input\nvector"
		  SrcPort		  1
		  DstBlock		  "Demux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Zero T/w/spd\ncase"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [35, 0; 0, 125]
		    DstBlock		    "Zero Treq\nor wreq case"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Logical\nOperator"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "From"
		  SrcPort		  1
		  Points		  [0, -35]
		  DstBlock		  "Min. Energy/emis"
		  DstPort		  9
		}
		Annotation {
		  Position		  [132, 378]
		  Text			  "Note: acc_elec_pwr_est is placed\no"
"utside of Min. Energy/emis due to the fact\nthat it is a FROM block. FROM blo"
"cks cannot\nbe placed inside of enabled sub-systems"
		}
	      }
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux2"
	      Ports		      [7, 1]
	      Position		      [260, 61, 280, 389]
	      ShowName		      off
	      Inputs		      "7"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [120, 194, 185, 226]
	      ShowName		      off
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time (s)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskInitialization      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cs_mph_avg_time"
	      System {
		Name			"Subsystem"
		Location		[137, 550, 582, 766]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [30, 55, 50, 75]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "1/average time"
		  Position		  [255, 154, 295, 176]
		  FontName		  "Arial"
		  Value			  "1/n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [80, 55, 100, 75]
		  ShowName		  off
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [340, 66, 360, 84]
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [225, 60, 245, 80]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  TransportDelay
		  Name			  "Transport\nDelay"
		  Position		  [155, 90, 195, 120]
		  DelayTime		  "n"
		  InitialInput		  "0"
		  BufferSize		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [390, 65, 410, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "1/average time"
		  SrcPort		  1
		  Points		  [15, 0; 0, -85]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Transport\nDelay"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "total fuel used (gal)1"
	      Position		      [130, 72, 240, 88]
	      ShowName		      off
	      FontName		      "Arial"
	      VariableName	      "cs_DeltaSOC_regen"
	      MaxDataPoints	      "50000"
	      Decimation	      "1"
	      SampleTime	      "0"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "trq req'd from\n engine (N*m)"
	      Position		      [430, 218, 460, 232]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Delta SOC\nexpected from\nregen"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[0, -25]
		DstBlock		"total fuel used (gal)1"
		DstPort			1
	      }
	      Branch {
		Points			[140, 0]
		DstBlock		"Mux2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "From<ex>"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [110, 0]
	      DstBlock		      "Mux2"
	      DstPort		      6
	    }
	    Line {
	      SrcBlock		      "From<cyc>"
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      Points		      [35, 0; 0, 15]
	      DstBlock		      "Mux2"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "From<mc>2"
	      SrcPort		      1
	      Points		      [160, 0]
	      DstBlock		      "Mux2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "From<ess>"
	      SrcPort		      1
	      DstBlock		      "Memory2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory2"
	      SrcPort		      1
	      Points		      [105, 0]
	      DstBlock		      "Mux2"
	      DstPort		      7
	    }
	    Line {
	      SrcBlock		      "Mux2"
	      SrcPort		      1
	      DstBlock		      "Minimize the \nenergy used \nand emissi"
"ons"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Minimize the \nenergy used \nand emissi"
"ons"
	      SrcPort		      1
	      DstBlock		      "trq req'd from\n engine (N*m)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From<fc>"
	      SrcPort		      1
	      DstBlock		      "Memory1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      DstBlock		      "Mux2"
	      DstPort		      5
	    }
	    Line {
	      SrcBlock		      "trq and spd req'd\ninto clutch\n(N*m, r"
"ad/s)"
	      SrcPort		      1
	      Points		      [165, 0]
	      DstBlock		      "Mux2"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <vc>"
	  Position		  [465, 195, 540, 215]
	  GotoTag		  "fc_trq_out_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux1"
	  Ports			  [2, 1]
	  Position		  [450, 91, 470, 129]
	  ShowName		  off
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  Selector
	  Name			  "spd"
	  Ports			  [1, 1]
	  Position		  [150, 105, 180, 135]
	  InputType		  "Vector"
	  ElementSrc		  "Internal"
	  Elements		  "2"
	  RowSrc		  "Internal"
	  Rows			  "1"
	  ColumnSrc		  "Internal"
	  Columns		  "1"
	  InputPortWidth	  "2"
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [545, 103, 575, 117]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "Mux1"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "spd"
	  SrcPort		  1
	  DstBlock		  "Mux1"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Delta SOC\nexpected\nfrom regen"
	  SrcPort		  1
	  DstBlock		  "Finds operation \npoint - energy/emissions "
"\nweighting"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  Points		  [25, 0]
	  Branch {
	    DstBlock		    "spd"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 40]
	    Branch {
	      DstBlock		      "Finds operation \npoint - energy/emissi"
"ons \nweighting"
	      DstPort		      1
	    }
	    Branch {
	      Points		      [0, 30]
	      DstBlock		      "Delta SOC\nexpected\nfrom regen"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "Finds operation \npoint - energy/emissions "
"\nweighting"
	  SrcPort		  1
	  Points		  [85, 0]
	  Branch {
	    Points		    [0, -75]
	    DstBlock		    "Mux1"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 30]
	    DstBlock		    "Goto <vc>"
	    DstPort		    1
	  }
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "Fuzzy Logic\ncontrol strategy\n<cs>"
      Ports		      [1, 1]
      Position		      [555, 548, 605, 582]
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDescription	      "This Block contains the Fuzzy Logic Control Str"
"ategy to control a parallel hybird configuration. 2 modes of operation are av"
"ailable. \n\nA FUEL USE mode limits the instantaneous fuel use of the IC engi"
"ne. \nAn EFFICIENCY mode tries to operate the IC engine near regions of peak "
"efficiency.\n\nTo look at the CONTENTS of this block, right-click and choose "
"\"Look under Mask\"."
      MaskDisplay	      "image(imread('bdi_fuzzy.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"Fuzzy Logic\ncontrol strategy\n<cs>"
	Location		[110, 95, 1000, 389]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [35, 160, 65, 180]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Block NOTES"
	  Ports			  []
	  Position		  [795, 240, 851, 280]
	  BackgroundColor	  "green"
	  ShowName		  off
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "disp('Block\\nNOTES')"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "Block NOTES"
	    Location		    [314, 648, 925, 997]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Annotation {
	      Position		      [303, 320]
	      Text		      "Where TLOAD is the load required from t"
"he drive cycle due to acceleration, drag, road grade, etc., and \nTICE_Set is"
" the desired output torque of the ICE.  The controller outputs the change of "
"the throttle command. "
	    }
	    Annotation {
	      Position		      [290, 244]
	      Text		      "\nDue to the highly nonlinear, time var"
"ying nature of the plant, the control strategy will be\n implemented with the"
" use of a fuzzy logic controller (FLC). The FLC will use two \ninputs:  the b"
"attery pack SOC and the desired ICE torque. Based on the above inputs,\nthe I"
"CE operating point is set (according to the MODE selected). Along the simulat"
"ion, \nin the reverse loop, the desired e-machine torque is calculated from t"
"he \nfollowing equation.  \n\nTEM_Desired = TLOAD - TICE_Set\n"
	    }
	    Annotation {
	      Position		      [316, 148]
	      Text		      "The idea behind the Fuzzy Logic control"
" strategy is to let the ICE run at an operating point \nthat consumes less th"
"an x gram of fuel per second at all operating conditions (FUSE USE MODE) or t"
"o \noperate about a preak efficiency point (EFFICIENCY MODE).  Since an Elect"
"ric Machine is available \nto load-level, the HEV can use its e-machine to fo"
"rce the engine to operate in a region that consumes less fuel, \nwhile mainta"
"ining  the state of charge (SOC) of the battery pack over the  majority of th"
"e drive cycle. \nThis is achieved by  using to E-Machine to compensate for th"
"e dearth in Torque required to meet the road load.\n"
	    }
	    Annotation {
	      Position		      [290, 56]
	      Text		      "This Block contains the Fuzzy Logic Con"
"trol Strategy to control a parallel hybrid configuration.\n\nA standard set o"
"f inputs (SoC and ICE torque required) are input in the beginning. Then scali"
"ng is done \nto the inputs to reflect the input membership functions. Likewis"
"e, the outputs are scaled based on the no. of output \nmembership functions. "
"The above block diagram also calls the M-Function which contains the rules.\n"
"\n"
	    }
	  }
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux"
	  Ports			  [1, 2]
	  Position		  [90, 152, 125, 188]
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Fuzzy logic Code"
	  Ports			  [2, 1]
	  Position		  [440, 95, 510, 155]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Fuzzy logic Code"
	    Location		    [386, 334, 937, 545]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "Torque"
	      Position		      [20, 63, 50, 77]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "SoC"
	      Position		      [20, 98, 50, 112]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [475, 160, 531, 200]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[198, 195, 678, 363]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [243, 53]
		  Text			  "This block calls the Fuzzy Controll"
"er through the Matlab-Function module. \nThe Fuzzy Control algorithm is writt"
"en in MATLAB script. This makes it easy \nfor the user to edit the fuzzy algo"
"rithm and make changes.\n\nFor more information on Matlab-functions, please r"
"efer to the MATLAB help files."
		}
	      }
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Fuel use \nor\nEfficieny"
	      Position		      [430, 80, 460, 110]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      MATLABFcn
	      Name		      "MATLAB Fcn\nEFFICIENCY MODE"
	      Position		      [225, 130, 285, 160]
	      MATLABFcn		      "mfuzzy_eff_mode(u(1),u(2))"
	      OutputDimensions	      "1"
	      OutputSignalType	      "auto"
	      Output1D		      on
	    }
	    Block {
	      BlockType		      MATLABFcn
	      Name		      "MATLAB Fcn\nFUEL USE MODE"
	      Position		      [225, 25, 285, 55]
	      MATLABFcn		      "mfuzzy_fuel_mode(u(1),u(2))"
	      OutputDimensions	      "1"
	      OutputSignalType	      "auto"
	      Output1D		      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Mode switcher"
	      Position		      [285, 85, 390, 105]
	      Value		      "cs_fuzzy_fuel_mode"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [90, 62, 125, 98]
	      Inputs		      "2"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "delta \nalpha"
	      Position		      [500, 88, 530, 102]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[0, -40]
		DstBlock		"MATLAB Fcn\nFUEL USE MODE"
		DstPort			1
	      }
	      Branch {
		Points			[0, 65]
		DstBlock		"MATLAB Fcn\nEFFICIENCY MODE"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Torque"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "SoC"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Mode switcher"
	      SrcPort		      1
	      DstBlock		      "Fuel use \nor\nEfficieny"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Fuel use \nor\nEfficieny"
	      SrcPort		      1
	      DstBlock		      "delta \nalpha"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MATLAB Fcn\nFUEL USE MODE"
	      SrcPort		      1
	      Points		      [125, 0]
	      DstBlock		      "Fuel use \nor\nEfficieny"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MATLAB Fcn\nEFFICIENCY MODE"
	      SrcPort		      1
	      Points		      [125, 0]
	      DstBlock		      "Fuel use \nor\nEfficieny"
	      DstPort		      3
	    }
	    Annotation {
	      Position		      [251, 14]
	      Text		      "FUZZY LOGIC CODE"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Input Scaling"
	  Ports			  [1, 2]
	  Position		  [300, 94, 375, 156]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Input Scaling"
	    Location		    [96, 117, 894, 604]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "Torque required"
	      Position		      [35, 68, 65, 82]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 2"
	      Ports		      [2, 1]
	      Position		      [510, 76, 525, 109]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 3"
	      Ports		      [2, 1]
	      Position		      [335, 221, 350, 254]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 5"
	      Ports		      [2, 1]
	      Position		      [515, 241, 530, 274]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 6"
	      Ports		      [2, 1]
	      Position		      [365, 116, 380, 149]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 7"
	      Ports		      [3, 1]
	      Position		      [330, 328, 345, 362]
	      IconShape		      "rectangular"
	      Inputs		      "++-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [695, 335, 751, 375]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[332, 702, 928, 910]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [277, 29]
		  Text			  "INPUT SCALING"
		}
		Annotation {
		  Position		  [298, 123]
		  Text			  "In this block, inputs to the Fuzzy "
"Logic controller are computed. The Current torque demand on the ICE \nand the"
" SoC are input as 2 scaled variables to the fuzzy controller. Both inputs are"
" scaled from 1 to 11.\n\nFor SoC, a value of cs_lo_soc would correspond to 1 "
"and a value of cs_hi_soc would correspond to 11, \nlinearly interpolating bet"
"ween them.\n\nFor the ICE Torque, any torque demand less than the target ICE "
"torque would scale from 1 to 6. Any torque \ndemand greater than the target I"
"CE torque would scale from 6 to 11 (the 2 being piecewise linear).\n\nThe tar"
"get ICE torque is the x g/s fuel use line, (FUEL USE MODE), or the peak effic"
"iency line \n(EFFICIENCY MODE)."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [320, 80, 345, 100]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [450, 90, 475, 110]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [335, 277, 355, 293]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [455, 255, 480, 275]
	      Value		      "6"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [235, 337, 290, 353]
	      Value		      "10e4*eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "Current  \nEngine RPM\nfrom <fc>\n"
	      Position		      [20, 163, 90, 187]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "engine_rpm"
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto Output Scaling"
	      Position		      [340, 186, 380, 204]
	      GotoTag		      "FLC1"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product8"
	      Ports		      [3, 1]
	      Position		      [400, 69, 430, 101]
	      Inputs		      "**/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [415, 152, 445, 183]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      From
	      Name		      "SOC\nfrom <ess>"
	      Position		      [20, 398, 80, 432]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation\n1-11"
	      Position		      [420, 400, 450, 430]
	      UpperLimit	      "11"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation\n1-11 "
	      Position		      [645, 155, 675, 185]
	      UpperLimit	      "11"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "SoC scaling function\n1-11"
	      Position		      [225, 400, 285, 430]
	      Expr		      "10*(u-cs_hi_soc)/(cs_hi_soc-cs_lo_soc)+"
"11"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [590, 155, 620, 185]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Target ICE Line"
	      Position		      [145, 153, 195, 197]
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "flc_target*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "epsilon"
	      Position		      [305, 117, 335, 133]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [140, 314, 190, 356]
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "trouble"
	      Ports		      [3, 1]
	      Position		      [405, 234, 435, 266]
	      Inputs		      "**/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Torque"
	      Position		      [705, 163, 735, 177]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "SoC"
	      Position		      [705, 408, 735, 422]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product8"
	      SrcPort		      1
	      DstBlock		      " 2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      " 2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " 2"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 3"
	      SrcPort		      1
	      DstBlock		      "trouble"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [15, 0; 0, -35]
	      DstBlock		      "trouble"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      DstBlock		      " 5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "trouble"
	      SrcPort		      1
	      DstBlock		      " 5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "SOC\nfrom <ess>"
	      SrcPort		      1
	      DstBlock		      "SoC scaling function\n1-11"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation\n1-11"
	      SrcPort		      1
	      DstBlock		      "SoC"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 5"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Saturation\n1-11 "
	      SrcPort		      1
	      DstBlock		      "Torque"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [15, 0; 0, -5]
	      DstBlock		      "Product8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      DstBlock		      " 7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "epsilon"
	      SrcPort		      1
	      DstBlock		      " 6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 6"
	      SrcPort		      1
	      DstBlock		      "Product8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      " 7"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "trouble"
	      DstPort		      3
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Current  \nEngine RPM\nfrom <fc>\n"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"Target ICE Line"
		DstPort			1
	      }
	      Branch {
		Points			[0, 160]
		DstBlock		"max_torque lookup"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "SoC scaling function\n1-11"
	      SrcPort		      1
	      DstBlock		      "Saturation\n1-11"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Saturation\n1-11 "
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      DstBlock		      " 7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Torque required"
	      SrcPort		      1
	      Points		      [225, 0]
	      Branch {
		DstBlock		"Product8"
		DstPort			1
	      }
	      Branch {
		Points			[0, 85]
		Branch {
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 70]
		  DstBlock		  " 3"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Target ICE Line"
	      SrcPort		      1
	      Points		      [105, 0]
	      Branch {
		Points			[15, 0]
		Branch {
		  Points		  [0, 20]
		  DstBlock		  "Goto Output Scaling"
		  DstPort		  1
		}
		Branch {
		  Points		  [30, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    " 6"
		    DstPort		    2
		  }
		}
	      }
	      Branch {
		Points			[0, 70]
		Branch {
		  DstBlock		  " 3"
		  DstPort		  2
		}
		Branch {
		  Points		  [0, 110]
		  DstBlock		  " 7"
		  DstPort		  3
		}
	      }
	    }
	    Annotation {
	      Position		      [507, 32]
	      Text		      "INPUT SCALING"
	      FontName		      "Arial"
	      FontSize		      14
	      FontWeight	      "bold"
	    }
	    Annotation {
	      Position		      [226, 28]
	      Text		      "STANDARD INPUTS"
	      FontName		      "Arial"
	      FontWeight	      "bold"
	    }
	  }
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux"
	  Ports			  [2, 1]
	  Position		  [730, 117, 765, 153]
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Output scaling"
	  Ports			  [1, 1]
	  Position		  [565, 93, 640, 157]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Output scaling"
	    Location		    [242, 320, 940, 676]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "delta alpha\n"
	      Position		      [40, 143, 70, 157]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " "
	      Ports		      [2, 1]
	      Position		      [240, 81, 255, 114]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 1"
	      Ports		      [2, 1]
	      Position		      [240, 201, 255, 234]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 2"
	      Ports		      [2, 1]
	      Position		      [455, 251, 470, 284]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 3"
	      Ports		      [2, 1]
	      Position		      [240, 261, 255, 294]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [586, 278, 641, 320]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[427, 288, 962, 473]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [269, 92]
		  Text			  "OUTPUT SCALING\nThis bock scales th"
"e outputs of the controller to match the size of the components.\nThe scaling"
" affects the way control signal is fed into the actuators. The scaling is don"
"e based \non the membership functions of the Fuzzy Control block. \n\nHere:\n"
" DELTA ALPHA is scaled from 1 to 11, 1 representing zero torque, 6 representi"
"ng target Torque \nand 11 representing Max ICE torque. (the 2 regions being p"
"iecewise linear).\n\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [190, 155, 215, 175]
	      Value		      "6"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [195, 95, 220, 115]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [340, 70, 365, 90]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [195, 215, 220, 235]
	      Value		      "6"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [340, 255, 365, 275]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From Input \nscaling"
	      Position		      [30, 40, 90, 70]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "FLC1"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From5"
	      Position		      [20, 255, 90, 285]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "engine_rpm"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product4"
	      Ports		      [2, 1]
	      Position		      [295, 47, 325, 78]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product5"
	      Ports		      [2, 1]
	      Position		      [395, 57, 425, 88]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product6"
	      Ports		      [2, 1]
	      Position		      [295, 232, 325, 263]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product7"
	      Ports		      [2, 1]
	      Position		      [395, 242, 425, 273]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [245, 142, 275, 173]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation 1-11"
	      Position		      [135, 135, 165, 165]
	      UpperLimit	      "11"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation4"
	      Position		      [565, 145, 595, 175]
	      UpperLimit	      "max(fc_max_trq*fc_trq_scale)"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [505, 145, 535, 175]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [135, 257, 180, 283]
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "ICE Torque\ncommand"
	      Position		      [635, 153, 665, 167]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      " "
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation 1-11"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, -60]
		DstBlock		" "
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      " "
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Product4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product4"
	      SrcPort		      1
	      DstBlock		      "Product5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Product5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From Input \nscaling"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Product4"
		DstPort			1
	      }
	      Branch {
		Points			[0, 245]
		Branch {
		  Points		  [0, 30; 335, 0]
		  DstBlock		  " 2"
		  DstPort		  2
		}
		Branch {
		  Points		  [120, 0]
		  DstBlock		  " 3"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "delta alpha\n"
	      SrcPort		      1
	      Points		      [35, 0]
	      Branch {
		Points			[0, 60]
		DstBlock		" 1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Saturation 1-11"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      " 1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " 1"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Product6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 3"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Product6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product6"
	      SrcPort		      1
	      DstBlock		      "Product7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Product7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product5"
	      SrcPort		      1
	      Points		      [60, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " 2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Product7"
	      SrcPort		      1
	      DstBlock		      " 2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Saturation4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation4"
	      SrcPort		      1
	      DstBlock		      "ICE Torque\ncommand"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From5"
	      SrcPort		      1
	      DstBlock		      "max_torque lookup"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      DstBlock		      " 3"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [274, 15]
	      Text		      "OUTPUT SCALING"
	      FontName		      "Arial"
	      FontSize		      12
	      FontWeight	      "bold"
	    }
	  }
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace4"
	  Position		  [185, 150, 265, 170]
	  VariableName		  "cs_trq_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace5"
	  Position		  [185, 190, 265, 210]
	  VariableName		  "cs_spd_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "help"
	  Ports			  []
	  Position		  [746, 229, 777, 272]
	  BackgroundColor	  "yellow"
	  DropShadow		  on
	  ShowName		  off
	  OpenFcn		  "web(['file:\\\\\\' which('fuzzy_logic.htm')"
"]);"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "image(imread('doc_man.jpg'))"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "help"
	    Location		    [203, 331, 569, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	  }
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [800, 128, 830, 142]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "Output scaling"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Mux"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Fuzzy logic Code"
	  SrcPort		  1
	  DstBlock		  "Output scaling"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Input Scaling"
	  SrcPort		  1
	  DstBlock		  "Fuzzy logic Code"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Input Scaling"
	  SrcPort		  2
	  DstBlock		  "Fuzzy logic Code"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  DstBlock		  "Demux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  2
	  Points		  [15, 0; 0, 20]
	  Branch {
	    DstBlock		    "To Workspace5"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 30; 570, 0]
	    DstBlock		    "Mux"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    DstBlock		    "To Workspace4"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -35]
	    DstBlock		    "Input Scaling"
	    DstPort		    1
	  }
	}
	Annotation {
	  Position		  [434, 25]
	  Text			  "FUZZY CONTROL BLOCK"
	  FontName		  "Arial"
	  FontSize		  12
	  FontWeight		  "bold"
	}
	Annotation {
	  Position		  [448, 222]
	  Text			  "Speed is directly fed through"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "Fuzzy Logic\ncontrol strategy\nwith Emissions\n"
"<cs>"
      Ports		      [1, 1]
      Position		      [685, 542, 735, 578]
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_fuzzy.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"Fuzzy Logic\ncontrol strategy\nwith Emissions"
"\n<cs>"
	Location		[76, 152, 958, 550]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"93"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [35, 160, 65, 180]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Block NOTES"
	  Ports			  []
	  Position		  [791, 283, 846, 325]
	  BackgroundColor	  "green"
	  ShowName		  off
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "disp('Block\\nNOTES')"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "Block NOTES"
	    Location		    [441, 524, 976, 709]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Annotation {
	      Position		      [269, 87]
	      Text		      "The Fuzzy Control Block takes in the to"
"rque and speed requested by the clutch (sink) and calculates \nthe torque spl"
"it between the ICE and the Motor. The fuzzy logic algorithm sets a base (opti"
"mal) \noperating point of the ICE and modifies the actual operating point abo"
"ut the optimal, based on \nthe actual torque request and the battery State of"
" Charge (SOC). Finally, a torque request is sent to the \nICE and the motor b"
"uffers the remaining torque (positive or negative)."
	    }
	  }
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux"
	  Ports			  [1, 2]
	  Position		  [100, 152, 135, 188]
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Fuzzy logic Code"
	  Ports			  [2, 1]
	  Position		  [420, 90, 490, 150]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Fuzzy logic Code"
	    Location		    [342, 492, 922, 680]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "Torque"
	      Position		      [35, 63, 65, 77]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "SoC"
	      Position		      [35, 103, 65, 117]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [495, 110, 551, 150]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[202, 191, 682, 359]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [243, 53]
		  Text			  "This block calls the Fuzzy Controll"
"er through the Matlab-Function module. \nThe Fuzzy Control algorithm is writt"
"en in MATLAB script. This makes it easy \nfor the user to edit the fuzzy algo"
"rithm and make changes.\n\nFor more information on Matlab-functions, please r"
"efer to the MATLAB help files."
		}
	      }
	    }
	    Block {
	      BlockType		      MATLABFcn
	      Name		      "MATLAB Fcn\nGPS\n"
	      Position		      [295, 75, 355, 105]
	      MATLABFcn		      "mfuzzy_emissions(u(1),u(2))"
	      OutputDimensions	      "1"
	      OutputSignalType	      "auto"
	      Output1D		      on
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [185, 52, 225, 128]
	      Inputs		      "2"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "delta \nalpha"
	      Position		      [405, 83, 435, 97]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "MATLAB Fcn\nGPS\n"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Torque"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MATLAB Fcn\nGPS\n"
	      SrcPort		      1
	      DstBlock		      "delta \nalpha"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "SoC"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Annotation {
	      Position		      [316, 24]
	      Text		      "FUZZY LOGIC CODE"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Input Scaling"
	  Ports			  [1, 1]
	  Position		  [255, 74, 330, 136]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Input Scaling"
	    Location		    [24, 214, 1036, 662]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "Torque required"
	      Position		      [45, 73, 75, 87]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 2"
	      Ports		      [2, 1]
	      Position		      [890, 81, 905, 114]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 3"
	      Ports		      [2, 1]
	      Position		      [715, 226, 730, 259]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 5"
	      Ports		      [2, 1]
	      Position		      [895, 246, 910, 279]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 6"
	      Ports		      [2, 1]
	      Position		      [745, 116, 760, 149]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 7"
	      Ports		      [3, 1]
	      Position		      [710, 333, 725, 367]
	      IconShape		      "rectangular"
	      Inputs		      "++-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [945, 315, 1001, 355]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[441, 351, 1027, 840]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [288, 123]
		  Text			  "In this block, inputs to the Fuzzy "
"Logic controller are computed. The Current torque demand on the ICE \nand the"
" SoC are input as 2 scaled variables to the fuzzy controller. Both inputs are"
" scaled from 1 to 11.\n\nFor SoC, a value of cs_lo_soc would correspond to 1 "
"and a value of cs_hi_soc would correspond to 11, \nlinearly interpolating bet"
"ween them.\n\nFor the ICE Torque, any torque demand less than the target ICE "
"torque would scale from 1 to 6. Any torque \ndemand greater than the target I"
"CE torque would scale from 6 to 11 (the 2 being piecewise linear).\n\n\n\n"
		}
		Annotation {
		  Position		  [277, 29]
		  Text			  "INPUT SCALING"
		}
		Annotation {
		  Position		  [277, 214]
		  Text			  "TARGET TORQUE COMPUTATION"
		}
		Annotation {
		  Position		  [288, 312]
		  Text			  "The target (optimal) torque for a p"
"articular speed requested from the ICE is calculated using a weighted average"
" of \nthe efficiency and emissions data for a particular speed in considerati"
"on. \n\nThe calculation of the target torque involves calculating the minimum"
" of a cost function. The competing quantities \nof the cost function include "
"the emissions and fuel economy for all torques at that speed, weighed by thei"
"r \nrespective weights. \n\nThe relative importance for the competing quantit"
"ies (weights) are changed during the simulation, \nto reflect changes in driv"
"ing conditions. For example, during a cold start, emissions are given higher "
"priority. Also,\nif the electric motor has been reaching it's maximum assist "
"capability in the wake of the torque request not being met,\nthen emissions a"
"re sacrificed for higher torque from the ICE.\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [695, 85, 720, 105]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [830, 95, 855, 115]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [715, 282, 735, 298]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [835, 260, 860, 280]
	      Value		      "6"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [615, 342, 670, 358]
	      Value		      "10e4*eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "Current  \nEngine speed\nfrom <fc>\n(ra"
"d/s)\n"
	      Position		      [20, 288, 105, 312]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "engine_rpm"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>"
	      Position		      [70, 141, 140, 159]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_clt_tmp"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<mc>/enforce torque limit"
	      Position		      [75, 235, 175, 255]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "mc_trq_limited"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [140, 173, 170, 197]
	      Gain		      "vc_fc_warm_tmp_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Goto
	      Name		      "Goto Output Scaling"
	      Position		      [720, 191, 760, 209]
	      GotoTag		      "FLC1"
	      TagVisibility	      "global"
	    }
	    Block {
	      BlockType		      MATLABFcn
	      Name		      "MATLAB Fcn\nTarget torque"
	      Position		      [470, 165, 530, 195]
	      MATLABFcn		      "fuzzy_target_compute_emissions(u(1),u(2"
"),u(3))"
	      OutputDimensions	      "1"
	      OutputSignalType	      "auto"
	      Output1D		      on
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [320, 230, 350, 260]
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [415, 148, 445, 222]
	      FontName		      "Arial"
	      Inputs		      "3"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product8"
	      Ports		      [3, 1]
	      Position		      [780, 74, 810, 106]
	      Inputs		      "**/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [795, 157, 825, 188]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [190, 144, 215, 171]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation\n1-11 "
	      Position		      [1025, 160, 1055, 190]
	      UpperLimit	      "11"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [970, 160, 1000, 190]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace4"
	      Position		      [570, 244, 665, 266]
	      VariableName	      "flc_opt_trq"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace5"
	      Position		      [570, 284, 665, 306]
	      VariableName	      "flc_max_trq"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "epsilon"
	      Position		      [690, 122, 720, 138]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [140, 334, 190, 376]
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "product"
	      Ports		      [3, 1]
	      Position		      [785, 239, 815, 271]
	      Inputs		      "**/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "thermostat\nsetting"
	      Position		      [75, 177, 125, 193]
	      Value		      "fc_tstat"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Torque"
	      Position		      [1085, 168, 1115, 182]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Saturation\n1-11 "
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 7"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "product"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      " 6"
	      SrcPort		      1
	      DstBlock		      "Product8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "epsilon"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      " 6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      DstBlock		      " 7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "Product8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation\n1-11 "
	      SrcPort		      1
	      DstBlock		      "Torque"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 5"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "product"
	      SrcPort		      1
	      DstBlock		      " 5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      DstBlock		      " 5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [15, 0; 0, -35]
	      DstBlock		      "product"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " 3"
	      SrcPort		      1
	      DstBlock		      "product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 2"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      " 2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product8"
	      SrcPort		      1
	      DstBlock		      " 2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "MATLAB Fcn\nTarget torque"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 75]
		DstBlock		"To Workspace4"
		DstPort			1
	      }
	      Branch {
		Points			[145, 0]
		Branch {
		  Points		  [0, 70]
		  Branch {
		    Points		    [0, 110]
		    DstBlock		    " 7"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    " 3"
		    DstPort		    2
		  }
		}
		Branch {
		  Points		  [15, 0]
		  Branch {
		    Points		    [30, 0]
		    Branch {
		    DstBlock		    " 6"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [0, 20]
		    DstBlock		    "Goto Output Scaling"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Line {
	      Labels		      [1, 0]
	      SrcBlock		      "Current  \nEngine speed\nfrom <fc>\n(ra"
"d/s)\n"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"max_torque lookup"
		DstPort			1
	      }
	      Branch {
		Points			[255, 0; 0, -90]
		DstBlock		"Mux"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [0, -5]
	      DstBlock		      "MATLAB Fcn\nTarget torque"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      Points		      [360, 0]
	      Branch {
		Points			[140, 0]
		DstBlock		" 7"
		DstPort			1
	      }
	      Branch {
		DstBlock		"To Workspace5"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Torque required"
	      SrcPort		      1
	      Points		      [505, 0]
	      Branch {
		Points			[0, 85]
		Branch {
		  Points		  [0, 70]
		  DstBlock		  " 3"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "Relational\nOperator"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"Product8"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "From<mc>/enforce torque limit"
	      SrcPort		      1
	      DstBlock		      "Memory"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "thermostat\nsetting"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [0, -60]
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Annotation {
	      Position		      [216, 38]
	      Text		      "INPUTS"
	      FontName		      "Arial"
	      FontSize		      14
	      FontWeight	      "bold"
	    }
	    Annotation {
	      Position		      [782, 37]
	      Text		      "INPUT SCALING"
	      FontName		      "Arial"
	      FontSize		      14
	      FontWeight	      "bold"
	    }
	    Annotation {
	      Position		      [267, 149]
	      Text		      "Engine COLD"
	    }
	    Annotation {
	      Position		      [248, 226]
	      Text		      "Motor Max \nTorque reached"
	    }
	    Annotation {
	      Position		      [223, 291]
	      Text		      "engine speed"
	    }
	  }
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux"
	  Ports			  [2, 1]
	  Position		  [755, 112, 790, 148]
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Output scaling"
	  Ports			  [1, 1]
	  Position		  [550, 88, 625, 152]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Output scaling"
	    Location		    [258, 313, 960, 721]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "delta alpha\n"
	      Position		      [40, 143, 70, 157]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " "
	      Ports		      [2, 1]
	      Position		      [240, 81, 255, 114]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 1"
	      Ports		      [2, 1]
	      Position		      [240, 201, 255, 234]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 2"
	      Ports		      [2, 1]
	      Position		      [455, 251, 470, 284]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      " 3"
	      Ports		      [2, 1]
	      Position		      [240, 261, 255, 294]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [586, 278, 641, 320]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[431, 284, 966, 469]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [269, 92]
		  Text			  "OUTPUT SCALING\nThis bock scales th"
"e outputs of the controller to match the size of the components.\nThe scaling"
" affects the way control signal is fed into the actuators. The scaling is don"
"e based \non the membership functions of the Fuzzy Control block. \n\nHere:\n"
" DELTA ALPHA is scaled from 1 to 11, 1 representing zero torque, 6 representi"
"ng target Torque \nand 11 representing Max ICE torque. (the 2 regions being p"
"iecewise linear).\n\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [190, 155, 215, 175]
	      Value		      "6"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [195, 95, 220, 115]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [340, 70, 365, 90]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [195, 215, 220, 235]
	      Value		      "6"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [340, 255, 365, 275]
	      Value		      "5"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From Input \nscaling"
	      Position		      [30, 40, 90, 70]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "FLC1"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From5"
	      Position		      [20, 255, 90, 285]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "engine_rpm"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product4"
	      Ports		      [2, 1]
	      Position		      [295, 47, 325, 78]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product5"
	      Ports		      [2, 1]
	      Position		      [395, 57, 425, 88]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product6"
	      Ports		      [2, 1]
	      Position		      [295, 232, 325, 263]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product7"
	      Ports		      [2, 1]
	      Position		      [395, 242, 425, 273]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [245, 142, 275, 173]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation 1-11"
	      Position		      [135, 135, 165, 165]
	      UpperLimit	      "11"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation4"
	      Position		      [565, 145, 595, 175]
	      UpperLimit	      "max(fc_max_trq*fc_trq_scale)"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [505, 145, 535, 175]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [135, 257, 180, 283]
	      InputValues	      "fc_map_spd*fc_spd_scale"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "ICE Torque\ncommand"
	      Position		      [635, 153, 665, 167]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      DstBlock		      " 3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From5"
	      SrcPort		      1
	      DstBlock		      "max_torque lookup"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation4"
	      SrcPort		      1
	      DstBlock		      "ICE Torque\ncommand"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Saturation4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product7"
	      SrcPort		      1
	      DstBlock		      " 2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product5"
	      SrcPort		      1
	      Points		      [60, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Product7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product6"
	      SrcPort		      1
	      DstBlock		      "Product7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " 3"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Product6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " 1"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Product6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      " 1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "delta alpha\n"
	      SrcPort		      1
	      Points		      [35, 0]
	      Branch {
		DstBlock		"Saturation 1-11"
		DstPort			1
	      }
	      Branch {
		Points			[0, 60]
		DstBlock		" 1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "From Input \nscaling"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 245]
		Branch {
		  Points		  [120, 0]
		  DstBlock		  " 3"
		  DstPort		  2
		}
		Branch {
		  Points		  [0, 30; 335, 0]
		  DstBlock		  " 2"
		  DstPort		  2
		}
	      }
	      Branch {
		DstBlock		"Product4"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Product5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product4"
	      SrcPort		      1
	      DstBlock		      "Product5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      " "
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Product4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation 1-11"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -60]
		DstBlock		" "
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      " "
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Annotation {
	      Position		      [274, 15]
	      Text		      "OUTPUT SCALING"
	      FontName		      "Arial"
	      FontSize		      12
	      FontWeight	      "bold"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "SoC "
	  Ports			  [0, 1]
	  Position		  [340, 174, 390, 216]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "SoC "
	    Location		    [383, 84, 1066, 398]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [505, 225, 561, 265]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[216, 177, 696, 345]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [243, 63]
		  Text			  "This block scales the battery SOC s"
"o as to feed it into the Fuzzy controller.\n1 represents the lower limit of a"
"llowable battery SOC while 11 represents the higher\nlimit of allowable batte"
"ry SOC."
		}
	      }
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [3, 1]
	      Position		      [415, 106, 430, 194]
	      ShowName		      off
	      Inputs		      "3"
	      DisplayOption	      "bar"
	    }
	    Block {
	      BlockType		      From
	      Name		      "SOC\nfrom <ess>"
	      Position		      [150, 68, 210, 102]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation\n1-11"
	      Position		      [570, 135, 600, 165]
	      UpperLimit	      "11"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "SoC scaling function\n1-11"
	      Position		      [470, 135, 530, 165]
	      Expr		      "10*(u(1)-u(2))/(u(2)-u(3))+11"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "default = 0.45"
	      Position		      [140, 185, 215, 205]
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "default = 0.55"
	      Position		      [140, 140, 215, 160]
	      Value		      "cs_hi_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "SoC"
	      Position		      [625, 143, 655, 157]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "SoC scaling function\n1-11"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "SOC\nfrom <ess>"
	      SrcPort		      1
	      Points		      [185, 0]
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "default = 0.55"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "default = 0.45"
	      SrcPort		      1
	      Points		      [180, 0]
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "SoC scaling function\n1-11"
	      SrcPort		      1
	      DstBlock		      "Saturation\n1-11"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation\n1-11"
	      SrcPort		      1
	      DstBlock		      "SoC"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [365, 107]
	      Text		      "soc"
	    }
	    Annotation {
	      Position		      [376, 136]
	      Text		      "cs_hi_soc"
	    }
	    Annotation {
	      Position		      [368, 181]
	      Text		      "cs_lo_soc"
	    }
	    Annotation {
	      Position		      [290, 231]
	      Text		      "BASE SOC LIMITS\nHigh= 0. 55\nLow  = 0."
"45"
	    }
	  }
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace4"
	  Position		  [185, 245, 265, 265]
	  VariableName		  "cs_trq_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace5"
	  Position		  [185, 290, 265, 310]
	  VariableName		  "cs_spd_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [825, 123, 855, 137]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "Fuzzy logic Code"
	  SrcPort		  1
	  DstBlock		  "Output scaling"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Input Scaling"
	  SrcPort		  1
	  DstBlock		  "Fuzzy logic Code"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  DstBlock		  "Demux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  2
	  Points		  [5, 0; 0, 120]
	  Branch {
	    DstBlock		    "To Workspace5"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 40; 595, 0]
	    DstBlock		    "Mux"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  1
	  Points		  [30, 0]
	  Branch {
	    DstBlock		    "To Workspace4"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -55]
	    DstBlock		    "Input Scaling"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Mux"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "SoC "
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "Fuzzy logic Code"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Output scaling"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  1
	}
	Annotation {
	  Position		  [434, 25]
	  Text			  "FUZZY CONTROL BLOCK"
	  FontName		  "Arial"
	  FontSize		  12
	  FontWeight		  "bold"
	}
	Annotation {
	  Position		  [448, 312]
	  Text			  "Speed is directly fed through"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "Insight electric assist\ncontrol strategy\n<cs>"
" DIRECT SPLIT"
      Ports		      [1, 2]
      Position		      [215, 335, 245, 370]
      BackgroundColor	      "yellow"
      AncestorBlock	      "lib_controls/Insight electric assist\ncontrol s"
"trategy\n<cs> DIRECT SPLIT"
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"Insight electric assist\ncontrol strategy\n<c"
"s> DIRECT SPLIT"
	Location		[5, 80, 1010, 561]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	212
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"61"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [60, 173, 90, 187]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "1st gear ?"
	  Ports			  [2, 1]
	  Position		  [440, 97, 485, 133]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "1st gear ?"
	    Location		    [225, 328, 890, 683]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In 1"
	      Position		      [50, 303, 80, 317]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "In 2"
	      Position		      [45, 28, 75, 42]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [120, 243, 145, 267]
	      Value		      "125"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [95, 134, 115, 156]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [30, 90, 120, 120]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "gear_number"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [20, 225, 110, 255]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "cs_trq_in_r"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [290, 142, 320, 173]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [145, 97, 175, 128]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [175, 232, 205, 263]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch11"
	      Position		      [365, 145, 395, 175]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [425, 153, 455, 167]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "In 2"
	      SrcPort		      1
	      Points		      [270, 0]
	      DstBlock		      "Switch11"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "In 1"
	      SrcPort		      1
	      Points		      [265, 0]
	      DstBlock		      "Switch11"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch11"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      Points		      [40, 0; 0, -85]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch11"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [70, 0; 0, 35]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [213, 104]
	      Text		      "1st Gear"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Alternator\nFunction"
	  Ports			  [2, 2]
	  Position		  [630, 105, 670, 140]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Alternator\nFunction"
	    Location		    [2, 74, 1014, 724]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [50, 193, 80, 207]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "In2"
	      Position		      [55, 473, 85, 487]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [20, 130, 76, 170]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[634, 323, 1223, 566]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [287, 128]
		  Text			  "ALTERNATOR FUNCTION\nIn the HONDA I"
"nsight, there is no separate alternator for the vehicle in the powertrain\nto"
" supply power for the accessory loads. The main electric motor is the alterna"
"tor for the vehicle. \nThus, it always produces a small negative torque for d"
"riving the accessory loads.  But the electric\nmotor has to take into account"
", the component efficiencies, and thus, is forced\nto regenerate a little mor"
"e than the accessory load.\n\nDuring assist, the battery pack supplies the el"
"ectrical accessory loads.\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [375, 95, 400, 115]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [545, 245, 570, 265]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [730, 70, 755, 90]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [25, 250, 140, 270]
	      BackgroundColor	      "cyan"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "acc_elec_pwr_est"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <fc>\nEngine speed\nin rad/s"
	      Position		      [25, 300, 115, 330]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "engine_rpm"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [535, 215, 650, 235]
	      BackgroundColor	      "cyan"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "acc_elec_pwr_est"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [210, 247, 230, 303]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [755, 282, 775, 338]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [455, 82, 485, 113]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [790, 57, 820, 88]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum2"
	      Ports		      [2, 1]
	      Position		      [320, 239, 335, 286]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum3"
	      Ports		      [2, 1]
	      Position		      [805, 239, 820, 286]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum4"
	      Ports		      [2, 1]
	      Position		      [610, 279, 625, 326]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum5"
	      Ports		      [2, 1]
	      Position		      [670, 269, 685, 316]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum7"
	      Ports		      [2, 1]
	      Position		      [890, 469, 905, 516]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "--"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [545, 285, 575, 315]
	      ShowName		      off
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch8"
	      Position		      [880, 115, 910, 145]
	      ShowName		      off
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Lookup2D
	      Name		      "motor/controller\ninput power\nmap (W)"
"\nonly base torque"
	      Position		      [425, 225, 485, 265]
	      RowIndex		      "mc_map_spd*mc_spd_scale"
	      ColumnIndex	      "mc_map_trq*mc_trq_scale"
	      OutputValues	      "mc_inpwr_map*mc_spd_scale*mc_trq_scale"
	    }
	    Block {
	      BlockType		      Lookup2D
	      Name		      "motor/controller\ninput power\nmap (W)"
"\nwith REGEN"
	      Position		      [430, 365, 490, 405]
	      RowIndex		      "mc_map_spd*mc_spd_scale"
	      ColumnIndex	      "mc_map_trq*mc_trq_scale"
	      OutputValues	      "mc_inpwr_map*mc_spd_scale*mc_trq_scale"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "prevent \ndivide by zero\nerror"
	      Position		      [135, 300, 165, 330]
	      UpperLimit	      "max(fc_spd_scale*fc_map_spd)"
	      LowerLimit	      "vc_idle_spd"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "prevent \ndivide by zero\nerror2"
	      Position		      [250, 465, 280, 495]
	      UpperLimit	      "max(fc_spd_scale*fc_map_spd)"
	      LowerLimit	      "vc_idle_spd"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "saturation"
	      Position		      [705, 280, 735, 310]
	      UpperLimit	      "inf"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Motor torque"
	      Position		      [955, 123, 985, 137]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "alternator torque"
	      Position		      [955, 488, 985, 502]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "Switch8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "prevent \ndivide by zero\nerror2"
	      SrcPort		      1
	      Points		      [0, 0; 105, 0]
	      Branch {
		Points			[350, 0]
		DstBlock		"Product1"
		DstPort			2
	      }
	      Branch {
		Points			[0, -105]
		Branch {
		  Points		  [0, -140]
		  DstBlock		  "motor/controller\ninput power\nmap "
"(W)\nonly base torque"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "motor/controller\ninput power\nmap "
"(W)\nwith REGEN"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Sum5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "In2"
	      SrcPort		      1
	      DstBlock		      "prevent \ndivide by zero\nerror2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum2"
	      SrcPort		      1
	      Points		      [0, 0; 10, 0]
	      Branch {
		Points			[0, 130]
		DstBlock		"motor/controller\ninput power\nmap (W"
")\nwith REGEN"
		DstPort			2
	      }
	      Branch {
		Points			[0, -60; 440, 0]
		DstBlock		"Sum3"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      Points		      [0, 0; 215, 0]
	      Branch {
		Points			[110, 0]
		DstBlock		"motor/controller\ninput power\nmap (W"
")\nonly base torque"
		DstPort			2
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"Sum2"
		DstPort			1
	      }
	      Branch {
		Points			[0, -110]
		Branch {
		  Points		  [0, -25; 380, 0]
		  Branch {
		    Points		    [0, 55]
		    DstBlock		    "Switch8"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator6"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Sum5"
	      SrcPort		      1
	      DstBlock		      "saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "saturation"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "motor/controller\ninput power\nmap (W)"
"\nwith REGEN"
	      SrcPort		      1
	      Points		      [100, 0]
	      DstBlock		      "Sum4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum4"
	      SrcPort		      1
	      DstBlock		      "Sum5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "prevent \ndivide by zero\nerror"
	      SrcPort		      1
	      Points		      [20, 0; 0, -25]
	      DstBlock		      "Product"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <fc>\nEngine speed\nin rad/s"
	      SrcPort		      1
	      DstBlock		      "prevent \ndivide by zero\nerror"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch8"
	      SrcPort		      1
	      DstBlock		      "Motor torque"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [0, 0; 70, 0]
	      Branch {
		DstBlock		"Sum2"
		DstPort			2
	      }
	      Branch {
		Points			[0, 230]
		DstBlock		"Sum7"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Sum7"
	      SrcPort		      1
	      DstBlock		      "alternator torque"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum3"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "Switch8"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [0, 0; 10, 0]
	      Branch {
		DstBlock		"Sum3"
		DstPort			2
	      }
	      Branch {
		Points			[0, 170]
		DstBlock		"Sum7"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [20, 0; 0, 200]
	      DstBlock		      "Switch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "motor/controller\ninput power\nmap (W)"
"\nonly base torque"
	      SrcPort		      1
	      Points		      [15, 0; 0, 65]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-20, 0; 0, 35]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum4"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [136, 472]
	      Text		      "current speed (rad/s)"
	    }
	    Annotation {
	      Position		      [152, 180]
	      Text		      "Torque request"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Block NOTES"
	  Ports			  []
	  Position		  [1180, 335, 1236, 375]
	  BackgroundColor	  "green"
	  ShowName		  off
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "disp('Block\\nNOTES')"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "Block NOTES"
	    Location		    [630, 327, 1219, 570]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Annotation {
	      Position		      [287, 128]
	      Text		      "HONDA INSIGHT TORQUE SPLIT CONTROL STRA"
"TEGY\n\nThe Honda Insight Control Startegy is modeled in this block. The Inpu"
"t is the Torque and speed\nrequired into the clutch. The electric motor torqu"
"e contibution is then calculated based on the \nfollowing parameters:\n1. Acc"
"eleration torque \n2. Deceleration torque\n3. 1st gear selection\n4. Vehicle "
"speed\netc...\n\nThe electric motor is also the alternator in the vehicle. Th"
"us, it produces the power required by the \naccessory loads. The remaining is"
" then demanded from the IC Engine. The 2 signals are then\nsent to the respec"
"tive blocks in the INSIGHT Model."
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Clutch Engaged ?"
	  Ports			  [2, 1]
	  Position		  [740, 106, 780, 139]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Clutch Engaged ?"
	    Location		    [651, 588, 1230, 926]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [90, 13, 120, 27]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "In2"
	      Position		      [90, 173, 120, 187]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [105, 90, 135, 120]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [110, 265, 140, 295]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [335, 250, 365, 280]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <gb>4"
	      Position		      [25, 214, 115, 236]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "engine_on"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From2"
	      Position		      [25, 50, 115, 80]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "clutch_state"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [1, 1]
	      Position		      [240, 59, 270, 91]
	      Operator		      "NOT"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [180, 57, 210, 88]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [180, 217, 210, 248]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [460, 60, 490, 90]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [400, 220, 430, 250]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [515, 68, 545, 82]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [20, 0; 0, -25]
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "In2"
	      SrcPort		      1
	      Points		      [260, 0]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <gb>4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      Points		      [320, 0]
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [314, 90]
	      Text		      "clutch not \ndisengaged"
	    }
	    Annotation {
	      Position		      [397, 108]
	      Text		      "Any torque\n requested from\nElectric M"
"otor\nonly when \nclutch engaged"
	    }
	  }
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant7"
	  Position		  [1100, 175, 1120, 195]
	  Orientation		  "up"
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux"
	  Ports			  [1, 2]
	  Position		  [120, 162, 155, 198]
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc>"
	  Position		  [1015, 165, 1085, 185]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc>\nEngine Speed control"
	  Position		  [965, 250, 1060, 280]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "spd_command"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [235, 350, 305, 380]
	  GotoTag		  "cs_trq_in_r"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Hard Acceleration"
	  Ports			  [2, 1]
	  Position		  [340, 66, 380, 99]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Hard Acceleration"
	    Location		    [194, 170, 994, 643]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    212
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "93"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [55, 313, 85, 327]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "In2"
	      Position		      [50, 473, 80, 487]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [175, 158, 200, 182]
	      Value		      "125"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [355, 96, 465, 124]
	      ShowName		      off
	      Value		      "6000*mc_trq_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [370, 69, 540, 91]
	      ShowName		      off
	      Value		      "max(mc_max_trq)*mc_trq_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [110, 325, 245, 345]
	      Value		      "cs_dl_assist_trq_threshold"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [230, 413, 255, 437]
	      Value		      ".3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Define the Assist\nCharacteristics"
	      Position		      [335, 225, 395, 255]
	      Expr		      "cs_mc_assist_slope*(u-cs_dl_assist_trq_"
"threshold)+ (cs_mc_assist_min_frac*max(mc_max_trq*mc_trq_scale))"
	    }
	    Block {
	      BlockType		      Derivative
	      Name		      "Derivative"
	      Position		      [150, 385, 180, 415]
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [35, 385, 125, 415]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [195, 114, 285, 136]
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "fc_spd_est"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [455, 321, 485, 354]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [575, 97, 605, 128]
	      ShowName		      off
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [495, 101, 540, 134]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [230, 147, 260, 178]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [305, 312, 335, 343]
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [280, 392, 310, 423]
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturate motor torque\nat approx 32% ma"
"x trq"
	      Position		      [455, 225, 485, 255]
	      UpperLimit	      "max(mc_max_trq*mc_trq_scale)*cs_mc_assi"
"st_max_frac"
	      LowerLimit	      "min(mc_max_gen_trq*mc_trq_scale)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch10"
	      Position		      [565, 325, 595, 355]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [635, 150, 665, 180]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "filter from\ndivide by zero \nor negati"
"ve\n"
	      Ports		      [1, 1]
	      Position		      [310, 113, 340, 137]
	      SourceBlock	      "lib_etc/filter from\ndivide by zero \no"
"r negative\n"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [690, 158, 720, 172]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Derivative"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch10"
	      SrcPort		      1
	      Points		      [10, 0; 0, -165]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "In2"
	      SrcPort		      1
	      Points		      [465, 0]
	      DstBlock		      "Switch10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      Points		      [125, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Define the Assist\nCharacteristics"
	      SrcPort		      1
	      DstBlock		      "Saturate motor torque\nat approx 32% ma"
"x trq"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturate motor torque\nat approx 32% ma"
"x trq"
	      SrcPort		      1
	      Points		      [40, 0; 0, 90]
	      DstBlock		      "Switch10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      Points		      [0, 0; 65, 0]
	      Branch {
		DstBlock		"Relational\nOperator5"
		DstPort			1
	      }
	      Branch {
		Points			[0, -80]
		Branch {
		  DstBlock		  "Define the Assist\nCharacteristics"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, -85]
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Derivative"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "filter from\ndivide by zero \nor negati"
"ve\n"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "filter from\ndivide by zero \nor negati"
"ve\n"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [0, 40]
	      DstBlock		      "Switch2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [0, 25]
	      DstBlock		      "MinMax"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [367, 400]
	      Text		      "Transient = 1"
	    }
	    Annotation {
	      Position		      [379, 328]
	      Text		      "moderate\naccn"
	    }
	    Annotation {
	      Position		      [662, 55]
	      Text		      "Insight max. effort Torque from motor\n"
"will be the minimum between\n{6000 W/shaft_speed} Nm AND\nthe maximum output "
"torque of motor (Nm)"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Hard Deceleration"
	  Ports			  [1, 1]
	  Position		  [225, 108, 265, 142]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Hard Deceleration"
	    Location		    [86, 439, 782, 899]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [15, 153, 45, 167]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [65, 166, 190, 184]
	      Value		      "cs_dl_regen_trq_threshold"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [80, 336, 205, 354]
	      Value		      "cs_dl_regen_trq_threshold"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [175, 270, 200, 290]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [365, 365, 390, 385]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Define regenerative \ncapabilities"
	      Position		      [210, 70, 270, 100]
	      Expr		      "(u-cs_dl_regen_trq_threshold)*cs_mc_reg"
"en_slope + (cs_mc_regen_min_frac*min(mc_max_gen_trq*mc_trq_scale))"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [305, 281, 335, 319]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [215, 152, 245, 183]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [235, 242, 265, 273]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [235, 322, 265, 353]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturate motor torque\nat 100% max rege"
"n trq"
	      Position		      [360, 70, 390, 100]
	      UpperLimit	      "max(mc_max_trq*mc_trq_scale)"
	      LowerLimit	      "min(mc_max_gen_trq*mc_trq_scale)*cs_mc_"
"regen_max_frac"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch10"
	      Position		      [430, 285, 460, 315]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch9"
	      Position		      [495, 155, 525, 185]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [565, 163, 595, 177]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Saturate motor torque\nat 100% max rege"
"n trq"
	      SrcPort		      1
	      Points		      [85, 0]
	      DstBlock		      "Switch9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Define regenerative \ncapabilities"
	      SrcPort		      1
	      DstBlock		      "Saturate motor torque\nat 100% max rege"
"n trq"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[35, 0]
		Branch {
		  Points		  [0, -75]
		  DstBlock		  "Define regenerative \ncapabilities"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "Relational\nOperator3"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 70]
		Branch {
		  Points		  [0, 20]
		  Branch {
		    DstBlock		    "Relational\nOperator4"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 80]
		    DstBlock		    "Relational\nOperator5"
		    DstPort		    1
		  }
		}
		Branch {
		  Points		  [360, 0]
		  DstBlock		  "Switch10"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Switch9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch9"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch10"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch10"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch10"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Switch9"
	      DstPort		      3
	    }
	    Annotation {
	      Position		      [363, 163]
	      Text		      "heavy decel"
	    }
	    Annotation {
	      Position		      [371, 289]
	      Text		      "light decel"
	    }
	  }
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux"
	  Ports			  [2, 1]
	  Position		  [1210, 142, 1245, 178]
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux1"
	  Ports			  [2, 1]
	  Position		  [1215, 237, 1250, 273]
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "No EM activity\nat\nSlow Speed"
	  Ports			  [1, 1]
	  Position		  [525, 99, 565, 131]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "No EM activity\nat\nSlow Speed"
	    Location		    [-13, 274, 673, 640]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [80, 298, 110, 312]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [225, 243, 250, 267]
	      Value		      "125"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [480, 136, 500, 154]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [130, 148, 265, 172]
	      Value		      "cs_decel_regen_threshold"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [55, 95, 145, 125]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "v_req_limited"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From1"
	      Position		      [65, 225, 155, 255]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "cs_trq_in_r"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [425, 167, 455, 198]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [300, 232, 330, 263]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator7"
	      Position		      [310, 102, 340, 133]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [555, 170, 585, 200]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "m/s-->mph"
	      Position		      [180, 96, 230, 124]
	      Gain		      "1/0.447"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [605, 178, 635, 192]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [10, 0; 0, -35]
	      DstBlock		      "Relational\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "m/s-->mph"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "m/s-->mph"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      Points		      [410, 0; 0, -110]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      Points		      [20, 0; 0, 30]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator7"
	      SrcPort		      1
	      Points		      [30, 0; 0, 55]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [35, 0; 0, -60]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Annotation {
	      Position		      [401, 135]
	      Text		      "slow \nspeed"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "SoC Correction"
	  Ports			  [1, 1]
	  Position		  [845, 107, 885, 143]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "SoC Correction"
	    Location		    [505, 77, 1361, 862]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [60, 68, 90, 82]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "16% of peak torque"
	      Position		      [390, 410, 420, 440]
	      UpperLimit	      "0.16*15"
	      LowerLimit	      "min(mc_max_gen_trq*mc_trq_scale)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [740, 660, 796, 700]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[632, 325, 1221, 568]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [287, 128]
		  Text			  "HONDA INSIGHT SoC Correction STRATE"
"GY\n\nIn the HONDA Insight strategy, the electric motor assist is independent"
" on the SoC of the battery pack\nexcept at low and high SoCs. (Based on test "
"results).\n\nAt high SoCs, above 0.8, all regeneration (charging) is stopped."
" At low SoCs, below 0.35 (approx), \nthe assist capacity of the motor is limi"
"ted, and all assist is cut off below an SoC of 0.2.\n\n"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant10"
	      Position		      [285, 336, 320, 354]
	      Value		      "0.235"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [460, 156, 480, 174]
	      Value		      "0.8"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [210, 666, 230, 684]
	      Value		      "0.2"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [210, 477, 245, 493]
	      Value		      "0.235"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [215, 557, 240, 573]
	      Value		      "0.2"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [285, 271, 320, 289]
	      Value		      "0.355"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <gb>"
	      Position		      [45, 138, 115, 162]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "Limited assist"
	      Ports		      [2, 1]
	      Position		      [475, 227, 505, 258]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Low SoC"
	      Ports		      [2, 1]
	      Position		      [465, 286, 495, 319]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Moderately\nlow SoC"
	      Ports		      [2, 1]
	      Position		      [390, 501, 420, 534]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "No Assist"
	      Position		      [295, 605, 325, 635]
	      UpperLimit	      "0"
	      LowerLimit	      "min(mc_max_gen_trq*mc_trq_scale)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [295, 462, 325, 493]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator7"
	      Position		      [295, 542, 325, 573]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator8"
	      Position		      [390, 257, 420, 288]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator9"
	      Position		      [390, 322, 420, 353]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [655, 145, 685, 175]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch5"
	      Position		      [395, 655, 425, 685]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch6"
	      Position		      [485, 505, 515, 535]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch7"
	      Position		      [550, 290, 580, 320]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "Torque limiter"
	      Position		      [270, 195, 330, 225]
	      Expr		      "u*6.88-1.4528"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Very high SoC"
	      Position		      [535, 142, 565, 173]
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Very low SoC"
	      Position		      [295, 652, 325, 683]
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "estimated\npeak torque"
	      Position		      [365, 195, 395, 225]
	      Gain		      "15"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "no regen\nonly assist"
	      Position		      [535, 60, 565, 90]
	      UpperLimit	      "max(mc_max_trq*mc_trq_scale)"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "saturation"
	      Position		      [600, 290, 630, 320]
	      UpperLimit	      "max(mc_max_trq*mc_trq_scale)"
	      LowerLimit	      "min(mc_max_gen_trq*mc_trq_scale)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [730, 153, 760, 167]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      Points		      [160, 0]
	      Branch {
		Points			[0, 175]
		Branch {
		  Points		  [0, 175]
		  Branch {
		    Points		    [0, 195]
		    Branch {
		    Points		    [0, 100; 125, 0]
		    DstBlock		    "Switch5"
		    DstPort		    3
		    }
		    Branch {
		    DstBlock		    "No Assist"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "16% of peak torque"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "Limited assist"
		  DstPort		  2
		}
	      }
	      Branch {
		DstBlock		"no regen\nonly assist"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "16% of peak torque"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Torque limiter"
	      SrcPort		      1
	      DstBlock		      "estimated\npeak torque"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <gb>"
	      SrcPort		      1
	      Points		      [70, 0]
	      Branch {
		Points			[0, 60]
		Branch {
		  DstBlock		  "Torque limiter"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 55]
		  Branch {
		    Points		    [0, 65]
		    Branch {
		    Points		    [0, 140]
		    Branch {
		    Points		    [0, 80]
		    Branch {
		    Points		    [0, 110]
		    DstBlock		    "Very low SoC"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator7"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator6"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "Relational\nOperator9"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator8"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		DstBlock		"Very high SoC"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "No Assist"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Switch5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Very low SoC"
	      SrcPort		      1
	      DstBlock		      "Switch5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Very low SoC"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator7"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Moderately\nlow SoC"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Moderately\nlow SoC"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch5"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "Switch6"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Moderately\nlow SoC"
	      SrcPort		      1
	      DstBlock		      "Switch6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch6"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Switch7"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Low SoC"
	      SrcPort		      1
	      DstBlock		      "Switch7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant10"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "no regen\nonly assist"
	      SrcPort		      1
	      Points		      [70, 0]
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Very high SoC"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      DstBlock		      "Very high SoC"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "estimated\npeak torque"
	      SrcPort		      1
	      Points		      [60, 0]
	      DstBlock		      "Limited assist"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator9"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Low SoC"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator8"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Low SoC"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Limited assist"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Switch7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch7"
	      SrcPort		      1
	      DstBlock		      "saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "saturation"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Annotation {
	      Position		      [319, 727]
	      Text		      "ORIGINAL TORQUE SIGNAL"
	    }
	  }
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [1015, 114, 1030, 161]
	  ShowName		  off
	  IconShape		  "rectangular"
	  Inputs		  "-+"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch7"
	  Position		  [1145, 135, 1175, 165]
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace2"
	  Position		  [225, 247, 295, 273]
	  VariableName		  "cs_trq_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace3"
	  Position		  [225, 292, 295, 318]
	  VariableName		  "cs_spd_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "help"
	  Ports			  []
	  Position		  [1266, 339, 1297, 382]
	  BackgroundColor	  "yellow"
	  DropShadow		  on
	  ShowName		  off
	  OpenFcn		  "web(['file:\\\\\\' which('honda_insight.htm"
"')]);"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "image(imread('doc_man.jpg'))"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "help"
	    Location		    [203, 331, 569, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	  }
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [1275, 153, 1305, 167]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nMOTOR\n(N*m, rad/s"
")"
	  Position		  [1275, 248, 1305, 262]
	  Port			  "2"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "Hard Deceleration"
	  SrcPort		  1
	  Points		  [10, 0]
	  Branch {
	    DstBlock		    "1st gear ?"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [0, -35]
	    DstBlock		    "Hard Acceleration"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  DstBlock		  "Demux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  2
	  Points		  [0, 20; 45, 0]
	  Branch {
	    Points		    [0, 95]
	    DstBlock		    "To Workspace3"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [395, 0]
	    Branch {
	      Points		      [0, -80]
	      DstBlock		      "Alternator\nFunction"
	      DstPort		      2
	    }
	    Branch {
	      Points		      [595, 0]
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	  }
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    Points		    [15, 0]
	    Branch {
	      Points		      [0, 90]
	      DstBlock		      "To Workspace2"
	      DstPort		      1
	    }
	    Branch {
	      Points		      [810, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Branch {
	      Points		      [0, -45]
	      Branch {
		DstBlock		"Hard Deceleration"
		DstPort			1
	      }
	      Branch {
		Points			[0, -50]
		DstBlock		"Hard Acceleration"
		DstPort			1
	      }
	    }
	  }
	  Branch {
	    Points		    [0, 195]
	    DstBlock		    "Goto"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Hard Acceleration"
	  SrcPort		  1
	  Points		  [25, 0; 0, 20]
	  DstBlock		  "1st gear ?"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  DstBlock		  "Switch7"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant7"
	  SrcPort		  1
	  Points		  [0, -10]
	  DstBlock		  "Switch7"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <vc>"
	  SrcPort		  1
	  Points		  [0, -25]
	  DstBlock		  "Switch7"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Mux"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Switch7"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Mux1"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nMOTOR\n(N*m, rad/s"
")"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Alternator\nFunction"
	  SrcPort		  1
	  DstBlock		  "Clutch Engaged ?"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "1st gear ?"
	  SrcPort		  1
	  DstBlock		  "No EM activity\nat\nSlow Speed"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "No EM activity\nat\nSlow Speed"
	  SrcPort		  1
	  DstBlock		  "Alternator\nFunction"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Alternator\nFunction"
	  SrcPort		  2
	  DstBlock		  "Clutch Engaged ?"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <vc>\nEngine Speed control"
	  SrcPort		  1
	  DstBlock		  "Mux1"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Clutch Engaged ?"
	  SrcPort		  1
	  DstBlock		  "SoC Correction"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "SoC Correction"
	  SrcPort		  1
	  Points		  [100, 0]
	  Branch {
	    DstBlock		    "Sum"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 120]
	    DstBlock		    "Mux1"
	    DstPort		    1
	  }
	}
	Annotation {
	  Position		  [1068, 129]
	  Text			  "ICE Torque"
	}
	Annotation {
	  Position		  [957, 179]
	  Text			  "Total Torque"
	}
	Annotation {
	  Position		  [958, 135]
	  Text			  "EM Torque"
	}
	Annotation {
	  Position		  [368, 202]
	  Text			  "Speed is directly fed through"
	}
	Annotation {
	  Position		  [1128, 258]
	  Text			  "Motor Spins at ICE speed"
	}
	Annotation {
	  Position		  [594, 15]
	  Text			  "HONDA INSIGHT CONTROL STRATEGY"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "SubSystem"
      Ports		      []
      Position		      [555, 449, 610, 498]
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      System {
	Name			"SubSystem"
	Location		[190, 107, 1002, 777]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"96"
	Block {
	  BlockType		  From
	  Name			  "From <logic>2"
	  Position		  [50, 394, 155, 426]
	  ForegroundColor	  "red"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_req_limited"
	}
	Block {
	  BlockType		  From
	  Name			  "From <veh>"
	  Position		  [25, 77, 100, 93]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_prev"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>"
	  Position		  [25, 110, 85, 130]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>1"
	  Position		  [25, 41, 110, 59]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>2"
	  Position		  [420, 312, 530, 328]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>3"
	  Position		  [420, 346, 520, 364]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "w_wheel_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>4"
	  Position		  [415, 450, 540, 470]
	  ForegroundColor	  "lightBlue"
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_rear_drivetrain_ach"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>5"
	  Position		  [415, 401, 535, 419]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_rear_brake"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>6"
	  Position		  [435, 270, 495, 290]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From <wh>8"
	  Position		  [30, 266, 115, 284]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "v_ave_req"
	}
	Block {
	  BlockType		  From
	  Name			  "From<wh>4"
	  Position		  [415, 371, 530, 389]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "F_max_front_brake"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto"
	  Position		  [275, 385, 395, 405]
	  NamePlacement		  "alternate"
	  GotoTag		  "spd_dep_muxed"
	  TagVisibility		  "local"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>1"
	  Position		  [230, 74, 320, 96]
	  GotoTag		  "v_req_limited"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>2"
	  Position		  [230, 111, 320, 129]
	  GotoTag		  "wt_front_axle"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>3"
	  Position		  [650, 316, 735, 334]
	  GotoTag		  "F_front_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>4"
	  Position		  [650, 379, 735, 401]
	  GotoTag		  "F_rear_brake"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <wh>5"
	  Position		  [225, 265, 335, 285]
	  GotoTag		  "F_front_brake_req"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto1"
	  Position		  [275, 409, 395, 431]
	  GotoTag		  "spd_dep_gear_num"
	  TagVisibility		  "local"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Speed Dependent Shifting"
	  Ports			  [1, 2]
	  Position		  [200, 382, 230, 433]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Speed Dependent Shifting"
	    Location		    [-16, 76, 971, 726]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "automatic"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "velocity\nrequired\n(limited)\n"
	      Position		      [25, 58, 55, 72]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up\nTable\n(gear for downshift)"
	      Position		      [110, 375, 140, 405]
	      InputValues	      "tx_spd_dep_dnshift(:,1)   % vector of s"
"peeds m/s"
	      OutputValues	      "tx_spd_dep_dnshift(:,2)  % gear number-"
"-must be step function"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "Look-Up\nTable\n(gear for upshift)"
	      Position		      [105, 50, 135, 80]
	      InputValues	      "tx_spd_dep_upshift(:,1)   % vector of s"
"peeds in m/s"
	      OutputValues	      "tx_spd_dep_upshift(:,2)  % gear number-"
"-must be step function"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [405, 102, 440, 138]
	      ForegroundColor	      "red"
	      Inputs		      "2"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux2"
	      Ports		      [2, 1]
	      Position		      [450, 382, 485, 418]
	      ForegroundColor	      "red"
	      Inputs		      "2"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "New gear ratio"
	      Position		      [725, 259, 810, 281]
	      ForegroundColor	      "red"
	      FontName		      "Arial"
	      VariableName	      "new_gear_ratio"
	      MaxDataPoints	      "50000"
	      Decimation	      "1"
	      SampleTime	      "0"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      Rounding
	      Name		      "Rounding\nFunction"
	      Position		      [190, 50, 220, 80]
	      Operator		      "round"
	    }
	    Block {
	      BlockType		      Rounding
	      Name		      "Rounding\nFunction1"
	      Position		      [195, 375, 225, 405]
	      Operator		      "round"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation4"
	      Position		      [280, 56, 300, 74]
	      ForegroundColor	      "red"
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation5"
	      Position		      [285, 381, 305, 399]
	      ForegroundColor	      "red"
	      FontName		      "Arial"
	      UpperLimit	      "gb_gears_num"
	      LowerLimit	      "1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "delta\nspeed\n(\"+\" is acceleration)"
	      Ports		      [2, 1]
	      Position		      [215, 240, 240, 300]
	      ForegroundColor	      "red"
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio6"
	      Position		      [345, 53, 375, 77]
	      ForegroundColor	      "red"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "gear ratio8"
	      Position		      [380, 378, 410, 402]
	      ForegroundColor	      "red"
	      FontName		      "Arial"
	      InputValues	      "[1:length(gb_ratio)]"
	      OutputValues	      "gb_ratio"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "prev veh\nspeed"
	      Position		      [130, 245, 170, 265]
	      ForegroundColor	      "red"
	      NamePlacement	      "alternate"
	      FontName		      "Arial"
	      X0		      "1"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "shifting"
	      Ports		      [1, 1]
	      Position		      [380, 444, 410, 476]
	      SourceBlock	      "lib_controls/SubSystem/shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "shifting1"
	      Ports		      [1, 1]
	      Position		      [350, 114, 380, 146]
	      SourceBlock	      "lib_controls/SubSystem/shifting"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "switch for gear\nnumber"
	      Position		      [580, 160, 610, 190]
	      ForegroundColor	      "red"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "switch for gear ratio\nand shifting (mu"
"xed)"
	      Position		      [580, 255, 610, 285]
	      ForegroundColor	      "red"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "total fuel used (gal)"
	      Position		      [370, 339, 450, 361]
	      ForegroundColor	      "red"
	      NamePlacement	      "alternate"
	      FontName		      "Arial"
	      VariableName	      "neg_gear_num"
	      MaxDataPoints	      "50000"
	      Decimation	      "1"
	      SampleTime	      "0"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear ratio and shifting"
	      Position		      [650, 235, 680, 250]
	      Orientation	      "up"
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "gear number"
	      Position		      [665, 168, 695, 182]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      Labels		      [0, 0]
	      SrcBlock		      "velocity\nrequired\n(limited)\n"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 190]
		Branch {
		  DstBlock		  "prev veh\nspeed"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 30]
		  Branch {
		    DstBlock		    "delta\nspeed\n(\"+\" is accelerat"
"ion)"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 105]
		    DstBlock		    "Look-Up\nTable\n(gear for downshi"
"ft)"
		    DstPort		    1
		  }
		}
	      }
	      Branch {
		DstBlock		"Look-Up\nTable\n(gear for upshift)"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "prev veh\nspeed"
	      SrcPort		      1
	      DstBlock		      "delta\nspeed\n(\"+\" is acceleration)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux2"
	      SrcPort		      1
	      Points		      [0, -120]
	      DstBlock		      "switch for gear ratio\nand shifting (mu"
"xed)"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      Points		      [0, 140]
	      DstBlock		      "switch for gear ratio\nand shifting (mu"
"xed)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Mux2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "gear ratio8"
	      SrcPort		      1
	      DstBlock		      "Mux2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation5"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, -40]
		  Branch {
		    Points		    [0, -165]
		    DstBlock		    "switch for gear\nnumber"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "total fuel used (gal)"
		    DstPort		    1
		  }
		}
		Branch {
		  DstBlock		  "gear ratio8"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, 70]
		DstBlock		"shifting"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "gear ratio6"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "shifting1"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation4"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 65]
		Branch {
		  Points		  [0, 35]
		  DstBlock		  "switch for gear\nnumber"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "shifting1"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"gear ratio6"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "switch for gear ratio\nand shifting (mu"
"xed)"
	      SrcPort		      1
	      Points		      [50, 0]
	      Branch {
		DstBlock		"New gear ratio"
		DstPort			1
	      }
	      Branch {
		DstBlock		"gear ratio and shifting"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "switch for gear\nnumber"
	      SrcPort		      1
	      DstBlock		      "gear number"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "delta\nspeed\n(\"+\" is acceleration)"
	      SrcPort		      1
	      Points		      [245, 0]
	      Branch {
		Points			[0, -95]
		DstBlock		"switch for gear\nnumber"
		DstPort			2
	      }
	      Branch {
		DstBlock		"switch for gear ratio\nand shifting ("
"muxed)"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Look-Up\nTable\n(gear for upshift)"
	      SrcPort		      1
	      DstBlock		      "Rounding\nFunction"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rounding\nFunction"
	      SrcPort		      1
	      DstBlock		      "Saturation4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Look-Up\nTable\n(gear for downshift)"
	      SrcPort		      1
	      DstBlock		      "Rounding\nFunction1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Rounding\nFunction1"
	      SrcPort		      1
	      DstBlock		      "Saturation5"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [709, 85]
	      Text		      "SPEED \nDEPENDENT \nSHIFT\nSIGNAL"
	    }
	    Annotation {
	      Position		      [285, 260]
	      Text		      "delta speed"
	    }
	    Annotation {
	      Position		      [510, 383]
	      Text		      "decel\ncase"
	    }
	    Annotation {
	      Position		      [468, 222]
	      Text		      "accel\ncase"
	    }
	    Annotation {
	      Position		      [525, 155]
	      Text		      "accel case"
	    }
	    Annotation {
	      Position		      [361, 193]
	      Text		      "decel case"
	    }
	    Annotation {
	      Position		      [740, 326]
	      Text		      "storing shifting and gear ratio\ninform"
"ation to workspace"
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "braking strategy"
	  Ports			  [2, 2]
	  Position		  [150, 262, 180, 313]
	  NamePlacement		  "alternate"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "braking strategy"
	    Location		    [27, 441, 629, 769]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [25, 130, 45, 150]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "slip-limited\nforce req'd\n(N)"
	      Position		      [25, 55, 45, 75]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [530, 275, 586, 315]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 496, 325]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [132, 17]
		  VerticalAlignment	  "top"
		  Text			  "This controller determines how much"
" braking\nforce the front and rear  friction brakes will supply."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [420, 25, 440, 45]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [240, 250, 260, 270]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [425, 150, 445, 170]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Keep\nfrac>0"
	      Position		      [290, 190, 320, 220]
	      ForegroundColor	      "magenta"
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [365, 126, 385, 144]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [365, 191, 385, 209]
	      FontName		      "Arial"
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [3, 1]
	      Position		      [235, 177, 265, 233]
	      IconShape		      "rectangular"
	      Inputs		      "--+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [415, 49, 445, 81]
	      FontName		      "Arial"
	      Threshold		      "0"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [420, 174, 450, 206]
	      FontName		      "Arial"
	      Threshold		      "0"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "convert\n(mph)"
	      Position		      [75, 121, 125, 159]
	      FontName		      "Arial"
	      Gain		      "2.2371"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "front driveline\nbraking fraction"
	      Position		      [165, 193, 195, 217]
	      InputValues	      "wh_fa_dl_brake_mph"
	      OutputValues	      "wh_fa_dl_brake_frac"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "front friction\nbraking fraction"
	      Position		      [165, 128, 195, 152]
	      InputValues	      "wh_fa_fric_brake_mph"
	      OutputValues	      "wh_fa_fric_brake_frac"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd front brake\nforce (N)"
	      Position		      [535, 55, 555, 75]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd rear brake\nforce (N)"
	      Position		      [530, 180, 550, 200]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Keep\nfrac>0"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Keep\nfrac>0"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-20, 0; 0, 20]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [0, -60]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "slip-limited\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [295, 0]
	      Branch {
		DstBlock		"Switch"
		DstPort			2
	      }
	      Branch {
		Points			[0, 65]
		Branch {
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 30]
		  Branch {
		    Points		    [0, 35]
		    DstBlock		    "Product1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [55, 0; 0, 30]
		    DstBlock		    "Switch1"
		    DstPort		    2
		  }
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "req'd front brake\nforce (N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "req'd rear brake\nforce (N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "req'd speed\n(m/s)"
	      SrcPort		      1
	      DstBlock		      "convert\n(mph)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "convert\n(mph)"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		DstBlock		"front friction\nbraking fraction"
		DstPort			1
	      }
	      Branch {
		Points			[0, 65]
		DstBlock		"front driveline\nbraking fraction"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "front driveline\nbraking fraction"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "front friction\nbraking fraction"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"Product"
		DstPort			2
	      }
	      Branch {
		Points			[0, 45]
		DstBlock		"Sum"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Sum"
	      DstPort		      3
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "config traction control"
	  Ports			  [3, 5]
	  Position		  [550, 39, 585, 141]
	  BackgroundColor	  "darkGreen"
	  ShowPortLabels	  off
	  BlockChoice		  "traction control 2 axle"
	  TemplateBlock		  "self"
	  MemberBlocks		  "traction control 2 axle,traction control J2"
"452 2 axle"
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "config traction control"
	    Location		    [148, 182, 646, 482]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [20, 40, 40, 60]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [20, 80, 40, 100]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [20, 120, 40, 140]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "traction control\n2 axle"
	      Ports		      [3, 5]
	      Position		      [100, 40, 140, 80]
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
"\n2 axle"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [200, 40, 220, 60]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [200, 80, 220, 100]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [200, 120, 220, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [200, 160, 220, 180]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [200, 200, 220, 220]
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -5]
	      DstBlock		      "traction control\n2 axle"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [20, 0; 0, -30]
	      DstBlock		      "traction control\n2 axle"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [40, 0]
	      DstBlock		      "traction control\n2 axle"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "traction control\n2 axle"
	      SrcPort		      1
	      Points		      [20, 0; 0, 10]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control\n2 axle"
	      SrcPort		      2
	      Points		      [10, 0; 0, 40]
	      DstBlock		      "req'd speed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control\n2 axle"
	      SrcPort		      3
	      Points		      [35, 0; 0, 70]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control\n2 axle"
	      SrcPort		      4
	      Points		      [35, 0; 0, 100]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "traction control\n2 axle"
	      SrcPort		      5
	      Points		      [0, 130]
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "current veh mass (kg)"
	  Ports			  [0, 1]
	  Position		  [135, 192, 195, 208]
	  BackgroundColor	  "darkGreen"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "current veh mass (kg)"
	    Location		    [26, 425, 296, 547]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "automatic"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Constant
	      Name		      "Constant12"
	      Position		      [25, 74, 80, 96]
	      BackgroundColor	      "darkGreen"
	      FontName		      "Arial"
	      Value		      "veh_mass"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [25, 26, 155, 54]
	      BackgroundColor	      "darkGreen"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "veh_cargo_mass"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum8"
	      Ports		      [2, 1]
	      Position		      [170, 30, 190, 50]
	      ShowName		      off
	      IconShape		      "round"
	      Inputs		      "|++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [215, 33, 245, 47]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Sum8"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Sum8"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant12"
	      SrcPort		      1
	      Points		      [95, 0]
	      DstBlock		      "Sum8"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "front and rear\nbrake controller\n(achievab"
"le)"
	  Ports			  [6, 2]
	  Position		  [580, 291, 615, 419]
	  ForegroundColor	  "lightBlue"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "front and rear\nbrake controller\n(achiev"
"able)"
	    Location		    [255, 126, 863, 699]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [95, 165, 115, 185]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tractive force\navailable from \nfront "
"drivetrain\n(N)"
	      Position		      [35, 225, 55, 245]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "axle speed\npossible\n(rad/s)"
	      Position		      [100, 35, 120, 55]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "max front\nbrake force\n(N)"
	      Position		      [65, 320, 85, 340]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "max rear\nbrake force\n(N)"
	      Position		      [65, 480, 85, 500]
	      Port		      "5"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "tractive force\navailable from \nrear d"
"rivetrain\n(N)"
	      Position		      [110, 245, 130, 265]
	      ForegroundColor	      "lightBlue"
	      Port		      "6"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [465, 500, 521, 540]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 596, 338]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [182, 12]
		  VerticalAlignment	  "top"
		  Text			  "This block apportions required fric"
"tion braking force between the \nfront (drive) and rear brakes.  Vehicle spee"
"d for brake strategy is\ncomputed assuming zero slip."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [160, 125, 180, 145]
	      Orientation	      "down"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [155, 360, 175, 380]
	      Orientation	      "down"
	      FontName		      "Arial"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [205, 432, 235, 463]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax1"
	      Ports		      [2, 1]
	      Position		      [205, 202, 235, 233]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax2"
	      Ports		      [2, 1]
	      Position		      [415, 392, 445, 423]
	      Function		      "max"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum1"
	      Ports		      [3, 1]
	      Position		      [155, 218, 175, 262]
	      ForegroundColor	      "lightBlue"
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "+--"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum2"
	      Ports		      [2, 1]
	      Position		      [150, 445, 170, 465]
	      FontName		      "Arial"
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch:\nbraking force\nto be split bet"
"ween\nfriction brakes\n(N)"
	      Position		      [290, 159, 320, 191]
	      FontName		      "Arial"
	      Threshold		      "0"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "braking force\nsupplied by\nfront frict"
"ion brakes\n(N)"
	      Ports		      [3, 1]
	      Position		      [415, 164, 445, 216]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"braking force\nsupplied by\nfront fri"
"ction brakes\n(N)"
		Location		[148, 298, 890, 621]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "add'l braking\nforce req'd\n(N)"
		  Position		  [35, 15, 55, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "possible speed\n(mph)"
		  Position		  [35, 115, 55, 135]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "max front\nbrake force\n(N)"
		  Position		  [35, 235, 55, 255]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [605, 245, 661, 285]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [229, 259, 832, 482]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [312, 167]
		    VerticalAlignment	    "top"
		    Text		    "The variable \"wh_max_front_fric_"
"brake_force_N\" must be assigned a positive value."
		    }
		    Annotation {
		    Position		    [292, 142]
		    VerticalAlignment	    "top"
		    Text		    "If all braking was intended to be"
" done by the drivetrain, the front friction brakes will do 60% of the braking"
"."
		    }
		    Annotation {
		    Position		    [292, 117]
		    VerticalAlignment	    "top"
		    Text		    "where the denominator can also be"
" expressed as [1 - front_axle_drivetrain_brake_fraction(vehicle speed)]."
		    }
		    Annotation {
		    Position		    [292, 62]
		    VerticalAlignment	    "top"
		    Text		    "[front_axle_friction_brake_fracti"
"on(vehicle speed)]\n---------------------------------------------------------"
"---------------------\n[front_axle_friction_brake_fraction(vehicle speed) + r"
"ear_axle_friction_brake_fraction(vehicle speed)]"
		    }
		    Annotation {
		    Position		    [292, 22]
		    VerticalAlignment	    "top"
		    Text		    "If additional braking force is re"
"quired to meet the specified deceleration, input #1 will be negative.\nThe fr"
"action of the additional req'd braking force made up by the front-axle fricti"
"on brakes is given by:"
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [165, 210, 215, 230]
		  Orientation		  "up"
		  FontName		  "Arial"
		  Value			  "1+eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [345, 195, 365, 215]
		  FontName		  "Arial"
		  Value			  "0.6"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Keep\n0<frac<1"
		  Position		  [455, 140, 485, 170]
		  ForegroundColor	  "magenta"
		  UpperLimit		  "1"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax"
		  Ports			  [2, 1]
		  Position		  [590, 142, 620, 173]
		  Function		  "max"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [530, 141, 550, 159]
		  FontName		  "Arial"
		  Inputs		  "**"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [320, 136, 340, 154]
		  FontName		  "Arial"
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [110, 40, 140, 70]
		  UpperLimit		  "max(wh_fa_fric_brake_mph)"
		  LowerLimit		  "min(wh_fa_fric_brake_mph)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation1"
		  Position		  [110, 110, 140, 140]
		  UpperLimit		  "max(wh_fa_dl_brake_mph)"
		  LowerLimit		  "min(wh_fa_dl_brake_mph)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [250, 102, 270, 193]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch1"
		  Position		  [395, 139, 425, 171]
		  FontName		  "Arial"
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "driveline\nbraking fraction"
		  Position		  [175, 113, 205, 137]
		  InputValues		  "wh_fa_dl_brake_mph"
		  OutputValues		  "wh_fa_dl_brake_frac"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "front friction\nbraking fraction"
		  Position		  [175, 43, 205, 67]
		  InputValues		  "wh_fa_fric_brake_mph"
		  OutputValues		  "wh_fa_fric_brake_frac"
		}
		Block {
		  BlockType		  Outport
		  Name			  "braking force\nfrom front-axle\nfri"
"ction brakes\n(N)"
		  Position		  [680, 150, 700, 170]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Keep\n0<frac<1"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Switch1"
		  SrcPort		  1
		  DstBlock		  "Keep\n0<frac<1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "MinMax"
		  SrcPort		  1
		  DstBlock		  "braking force\nfrom front-axle\nfri"
"ction brakes\n(N)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "MinMax"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "max front\nbrake force\n(N)"
		  SrcPort		  1
		  Points		  [505, 0; 0, -80]
		  DstBlock		  "MinMax"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "add'l braking\nforce req'd\n(N)"
		  SrcPort		  1
		  Points		  [450, 0; 0, 120]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [0, -35]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "driveline\nbraking fraction"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "front friction\nbraking fraction"
		  SrcPort		  1
		  Points		  [80, 0; 0, 85]
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  DstBlock		  "Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Product1"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 25; 80, 0; 0, -20]
		    DstBlock		    "Switch1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [5, 0; 0, -40]
		  DstBlock		  "Switch1"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  DstBlock		  "front friction\nbraking fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation1"
		  SrcPort		  1
		  DstBlock		  "driveline\nbraking fraction"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "possible speed\n(mph)"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Saturation1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -70]
		    DstBlock		    "Saturation"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "m/s -> mph\n(mph)"
	      Position		      [255, 22, 305, 68]
	      FontName		      "Arial"
	      Gain		      "2.237"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "rad/s -> m/s\n(m/s)"
	      Position		      [150, 18, 230, 72]
	      FontName		      "Arial"
	      Gain		      "wh_radius"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "rear braking\nforce req'd\n(N)"
	      Position		      [285, 384, 315, 416]
	      FontName		      "Arial"
	      Threshold		      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front-axle\nbraking force\n(N)"
	      Position		      [505, 180, 525, 200]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "rear-axle\nbraking force\n(N)"
	      Position		      [505, 400, 525, 420]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "max rear\nbrake force\n(N)"
	      SrcPort		      1
	      Points		      [270, 0; 0, -75]
	      DstBlock		      "MinMax2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "max front\nbrake force\n(N)"
	      SrcPort		      1
	      Points		      [310, 0]
	      DstBlock		      "braking force\nsupplied by\nfront frict"
"ion brakes\n(N)"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [0, 0; 0, 5]
	      Branch {
		DstBlock		"rear braking\nforce req'd\n(N)"
		DstPort			1
	      }
	      Branch {
		Points			[0, 50]
		DstBlock		"MinMax"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [5, 0; 0, -40]
	      DstBlock		      "rear braking\nforce req'd\n(N)"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Sum2"
	      SrcPort		      1
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "rear braking\nforce req'd\n(N)"
	      SrcPort		      1
	      DstBlock		      "MinMax2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax2"
	      SrcPort		      1
	      DstBlock		      "rear-axle\nbraking force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "rad/s -> m/s\n(m/s)"
	      SrcPort		      1
	      DstBlock		      "m/s -> mph\n(mph)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "axle speed\npossible\n(rad/s)"
	      SrcPort		      1
	      DstBlock		      "rad/s -> m/s\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "tractive force\navailable from \nfront "
"drivetrain\n(N)"
	      SrcPort		      1
	      Points		      [0, 5]
	      DstBlock		      "Sum1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      Points		      [0, 0; 15, 0]
	      Branch {
		Points			[0, 50]
		DstBlock		"Sum1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Switch:\nbraking force\nto be split b"
"etween\nfriction brakes\n(N)"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Sum1"
	      SrcPort		      1
	      Points		      [5, 0; 0, -15]
	      DstBlock		      "MinMax1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "MinMax1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -35]
	      DstBlock		      "Switch:\nbraking force\nto be split bet"
"ween\nfriction brakes\n(N)"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, 0; 0, 15]
	      Branch {
		DstBlock		"Switch:\nbraking force\nto be split b"
"etween\nfriction brakes\n(N)"
		DstPort			1
	      }
	      Branch {
		Points			[0, 45]
		DstBlock		"MinMax1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "m/s -> mph\n(mph)"
	      SrcPort		      1
	      Points		      [70, 0; 0, 145]
	      DstBlock		      "braking force\nsupplied by\nfront frict"
"ion brakes\n(N)"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch:\nbraking force\nto be split bet"
"ween\nfriction brakes\n(N)"
	      SrcPort		      1
	      Points		      [0, 0; 25, 0]
	      Branch {
		DstBlock		"braking force\nsupplied by\nfront fri"
"ction brakes\n(N)"
		DstPort			1
	      }
	      Branch {
		Points			[0, 130; -90, 0; 0, 95]
		Branch {
		  DstBlock		  "rear braking\nforce req'd\n(N)"
		  DstPort		  2
		}
		Branch {
		  Points		  [-125, 0]
		  DstBlock		  "Sum2"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "braking force\nsupplied by\nfront frict"
"ion brakes\n(N)"
	      SrcPort		      1
	      Points		      [0, 0; 10, 0]
	      Branch {
		Points			[0, 165; -335, 0; 0, 105]
		DstBlock		"Sum2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"front-axle\nbraking force\n(N)"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "tractive force\navailable from \nrear d"
"rivetrain\n(N)"
	      SrcPort		      1
	      DstBlock		      "Sum1"
	      DstPort		      3
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "shifting"
	  Ports			  [1, 1]
	  Position		  [200, 459, 230, 491]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "shifting"
	    Location		    [178, 196, 468, 387]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "gear\nnumber"
	      Position		      [15, 50, 35, 70]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [20, 131, 120, 159]
	      FontName		      "Arial"
	      Value		      "gb_shift_delay-1e-6"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [185, 53, 215, 77]
	      FontName		      "Arial"
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "time since last shift"
	      Ports		      [1, 1]
	      Position		      [65, 43, 125, 77]
	      ShowName		      off
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('time since\\nlast shift')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"time since last shift"
		Location		[24, 388, 314, 527]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [10, 60, 30, 80]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "just shifted"
		  Ports			  [1, 1]
		  Position		  [60, 57, 110, 83]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('just\\nshifted')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "just shifted"
		    Location		    [142, 212, 465, 357]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [55, 55, 75, 75]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [120, 55, 155, 75]
		    FontName		    "Arial"
		    X0			    "1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "Relational\nOperator"
		    Position		    [190, 58, 220, 82]
		    FontName		    "Arial"
		    Operator		    "~="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [250, 60, 270, 80]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Relational\nOperator"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 30; 75, 0; 0, -20]
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "timer"
		  Ports			  [1, 1]
		  Position		  [140, 55, 175, 85]
		  ShowName		  off
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('timer')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "timer"
		    Location		    [455, 179, 859, 394]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "trigger"
		    Position		    [15, 125, 35, 145]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [100, 100, 120, 120]
		    FontName		    "Arial"
		    Value		    "1"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [100, 150, 120, 170]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant2"
		    Position		    [150, 5, 170, 25]
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [265, 59, 295, 91]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "no-lag\nReset Integrator"
		    Ports		    [3, 1]
		    Position		    [155, 96, 205, 174]
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    MaskType		    "No-lag Reset Integrator"
		    MaskDescription	    "No-lag Reset Integrator"
		    MaskHelp		    "Integrates first input using Eule"
"r technique.\\nAt the time step that input 2 <> zero,\\noutput is reset to in"
"put 3."
		    MaskPromptString	    "Initial Value"
		    MaskStyleString	    "edit"
		    MaskTunableValueString  "on"
		    MaskEnableString	    "on"
		    MaskVisibilityString    "on"
		    MaskToolTipString	    "on"
		    MaskInitialization	    "initval=@1;"
		    MaskDisplay		    "disp('1/s\\nw/ reset\\nno lag')"
		    MaskIconFrame	    on
		    MaskIconOpaque	    on
		    MaskIconRotate	    "none"
		    MaskIconUnits	    "autoscale"
		    MaskValueString	    "15"
		    System {
		    Name		    "no-lag\nReset Integrator"
		    Location		    [258, 616, 780, 880]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [60, 100, 80, 120]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [60, 140, 80, 160]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_3"
		    Position		    [45, 185, 65, 205]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [125, 205, 145, 225]
		    Orientation		    "up"
		    NamePlacement	    "alternate"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory"
		    Position		    [340, 55, 375, 75]
		    Orientation		    "left"
		    FontName		    "Arial"
		    X0			    "initval"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [160, 96, 180, 114]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [230, 90, 250, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Switch
		    Name		    "Switch"
		    Position		    [290, 139, 320, 171]
		    FontName		    "Arial"
		    Threshold		    "eps"
		    }
		    Block {
		    BlockType		    SubSystem
		    Name		    "dt"
		    Ports		    [0, 1]
		    Position		    [112, 50, 138, 80]
		    Orientation		    "down"
		    ShowPortLabels	    off
		    TreatAsAtomicUnit	    off
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    }
		    }
		    Block {
		    BlockType		    RelationalOperator
		    Name		    "in_2==0"
		    Position		    [160, 143, 190, 167]
		    Operator		    "=="
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [455, 145, 475, 165]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_3"
		    SrcPort		    1
		    Points		    [200, 0; 0, -30]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "in_2==0"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "dt"
		    SrcPort		    1
		    Points		    [0, 15]
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory"
		    SrcPort		    1
		    Points		    [-130, 0; 0, 30]
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    Points		    [10, 0; 0, 45]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    Points		    [85, 0]
		    Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "in_2==0"
		    SrcPort		    1
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, -40]
		    DstBlock		    "in_2==0"
		    DstPort		    2
		    }
		    }
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "time"
		    Position		    [350, 65, 370, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Switch"
		    SrcPort		    1
		    DstBlock		    "time"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "trigger"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, -60]
		    DstBlock		    "Switch"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    2
		    }
		    }
		    Line {
		    SrcBlock		    "Constant2"
		    SrcPort		    1
		    Points		    [35, 0; 0, 50]
		    DstBlock		    "Switch"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    DstBlock		    "no-lag\nReset Integrator"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "no-lag\nReset Integrator"
		    SrcPort		    1
		    Points		    [35, 0; 0, -50]
		    DstBlock		    "Switch"
		    DstPort		    3
		    }
		  }
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [225, 60, 245, 80]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "just shifted"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "just shifted"
		  SrcPort		  1
		  DstBlock		  "timer"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "timer"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "out_1"
	      Position		      [250, 55, 270, 75]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "out_1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "gear\nnumber"
	      SrcPort		      1
	      DstBlock		      "time since last shift"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [15, 0; 0, -75]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "time since last shift"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "sim stop\nsubsystem"
	  Ports			  []
	  Position		  [585, 485, 615, 535]
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "sim stop\nsubsystem"
	    Location		    [128, 88, 766, 630]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "automatic"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [465, 65, 521, 105]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[323, 484, 957, 574]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [317, 48]
		  Text			  "This block controls the simulation "
"stop time.  The simulation maybe \nstop based on the achievement of a specifi"
"ed speed, a max speed, a time, a distance, or an engine condition."
		}
	      }
	    }
	    Block {
	      BlockType		      Clock
	      Name		      "Clock"
	      Position		      [65, 375, 85, 395]
	      DisplayTime	      off
	      Decimation	      "10"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<cs>"
	      Position		      [25, 70, 95, 90]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "engine_on"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<cs>1"
	      Position		      [25, 170, 95, 190]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "distance"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<cs>2"
	      Position		      [30, 270, 100, 290]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "mpha"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<cs>3"
	      Position		      [40, 475, 110, 495]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "mpha"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [500, 302, 530, 333]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [260, 157, 290, 188]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [260, 257, 290, 288]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product2"
	      Ports		      [2, 1]
	      Position		      [255, 362, 285, 393]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product3"
	      Ports		      [2, 1]
	      Position		      [255, 462, 285, 493]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [435, 212, 465, 243]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [400, 377, 430, 408]
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      Stop
	      Name		      "Stop Simulation"
	      Position		      [570, 303, 605, 337]
	    }
	    Block {
	      BlockType		      Stop
	      Name		      "Stop Simulation1"
	      Position		      [270, 63, 305, 97]
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [4, 1]
	      Position		      [340, 151, 360, 284]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "++++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum1"
	      Ports		      [4, 1]
	      Position		      [340, 331, 360, 464]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "++++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "do ex calcs?2"
	      Position		      [120, 25, 210, 40]
	      Orientation	      "down"
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "enable_stop_fc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "do ex calcs?3"
	      Position		      [20, 120, 150, 140]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "enable_sim_stop_distance"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "do ex calcs?4"
	      Position		      [25, 225, 155, 245]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "enable_sim_stop_speed"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "do ex calcs?5"
	      Position		      [30, 325, 150, 345]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "enable_sim_stop_time"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "do ex calcs?6"
	      Position		      [25, 424, 165, 446]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "enable_sim_stop_max_spd"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "do ex calcs?7"
	      Position		      [385, 232, 410, 258]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "stop sim distance"
	      Ports		      [1, 1, 1]
	      Position		      [145, 163, 220, 197]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      on
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"stop sim distance"
		Location		[443, 266, 766, 434]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "distance"
		  Position		  [30, 15, 50, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  EnablePort
		  Name			  "Enable"
		  Ports			  []
		  Position		  [230, 70, 250, 90]
		  StatesWhenEnabling	  "held"
		  ShowOutputPort	  off
		}
		Block {
		  BlockType		  Constant
		  Name			  "Const"
		  Position		  [30, 74, 135, 96]
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "sim_stop_distance"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [165, 18, 195, 42]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [240, 23, 270, 37]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "distance"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Const"
		  SrcPort		  1
		  Points		  [0, -50]
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "stop sim fc"
	      Ports		      [1, 1, 1]
	      Position		      [110, 63, 215, 97]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      on
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"stop sim fc"
		Location		[441, 252, 788, 534]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "engine on?"
		  Position		  [30, 15, 50, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  EnablePort
		  Name			  "Enable"
		  Ports			  []
		  Position		  [270, 145, 290, 165]
		  StatesWhenEnabling	  "held"
		  ShowOutputPort	  off
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [30, 140, 50, 160]
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Const"
		  Position		  [15, 180, 85, 200]
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "j17_endtimes"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [185, 27, 215, 58]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [2, 1]
		  Position		  [100, 17, 130, 48]
		  Operator		  "OR"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator2"
		  Ports			  [1, 1]
		  Position		  [185, 94, 215, 126]
		  Operator		  "OR"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Reference
		  Name			  "Manual Switch"
		  Ports			  [2, 1]
		  Position		  [185, 187, 215, 223]
		  ForegroundColor	  "green"
		  SourceBlock		  "simulink3/Nonlinear/Manual Switch"
		  SourceType		  "Manual Switch"
		  sw			  "0"
		  action		  "0"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [95, 80, 125, 110]
		  Orientation		  "left"
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [125, 158, 155, 182]
		  Operator		  "=="
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator1"
		  Position		  [125, 218, 155, 242]
		  ForegroundColor	  "green"
		  Operator		  ">="
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [275, 38, 305, 52]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Manual Switch"
		  SrcPort		  1
		  Points		  [0, -45; -50, 0]
		  DstBlock		  "Logical\nOperator2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Manual Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Manual Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [45, 0; 0, 15]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Const"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "engine on?"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [-5, 0]
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, 60]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Logical\nOperator"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator2"
		  SrcPort		  1
		  Points		  [0, -20; -50, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "stop sim max spd"
	      Ports		      [1, 1, 1]
	      Position		      [140, 468, 215, 502]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      on
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"stop sim max spd"
		Location		[445, 264, 798, 458]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "speed"
		  Position		  [30, 15, 50, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  EnablePort
		  Name			  "Enable"
		  Ports			  []
		  Position		  [30, 75, 50, 95]
		  StatesWhenEnabling	  "held"
		  ShowOutputPort	  off
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [260, 45, 316, 85]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [319, 488, 953, 578]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [317, 48]
		    Text		    "When enabled, stop the simulation"
" when the current speed is greater \nthan zero and is less than or equal to t"
"he speed at gb_shift_delay*5+1 \nseconds ago (i.e. vehicle has reached a cons"
"tant max speed). Only used \nduring acceleration test."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Const"
		  Position		  [25, 129, 55, 151]
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [190, 112, 220, 143]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [115, 123, 145, 147]
		  Operator		  ">"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator3"
		  Position		  [185, 18, 215, 42]
		  Operator		  "<="
		}
		Block {
		  BlockType		  TransportDelay
		  Name			  "Transport\nDelay"
		  Position		  [115, 40, 145, 70]
		  DelayTime		  "(gb_shift_delay*5)+1"
		  InitialInput		  "0"
		  BufferSize		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [270, 123, 300, 137]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Const"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "speed"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator3"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 30]
		    Branch {
		    Points		    [0, 75]
		    DstBlock		    "Relational\nOperator2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Transport\nDelay"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Relational\nOperator3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator3"
		  SrcPort		  1
		  Points		  [10, 0; 0, 55; -55, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "stop sim speed"
	      Ports		      [1, 1, 1]
	      Position		      [150, 263, 225, 297]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      on
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"stop sim speed"
		Location		[445, 260, 768, 428]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "speed"
		  Position		  [30, 15, 50, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  EnablePort
		  Name			  "Enable"
		  Ports			  []
		  Position		  [230, 70, 250, 90]
		  StatesWhenEnabling	  "held"
		  ShowOutputPort	  off
		}
		Block {
		  BlockType		  Constant
		  Name			  "Const"
		  Position		  [30, 74, 135, 96]
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "sim_stop_speed"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [165, 18, 195, 42]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [240, 23, 270, 37]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Const"
		  SrcPort		  1
		  Points		  [0, -50]
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "speed"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "stop sim time"
	      Ports		      [1, 1, 1]
	      Position		      [145, 368, 220, 402]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      on
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"stop sim time"
		Location		[443, 266, 766, 434]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "time"
		  Position		  [30, 15, 50, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  EnablePort
		  Name			  "Enable"
		  Ports			  []
		  Position		  [230, 70, 250, 90]
		  StatesWhenEnabling	  "held"
		  ShowOutputPort	  off
		}
		Block {
		  BlockType		  Constant
		  Name			  "Const"
		  Position		  [30, 74, 135, 96]
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "sim_stop_time"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator2"
		  Position		  [165, 18, 195, 42]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Outport
		  Name			  "Out1"
		  Position		  [240, 23, 270, 37]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "time"
		  SrcPort		  1
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Const"
		  SrcPort		  1
		  Points		  [0, -50]
		  DstBlock		  "Relational\nOperator2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Relational\nOperator2"
		  SrcPort		  1
		  DstBlock		  "Out1"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "stop sim fc"
	      SrcPort		      1
	      DstBlock		      "Stop Simulation1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "do ex calcs?7"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, 165]
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Sum1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Stop Simulation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product3"
	      SrcPort		      1
	      Points		      [35, 0]
	      DstBlock		      "Sum1"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Product2"
	      SrcPort		      1
	      Points		      [10, 0; 0, 35]
	      DstBlock		      "Sum1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      Points		      [10, 0; 0, 105]
	      DstBlock		      "Sum1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      Points		      [15, 0; 0, 170]
	      DstBlock		      "Sum1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "do ex calcs?6"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[65, 0]
		Branch {
		  Points		  [85, 0]
		  DstBlock		  "Sum"
		  DstPort		  4
		}
		Branch {
		  DstBlock		  "Product3"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"stop sim max spd"
		DstPort			enable
	      }
	    }
	    Line {
	      SrcBlock		      "do ex calcs?5"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[60, 0]
		Branch {
		  Points		  [80, 0; 0, -100]
		  DstBlock		  "Sum"
		  DstPort		  3
		}
		Branch {
		  DstBlock		  "Product2"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"stop sim time"
		DstPort			enable
	      }
	    }
	    Line {
	      SrcBlock		      "do ex calcs?4"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[60, 0]
		Branch {
		  Points		  [70, 0; 0, -35]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Product1"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"stop sim speed"
		DstPort			enable
	      }
	    }
	    Line {
	      SrcBlock		      "stop sim speed"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "stop sim time"
	      SrcPort		      1
	      DstBlock		      "Product2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "stop sim max spd"
	      SrcPort		      1
	      DstBlock		      "Product3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "do ex calcs?3"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[65, 0]
		Branch {
		  Points		  [80, 0]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "Product"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"stop sim distance"
		DstPort			enable
	      }
	    }
	    Line {
	      SrcBlock		      "stop sim distance"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From<cs>3"
	      SrcPort		      1
	      DstBlock		      "stop sim max spd"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Clock"
	      SrcPort		      1
	      DstBlock		      "stop sim time"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From<cs>2"
	      SrcPort		      1
	      DstBlock		      "stop sim speed"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From<cs>1"
	      SrcPort		      1
	      DstBlock		      "stop sim distance"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From<cs>"
	      SrcPort		      1
	      DstBlock		      "stop sim fc"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "do ex calcs?2"
	      SrcPort		      1
	      DstBlock		      "stop sim fc"
	      DstPort		      enable
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "traction control"
	  Ports			  [3, 3]
	  Position		  [140, 35, 175, 135]
	  BackgroundColor	  "darkGreen"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "traction control"
	    Location		    [468, 206, 851, 474]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [45, 95, 65, 115]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [50, 180, 70, 200]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [45, 70, 65, 90]
	      NamePlacement	      "alternate"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [310, 215, 366, 255]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 504, 317]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [137, 12]
		  VerticalAlignment	  "top"
		  Text			  "Requested speed and force are limit"
"ed by the\ntractive characteristics of the tires in this block."
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      Ports		      [2, 1]
	      Position		      [140, 93, 170, 142]
	      BackgroundColor	      "darkGreen"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		Location		[2, 70, 1006, 732]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  Position		  [60, 20, 80, 40]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  Position		  [55, 185, 75, 205]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [1020, 920, 1076, 960]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [229, 259, 910, 399]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [347, 22]
		    VerticalAlignment	    "top"
		    Text		    "This block limits the requested s"
"peed by the maximum and minimum attainable given the maximum traction of the "
"tires.\nThat is, acceleration and braking maneuvers are limited to the point "
"of imminent skidding."
		    }
		    Annotation {
		    Position		    [337, 57]
		    VerticalAlignment	    "top"
		    Text		    "The above equations are derived b"
"y solving F_maxaccel=mass*a_max for the maximum or minimum speed at the end o"
"f the time step,\ngiven that F_maxaccel depends on the weight borne by the fr"
"ont tires which in turn depends on the vehicle's acceleration rate."
		    }
		    Annotation {
		    Position		    [337, 92]
		    VerticalAlignment	    "top"
		    Text		    "Front-wheel drive is assumed, and"
" weight transfer due to acceleration is included in the calculation of maximu"
"m tractive force."
		    }
		  }
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [270, 620, 290, 640]
		  FontName		  "Arial"
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [420, 107, 485, 123]
		  BackgroundColor	  "darkGreen"
		  Value			  "veh_gravity"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [410, 173, 560, 187]
		  FontName		  "Arial"
		  Value			  "0.5*veh_gravity*wh_2nd_rrc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant10"
		  Position		  [450, 344, 515, 366]
		  FontName		  "Arial"
		  Value			  "veh_gravity"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant11"
		  Position		  [205, 94, 275, 116]
		  Value			  "wh_1st_rrc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [145, 46, 430, 64]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_gravit"
"y*veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [225, 234, 420, 256]
		  FontName		  "Arial"
		  Value			  "0.125*veh_air_density*veh_CD*veh_FA"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant4"
		  Position		  [235, 290, 515, 310]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_cg_hei"
"ght/veh_wheelbase"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant6"
		  Position		  [255, 703, 460, 727]
		  FontName		  "Arial"
		  Value			  "0.375*veh_air_density*veh_CD*veh_FA"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant7"
		  Position		  [255, 748, 460, 772]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "0.5*veh_gravity*wh_2nd_rrc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant9"
		  Position		  [150, 884, 530, 906]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_cg_hei"
"ght/veh_wheelbase"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn"
		  Position		  [415, 625, 445, 645]
		  FontName		  "Arial"
		  Expr			  "1/u"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>"
		  Position		  [35, 134, 95, 156]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [315, 660, 355, 680]
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax"
		  Ports			  [2, 1]
		  Position		  [915, 247, 945, 278]
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [4, 1]
		  Position		  [590, 168, 610, 227]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "4"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [3, 1]
		  Position		  [590, 237, 610, 273]
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product10"
		  Ports			  [3, 1]
		  Position		  [590, 357, 610, 393]
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product11"
		  Ports			  [3, 1]
		  Position		  [505, 119, 535, 151]
		  BackgroundColor	  "darkGreen"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [4, 1]
		  Position		  [590, 297, 610, 333]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "4"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product3"
		  Ports			  [3, 1]
		  Position		  [590, 417, 610, 453]
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product4"
		  Ports			  [2, 1]
		  Position		  [590, 691, 610, 724]
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product5"
		  Ports			  [2, 1]
		  Position		  [590, 821, 610, 854]
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product6"
		  Ports			  [3, 1]
		  Position		  [590, 888, 610, 922]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product7"
		  Ports			  [3, 1]
		  Position		  [500, 754, 520, 796]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product8"
		  Ports			  [2, 1]
		  Position		  [310, 98, 330, 122]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product9"
		  Ports			  [3, 1]
		  Position		  [510, 63, 530, 87]
		  BackgroundColor	  "darkGreen"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [7, 1]
		  Position		  [680, 47, 700, 463]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+---+-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [375, 625, 395, 645]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum2"
		  Ports			  [4, 1]
		  Position		  [670, 681, 690, 934]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum3"
		  Ports			  [6, 1]
		  Position		  [680, 482, 700, 643]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "-----+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum4"
		  Ports			  [2, 1]
		  Position		  [835, 570, 855, 590]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum5"
		  Ports			  [2, 1]
		  Position		  [820, 260, 840, 280]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum6"
		  Ports			  [2, 1]
		  Position		  [390, 113, 410, 157]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum7"
		  Ports			  [4, 1]
		  Position		  [725, 676, 745, 929]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+++-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig\nFn4"
		  Ports			  [1, 1]
		  Position		  [160, 200, 190, 230]
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn"
		  Ports			  [1, 1]
		  Position		  [110, 130, 140, 160]
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn1"
		  Ports			  [1, 1]
		  Position		  [160, 130, 190, 160]
		  Operator		  "sin"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)"
		  Ports			  [0, 1]
		  Position		  [320, 152, 380, 168]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)1"
		  Ports			  [0, 1]
		  Position		  [450, 217, 510, 233]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)2"
		  Ports			  [0, 1]
		  Position		  [370, 77, 430, 93]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)3"
		  Ports			  [0, 1]
		  Position		  [280, 322, 340, 338]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)4"
		  Ports			  [0, 1]
		  Position		  [275, 427, 335, 443]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)5"
		  Ports			  [0, 1]
		  Position		  [385, 782, 445, 798]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)6"
		  Ports			  [0, 1]
		  Position		  [385, 822, 445, 838]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)7"
		  Ports			  [0, 1]
		  Position		  [385, 907, 445, 923]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  Ports			  [2, 1]
		  Position		  [750, 249, 775, 276]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('/')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "max speed at END\nof time step gi"
"ven\ntire traction limit\n(m/s)"
		    Location		    [0, 0, 0, 0]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [30, 50, 50, 70]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [10, 80, 30, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "Fcn"
		    Position		    [60, 79, 90, 101]
		    FontName		    "Arial"
		    Expr		    "1/u"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [130, 56, 150, 74]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [180, 55, 200, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "Fcn"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Fcn"
		    SrcPort		    1
		    Points		    [15, 0; 0, -20]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Gain
		  Name			  "max time-step\naverage speed\n(m/s)"
		  Position		  [865, 256, 895, 284]
		  FontName		  "Arial"
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  Ports			  [2, 1]
		  Position		  [770, 559, 795, 586]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('/')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "min speed at END\nof time step gi"
"ven\ntire traction limit\n(m/s)"
		    Location		    [435, 32767, 641, 32767]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [30, 50, 50, 70]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [10, 80, 30, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "Fcn"
		    Position		    [60, 79, 90, 101]
		    FontName		    "Arial"
		    Expr		    "1/u"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [130, 56, 150, 74]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [180, 55, 200, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Fcn"
		    SrcPort		    1
		    Points		    [15, 0; 0, -20]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "Fcn"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Gain
		  Name			  "min time-step\naverage speed\n(m/s)"
		  Position		  [880, 566, 910, 594]
		  FontName		  "Arial"
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  MinMax
		  Name			  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  Ports			  [2, 1]
		  Position		  [975, 557, 1005, 588]
		  Function		  "max"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [1055, 565, 1075, 585]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "current veh mass (kg)7"
		  SrcPort		  1
		  DstBlock		  "Product6"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "current veh mass (kg)5"
		  SrcPort		  1
		  DstBlock		  "Product7"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "current veh mass (kg)3"
		  SrcPort		  1
		  DstBlock		  "Product2"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "current veh mass (kg)2"
		  SrcPort		  1
		  DstBlock		  "Product9"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "current veh mass (kg)1"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Product"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "current veh mass (kg)"
		  SrcPort		  1
		  Points		  [105, 0]
		  DstBlock		  "Product11"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  DstBlock		  "Product11"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product11"
		  SrcPort		  1
		  Points		  [105, 0]
		  Branch {
		    Labels		    [1, 0]
		    Points		    [0, 390]
		    DstBlock		    "Sum3"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Sum6"
		  SrcPort		  1
		  DstBlock		  "Product11"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Trig Fn1"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, 240]
		    DstBlock		    "Product10"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Sum6"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Constant10"
		  SrcPort		  1
		  Points		  [25, 0; 0, 20]
		  DstBlock		  "Product10"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant4"
		  SrcPort		  1
		  Points		  [30, 0]
		  Branch {
		    Points		    [0, 65]
		    DstBlock		    "Product10"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Product10"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  6
		}
		Line {
		  SrcBlock		  "Product3"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    7
		  }
		  Branch {
		    Points		    [0, 190]
		    DstBlock		    "Sum3"
		    DstPort		    6
		  }
		}
		Line {
		  SrcBlock		  "current veh mass (kg)4"
		  SrcPort		  1
		  DstBlock		  "Product3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "max time-step\naverage speed\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "MinMax"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  SrcPort		  1
		  Points		  [800, 0; 0, 225]
		  DstBlock		  "MinMax"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum5"
		  SrcPort		  1
		  DstBlock		  "max time-step\naverage speed\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Product9"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant11"
		  SrcPort		  1
		  DstBlock		  "Product8"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product8"
		  SrcPort		  1
		  Points		  [40, 0]
		  DstBlock		  "Sum6"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Trig\nFn4"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [80, 0]
		    Branch {
		    Points		    [0, -100]
		    Branch {
		    Points		    [0, -40]
		    DstBlock		    "Product9"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Product8"
		    DstPort		    2
		    }
		    }
		    Branch {
		    Points		    [290, 0]
		    DstBlock		    "Product"
		    DstPort		    3
		    }
		  }
		  Branch {
		    Points		    [0, 560]
		    DstBlock		    "Product7"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Fcn"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "current veh mass (kg)6"
		  SrcPort		  1
		  DstBlock		  "Product5"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum2"
		  SrcPort		  1
		  Points		  [10, 0; 0, -540]
		  DstBlock		  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "min time-step\naverage speed\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum4"
		  SrcPort		  1
		  DstBlock		  "min time-step\naverage speed\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "Sum4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "MinMax"
		  SrcPort		  1
		  Points		  [0, 300]
		  DstBlock		  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum3"
		  SrcPort		  1
		  DstBlock		  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum7"
		  SrcPort		  1
		  Points		  [0, -225]
		  DstBlock		  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant7"
		  SrcPort		  1
		  DstBlock		  "Product7"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant9"
		  SrcPort		  1
		  DstBlock		  "Product6"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant6"
		  SrcPort		  1
		  DstBlock		  "Product4"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product4"
		  SrcPort		  1
		  Points		  [30, 0]
		  Branch {
		    DstBlock		    "Sum2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -5]
		    DstBlock		    "Sum7"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Product7"
		  SrcPort		  1
		  Points		  [120, 0]
		  Branch {
		    DstBlock		    "Sum2"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, -5]
		    DstBlock		    "Sum7"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Product5"
		  SrcPort		  1
		  Points		  [30, 0]
		  Branch {
		    DstBlock		    "Sum2"
		    DstPort		    3
		  }
		  Branch {
		    Points		    [0, -5]
		    DstBlock		    "Sum7"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Product6"
		  SrcPort		  1
		  Points		  [30, 0]
		  Branch {
		    DstBlock		    "Sum2"
		    DstPort		    4
		  }
		  Branch {
		    Points		    [0, -5]
		    DstBlock		    "Sum7"
		    DstPort		    4
		  }
		}
		Line {
		  SrcBlock		  "Trig Fn"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "Trig\nFn4"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Trig Fn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  SrcPort		  1
		  Points		  [480, 0]
		  Branch {
		    Points		    [0, 60]
		    Branch {
		    Points		    [0, 10]
		    Branch {
		    Labels		    [1, 0]
		    Points		    [0, 50]
		    Branch {
		    Points		    [0, 110]
		    Branch {
		    Points		    [0, 240]
		    Branch {
		    Points		    [245, 0; 0, -80]
		    Branch {
		    DstBlock		    "Sum5"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    }
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Product4"
		    DstPort		    1
		    }
		    }
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		    }
		    }
		    Branch {
		    Points		    [15, 0]
		    DstBlock		    "Product2"
		    DstPort		    2
		    }
		    }
		    Branch {
		    DstBlock		    "Product1"
		    DstPort		    3
		    }
		    }
		    Branch {
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		  }
		  Branch {
		    Points		    [15, 0]
		    DstBlock		    "Product"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "From<cyc>"
		  SrcPort		  1
		  DstBlock		  "Trig Fn"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "Sum5"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, 285]
		    DstBlock		    "Sum3"
		    DstPort		    5
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    5
		  }
		}
		Line {
		  SrcBlock		  "Product9"
		  SrcPort		  1
		  Points		  [85, 0]
		  Branch {
		    Points		    [0, 425]
		    DstBlock		    "Sum3"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  Points		  [0, -5; 35, 0]
		  Branch {
		    Points		    [0, 355]
		    DstBlock		    "Sum3"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [40, 0]
		  Branch {
		    Points		    [0, 320]
		    DstBlock		    "Sum3"
		    DstPort		    4
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    4
		  }
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  1
		}
		Line {
		  Labels		  [0, 0]
		  SrcBlock		  "Fcn"
		  SrcPort		  1
		  Points		  [115, 0]
		  Branch {
		    Points		    [0, 270]
		    DstBlock		    "Product6"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 210]
		    Branch {
		    DstBlock		    "Product5"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -400]
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    3
		    }
		    Branch {
		    Points		    [0, -125]
		    DstBlock		    "Product2"
		    DstPort		    3
		    }
		    }
		  }
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Product"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      Ports		      [3, 2]
	      Position		      [255, 62, 285, 178]
	      BackgroundColor	      "darkGreen"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		Location		[110, 99, 997, 640]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "tractive force req'd at\ntire/road "
"interface\n(N)"
		  Position		  [70, 385, 90, 405]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "requested time-step\naverage vehicl"
"e speed\n(m/s)"
		  Position		  [70, 15, 90, 35]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "speed at beginning\nof time step\n("
"m/s)"
		  Position		  [65, 85, 85, 105]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  MinMax
		  Name			  " "
		  Ports			  [2, 1]
		  Position		  [620, 372, 650, 403]
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [815, 480, 871, 520]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [229, 259, 712, 322]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [242, 12]
		    VerticalAlignment	    "top"
		    Text		    "No more force will be requested o"
"f the drivetrain than can be transmitted by the front tires.\nThis transmitta"
"ble force is computed taking into account the slip characteristics of the tir"
"es\nand the variable, acceleration-dependent weight borne by the front axle."
		    }
		  }
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [140, 110, 160, 130]
		  FontName		  "Arial"
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [415, 13, 610, 37]
		  Orientation		  "left"
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "veh_cg_height/veh_wheelbase"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [215, 316, 395, 334]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "veh_gravity*veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [605, 274, 740, 296]
		  Orientation		  "left"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>"
		  Position		  [105, 194, 165, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [620, 422, 645, 448]
		  FontName		  "Arial"
		  Gain			  "-1"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain1"
		  Position		  [355, 82, 380, 108]
		  FontName		  "Arial"
		  Gain			  "2"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain2"
		  Position		  [310, 182, 390, 228]
		  Gain			  "veh_gravity"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [185, 135, 220, 155]
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [300, 86, 320, 104]
		  FontName		  "Arial"
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [3, 1]
		  Position		  [485, 63, 505, 107]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [2, 1]
		  Position		  [585, 340, 605, 360]
		  Orientation		  "down"
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product3"
		  Ports			  [3, 1]
		  Position		  [480, 253, 500, 297]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [155, 80, 175, 100]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [240, 115, 260, 135]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum2"
		  Ports			  [2, 1]
		  Position		  [415, 87, 445, 118]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn"
		  Ports			  [1, 1]
		  Position		  [195, 190, 225, 220]
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn1"
		  Ports			  [1, 1]
		  Position		  [250, 190, 280, 220]
		  Operator		  "sin"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn2"
		  Ports			  [1, 1]
		  Position		  [250, 260, 280, 290]
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)"
		  Ports			  [0, 1]
		  Position		  [310, 147, 370, 163]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  Ports			  [2, 1]
		  Position		  [700, 412, 730, 443]
		  Function		  "max"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Sum
		  Name			  "weight on\nfront axle\n(N)"
		  Ports			  [2, 1]
		  Position		  [540, 59, 560, 161]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "slip-limited force\n(N)"
		  Position		  [820, 420, 840, 440]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "weight on front axle\n(N)"
		  Position		  [820, 100, 840, 120]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "current veh mass (kg)"
		  SrcPort		  1
		  Points		  [90, 0]
		  Branch {
		    Points		    [0, -55]
		    DstBlock		    "Product1"
		    DstPort		    3
		  }
		  Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Trig Fn2"
		  SrcPort		  1
		  DstBlock		  "Product3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [65, 0]
		  DstBlock		  "Product3"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product3"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "weight on\nfront axle\n(N)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Trig Fn"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, 70]
		    DstBlock		    "Trig Fn2"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Trig Fn1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Gain2"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Trig Fn1"
		  SrcPort		  1
		  DstBlock		  "Gain2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<cyc>"
		  SrcPort		  1
		  DstBlock		  "Trig Fn"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Gain1"
		  SrcPort		  1
		  DstBlock		  "Sum2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  SrcPort		  1
		  DstBlock		  "slip-limited force\n(N)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  " "
		  SrcPort		  1
		  Points		  [15, 0; 0, 30]
		  DstBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  Points		  [0, 15]
		  Branch {
		    Points		    [0, 55]
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    " "
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "tractive force req'd at\ntire/road "
"interface\n(N)"
		  SrcPort		  1
		  DstBlock		  " "
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Gain1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  Points		  [15, 0; 0, -25]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "speed at beginning\nof time step\n("
"m/s)"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "requested time-step\naverage vehicl"
"e speed\n(m/s)"
		  SrcPort		  1
		  Points		  [40, 0; 0, 60]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "weight on\nfront axle\n(N)"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "weight on front axle\n(N)"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [0, 45]
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  DstBlock		  "weight on\nfront axle\n(N)"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [330, 60, 350, 80]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [330, 15, 350, 35]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [330, 120, 350, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      DstBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[115, 0; 0, -30]
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		DstPort			3
	      }
	      Branch {
		Points			[0, -60]
		DstBlock		"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      2
	      Points		      [0, -20]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      1
	      Points		      [0, -20]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      DstBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -95]
		DstBlock		"req'd speed\n(m/s)"
		DstPort			1
	      }
	      Branch {
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		DstPort			2
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "traction control 2 axle"
	  Ports			  [3, 5]
	  Position		  [685, 39, 720, 141]
	  ForegroundColor	  "lightBlue"
	  BackgroundColor	  "darkGreen"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "traction control 2 axle"
	    Location		    [303, 349, 766, 645]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [45, 95, 65, 115]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [50, 180, 70, 200]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [45, 70, 65, 90]
	      NamePlacement	      "alternate"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [360, 225, 416, 265]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 504, 317]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [137, 12]
		  VerticalAlignment	  "top"
		  Text			  "Requested speed and force are limit"
"ed by the\ntractive characteristics of the tires in this block."
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      Ports		      [2, 1]
	      Position		      [140, 93, 170, 142]
	      ForegroundColor	      "lightBlue"
	      BackgroundColor	      "darkGreen"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		Location		[2, 70, 1006, 722]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  Position		  [810, 255, 830, 275]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  Position		  [55, 275, 75, 295]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [1020, 1010, 1076, 1050]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [229, 259, 910, 399]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [347, 22]
		    VerticalAlignment	    "top"
		    Text		    "This block limits the requested s"
"peed by the maximum and minimum attainable given the maximum traction of the "
"tires.\nThat is, acceleration and braking maneuvers are limited to the point "
"of imminent skidding."
		    }
		    Annotation {
		    Position		    [337, 57]
		    VerticalAlignment	    "top"
		    Text		    "The above equations are derived b"
"y solving F_maxaccel=mass*a_max for the maximum or minimum speed at the end o"
"f the time step,\ngiven that F_maxaccel depends on the weight borne by the fr"
"ont tires which in turn depends on the vehicle's acceleration rate."
		    }
		    Annotation {
		    Position		    [337, 92]
		    VerticalAlignment	    "top"
		    Text		    "Front-wheel drive is assumed, and"
" weight transfer due to acceleration is included in the calculation of maximu"
"m tractive force."
		    }
		  }
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [270, 795, 290, 815]
		  FontName		  "Arial"
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [420, 197, 485, 213]
		  BackgroundColor	  "darkGreen"
		  Value			  "veh_gravity"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [410, 263, 560, 277]
		  FontName		  "Arial"
		  Value			  "0.5*veh_gravity*wh_2nd_rrc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant10"
		  Position		  [450, 434, 515, 456]
		  FontName		  "Arial"
		  Value			  "veh_gravity"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant11"
		  Position		  [205, 184, 275, 206]
		  Value			  "wh_1st_rrc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant12"
		  Position		  [135, 1124, 515, 1146]
		  ForegroundColor	  "lightBlue"
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*(-1*veh_cg"
"_height)/veh_wheelbase"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [145, 136, 430, 154]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_gravit"
"y*veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [225, 324, 420, 346]
		  FontName		  "Arial"
		  Value			  "0.125*veh_air_density*veh_CD*veh_FA"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant4"
		  Position		  [215, 380, 495, 400]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_cg_hei"
"ght/veh_wheelbase"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant5"
		  Position		  [145, 56, 430, 74]
		  ForegroundColor	  "lightBlue"
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_gravit"
"y*(1-veh_front_wt_frac)"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant6"
		  Position		  [255, 878, 460, 902]
		  FontName		  "Arial"
		  Value			  "0.375*veh_air_density*veh_CD*veh_FA"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant7"
		  Position		  [255, 923, 460, 947]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "0.5*veh_gravity*wh_2nd_rrc"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant9"
		  Position		  [150, 1059, 530, 1081]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_cg_hei"
"ght/veh_wheelbase"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Fcn"
		  Position		  [415, 800, 445, 820]
		  FontName		  "Arial"
		  Expr			  "1/u"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>"
		  Position		  [35, 224, 95, 246]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [315, 835, 355, 855]
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax"
		  Ports			  [2, 1]
		  Position		  [915, 337, 945, 368]
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [4, 1]
		  Position		  [590, 258, 610, 317]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "4"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [3, 1]
		  Position		  [590, 327, 610, 363]
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product10"
		  Ports			  [3, 1]
		  Position		  [590, 447, 610, 483]
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product11"
		  Ports			  [3, 1]
		  Position		  [505, 209, 535, 241]
		  BackgroundColor	  "darkGreen"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product12"
		  Ports			  [3, 1]
		  Position		  [510, 73, 530, 97]
		  ForegroundColor	  "lightBlue"
		  BackgroundColor	  "darkGreen"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product14"
		  Ports			  [3, 1]
		  Position		  [575, 1128, 595, 1162]
		  ForegroundColor	  "lightBlue"
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [4, 1]
		  Position		  [590, 387, 610, 423]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "4"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product3"
		  Ports			  [3, 1]
		  Position		  [590, 507, 610, 543]
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product4"
		  Ports			  [2, 1]
		  Position		  [590, 866, 610, 899]
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product5"
		  Ports			  [2, 1]
		  Position		  [590, 996, 610, 1029]
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product6"
		  Ports			  [3, 1]
		  Position		  [580, 1063, 600, 1097]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product7"
		  Ports			  [3, 1]
		  Position		  [500, 929, 520, 971]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product8"
		  Ports			  [2, 1]
		  Position		  [310, 188, 330, 212]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product9"
		  Ports			  [3, 1]
		  Position		  [510, 153, 530, 177]
		  BackgroundColor	  "darkGreen"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [10, 1]
		  Position		  [680, 102, 700, 618]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++---+-++-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [375, 800, 395, 820]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum2"
		  Ports			  [5, 1]
		  Position		  [670, 878, 690, 1132]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+++++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum3"
		  Ports			  [8, 1]
		  Position		  [680, 659, 700, 821]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "------+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum4"
		  Ports			  [2, 1]
		  Position		  [835, 745, 855, 765]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum5"
		  Ports			  [2, 1]
		  Position		  [820, 350, 840, 370]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum6"
		  Ports			  [2, 1]
		  Position		  [390, 203, 410, 247]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum7"
		  Ports			  [5, 1]
		  Position		  [725, 853, 745, 1107]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+++--"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig\nFn4"
		  Ports			  [1, 1]
		  Position		  [160, 290, 190, 320]
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn"
		  Ports			  [1, 1]
		  Position		  [110, 220, 140, 250]
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn1"
		  Ports			  [1, 1]
		  Position		  [160, 220, 190, 250]
		  Operator		  "sin"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)"
		  Ports			  [0, 1]
		  Position		  [320, 242, 380, 258]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)1"
		  Ports			  [0, 1]
		  Position		  [450, 307, 510, 323]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)10"
		  Ports			  [0, 1]
		  Position		  [370, 1147, 430, 1163]
		  ForegroundColor	  "lightBlue"
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)2"
		  Ports			  [0, 1]
		  Position		  [370, 167, 430, 183]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)3"
		  Ports			  [0, 1]
		  Position		  [280, 412, 340, 428]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)4"
		  Ports			  [0, 1]
		  Position		  [275, 517, 335, 533]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)5"
		  Ports			  [0, 1]
		  Position		  [385, 957, 445, 973]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)6"
		  Ports			  [0, 1]
		  Position		  [385, 997, 445, 1013]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)7"
		  Ports			  [0, 1]
		  Position		  [385, 1082, 445, 1098]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)8"
		  Ports			  [0, 1]
		  Position		  [370, 87, 430, 103]
		  ForegroundColor	  "lightBlue"
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Gain
		  Name			  "front \nactive?"
		  Position		  [565, 151, 595, 179]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_front_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "front \nactive?1"
		  Position		  [620, 1067, 640, 1093]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_front_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "front \nactive?2"
		  Position		  [515, 377, 535, 403]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_front_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  Ports			  [2, 1]
		  Position		  [750, 339, 775, 366]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('/')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "max speed at END\nof time step gi"
"ven\ntire traction limit\n(m/s)"
		    Location		    [0, 0, 0, 0]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [30, 50, 50, 70]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [10, 80, 30, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "Fcn"
		    Position		    [60, 79, 90, 101]
		    FontName		    "Arial"
		    Expr		    "1/u"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [130, 56, 150, 74]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [180, 55, 200, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Fcn"
		    SrcPort		    1
		    Points		    [15, 0; 0, -20]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "Fcn"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Gain
		  Name			  "max time-step\naverage speed\n(m/s)"
		  Position		  [865, 346, 895, 374]
		  FontName		  "Arial"
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  Ports			  [2, 1]
		  Position		  [770, 734, 795, 761]
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('/')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "min speed at END\nof time step gi"
"ven\ntire traction limit\n(m/s)"
		    Location		    [435, 32767, 641, 32767]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "in_1"
		    Position		    [30, 50, 50, 70]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "in_2"
		    Position		    [10, 80, 30, 100]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Fcn
		    Name		    "Fcn"
		    Position		    [60, 79, 90, 101]
		    FontName		    "Arial"
		    Expr		    "1/u"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [130, 56, 150, 74]
		    FontName		    "Arial"
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [180, 55, 200, 75]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "in_2"
		    SrcPort		    1
		    DstBlock		    "Fcn"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Fcn"
		    SrcPort		    1
		    Points		    [15, 0; 0, -20]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "in_1"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Gain
		  Name			  "min time-step\naverage speed\n(m/s)"
		  Position		  [880, 741, 910, 769]
		  FontName		  "Arial"
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear \nactive?"
		  Position		  [555, 71, 585, 99]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear \nactive?1"
		  Position		  [535, 531, 565, 559]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear \nactive?2"
		  Position		  [535, 591, 565, 619]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear \nactive?3"
		  Position		  [615, 1131, 640, 1159]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "rear slip\nterms"
		  Ports			  [3, 2]
		  Position		  [475, 540, 515, 600]
		  ForegroundColor	  "lightBlue"
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "rear slip\nterms"
		    Location		    [251, 364, 905, 608]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "automatic"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "initial speed"
		    Position		    [365, 48, 395, 62]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "1/dt"
		    Position		    [420, 68, 450, 82]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "sin(theta)"
		    Position		    [395, 163, 425, 177]
		    Port		    "3"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant12"
		    Position		    [15, 23, 320, 47]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Value		    "max(wh_slip_force_coeff)*(-1*veh_"
"cg_height)/veh_wheelbase"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant8"
		    Position		    [260, 149, 325, 171]
		    FontName		    "Arial"
		    Value		    "veh_gravity"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product13"
		    Ports		    [3, 1]
		    Position		    [470, 142, 490, 178]
		    FontName		    "Arial"
		    Inputs		    "3"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product14"
		    Ports		    [4, 1]
		    Position		    [485, 28, 505, 102]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Inputs		    "4"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Reference
		    Name		    "current \nveh mass (kg)"
		    Ports		    [0, 1]
		    Position		    [355, 83, 405, 117]
		    BackgroundColor	    "darkGreen"
		    SourceBlock		    "lib_controls/SubSystem/current ve"
"h mass (kg)"
		    SourceType		    "SubSystem"
		    ShowPortLabels	    "off"
		    TreatAsAtomicUnit	    "off"
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [540, 58, 570, 72]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out2"
		    Position		    [530, 153, 560, 167]
		    Port		    "2"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "sin(theta)"
		    SrcPort		    1
		    DstBlock		    "Product13"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Product13"
		    SrcPort		    1
		    DstBlock		    "Out2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "1/dt"
		    SrcPort		    1
		    DstBlock		    "Product14"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Product14"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "initial speed"
		    SrcPort		    1
		    DstBlock		    "Product14"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "current \nveh mass (kg)"
		    SrcPort		    1
		    Points		    [60, 0]
		    DstBlock		    "Product14"
		    DstPort		    4
		    }
		    Line {
		    SrcBlock		    "Constant8"
		    SrcPort		    1
		    DstBlock		    "Product13"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant12"
		    SrcPort		    1
		    Points		    [10, 0]
		    Branch {
		    Points		    [0, 0; 0, 115]
		    DstBlock		    "Product13"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Product14"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  MinMax
		  Name			  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  Ports			  [2, 1]
		  Position		  [975, 732, 1005, 763]
		  Function		  "max"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [1055, 655, 1075, 675]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [0, -5]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  Labels		  [0, 0]
		  SrcBlock		  "Fcn"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [105, 0]
		    Branch {
		    Points		    [0, 210]
		    Branch {
		    Points		    [0, -485]
		    Branch {
		    Points		    [0, -125]
		    DstBlock		    "Product2"
		    DstPort		    3
		    }
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    3
		    }
		    }
		    Branch {
		    DstBlock		    "Product5"
		    DstPort		    2
		    }
		    }
		    Branch {
		    Points		    [-5, 0; 0, 270]
		    Branch {
		    DstBlock		    "Product6"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Product14"
		    DstPort		    2
		    }
		    }
		  }
		  Branch {
		    DstBlock		    "rear slip\nterms"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [0, -15]
		  DstBlock		  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [0, 0; 40, 0]
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "Sum"
		    DstPort		    5
		  }
		  Branch {
		    Points		    [0, 405]
		    DstBlock		    "Sum3"
		    DstPort		    5
		  }
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  Points		  [0, -5; 35, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    4
		  }
		  Branch {
		    Points		    [0, 445]
		    DstBlock		    "Sum3"
		    DstPort		    4
		  }
		}
		Line {
		  SrcBlock		  "Product9"
		  SrcPort		  1
		  DstBlock		  "front \nactive?"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  Points		  [0, 0; 25, 0]
		  Branch {
		    Points		    [25, 0]
		    DstBlock		    "Sum"
		    DstPort		    6
		  }
		  Branch {
		    Points		    [0, 365]
		    DstBlock		    "Sum3"
		    DstPort		    6
		  }
		}
		Line {
		  SrcBlock		  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "Sum5"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<cyc>"
		  SrcPort		  1
		  DstBlock		  "Trig Fn"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  SrcPort		  1
		  Points		  [0, 0; 50, 0]
		  Branch {
		    Points		    [430, 0]
		    Branch {
		    Points		    [15, 0]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, 60]
		    Branch {
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, 10]
		    Branch {
		    DstBlock		    "Product1"
		    DstPort		    3
		    }
		    Branch {
		    Labels		    [1, 0]
		    Points		    [0, 50]
		    Branch {
		    Points		    [15, 0]
		    DstBlock		    "Product2"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, 110]
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		    }
		    Branch {
		    Labels		    [1, 0]
		    Points		    [0, 325]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Product4"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [245, 0; 0, -80]
		    Branch {
		    DstBlock		    "Sum4"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Sum5"
		    DstPort		    2
		    }
		    }
		    }
		    }
		    }
		    }
		    }
		  }
		  Branch {
		    Points		    [0, 265]
		    DstBlock		    "rear slip\nterms"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Trig Fn"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "Trig Fn1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Trig\nFn4"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Product6"
		  SrcPort		  1
		  DstBlock		  "front \nactive?1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product5"
		  SrcPort		  1
		  Points		  [0, 0; 30, 0]
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "Sum7"
		    DstPort		    3
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "Sum2"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Product7"
		  SrcPort		  1
		  Points		  [0, 0; 120, 0]
		  Branch {
		    Points		    [0, -20]
		    DstBlock		    "Sum7"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "Sum2"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Product4"
		  SrcPort		  1
		  Points		  [0, 0; 30, 0]
		  Branch {
		    Points		    [0, -5]
		    DstBlock		    "Sum7"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "Sum2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant6"
		  SrcPort		  1
		  DstBlock		  "Product4"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant9"
		  SrcPort		  1
		  DstBlock		  "Product6"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant7"
		  SrcPort		  1
		  DstBlock		  "Product7"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum7"
		  SrcPort		  1
		  Points		  [0, -225]
		  DstBlock		  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum3"
		  SrcPort		  1
		  DstBlock		  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "MinMax"
		  SrcPort		  1
		  Points		  [0, 385]
		  DstBlock		  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "min speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "Sum4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum4"
		  SrcPort		  1
		  DstBlock		  "min time-step\naverage speed\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  SrcPort		  1
		  Points		  [0, -85]
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "min time-step\naverage speed\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "requested time-step\naverage speed "
"limited\nby tire traction\n(m/s)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum2"
		  SrcPort		  1
		  Points		  [25, 0; 0, -645]
		  DstBlock		  "max speed at END\nof time step give"
"n\ntire traction limit\n(m/s)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "current veh mass (kg)6"
		  SrcPort		  1
		  DstBlock		  "Product5"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "Fcn"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Trig\nFn4"
		  SrcPort		  1
		  Points		  [0, 0; 10, 0]
		  Branch {
		    Points		    [0, 645]
		    DstBlock		    "Product7"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [80, 0]
		    Branch {
		    Points		    [290, 0]
		    DstBlock		    "Product"
		    DstPort		    3
		    }
		    Branch {
		    Points		    [0, -100]
		    Branch {
		    DstBlock		    "Product8"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -40]
		    Branch {
		    DstBlock		    "Product9"
		    DstPort		    2
		    }
		    Branch {
		    Points		    [0, -80]
		    DstBlock		    "Product12"
		    DstPort		    2
		    }
		    }
		    }
		  }
		}
		Line {
		  SrcBlock		  "Product8"
		  SrcPort		  1
		  Points		  [40, 0]
		  DstBlock		  "Sum6"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant11"
		  SrcPort		  1
		  DstBlock		  "Product8"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Product9"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum5"
		  SrcPort		  1
		  DstBlock		  "max time-step\naverage speed\n(m/s)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  SrcPort		  1
		  Points		  [50, 0; 0, 80]
		  DstBlock		  "MinMax"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "max time-step\naverage speed\n(m/s)"
		  SrcPort		  1
		  DstBlock		  "MinMax"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "current veh mass (kg)4"
		  SrcPort		  1
		  DstBlock		  "Product3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product3"
		  SrcPort		  1
		  Points		  [0, 0; 45, 0]
		  Branch {
		    Points		    [5, 0]
		    DstBlock		    "Sum"
		    DstPort		    8
		  }
		  Branch {
		    Points		    [0, 265]
		    DstBlock		    "Sum3"
		    DstPort		    7
		  }
		}
		Line {
		  SrcBlock		  "Product10"
		  SrcPort		  1
		  Points		  [50, 0]
		  DstBlock		  "Sum"
		  DstPort		  7
		}
		Line {
		  SrcBlock		  "Constant4"
		  SrcPort		  1
		  DstBlock		  "front \nactive?2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant10"
		  SrcPort		  1
		  Points		  [25, 0; 0, 20]
		  DstBlock		  "Product10"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Trig Fn1"
		  SrcPort		  1
		  Points		  [0, 0; 5, 0]
		  Branch {
		    DstBlock		    "Sum6"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 240]
		    Branch {
		    DstBlock		    "Product10"
		    DstPort		    3
		    }
		    Branch {
		    Points		    [0, 115]
		    DstBlock		    "rear slip\nterms"
		    DstPort		    3
		    }
		  }
		}
		Line {
		  SrcBlock		  "Sum6"
		  SrcPort		  1
		  DstBlock		  "Product11"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product11"
		  SrcPort		  1
		  Points		  [0, 0; 105, 0]
		  Branch {
		    Points		    [20, 0]
		    DstBlock		    "Sum"
		    DstPort		    3
		  }
		  Branch {
		    Labels		    [1, 0]
		    Points		    [0, 485]
		    DstBlock		    "Sum3"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  DstBlock		  "Product11"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "current veh mass (kg)"
		  SrcPort		  1
		  Points		  [105, 0]
		  DstBlock		  "Product11"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "current veh mass (kg)1"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Product"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "current veh mass (kg)2"
		  SrcPort		  1
		  DstBlock		  "Product9"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "current veh mass (kg)3"
		  SrcPort		  1
		  DstBlock		  "Product2"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "current veh mass (kg)5"
		  SrcPort		  1
		  DstBlock		  "Product7"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "current veh mass (kg)7"
		  SrcPort		  1
		  DstBlock		  "Product6"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Product12"
		  SrcPort		  1
		  DstBlock		  "rear \nactive?"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant5"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Product12"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "current veh mass (kg)8"
		  SrcPort		  1
		  DstBlock		  "Product12"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "rear \nactive?"
		  SrcPort		  1
		  Points		  [45, 0]
		  Branch {
		    Points		    [30, 0]
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 585]
		    DstBlock		    "Sum3"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "rear slip\nterms"
		  SrcPort		  1
		  DstBlock		  "rear \nactive?1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "rear slip\nterms"
		  SrcPort		  2
		  DstBlock		  "rear \nactive?2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product14"
		  SrcPort		  1
		  DstBlock		  "rear \nactive?3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant12"
		  SrcPort		  1
		  DstBlock		  "Product14"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "current veh mass (kg)10"
		  SrcPort		  1
		  DstBlock		  "Product14"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "rear \nactive?1"
		  SrcPort		  1
		  Points		  [5, 0; 0, 20; 30, 0]
		  Branch {
		    Points		    [60, 0]
		    DstBlock		    "Sum"
		    DstPort		    9
		  }
		  Branch {
		    Points		    [0, 245]
		    DstBlock		    "Sum3"
		    DstPort		    8
		  }
		}
		Line {
		  SrcBlock		  "rear \nactive?2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Sum"
		  DstPort		  10
		}
		Line {
		  SrcBlock		  "rear \nactive?3"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, -5; 65, 0]
		    DstBlock		    "Sum7"
		    DstPort		    5
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "Sum2"
		    DstPort		    5
		  }
		}
		Line {
		  SrcBlock		  "front \nactive?"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    Points		    [45, 0]
		    DstBlock		    "Sum"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 525]
		    DstBlock		    "Sum3"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "front \nactive?1"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, -50]
		    DstBlock		    "Sum7"
		    DstPort		    4
		  }
		  Branch {
		    Points		    [10, 0]
		    DstBlock		    "Sum2"
		    DstPort		    4
		  }
		}
		Line {
		  SrcBlock		  "front \nactive?2"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 65]
		    DstBlock		    "Product10"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      Ports		      [3, 4]
	      Position		      [255, 62, 285, 178]
	      ForegroundColor	      "lightBlue"
	      BackgroundColor	      "darkGreen"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		Location		[78, 78, 766, 631]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "tractive force req'd at\ntire/road "
"interface\n(N)"
		  Position		  [260, 385, 280, 405]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "requested time-step\naverage vehicl"
"e speed\n(m/s)"
		  Position		  [65, 20, 85, 40]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "speed at beginning\nof time step\n("
"m/s)"
		  Position		  [65, 85, 85, 105]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  MinMax
		  Name			  " "
		  Ports			  [2, 1]
		  Position		  [370, 372, 400, 403]
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [565, 480, 621, 520]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [229, 259, 712, 322]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [242, 12]
		    VerticalAlignment	    "top"
		    Text		    "No more force will be requested o"
"f the drivetrain than can be transmitted by the front tires.\nThis transmitta"
"ble force is computed taking into account the slip characteristics of the tir"
"es\nand the variable, acceleration-dependent weight borne by the front axle."
		    }
		  }
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [365, 174, 500, 196]
		  Orientation		  "left"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [370, 422, 395, 448]
		  FontName		  "Arial"
		  Gain			  "-1"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [265, 210, 285, 230]
		  Orientation		  "down"
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [2, 1]
		  Position		  [335, 230, 355, 250]
		  Orientation		  "down"
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product3"
		  Ports			  [2, 1]
		  Position		  [425, 322, 445, 353]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product4"
		  Ports			  [2, 1]
		  Position		  [145, 237, 165, 268]
		  Orientation		  "left"
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [305, 335, 325, 355]
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum2"
		  Ports			  [2, 1]
		  Position		  [200, 248, 225, 272]
		  Orientation		  "left"
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "front"
		  Ports			  [2, 1]
		  Position		  [175, 15, 215, 75]
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "front"
		    Location		    [344, 121, 909, 494]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "automatic"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 88, 55, 102]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "In2"
		    Position		    [25, 98, 55, 112]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 120, 85, 140]
		    FontName		    "Arial"
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [340, 23, 535, 47]
		    Orientation		    "left"
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Value		    "veh_cg_height/veh_wheelbase"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [140, 326, 320, 344]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Value		    "veh_gravity*veh_front_wt_frac"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    From
		    Name		    "From<cyc>"
		    Position		    [30, 204, 90, 226]
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "grade"
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Gain1"
		    Position		    [280, 92, 305, 118]
		    FontName		    "Arial"
		    Gain		    "2"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Gain2"
		    Position		    [235, 192, 315, 238]
		    Gain		    "veh_gravity"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [110, 145, 145, 165]
		    FontName		    "Arial"
		    X0			    "-0.1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [225, 96, 245, 114]
		    FontName		    "Arial"
		    Inputs		    "*/"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product1"
		    Ports		    [3, 1]
		    Position		    [410, 73, 430, 117]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Inputs		    "3"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product3"
		    Ports		    [3, 1]
		    Position		    [405, 263, 425, 307]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Inputs		    "3"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [80, 90, 100, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [165, 125, 185, 145]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum2"
		    Ports		    [2, 1]
		    Position		    [340, 97, 370, 128]
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn"
		    Ports		    [1, 1]
		    Position		    [120, 200, 150, 230]
		    Operator		    "atan"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn1"
		    Ports		    [1, 1]
		    Position		    [175, 200, 205, 230]
		    Operator		    "sin"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn2"
		    Ports		    [1, 1]
		    Position		    [175, 270, 205, 300]
		    Operator		    "cos"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Reference
		    Name		    "current veh mass (kg)"
		    Ports		    [0, 1]
		    Position		    [235, 157, 295, 173]
		    BackgroundColor	    "darkGreen"
		    SourceBlock		    "lib_controls/SubSystem/current ve"
"h mass (kg)"
		    SourceType		    "SubSystem"
		    ShowPortLabels	    "off"
		    TreatAsAtomicUnit	    "off"
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "weight on\nfront axle\n(N)1"
		    Ports		    [2, 1]
		    Position		    [465, 69, 485, 171]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "-+"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [510, 113, 540, 127]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "weight on\nfront axle\n(N)1"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In2"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "current veh mass (kg)"
		    SrcPort		    1
		    Points		    [0, 0; 90, 0]
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -55]
		    DstBlock		    "Product1"
		    DstPort		    3
		    }
		    }
		    Line {
		    SrcBlock		    "Trig Fn2"
		    SrcPort		    1
		    DstBlock		    "Product3"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    Points		    [65, 0]
		    DstBlock		    "Product3"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Product3"
		    SrcPort		    1
		    Points		    [20, 0]
		    DstBlock		    "weight on\nfront axle\n(N)1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Trig Fn"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, 70]
		    DstBlock		    "Trig Fn2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Trig Fn1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Gain2"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum2"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Trig Fn1"
		    SrcPort		    1
		    DstBlock		    "Gain2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From<cyc>"
		    SrcPort		    1
		    DstBlock		    "Trig Fn"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum2"
		    SrcPort		    1
		    Points		    [0, -20]
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Gain1"
		    SrcPort		    1
		    DstBlock		    "Sum2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Gain1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    Points		    [15, 0; 0, -25]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, 45]
		    DstBlock		    "Product1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product1"
		    SrcPort		    1
		    DstBlock		    "weight on\nfront axle\n(N)1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Gain
		  Name			  "front \nactive?"
		  Position		  [335, 275, 355, 305]
		  Orientation		  "down"
		  ForegroundColor	  "lightBlue"
		  FontName		  "Arial"
		  Gain			  "wh_front_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  ToWorkspace
		  Name			  "front traction ratio"
		  Position		  [120, 322, 245, 338]
		  FontName		  "Arial"
		  VariableName		  "front_traction_ratio_orig"
		  MaxDataPoints		  "inf"
		  Decimation		  "1"
		  SampleTime		  "0"
		  SaveFormat		  "Array"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "rear"
		  Ports			  [2, 1]
		  Position		  [175, 100, 215, 160]
		  ForegroundColor	  "lightBlue"
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "rear"
		    Location		    [185, 87, 750, 460]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "automatic"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Inport
		    Name		    "In1"
		    Position		    [25, 88, 55, 102]
		    Port		    "1"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Inport
		    Name		    "In2"
		    Position		    [25, 98, 55, 112]
		    Port		    "2"
		    LatchInput		    off
		    Interpolate		    on
		    }
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 120, 85, 140]
		    FontName		    "Arial"
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant"
		    Position		    [340, 23, 535, 47]
		    Orientation		    "left"
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Value		    "(-1*veh_cg_height)/veh_wheelbase"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant1"
		    Position		    [140, 326, 320, 344]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Value		    "veh_gravity*(1-veh_front_wt_frac)"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    From
		    Name		    "From<cyc>"
		    Position		    [30, 204, 90, 226]
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "grade"
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Gain1"
		    Position		    [280, 92, 305, 118]
		    FontName		    "Arial"
		    Gain		    "2"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Gain
		    Name		    "Gain2"
		    Position		    [235, 192, 315, 238]
		    Gain		    "veh_gravity"
		    Multiplication	    "Element-wise(K.*u)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [110, 145, 145, 165]
		    FontName		    "Arial"
		    X0			    "-0.1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product"
		    Ports		    [2, 1]
		    Position		    [225, 96, 245, 114]
		    FontName		    "Arial"
		    Inputs		    "*/"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product1"
		    Ports		    [3, 1]
		    Position		    [410, 73, 430, 117]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Inputs		    "3"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product3"
		    Ports		    [3, 1]
		    Position		    [405, 263, 425, 307]
		    BackgroundColor	    "darkGreen"
		    FontName		    "Arial"
		    Inputs		    "3"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum"
		    Ports		    [2, 1]
		    Position		    [80, 90, 100, 110]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [165, 125, 185, 145]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum2"
		    Ports		    [2, 1]
		    Position		    [340, 97, 370, 128]
		    IconShape		    "rectangular"
		    Inputs		    "++"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn"
		    Ports		    [1, 1]
		    Position		    [120, 200, 150, 230]
		    Operator		    "atan"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn1"
		    Ports		    [1, 1]
		    Position		    [175, 200, 205, 230]
		    Operator		    "sin"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn2"
		    Ports		    [1, 1]
		    Position		    [175, 270, 205, 300]
		    Operator		    "cos"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Reference
		    Name		    "current veh mass (kg)"
		    Ports		    [0, 1]
		    Position		    [235, 157, 295, 173]
		    BackgroundColor	    "darkGreen"
		    SourceBlock		    "lib_controls/SubSystem/current ve"
"h mass (kg)"
		    SourceType		    "SubSystem"
		    ShowPortLabels	    "off"
		    TreatAsAtomicUnit	    "off"
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "weight on\nrear axle\n(N)"
		    Ports		    [2, 1]
		    Position		    [465, 69, 485, 171]
		    FontName		    "Arial"
		    IconShape		    "rectangular"
		    Inputs		    "-+"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [510, 113, 540, 127]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "weight on\nrear axle\n(N)"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "In2"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "In1"
		    SrcPort		    1
		    DstBlock		    "Sum"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "current veh mass (kg)"
		    SrcPort		    1
		    Points		    [0, 0; 90, 0]
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -55]
		    DstBlock		    "Product1"
		    DstPort		    3
		    }
		    }
		    Line {
		    SrcBlock		    "Trig Fn2"
		    SrcPort		    1
		    DstBlock		    "Product3"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Constant1"
		    SrcPort		    1
		    Points		    [65, 0]
		    DstBlock		    "Product3"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Product3"
		    SrcPort		    1
		    Points		    [20, 0]
		    DstBlock		    "weight on\nrear axle\n(N)"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Trig Fn"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, 70]
		    DstBlock		    "Trig Fn2"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Trig Fn1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Gain2"
		    SrcPort		    1
		    Points		    [5, 0]
		    DstBlock		    "Sum2"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Trig Fn1"
		    SrcPort		    1
		    DstBlock		    "Gain2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From<cyc>"
		    SrcPort		    1
		    DstBlock		    "Trig Fn"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum2"
		    SrcPort		    1
		    Points		    [0, -20]
		    DstBlock		    "Product1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Gain1"
		    SrcPort		    1
		    DstBlock		    "Sum2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product"
		    SrcPort		    1
		    DstBlock		    "Gain1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    Points		    [15, 0; 0, -25]
		    DstBlock		    "Product"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Sum"
		    SrcPort		    1
		    DstBlock		    "Product"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant"
		    SrcPort		    1
		    Points		    [0, 45]
		    DstBlock		    "Product1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product1"
		    SrcPort		    1
		    DstBlock		    "weight on\nrear axle\n(N)"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear \nactive?"
		  Position		  [265, 275, 285, 305]
		  Orientation		  "down"
		  ForegroundColor	  "lightBlue"
		  NamePlacement		  "alternate"
		  FontName		  "Arial"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  MinMax
		  Name			  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  Ports			  [2, 1]
		  Position		  [450, 412, 480, 443]
		  Function		  "max"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Outport
		  Name			  "slip-limited force\n(N)"
		  Position		  [570, 420, 590, 440]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "weight on front axle\n(N)"
		  Position		  [390, 35, 410, 55]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "weight on rear axle\n(N)"
		  Position		  [390, 120, 410, 140]
		  ForegroundColor	  "lightBlue"
		  Port			  "3"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "front/total\ntraction ratio"
		  Position		  [495, 330, 515, 350]
		  ForegroundColor	  "lightBlue"
		  Port			  "4"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "front"
		  SrcPort		  1
		  Points		  [110, 0]
		  Branch {
		    Points		    [0, 170]
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "weight on front axle\n(N)"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "requested time-step\naverage vehicl"
"e speed\n(m/s)"
		  SrcPort		  1
		  Points		  [55, 0]
		  Branch {
		    DstBlock		    "front"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 85]
		    DstBlock		    "rear"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "speed at beginning\nof time step\n("
"m/s)"
		  SrcPort		  1
		  Points		  [35, 0]
		  Branch {
		    Points		    [35, 0]
		    DstBlock		    "front"
		    DstPort		    2
		  }
		  Branch {
		    Points		    [0, 50]
		    DstBlock		    "rear"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [-10, 0; 0, 10]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Product1"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "tractive force req'd at\ntire/road "
"interface\n(N)"
		  SrcPort		  1
		  DstBlock		  " "
		  DstPort		  2
		}
		Line {
		  SrcBlock		  " "
		  SrcPort		  1
		  Points		  [15, 0; 0, 30]
		  DstBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  SrcPort		  1
		  DstBlock		  "slip-limited force\n(N)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "rear"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "weight on rear axle\n(N)"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 65]
		    DstBlock		    "Product1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  Points		  [10, 0; 0, 15]
		  Branch {
		    Points		    [0, 20]
		    Branch {
		    DstBlock		    " "
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 55]
		    DstBlock		    "Gain"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [70, 0]
		    DstBlock		    "Product3"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [0, 25]
		  Branch {
		    DstBlock		    "rear \nactive?"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [-35, 0]
		    DstBlock		    "Sum2"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "front \nactive?"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [-100, 0]
		    Branch {
		    DstBlock		    "Sum2"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, -10]
		    DstBlock		    "Product4"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Product3"
		  SrcPort		  1
		  DstBlock		  "front/total\ntraction ratio"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "front \nactive?"
		  SrcPort		  1
		  Points		  [0, -5; 0, 10]
		  Branch {
		    Points		    [0, 10; -55, 0]
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [65, 0]
		    DstBlock		    "Product3"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "rear \nactive?"
		  SrcPort		  1
		  Points		  [0, 40]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum2"
		  SrcPort		  1
		  DstBlock		  "Product4"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product4"
		  SrcPort		  1
		  Points		  [-35, 0]
		  DstBlock		  "front traction ratio"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [320, 50, 340, 70]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [360, 15, 380, 35]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [350, 95, 370, 115]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [405, 125, 425, 145]
	      ForegroundColor	      "lightBlue"
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [325, 155, 345, 175]
	      ForegroundColor	      "lightBlue"
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		DstPort			2
	      }
	      Branch {
		Points			[0, -95]
		DstBlock		"req'd speed\n(m/s)"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      DstBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      1
	      Points		      [0, -15]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      2
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[115, 0; 0, -30]
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		DstPort			3
	      }
	      Branch {
		Points			[0, -60]
		DstBlock		"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      DstBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      3
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      4
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "traction control J2452"
	  Ports			  [3, 3]
	  Position		  [410, 35, 445, 135]
	  BackgroundColor	  "darkGreen"
	  AncestorBlock		  "lib_controls/SubSystem/traction\n control"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "traction control J2452"
	    Location		    [6, 74, 553, 353]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [45, 95, 65, 115]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [50, 180, 70, 200]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [45, 70, 65, 90]
	      NamePlacement	      "alternate"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [310, 215, 366, 255]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 504, 317]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [137, 12]
		  VerticalAlignment	  "top"
		  Text			  "Requested speed and force are limit"
"ed by the\ntractive characteristics of the tires in this block."
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      Ports		      [2, 1]
	      Position		      [135, 97, 165, 148]
	      BackgroundColor	      "darkGreen"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		Location		[2, 44, 1014, 742]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  Position		  [65, 15, 85, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  Position		  [60, 630, 80, 650]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [695, 620, 751, 660]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [135, 290, 822, 501]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [347, 22]
		    VerticalAlignment	    "top"
		    Text		    "This block limits the requested s"
"peed by the maximum and minimum attainable given the maximum traction of the "
"tires.\nThat is, acceleration and braking maneuvers are limited to the point "
"of imminent skidding."
		    }
		    Annotation {
		    Position		    [337, 57]
		    VerticalAlignment	    "top"
		    Text		    "The above equations are derived b"
"y solving F_maxaccel=mass*a_max for the maximum or minimum speed at the end o"
"f the time step,\ngiven that F_maxaccel depends on the weight borne by the fr"
"ont tires which in turn depends on the vehicle's acceleration rate."
		    }
		    Annotation {
		    Position		    [337, 92]
		    VerticalAlignment	    "top"
		    Text		    "Front-wheel drive is assumed, and"
" weight transfer due to acceleration is included in the calculation of maximu"
"m tractive force.\n\nSAE J2452 rolling resistance model is included.\n\nRolli"
"ng resistance coefficients veh_rr_a and veh_rr_b have units of N/km/h and N/("
"km/h)^2 respectively.\nEach is converted to N/m/s and N/(m/s)^2 with the gain"
" blocks before it is input into the final traction equation.\n\nVeh_rr_a, veh"
"_rr_b, and veh_rr_c must always be adjusted for roadwheel curvature before us"
"e."
		    }
		  }
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [210, 205, 230, 225]
		  FontName		  "Arial"
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [540, 122, 600, 138]
		  ShowName		  off
		  Value			  "veh_CD"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [540, 186, 600, 204]
		  ShowName		  off
		  Value			  "veh_FA"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant10"
		  Position		  [450, 502, 545, 518]
		  ShowName		  off
		  Value			  "veh_gravity"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant11"
		  Position		  [65, 600, 270, 620]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "(veh_cg_height/veh_wheelbase)"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant12"
		  Position		  [25, 528, 110, 552]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "wh_radius"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant13"
		  Position		  [170, 444, 290, 466]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant14"
		  Position		  [415, 559, 440, 581]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [150, 46, 435, 64]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_gravit"
"y*veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [450, 241, 545, 259]
		  ShowName		  off
		  Value			  "veh_air_density"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant4"
		  Position		  [450, 272, 545, 288]
		  ShowName		  off
		  Value			  "veh_rr_alpha"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant5"
		  Position		  [450, 307, 545, 323]
		  ShowName		  off
		  Value			  "veh_rr_beta"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant6"
		  Position		  [385, 382, 480, 398]
		  ShowName		  off
		  Value			  "veh_rr_a"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant7"
		  Position		  [385, 412, 480, 428]
		  ShowName		  off
		  Value			  "veh_rr_b"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant8"
		  Position		  [390, 441, 485, 459]
		  ShowName		  off
		  Value			  "veh_rr_c"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant9"
		  Position		  [450, 471, 545, 489]
		  ShowName		  off
		  Value			  "wh_pressure"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Curvature Correction Factor"
		  Position		  [80, 314, 380, 346]
		  Value			  "(veh_roadwheel_radius/(veh_roadwhee"
"l_radius+wh_radius))"
		  VectorParams1D	  off
		}
		Block {
		  BlockType		  MinMax
		  Name			  "Error Check"
		  Ports			  [2, 1]
		  Position		  [470, 537, 500, 568]
		  Function		  "max"
		  Inputs		  "2"
		  Port {
		    PortNumber		    1
		    Name		    "Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [110, 562, 185, 578]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "Fr_out"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>"
		  Position		  [40, 94, 100, 116]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>1"
		  Position		  [295, 129, 355, 151]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>2"
		  Position		  [125, 384, 185, 406]
		  NamePlacement		  "alternate"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  From
		  Name			  "From<wh>"
		  Position		  [12, 420, 108, 450]
		  Orientation		  "down"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "wh_trq_a"
		}
		Block {
		  BlockType		  Math
		  Name			  "Math\nFunction3"
		  Ports			  [1, 1]
		  Position		  [405, 315, 435, 345]
		  ShowName		  off
		  Operator		  "sqrt"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [255, 245, 295, 265]
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [40, 470, 80, 490]
		  Orientation		  "down"
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax"
		  Ports			  [2, 1]
		  Position		  [760, 247, 790, 278]
		  ShowName		  off
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [17, 1]
		  Position		  [655, 59, 670, 631]
		  ShowName		  off
		  Inputs		  "17"
		  DisplayOption		  "bar"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [3, 1]
		  Position		  [315, 423, 335, 447]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [2, 1]
		  Position		  [525, 353, 545, 377]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product3"
		  Ports			  [2, 1]
		  Position		  [530, 388, 550, 412]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product4"
		  Ports			  [2, 1]
		  Position		  [150, 513, 170, 537]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product5"
		  Ports			  [2, 1]
		  Position		  [310, 538, 330, 562]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product6"
		  Ports			  [2, 1]
		  Position		  [365, 588, 385, 612]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "W"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Product
		  Name			  "Product7"
		  Ports			  [2, 1]
		  Position		  [525, 423, 545, 447]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product9"
		  Ports			  [3, 1]
		  Position		  [515, 53, 535, 87]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "Ftract"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [395, 530, 415, 550]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [315, 210, 335, 230]
		  ShowName		  off
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "dt"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum4"
		  Ports			  [2, 1]
		  Position		  [220, 530, 240, 550]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum5"
		  Ports			  [2, 1]
		  Position		  [570, 565, 590, 585]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "Nr=W-Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn"
		  Ports			  [1, 1]
		  Position		  [115, 90, 145, 120]
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn1"
		  Ports			  [1, 1]
		  Position		  [165, 90, 195, 120]
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn2"
		  Ports			  [1, 1]
		  Position		  [370, 125, 400, 155]
		  ShowName		  off
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		  Port {
		    PortNumber		    1
		    Name		    "theta"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn3"
		  Ports			  [1, 1]
		  Position		  [200, 380, 230, 410]
		  ShowName		  off
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn4"
		  Ports			  [1, 1]
		  Position		  [250, 380, 280, 410]
		  ShowName		  off
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Vf"
		  Position		  [690, 293, 730, 327]
		  Expr			  "-1/2*(-2*u(4)*u(17)-2*u(1)*u(6)+4*u"
"(13)^u(8)*u(6)*(1/2*u(15))^u(9)*u(10)+4*u(13)^u(8)*u(6)*(1/2*u(15))^u(9)*u(11"
")*u(17)+4*u(13)^u(8)*u(6)*(1/2*u(15))^u(9)*u(12)*u(17)^2+4*u(13)^u(8)*u(6)*(1"
"/2*u(16))^u(9)*u(10)+4*u(13)^u(8)*u(6)*(1/2*u(16))^u(9)*u(11)*u(17)+4*u(13)^u"
"(8)*u(6)*(1/2*u(16))^u(9)*u(12)*u(17)^2+u(7)*u(3)*u(5)*u(17)^2*u(6)+2*u(4)*u("
"14)*sin(u(2))*u(6))/u(4)"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)1"
		  Ports			  [0, 1]
		  Position		  [190, 482, 250, 498]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)2"
		  Ports			  [0, 1]
		  Position		  [375, 82, 435, 98]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)6"
		  Ports			  [0, 1]
		  Position		  [540, 152, 600, 168]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Gain
		  Name			  "unit conversion"
		  Position		  [570, 434, 635, 466]
		  Gain			  "3.6*3.6"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "unit conversion2"
		  Position		  [585, 407, 630, 433]
		  NamePlacement		  "alternate"
		  Gain			  "3.6"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [810, 255, 830, 275]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Product7"
		  SrcPort		  1
		  Points		  [0, 15]
		  DstBlock		  "unit conversion"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant8"
		  SrcPort		  1
		  Points		  [10, 0; 0, -10]
		  DstBlock		  "Product7"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product3"
		  SrcPort		  1
		  Points		  [5, 0; 0, 20]
		  DstBlock		  "unit conversion2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant7"
		  SrcPort		  1
		  Points		  [15, 0; 0, -15]
		  DstBlock		  "Product3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  Points		  [45, 0; 0, 15]
		  DstBlock		  "Mux"
		  DstPort		  10
		}
		Line {
		  SrcBlock		  "Constant6"
		  SrcPort		  1
		  Points		  [10, 0; 0, -20]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Math\nFunction3"
		  SrcPort		  1
		  Points		  [35, 0; 0, 30; 30, 0]
		  Branch {
		    Points		    [0, 35]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Product7"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Curvature Correction Factor"
		  SrcPort		  1
		  DstBlock		  "Math\nFunction3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "unit conversion"
		  SrcPort		  1
		  DstBlock		  "Mux"
		  DstPort		  12
		}
		Line {
		  SrcBlock		  "unit conversion2"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Mux"
		  DstPort		  11
		}
		Line {
		  Name			  "Nf"
		  Labels		  [0, 0]
		  SrcBlock		  "Error Check"
		  SrcPort		  1
		  Points		  [0, 0; 45, 0]
		  Branch {
		    Points		    [0, 15]
		    DstBlock		    "Sum5"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Mux"
		    DstPort		    15
		  }
		}
		Line {
		  SrcBlock		  "Constant14"
		  SrcPort		  1
		  Points		  [5, 0; 0, -10]
		  DstBlock		  "Error Check"
		  DstPort		  2
		}
		Line {
		  Name			  "Nf"
		  Labels		  [0, 0]
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [15, 0; 0, 5]
		  DstBlock		  "Error Check"
		  DstPort		  1
		}
		Line {
		  Name			  "Nr=W-Nf"
		  Labels		  [0, 0]
		  SrcBlock		  "Sum5"
		  SrcPort		  1
		  Points		  [35, 0; 0, 15]
		  DstBlock		  "Mux"
		  DstPort		  16
		}
		Line {
		  Name			  "W"
		  Labels		  [0, 0]
		  SrcBlock		  "Product6"
		  SrcPort		  1
		  Points		  [150, 0; 0, -20]
		  DstBlock		  "Sum5"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [75, 0]
		  DstBlock		  "Product4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<wh>"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  SrcPort		  1
		  Points		  [510, 0; 0, -15]
		  DstBlock		  "Mux"
		  DstPort		  17
		}
		Line {
		  SrcBlock		  "current veh mass (kg)1"
		  SrcPort		  1
		  Points		  [0, 0; 45, 0]
		  Branch {
		    Points		    [35, 0; 0, 115]
		    DstBlock		    "Product6"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Product1"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Constant13"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Trig Fn4"
		  SrcPort		  1
		  Points		  [0, 0; 15, 0]
		  Branch {
		    Points		    [50, 0]
		    DstBlock		    "Product6"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Product1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Trig Fn3"
		  SrcPort		  1
		  DstBlock		  "Trig Fn4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<cyc>2"
		  SrcPort		  1
		  DstBlock		  "Trig Fn3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant10"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  14
		}
		Line {
		  SrcBlock		  "Constant9"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  13
		}
		Line {
		  SrcBlock		  "Constant5"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  9
		}
		Line {
		  SrcBlock		  "Constant4"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  8
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  7
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [0, 10]
		  DstBlock		  "Mux"
		  DstPort		  5
		}
		Line {
		  SrcBlock		  "current veh mass (kg)6"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "Vf"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Trig Fn1"
		  SrcPort		  1
		  Points		  [150, 0; 0, -35]
		  DstBlock		  "Product9"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "current veh mass (kg)2"
		  SrcPort		  1
		  Points		  [0, -10]
		  DstBlock		  "Product9"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  SrcPort		  1
		  Points		  [605, 0; 0, 230]
		  DstBlock		  "MinMax"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Product9"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Trig Fn"
		  SrcPort		  1
		  DstBlock		  "Trig Fn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<cyc>"
		  SrcPort		  1
		  DstBlock		  "Trig Fn"
		  DstPort		  1
		}
		Line {
		  Name			  "Ftract"
		  Labels		  [0, 0]
		  SrcBlock		  "Product9"
		  SrcPort		  1
		  Points		  [100, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  Name			  "dt"
		  Labels		  [0, 0]
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  Points		  [300, 0]
		  DstBlock		  "Mux"
		  DstPort		  6
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From<cyc>1"
		  SrcPort		  1
		  DstBlock		  "Trig Fn2"
		  DstPort		  1
		}
		Line {
		  Name			  "theta"
		  Labels		  [0, 0]
		  SrcBlock		  "Trig Fn2"
		  SrcPort		  1
		  Points		  [100, 0; 0, -35; 135, 0]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [30, 0; 0, 100]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "MinMax"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant12"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Product4"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product4"
		  SrcPort		  1
		  Points		  [15, 0; 0, 10]
		  DstBlock		  "Sum4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum4"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum4"
		  SrcPort		  1
		  Points		  [25, 0; 0, 5]
		  DstBlock		  "Product5"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant11"
		  SrcPort		  1
		  Points		  [10, 0; 0, -55]
		  DstBlock		  "Product5"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product5"
		  SrcPort		  1
		  Points		  [45, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Vf"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "MinMax"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      Ports		      [3, 2]
	      Position		      [255, 62, 285, 178]
	      BackgroundColor	      "darkGreen"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		Location		[76, 174, 963, 715]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "tractive force req'd at\ntire/road "
"interface\n(N)"
		  Position		  [70, 385, 90, 405]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "requested time-step\naverage vehicl"
"e speed\n(m/s)"
		  Position		  [70, 15, 90, 35]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "speed at beginning\nof time step\n("
"m/s)"
		  Position		  [65, 85, 85, 105]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  MinMax
		  Name			  " "
		  Ports			  [2, 1]
		  Position		  [620, 372, 650, 403]
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [815, 480, 871, 520]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [229, 259, 712, 322]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [242, 12]
		    VerticalAlignment	    "top"
		    Text		    "No more force will be requested o"
"f the drivetrain than can be transmitted by the front tires.\nThis transmitta"
"ble force is computed taking into account the slip characteristics of the tir"
"es\nand the variable, acceleration-dependent weight borne by the front axle."
		    }
		  }
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [140, 110, 160, 130]
		  FontName		  "Arial"
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [415, 13, 610, 37]
		  Orientation		  "left"
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "veh_cg_height/veh_wheelbase"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [215, 316, 395, 334]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Value			  "veh_gravity*veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [605, 274, 740, 296]
		  Orientation		  "left"
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>"
		  Position		  [105, 194, 165, 216]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [620, 422, 645, 448]
		  FontName		  "Arial"
		  Gain			  "-1"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain1"
		  Position		  [355, 82, 380, 108]
		  FontName		  "Arial"
		  Gain			  "2"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain2"
		  Position		  [310, 182, 390, 228]
		  Gain			  "veh_gravity"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [185, 135, 220, 155]
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [300, 86, 320, 104]
		  FontName		  "Arial"
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [3, 1]
		  Position		  [485, 63, 505, 107]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [2, 1]
		  Position		  [585, 340, 605, 360]
		  Orientation		  "down"
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product3"
		  Ports			  [3, 1]
		  Position		  [480, 253, 500, 297]
		  BackgroundColor	  "darkGreen"
		  FontName		  "Arial"
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [155, 80, 175, 100]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [240, 115, 260, 135]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum2"
		  Ports			  [2, 1]
		  Position		  [415, 87, 445, 118]
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn"
		  Ports			  [1, 1]
		  Position		  [195, 190, 225, 220]
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn1"
		  Ports			  [1, 1]
		  Position		  [250, 190, 280, 220]
		  Operator		  "sin"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn2"
		  Ports			  [1, 1]
		  Position		  [250, 260, 280, 290]
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)"
		  Ports			  [0, 1]
		  Position		  [310, 147, 370, 163]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  Ports			  [2, 1]
		  Position		  [700, 412, 730, 443]
		  Function		  "max"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Sum
		  Name			  "weight on\nfront axle\n(N)"
		  Ports			  [2, 1]
		  Position		  [540, 59, 560, 161]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "slip-limited force\n(N)"
		  Position		  [820, 420, 840, 440]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "weight on front axle\n(N)"
		  Position		  [820, 100, 840, 120]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  DstBlock		  "weight on\nfront axle\n(N)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [0, 45]
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "weight on\nfront axle\n(N)"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "weight on front axle\n(N)"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "requested time-step\naverage vehicl"
"e speed\n(m/s)"
		  SrcPort		  1
		  Points		  [40, 0; 0, 60]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "speed at beginning\nof time step\n("
"m/s)"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  Points		  [15, 0; 0, -25]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Gain1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  DstBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "tractive force req'd at\ntire/road "
"interface\n(N)"
		  SrcPort		  1
		  DstBlock		  " "
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  Points		  [0, 15]
		  Branch {
		    DstBlock		    " "
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 55]
		    DstBlock		    "Gain"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  " "
		  SrcPort		  1
		  Points		  [15, 0; 0, 30]
		  DstBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "tractive force request\nlimited by "
"slip-threshhold\nforce (N)1"
		  SrcPort		  1
		  DstBlock		  "slip-limited force\n(N)"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Gain1"
		  SrcPort		  1
		  DstBlock		  "Sum2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From<cyc>"
		  SrcPort		  1
		  DstBlock		  "Trig Fn"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Trig Fn1"
		  SrcPort		  1
		  DstBlock		  "Gain2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Gain2"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Trig Fn"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    DstBlock		    "Trig Fn1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 70]
		    DstBlock		    "Trig Fn2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Product3"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "weight on\nfront axle\n(N)"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [65, 0]
		  DstBlock		  "Product3"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Trig Fn2"
		  SrcPort		  1
		  DstBlock		  "Product3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "current veh mass (kg)"
		  SrcPort		  1
		  Points		  [90, 0]
		  Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -55]
		    DstBlock		    "Product1"
		    DstPort		    3
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [330, 60, 350, 80]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [330, 15, 350, 35]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [330, 120, 350, 140]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      SrcPort		      1
	      Points		      [0, -5; 20, 0]
	      Branch {
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		DstPort			2
	      }
	      Branch {
		Points			[0, -95]
		DstBlock		"req'd speed\n(m/s)"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      DstBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      1
	      Points		      [0, -20]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)"
	      SrcPort		      2
	      Points		      [0, -20]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[115, 0; 0, -30]
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)"
		DstPort			3
	      }
	      Branch {
		Points			[0, -55]
		DstBlock		"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "traction control J2452 2 axle"
	  Ports			  [3, 5]
	  Position		  [755, 144, 790, 246]
	  ForegroundColor	  "lightBlue"
	  BackgroundColor	  "darkGreen"
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "traction control J2452 2 axle"
	    Location		    [31, 184, 578, 463]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      Position		      [45, 95, 65, 115]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      Position		      [50, 180, 70, 200]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "total tractive\nforce req'd\n(N)"
	      Position		      [45, 70, 65, 90]
	      NamePlacement	      "alternate"
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [400, 215, 456, 255]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[229, 259, 504, 317]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [137, 12]
		  VerticalAlignment	  "top"
		  Text			  "Requested speed and force are limit"
"ed by the\ntractive characteristics of the tires in this block."
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      Ports		      [2, 1]
	      Position		      [135, 97, 165, 148]
	      BackgroundColor	      "darkGreen"
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		Location		[2, 74, 998, 742]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  Position		  [65, 15, 85, 35]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  Position		  [60, 630, 80, 650]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Block NOTES"
		  Ports			  []
		  Position		  [765, 670, 821, 710]
		  BackgroundColor	  "green"
		  ShowName		  off
		  ShowPortLabels	  on
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  MaskDisplay		  "disp('Block\\nNOTES')"
		  MaskIconFrame		  on
		  MaskIconOpaque	  on
		  MaskIconRotate	  "none"
		  MaskIconUnits		  "autoscale"
		  System {
		    Name		    "Block NOTES"
		    Location		    [135, 290, 822, 501]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Annotation {
		    Position		    [347, 22]
		    VerticalAlignment	    "top"
		    Text		    "This block limits the requested s"
"peed by the maximum and minimum attainable given the maximum traction of the "
"tires.\nThat is, acceleration and braking maneuvers are limited to the point "
"of imminent skidding."
		    }
		    Annotation {
		    Position		    [337, 57]
		    VerticalAlignment	    "top"
		    Text		    "The above equations are derived b"
"y solving F_maxaccel=mass*a_max for the maximum or minimum speed at the end o"
"f the time step,\ngiven that F_maxaccel depends on the weight borne by the fr"
"ont tires which in turn depends on the vehicle's acceleration rate."
		    }
		    Annotation {
		    Position		    [337, 92]
		    VerticalAlignment	    "top"
		    Text		    "Front-wheel drive is assumed, and"
" weight transfer due to acceleration is included in the calculation of maximu"
"m tractive force.\n\nSAE J2452 rolling resistance model is included.\n\nRolli"
"ng resistance coefficients veh_rr_a and veh_rr_b have units of N/km/h and N/("
"km/h)^2 respectively.\nEach is converted to N/m/s and N/(m/s)^2 with the gain"
" blocks before it is input into the final traction equation.\n\nVeh_rr_a, veh"
"_rr_b, and veh_rr_c must always be adjusted for roadwheel curvature before us"
"e."
		    }
		  }
		}
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [210, 205, 230, 225]
		  FontName		  "Arial"
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [540, 122, 600, 138]
		  ShowName		  off
		  Value			  "veh_CD"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [540, 186, 600, 204]
		  ShowName		  off
		  Value			  "veh_FA"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant10"
		  Position		  [450, 502, 545, 518]
		  ShowName		  off
		  Value			  "veh_gravity"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant11"
		  Position		  [65, 600, 270, 620]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "(veh_cg_height/veh_wheelbase)"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant12"
		  Position		  [25, 528, 110, 552]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "wh_radius"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant13"
		  Position		  [170, 444, 290, 466]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant14"
		  Position		  [415, 559, 440, 581]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant2"
		  Position		  [150, 46, 435, 64]
		  BackgroundColor	  "darkGreen"
		  ShowName		  off
		  FontName		  "Arial"
		  Value			  "max(wh_slip_force_coeff)*veh_gravit"
"y*veh_front_wt_frac"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [450, 241, 545, 259]
		  ShowName		  off
		  Value			  "veh_air_density"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant4"
		  Position		  [450, 272, 545, 288]
		  ShowName		  off
		  Value			  "veh_rr_alpha"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant5"
		  Position		  [450, 307, 545, 323]
		  ShowName		  off
		  Value			  "veh_rr_beta"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant6"
		  Position		  [385, 382, 480, 398]
		  ShowName		  off
		  Value			  "veh_rr_a"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant7"
		  Position		  [385, 412, 480, 428]
		  ShowName		  off
		  Value			  "veh_rr_b"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant8"
		  Position		  [390, 441, 485, 459]
		  ShowName		  off
		  Value			  "veh_rr_c"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant9"
		  Position		  [450, 471, 545, 489]
		  ShowName		  off
		  Value			  "wh_pressure"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Curvature Correction Factor"
		  Position		  [80, 314, 380, 346]
		  Value			  "(veh_roadwheel_radius/(veh_roadwhee"
"l_radius+wh_radius))"
		  VectorParams1D	  off
		}
		Block {
		  BlockType		  MinMax
		  Name			  "Error Check"
		  Ports			  [2, 1]
		  Position		  [470, 537, 500, 568]
		  Function		  "max"
		  Inputs		  "2"
		  Port {
		    PortNumber		    1
		    Name		    "Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  From
		  Name			  "From <veh>"
		  Position		  [110, 562, 185, 578]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "Fr_out"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>"
		  Position		  [150, 84, 210, 106]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>1"
		  Position		  [295, 129, 355, 151]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  From
		  Name			  "From<cyc>2"
		  Position		  [125, 384, 185, 406]
		  NamePlacement		  "alternate"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "grade"
		}
		Block {
		  BlockType		  From
		  Name			  "From<wh>"
		  Position		  [12, 420, 108, 450]
		  Orientation		  "down"
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "wh_trq_a"
		}
		Block {
		  BlockType		  Math
		  Name			  "Math\nFunction3"
		  Ports			  [1, 1]
		  Position		  [405, 315, 435, 345]
		  ShowName		  off
		  Operator		  "sqrt"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [255, 245, 295, 265]
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [40, 470, 80, 490]
		  Orientation		  "down"
		  FontName		  "Arial"
		  X0			  "-0.1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  MinMax
		  Name			  "MinMax"
		  Ports			  [2, 1]
		  Position		  [760, 247, 790, 278]
		  ShowName		  off
		  Function		  "min"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Mux
		  Name			  "Mux"
		  Ports			  [20, 1]
		  Position		  [655, 42, 675, 743]
		  ShowName		  off
		  Inputs		  "20"
		  DisplayOption		  "bar"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [3, 1]
		  Position		  [315, 423, 335, 447]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product2"
		  Ports			  [2, 1]
		  Position		  [525, 353, 545, 377]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product3"
		  Ports			  [2, 1]
		  Position		  [530, 388, 550, 412]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product4"
		  Ports			  [2, 1]
		  Position		  [150, 513, 170, 537]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product5"
		  Ports			  [2, 1]
		  Position		  [310, 538, 330, 562]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product6"
		  Ports			  [2, 1]
		  Position		  [365, 588, 385, 612]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "W"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Product
		  Name			  "Product7"
		  Ports			  [2, 1]
		  Position		  [525, 423, 545, 447]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product9"
		  Ports			  [3, 1]
		  Position		  [515, 53, 535, 87]
		  BackgroundColor	  "darkGreen"
		  NamePlacement		  "alternate"
		  ShowName		  off
		  Inputs		  "3"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "Ftract"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Subsystem"
		  Ports			  [0, 2]
		  Position		  [445, 700, 485, 760]
		  ForegroundColor	  "lightBlue"
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "Subsystem"
		    Location		    [111, 265, 794, 557]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "automatic"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Constant
		    Name		    "Constant16"
		    Position		    [80, 245, 285, 265]
		    ForegroundColor	    "lightBlue"
		    BackgroundColor	    "darkGreen"
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "(-1*veh_cg_height/veh_wheelbase)"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant17"
		    Position		    [40, 173, 125, 197]
		    BackgroundColor	    "darkGreen"
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "wh_radius"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant18"
		    Position		    [185, 89, 305, 111]
		    ForegroundColor	    "lightBlue"
		    BackgroundColor	    "darkGreen"
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "(1-veh_front_wt_frac)"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    Constant
		    Name		    "Constant19"
		    Position		    [430, 204, 455, 226]
		    BackgroundColor	    "darkGreen"
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "0"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    MinMax
		    Name		    "Error Check1"
		    Ports		    [2, 1]
		    Position		    [485, 182, 515, 213]
		    Function		    "max"
		    Inputs		    "2"
		    Port {
		    PortNumber		    1
		    Name		    "Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		    }
		    }
		    Block {
		    BlockType		    From
		    Name		    "From <veh>1"
		    Position		    [125, 207, 200, 223]
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "Fr_out"
		    }
		    Block {
		    BlockType		    From
		    Name		    "From<cyc>4"
		    Position		    [140, 29, 200, 51]
		    NamePlacement	    "alternate"
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "grade"
		    }
		    Block {
		    BlockType		    From
		    Name		    "From<wh>1"
		    Position		    [27, 65, 123, 95]
		    Orientation		    "down"
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "wh_trq_a"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory2"
		    Position		    [55, 115, 95, 135]
		    Orientation		    "down"
		    FontName		    "Arial"
		    X0			    "-0.1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product10"
		    Ports		    [3, 1]
		    Position		    [330, 68, 350, 92]
		    BackgroundColor	    "darkGreen"
		    NamePlacement	    "alternate"
		    ShowName		    off
		    Inputs		    "3"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product11"
		    Ports		    [2, 1]
		    Position		    [165, 158, 185, 182]
		    BackgroundColor	    "darkGreen"
		    NamePlacement	    "alternate"
		    ShowName		    off
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product12"
		    Ports		    [2, 1]
		    Position		    [325, 183, 345, 207]
		    BackgroundColor	    "darkGreen"
		    NamePlacement	    "alternate"
		    ShowName		    off
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product13"
		    Ports		    [2, 1]
		    Position		    [380, 233, 400, 257]
		    BackgroundColor	    "darkGreen"
		    NamePlacement	    "alternate"
		    ShowName		    off
		    Inputs		    "2"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    Port {
		    PortNumber		    1
		    Name		    "W"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		    }
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum2"
		    Ports		    [2, 1]
		    Position		    [410, 175, 430, 195]
		    ShowName		    off
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    Port {
		    PortNumber		    1
		    Name		    "Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		    }
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum3"
		    Ports		    [2, 1]
		    Position		    [235, 175, 255, 195]
		    ShowName		    off
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum6"
		    Ports		    [2, 1]
		    Position		    [585, 210, 605, 230]
		    ShowName		    off
		    IconShape		    "rectangular"
		    Inputs		    "-+"
		    SaturateOnIntegerOverflow on
		    Port {
		    PortNumber		    1
		    Name		    "Nr=W-Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		    }
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn7"
		    Ports		    [1, 1]
		    Position		    [215, 25, 245, 55]
		    ShowName		    off
		    Operator		    "atan"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn8"
		    Ports		    [1, 1]
		    Position		    [265, 25, 295, 55]
		    ShowName		    off
		    Operator		    "cos"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Reference
		    Name		    "current veh mass (kg)4"
		    Ports		    [0, 1]
		    Position		    [205, 127, 265, 143]
		    BackgroundColor	    "darkGreen"
		    SourceBlock		    "lib_controls/SubSystem/current ve"
"h mass (kg)"
		    SourceType		    "SubSystem"
		    ShowPortLabels	    "off"
		    TreatAsAtomicUnit	    "off"
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [585, 193, 615, 207]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out2"
		    Position		    [630, 213, 660, 227]
		    Port		    "2"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    Name		    "Nf"
		    Labels		    [0, 0]
		    SrcBlock		    "Error Check1"
		    SrcPort		    1
		    Points		    [0, 0; 45, 0]
		    Branch {
		    Points		    [0, 15]
		    DstBlock		    "Sum6"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Constant19"
		    SrcPort		    1
		    Points		    [5, 0; 0, -10]
		    DstBlock		    "Error Check1"
		    DstPort		    2
		    }
		    Line {
		    Name		    "Nf"
		    Labels		    [0, 0]
		    SrcBlock		    "Sum2"
		    SrcPort		    1
		    Points		    [15, 0; 0, 5]
		    DstBlock		    "Error Check1"
		    DstPort		    1
		    }
		    Line {
		    Name		    "W"
		    Labels		    [0, 0]
		    SrcBlock		    "Product13"
		    SrcPort		    1
		    Points		    [150, 0; 0, -20]
		    DstBlock		    "Sum6"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Memory2"
		    SrcPort		    1
		    Points		    [75, 0]
		    DstBlock		    "Product11"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From<wh>1"
		    SrcPort		    1
		    DstBlock		    "Memory2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "current veh mass (kg)4"
		    SrcPort		    1
		    Points		    [0, 0; 45, 0]
		    Branch {
		    Points		    [35, 0; 0, 115]
		    DstBlock		    "Product13"
		    DstPort		    2
		    }
		    Branch {
		    DstBlock		    "Product10"
		    DstPort		    3
		    }
		    }
		    Line {
		    SrcBlock		    "Constant18"
		    SrcPort		    1
		    Points		    [0, -20]
		    DstBlock		    "Product10"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Trig Fn8"
		    SrcPort		    1
		    Points		    [0, 0; 15, 0]
		    Branch {
		    Points		    [50, 0]
		    DstBlock		    "Product13"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Product10"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Trig Fn7"
		    SrcPort		    1
		    DstBlock		    "Trig Fn8"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From<cyc>4"
		    SrcPort		    1
		    DstBlock		    "Trig Fn7"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Product10"
		    SrcPort		    1
		    Points		    [30, 0; 0, 100]
		    DstBlock		    "Sum2"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant17"
		    SrcPort		    1
		    Points		    [20, 0]
		    DstBlock		    "Product11"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Product11"
		    SrcPort		    1
		    Points		    [15, 0; 0, 10]
		    DstBlock		    "Sum3"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From <veh>1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -25]
		    DstBlock		    "Sum3"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum3"
		    SrcPort		    1
		    Points		    [25, 0; 0, 5]
		    DstBlock		    "Product12"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Constant16"
		    SrcPort		    1
		    Points		    [10, 0; 0, -55]
		    DstBlock		    "Product12"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Product12"
		    SrcPort		    1
		    Points		    [45, 0]
		    DstBlock		    "Sum2"
		    DstPort		    2
		    }
		    Line {
		    Name		    "Nr=W-Nf"
		    Labels		    [0, 0]
		    SrcBlock		    "Sum6"
		    SrcPort		    1
		    DstBlock		    "Out2"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "Subsystem1"
		  Ports			  [0, 1]
		  Position		  [385, 650, 425, 710]
		  ForegroundColor	  "lightBlue"
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "Subsystem1"
		    Location		    [112, 574, 602, 690]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "automatic"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Constant
		    Name		    "Constant15"
		    Position		    [25, 26, 310, 44]
		    ForegroundColor	    "lightBlue"
		    BackgroundColor	    "darkGreen"
		    ShowName		    off
		    FontName		    "Arial"
		    Value		    "max(wh_slip_force_coeff)*veh_grav"
"ity*(1-veh_front_wt_frac)"
		    VectorParams1D	    on
		    }
		    Block {
		    BlockType		    From
		    Name		    "From<cyc>3"
		    Position		    [25, 64, 85, 86]
		    CloseFcn		    "tagdialog Close"
		    GotoTag		    "grade"
		    }
		    Block {
		    BlockType		    Product
		    Name		    "Product8"
		    Ports		    [3, 1]
		    Position		    [390, 33, 410, 67]
		    BackgroundColor	    "darkGreen"
		    NamePlacement	    "alternate"
		    ShowName		    off
		    Inputs		    "3"
		    Multiplication	    "Element-wise(.*)"
		    SaturateOnIntegerOverflow on
		    Port {
		    PortNumber		    1
		    Name		    "Ftract"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		    }
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn5"
		    Ports		    [1, 1]
		    Position		    [100, 60, 130, 90]
		    Operator		    "atan"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Trigonometry
		    Name		    "Trig Fn6"
		    Ports		    [1, 1]
		    Position		    [150, 60, 180, 90]
		    Operator		    "cos"
		    OutputSignalType	    "auto"
		    }
		    Block {
		    BlockType		    Reference
		    Name		    "current veh mass (kg)3"
		    Ports		    [0, 1]
		    Position		    [250, 62, 310, 78]
		    BackgroundColor	    "darkGreen"
		    SourceBlock		    "lib_controls/SubSystem/current ve"
"h mass (kg)"
		    SourceType		    "SubSystem"
		    ShowPortLabels	    "off"
		    TreatAsAtomicUnit	    "off"
		    RTWSystemCode	    "Auto"
		    RTWFcnNameOpts	    "Auto"
		    RTWFileNameOpts	    "Auto"
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "Out1"
		    Position		    [435, 43, 465, 57]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "[]"
		    }
		    Line {
		    SrcBlock		    "Trig Fn6"
		    SrcPort		    1
		    Points		    [30, 0; 0, -25]
		    DstBlock		    "Product8"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "current veh mass (kg)3"
		    SrcPort		    1
		    Points		    [0, -10]
		    DstBlock		    "Product8"
		    DstPort		    3
		    }
		    Line {
		    SrcBlock		    "Constant15"
		    SrcPort		    1
		    Points		    [60, 0]
		    DstBlock		    "Product8"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Trig Fn5"
		    SrcPort		    1
		    DstBlock		    "Trig Fn6"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "From<cyc>3"
		    SrcPort		    1
		    DstBlock		    "Trig Fn5"
		    DstPort		    1
		    }
		    Line {
		    Name		    "Ftract"
		    Labels		    [0, 0]
		    SrcBlock		    "Product8"
		    SrcPort		    1
		    DstBlock		    "Out1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [395, 530, 415, 550]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [315, 210, 335, 230]
		  ShowName		  off
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "dt"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum4"
		  Ports			  [2, 1]
		  Position		  [220, 530, 240, 550]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum5"
		  Ports			  [2, 1]
		  Position		  [540, 565, 560, 585]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		  Port {
		    PortNumber		    1
		    Name		    "Nr=W-Nf"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn"
		  Ports			  [1, 1]
		  Position		  [225, 80, 255, 110]
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn1"
		  Ports			  [1, 1]
		  Position		  [275, 80, 305, 110]
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn2"
		  Ports			  [1, 1]
		  Position		  [370, 125, 400, 155]
		  ShowName		  off
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		  Port {
		    PortNumber		    1
		    Name		    "theta"
		    TestPoint		    off
		    LinearAnalysisOutput    off
		    LinearAnalysisInput	    off
		    RTWStorageClass	    "Auto"
		  }
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn3"
		  Ports			  [1, 1]
		  Position		  [200, 380, 230, 410]
		  ShowName		  off
		  Operator		  "atan"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Trigonometry
		  Name			  "Trig Fn4"
		  Ports			  [1, 1]
		  Position		  [250, 380, 280, 410]
		  ShowName		  off
		  Operator		  "cos"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Fcn
		  Name			  "Vf"
		  Position		  [695, 303, 735, 337]
		  ForegroundColor	  "lightBlue"
		  Expr			  "-1/2*(-2*u(4)*u(17)-2*u(1)*u(6)-2*u"
"(18)*u(6)+4*u(13)^u(8)*u(6)*(1/2*u(15))^u(9)*u(10)+4*u(13)^u(8)*u(6)*(1/2*u(1"
"9))^u(9)*u(10)+4*u(13)^u(8)*u(6)*(1/2*u(15))^u(9)*u(11)*u(17)+4*u(13)^u(8)*u("
"6)*(1/2*u(19))^u(9)*u(11)*u(17)+4*u(13)^u(8)*u(6)*(1/2*u(15))^u(9)*u(12)*u(17"
")^2+4*u(13)^u(8)*u(6)*(1/2*u(19))^u(9)*u(12)*u(17)^2+4*u(13)^u(8)*u(6)*(1/2*u"
"(16))^u(9)*u(10)+4*u(13)^u(8)*u(6)*(1/2*u(20))^u(9)*u(10)+4*u(13)^u(8)*u(6)*("
"1/2*u(16))^u(9)*u(11)*u(17)+4*u(13)^u(8)*u(6)*(1/2*u(20))^u(9)*u(11)*u(17)+4*"
"u(13)^u(8)*u(6)*(1/2*u(16))^u(9)*u(12)*u(17)^2+4*u(13)^u(8)*u(6)*(1/2*u(20))^"
"u(9)*u(12)*u(17)^2+u(7)*u(3)*u(5)*u(17)^2*u(6)+2*u(4)*u(14)*sin(u(2))*u(6))/u"
"(4)"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)1"
		  Ports			  [0, 1]
		  Position		  [190, 482, 250, 498]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)2"
		  Ports			  [0, 1]
		  Position		  [375, 82, 435, 98]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Reference
		  Name			  "current veh mass (kg)6"
		  Ports			  [0, 1]
		  Position		  [540, 152, 600, 168]
		  BackgroundColor	  "darkGreen"
		  SourceBlock		  "lib_controls/SubSystem/current veh "
"mass (kg)"
		  SourceType		  "SubSystem"
		  ShowPortLabels	  "off"
		  TreatAsAtomicUnit	  "off"
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		}
		Block {
		  BlockType		  Gain
		  Name			  "front \nactive?"
		  Position		  [580, 525, 610, 555]
		  ForegroundColor	  "lightBlue"
		  Gain			  "wh_front_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "front \nactive?1"
		  Position		  [585, 55, 615, 85]
		  ForegroundColor	  "lightBlue"
		  Gain			  "wh_front_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "front \nactive?2"
		  Position		  [605, 570, 635, 600]
		  ForegroundColor	  "lightBlue"
		  Gain			  "wh_front_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear\nactive?"
		  Position		  [505, 665, 535, 695]
		  ForegroundColor	  "lightBlue"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear\nactive?1"
		  Position		  [550, 700, 580, 730]
		  ForegroundColor	  "lightBlue"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "rear\nactive?2"
		  Position		  [590, 730, 620, 760]
		  ForegroundColor	  "lightBlue"
		  Gain			  "wh_rear_active_bool"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "unit conversion"
		  Position		  [570, 434, 635, 466]
		  Gain			  "3.6*3.6"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "unit conversion2"
		  Position		  [585, 407, 630, 433]
		  NamePlacement		  "alternate"
		  Gain			  "3.6"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [810, 255, 830, 275]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Product7"
		  SrcPort		  1
		  Points		  [0, 15]
		  DstBlock		  "unit conversion"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant8"
		  SrcPort		  1
		  Points		  [10, 0; 0, -10]
		  DstBlock		  "Product7"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product3"
		  SrcPort		  1
		  Points		  [5, 0; 0, 20]
		  DstBlock		  "unit conversion2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant7"
		  SrcPort		  1
		  Points		  [15, 0; 0, -15]
		  DstBlock		  "Product3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product2"
		  SrcPort		  1
		  Points		  [45, 0; 0, 10]
		  DstBlock		  "Mux"
		  DstPort		  10
		}
		Line {
		  SrcBlock		  "Constant6"
		  SrcPort		  1
		  Points		  [10, 0; 0, -20]
		  DstBlock		  "Product2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Math\nFunction3"
		  SrcPort		  1
		  Points		  [35, 0; 0, 30; 30, 0]
		  Branch {
		    Points		    [0, 35]
		    Branch {
		    Points		    [0, 35]
		    DstBlock		    "Product7"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Product3"
		    DstPort		    1
		    }
		  }
		  Branch {
		    DstBlock		    "Product2"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Curvature Correction Factor"
		  SrcPort		  1
		  DstBlock		  "Math\nFunction3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "unit conversion"
		  SrcPort		  1
		  DstBlock		  "Mux"
		  DstPort		  12
		}
		Line {
		  SrcBlock		  "unit conversion2"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Mux"
		  DstPort		  11
		}
		Line {
		  Name			  "Nf"
		  Labels		  [0, 0]
		  SrcBlock		  "Error Check"
		  SrcPort		  1
		  Points		  [20, 0]
		  Branch {
		    DstBlock		    "Sum5"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [40, 0]
		    DstBlock		    "front \nactive?"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Constant14"
		  SrcPort		  1
		  Points		  [5, 0; 0, -10]
		  DstBlock		  "Error Check"
		  DstPort		  2
		}
		Line {
		  Name			  "Nf"
		  Labels		  [0, 0]
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [15, 0; 0, 5]
		  DstBlock		  "Error Check"
		  DstPort		  1
		}
		Line {
		  Name			  "Nr=W-Nf"
		  Labels		  [0, 0]
		  SrcBlock		  "Sum5"
		  SrcPort		  1
		  Points		  [0, 10]
		  DstBlock		  "front \nactive?2"
		  DstPort		  1
		}
		Line {
		  Name			  "W"
		  Labels		  [0, 0]
		  SrcBlock		  "Product6"
		  SrcPort		  1
		  Points		  [135, 0]
		  DstBlock		  "Sum5"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [75, 0]
		  DstBlock		  "Product4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<wh>"
		  SrcPort		  1
		  DstBlock		  "Memory1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "vehicle speed at\nbeginning of time"
" step\n(m/s)"
		  SrcPort		  1
		  Points		  [555, 0]
		  DstBlock		  "Mux"
		  DstPort		  17
		}
		Line {
		  SrcBlock		  "current veh mass (kg)1"
		  SrcPort		  1
		  Points		  [0, 0; 45, 0]
		  Branch {
		    Points		    [35, 0; 0, 115]
		    DstBlock		    "Product6"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Product1"
		    DstPort		    3
		  }
		}
		Line {
		  SrcBlock		  "Constant13"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Trig Fn4"
		  SrcPort		  1
		  Points		  [0, 0; 15, 0]
		  Branch {
		    Points		    [50, 0]
		    DstBlock		    "Product6"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Product1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Trig Fn3"
		  SrcPort		  1
		  DstBlock		  "Trig Fn4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<cyc>2"
		  SrcPort		  1
		  DstBlock		  "Trig Fn3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant10"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  14
		}
		Line {
		  SrcBlock		  "Constant9"
		  SrcPort		  1
		  DstBlock		  "Mux"
		  DstPort		  13
		}
		Line {
		  SrcBlock		  "Constant5"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  9
		}
		Line {
		  SrcBlock		  "Constant4"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  8
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [90, 0]
		  DstBlock		  "Mux"
		  DstPort		  7
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [0, 5]
		  DstBlock		  "Mux"
		  DstPort		  5
		}
		Line {
		  SrcBlock		  "current veh mass (kg)6"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Mux"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  DstBlock		  "Mux"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Mux"
		  SrcPort		  1
		  DstBlock		  "Vf"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Trig Fn1"
		  SrcPort		  1
		  Points		  [30, 0; 0, -25]
		  DstBlock		  "Product9"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "current veh mass (kg)2"
		  SrcPort		  1
		  Points		  [0, -10]
		  DstBlock		  "Product9"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "requested time-step \naverage vehic"
"le speed\n(m/s)\n"
		  SrcPort		  1
		  Points		  [605, 0; 0, 230]
		  DstBlock		  "MinMax"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant2"
		  SrcPort		  1
		  Points		  [60, 0]
		  DstBlock		  "Product9"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Trig Fn"
		  SrcPort		  1
		  DstBlock		  "Trig Fn1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From<cyc>"
		  SrcPort		  1
		  DstBlock		  "Trig Fn"
		  DstPort		  1
		}
		Line {
		  Name			  "Ftract"
		  Labels		  [0, 0]
		  SrcBlock		  "Product9"
		  SrcPort		  1
		  DstBlock		  "front \nactive?1"
		  DstPort		  1
		}
		Line {
		  Name			  "dt"
		  Labels		  [0, 0]
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  Points		  [300, 0]
		  DstBlock		  "Mux"
		  DstPort		  6
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "From<cyc>1"
		  SrcPort		  1
		  DstBlock		  "Trig Fn2"
		  DstPort		  1
		}
		Line {
		  Name			  "theta"
		  Labels		  [0, 0]
		  SrcBlock		  "Trig Fn2"
		  SrcPort		  1
		  Points		  [100, 0; 0, -45]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  Points		  [30, 0; 0, 100]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "MinMax"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant12"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Product4"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product4"
		  SrcPort		  1
		  Points		  [15, 0; 0, 10]
		  DstBlock		  "Sum4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "From <veh>"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Sum4"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum4"
		  SrcPort		  1
		  Points		  [25, 0; 0, 5]
		  DstBlock		  "Product5"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant11"
		  SrcPort		  1
		  Points		  [10, 0; 0, -55]
		  DstBlock		  "Product5"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product5"
		  SrcPort		  1
		  Points		  [45, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Vf"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "MinMax"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Subsystem1"
		  SrcPort		  1
		  DstBlock		  "rear\nactive?"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Subsystem"
		  SrcPort		  1
		  DstBlock		  "rear\nactive?1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Subsystem"
		  SrcPort		  2
		  DstBlock		  "rear\nactive?2"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "front \nactive?1"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Mux"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "front \nactive?"
		  SrcPort		  1
		  Points		  [25, 0]
		  DstBlock		  "Mux"
		  DstPort		  15
		}
		Line {
		  SrcBlock		  "front \nactive?2"
		  SrcPort		  1
		  DstBlock		  "Mux"
		  DstPort		  16
		}
		Line {
		  SrcBlock		  "rear\nactive?"
		  SrcPort		  1
		  Points		  [45, 0; 0, -25]
		  DstBlock		  "Mux"
		  DstPort		  18
		}
		Line {
		  SrcBlock		  "rear\nactive?2"
		  SrcPort		  1
		  Points		  [0, -20]
		  DstBlock		  "Mux"
		  DstPort		  20
		}
		Line {
		  SrcBlock		  "rear\nactive?1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -25]
		  DstBlock		  "Mux"
		  DstPort		  19
		}
	      }
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)1"
	      Ports		      [3, 4]
	      Position		      [260, 62, 290, 178]
	      ForegroundColor	      "lightBlue"
	      BackgroundColor	      "darkGreen"
	      SourceBlock	      "lib_controls/SubSystem/traction control"
"\n2 axle/enforce max. \nfront axle\ntractive force\n due to slip (N)"
	      SourceType	      "SubSystem"
	      ShowPortLabels	      "off"
	      TreatAsAtomicUnit	      "off"
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd force\n(N)"
	      Position		      [330, 60, 350, 80]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "req'd speed\n(m/s)"
	      Position		      [330, 15, 350, 35]
	      Port		      "2"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nfront axle\n(N)"
	      Position		      [365, 100, 385, 120]
	      Port		      "3"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "weight on\nrear axle\n(N)"
	      Position		      [425, 130, 445, 150]
	      Port		      "4"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "front/total \ntraction ratio"
	      Position		      [320, 155, 340, 175]
	      ForegroundColor	      "lightBlue"
	      Port		      "5"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      SrcPort		      1
	      Points		      [0, -5; 20, 0]
	      Branch {
		Points			[0, -95]
		DstBlock		"req'd speed\n(m/s)"
		DstPort			1
	      }
	      Branch {
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "total tractive\nforce req'd\n(N)"
	      SrcPort		      1
	      DstBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)1"
	      SrcPort		      1
	      Points		      [0, -5]
	      DstBlock		      "req'd force\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)1"
	      SrcPort		      2
	      Points		      [0, 5]
	      DstBlock		      "weight on\nfront axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "vehicle speed at\nbeginning of time\n s"
"tep (m/s)"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[0, -55]
		DstBlock		"apply tire traction\nlimit to req'd s"
"peed\n(m/s)"
		DstPort			2
	      }
	      Branch {
		Points			[115, 0; 0, -30]
		DstBlock		"enforce max. \nfront axle\ntractive f"
"orce\n due to slip (N)1"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "time-average\nvehicle speed\n req'd (m/"
"s)"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "apply tire traction\nlimit to req'd spe"
"ed\n(m/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)1"
	      SrcPort		      3
	      Points		      [115, 0]
	      DstBlock		      "weight on\nrear axle\n(N)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "enforce max. \nfront axle\ntractive for"
"ce\n due to slip (N)1"
	      SrcPort		      4
	      DstBlock		      "front/total \ntraction ratio"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "From <wh>1"
	  SrcPort		  1
	  DstBlock		  "traction control"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <veh>"
	  SrcPort		  1
	  DstBlock		  "traction control"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>"
	  SrcPort		  1
	  DstBlock		  "traction control"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "traction control"
	  SrcPort		  3
	  DstBlock		  "Goto <wh>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "traction control"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>8"
	  SrcPort		  1
	  DstBlock		  "braking strategy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "braking strategy"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>5"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>6"
	  SrcPort		  1
	  Points		  [65, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>2"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <wh>3"
	  SrcPort		  1
	  Points		  [40, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From<wh>4"
	  SrcPort		  1
	  Points		  [30, 0]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <wh>5"
	  SrcPort		  1
	  Points		  [5, 0; 0, -25]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  1
	  DstBlock		  "Goto <wh>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  SrcPort		  2
	  DstBlock		  "Goto <wh>4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <logic>2"
	  SrcPort		  1
	  DstBlock		  "Speed Dependent Shifting"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Speed Dependent Shifting"
	  SrcPort		  1
	  DstBlock		  "Goto"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Speed Dependent Shifting"
	  SrcPort		  2
	  DstBlock		  "Goto1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <wh>4"
	  SrcPort		  1
	  Points		  [10, 0; 0, -55]
	  DstBlock		  "front and rear\nbrake controller\n(achievab"
"le)"
	  DstPort		  6
	}
	Annotation {
	  Position		  [216, 46]
	  Text			  "required\nforce (N)"
	}
	Annotation {
	  Position		  [84, 301]
	  Text			  "required force\n(from traction control)"
	}
	Annotation {
	  Position		  [221, 307]
	  Text			  "required rear \nbrake force"
	}
	Annotation {
	  Position		  [466, 19]
	  Text			  "SUB MODEL LIBRARY FOR VEHICLE CONTROLS"
	}
	Annotation {
	  Position		  [310, 483]
	  Text			  "this shifting block part \nof the speed dep"
"endent\n shifting above"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "electric assist\ncontrol strategy\n<cs>"
      Ports		      [1, 1]
      Position		      [385, 149, 415, 181]
      BackgroundColor	      "yellow"
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"electric assist\ncontrol strategy\n<cs>"
	Location		[170, 202, 774, 548]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [40, 108, 70, 122]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [365, 150, 385, 170]
	  Orientation		  "up"
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux"
	  Ports			  [1, 2]
	  Position		  [150, 162, 185, 198]
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc>"
	  Position		  [135, 225, 205, 245]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  MinMax
	  Name			  "MinMax"
	  Ports			  [2, 1]
	  Position		  [315, 92, 345, 123]
	  Function		  "max"
	  Inputs		  "2"
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux"
	  Ports			  [2, 1]
	  Position		  [455, 112, 490, 148]
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  Sum
	  Name			  "Sum"
	  Ports			  [2, 1]
	  Position		  [255, 49, 270, 96]
	  IconShape		  "rectangular"
	  Inputs		  "++"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch"
	  Position		  [390, 105, 420, 135]
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "chg trq req'd\n(Nm)"
	  Ports			  [0, 1]
	  Position		  [95, 45, 125, 75]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "chg trq req'd\n(Nm)"
	    Location		    [318, 134, 900, 377]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [25, 48, 170, 72]
	      Value		      "cs_charge_trq*fc_trq_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [325, 105, 365, 125]
	      Value		      "ess_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>1"
	      Position		      [65, 94, 110, 116]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Goal"
	      Position		      [20, 134, 155, 156]
	      Value		      "(cs_lo_soc+cs_hi_soc)/2"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product"
	      Ports		      [2, 1]
	      Position		      [280, 52, 310, 83]
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [230, 142, 260, 173]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Range"
	      Position		      [20, 174, 155, 196]
	      Value		      "(cs_hi_soc-cs_lo_soc)/2"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [330, 55, 360, 85]
	      UpperLimit	      "inf"
	      LowerLimit	      "-inf"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [180, 97, 210, 128]
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [420, 65, 450, 95]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "add'l trq req'd\n(Nm)"
	      Position		      [490, 73, 520, 87]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Product"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      DstBlock		      "Product"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Range"
	      SrcPort		      1
	      Points		      [55, 0]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Goal"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <ess>1"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "add'l trq req'd\n(Nm)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [35, 0; 0, -25]
	      Branch {
		DstBlock		"Switch"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Switch"
		DstPort			3
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "help"
	  Ports			  []
	  Position		  [451, 194, 482, 237]
	  BackgroundColor	  "yellow"
	  DropShadow		  on
	  ShowName		  off
	  OpenFcn		  "web(['file:\\\\\\' which('Parallel.htm')])"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "image(imread('doc_man.jpg'))"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "help"
	    Location		    [203, 331, 569, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "minimum trq\n(Nm)"
	  Ports			  [1, 1]
	  Position		  [150, 100, 180, 130]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "minimum trq\n(Nm)"
	    Location		    [193, 230, 777, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      Position		      [40, 108, 70, 122]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [60, 223, 130, 247]
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [355, 215, 375, 235]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [60, 174, 105, 196]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [280, 89, 385, 141]
	      Gain		      "cs_min_trq_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [200, 177, 230, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Selector
	      Name		      "Selector"
	      Ports		      [1, 1]
	      Position		      [120, 100, 150, 130]
	      InputType		      "Vector"
	      ElementSrc	      "Internal"
	      Elements		      "2"
	      RowSrc		      "Internal"
	      Rows		      "1"
	      ColumnSrc		      "Internal"
	      Columns		      "1"
	      InputPortWidth	      "2"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [405, 180, 435, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Terminator
	      Name		      "Terminator"
	      Position		      [400, 30, 420, 50]
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "constant threshhold trq (N*m)"
	      Position		      [240, 28, 370, 52]
	      Value		      "max(fc_max_trq)*0.33"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [200, 103, 230, 127]
	      InputValues	      "fc_map_spd"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "minimum trq\n(N*m)"
	      Position		      [480, 188, 510, 202]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      Points		      [25, 0; 0, -35]
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "minimum trq\n(N*m)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [5, 0; 0, -20]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "constant threshhold trq (N*m)"
	      SrcPort		      1
	      DstBlock		      "Terminator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      SrcPort		      1
	      DstBlock		      "Selector"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Selector"
	      SrcPort		      1
	      DstBlock		      "max_torque lookup"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [525, 123, 555, 137]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  Points		  [50, 0]
	  Branch {
	    DstBlock		    "minimum trq\n(Nm)"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 65]
	    DstBlock		    "Demux"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "chg trq req'd\n(Nm)"
	  SrcPort		  1
	  DstBlock		  "Sum"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Sum"
	  SrcPort		  1
	  Points		  [20, 0; 0, 25]
	  DstBlock		  "MinMax"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "MinMax"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Switch"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Mux"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  2
	  Points		  [245, 0; 0, -50]
	  DstBlock		  "Mux"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "minimum trq\n(Nm)"
	  SrcPort		  1
	  DstBlock		  "MinMax"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <vc>"
	  SrcPort		  1
	  Points		  [145, 0; 0, -115]
	  DstBlock		  "Switch"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  1
	  Points		  [50, 0]
	  DstBlock		  "Sum"
	  DstPort		  2
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "electric assist\ncontrol strategy\nbal <cs>"
      Ports		      [1, 1]
      Position		      [580, 224, 610, 256]
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"electric assist\ncontrol strategy\nbal <cs>"
	Location		[87, 152, 696, 451]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [40, 23, 70, 37]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [365, 145, 385, 165]
	  Orientation		  "up"
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc>"
	  Position		  [150, 225, 220, 245]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  MinMax
	  Name			  "MinMax"
	  Ports			  [2, 1]
	  Position		  [315, 82, 345, 113]
	  Function		  "max"
	  Inputs		  "2"
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux"
	  Ports			  [2, 1]
	  Position		  [455, 102, 490, 138]
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "SOC corrected \ntrq req'd (N*m)"
	  Ports			  [1, 1]
	  Position		  [165, 14, 195, 46]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "SOC corrected \ntrq req'd (N*m)"
	    Location		    [10, 74, 1021, 716]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      Position		      [35, 63, 65, 77]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Abs
	      Name		      "Abs"
	      Position		      [510, 310, 540, 340]
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [170, 300, 190, 320]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [410, 325, 430, 345]
	      Orientation	      "left"
	      Value		      "-1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [410, 410, 430, 430]
	      Orientation	      "left"
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [550, 415, 570, 435]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Demux
	      Name		      "Demux"
	      Ports		      [1, 2]
	      Position		      [100, 39, 105, 101]
	      ShowName		      off
	      Outputs		      "2"
	      BusSelectionMode	      off
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>2"
	      Position		      [60, 469, 105, 491]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [370, 220, 400, 250]
	      Gain		      "cs_trq_to_soc_factor"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [490, 527, 520, 558]
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [3, 1]
	      Position		      [505, 194, 535, 226]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [350, 357, 380, 388]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [1, 1]
	      Position		      [290, 364, 320, 396]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [2, 1]
	      Position		      [435, 492, 465, 523]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [1, 1]
	      Position		      [370, 454, 400, 486]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [2, 1]
	      Position		      [435, 562, 465, 593]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [1, 1]
	      Position		      [370, 524, 400, 556]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [1, 1]
	      Position		      [510, 465, 540, 495]
	      Orientation	      "up"
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual \nSwitch"
	      Ports		      [2, 1]
	      Position		      [700, 247, 730, 278]
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Reference
	      Name		      "Manual \nSwitch1"
	      Ports		      [2, 1]
	      Position		      [560, 292, 590, 323]
	      SourceBlock	      "simulink3/Nonlinear/Manual Switch"
	      SourceType	      "Manual Switch"
	      sw		      "1"
	      action		      "0"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Multiplier4"
	      Ports		      [4, 1]
	      Position		      [750, 75, 770, 290]
	      ShowName		      off
	      Inputs		      "4"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [440, 182, 470, 213]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [235, 302, 265, 333]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [440, 242, 470, 273]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "SOC \nCorrection\n Factor"
	      Ports		      [3, 1]
	      Position		      [160, 494, 190, 546]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"SOC \nCorrection\n Factor"
		Location		[133, 175, 916, 430]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "SOC"
		  Position		  [20, 33, 50, 47]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "high soc"
		  Position		  [20, 67, 50, 83]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "low soc"
		  Position		  [20, 98, 50, 112]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Gain
		  Name			  "0.5*range"
		  Position		  [135, 120, 165, 150]
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [390, 70, 410, 90]
		  Value			  "3"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant4"
		  Position		  [325, 140, 345, 160]
		  Value			  "2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Reference
		  Name			  "Manual \nSwitch1"
		  Ports			  [2, 1]
		  Position		  [635, 82, 665, 113]
		  SourceBlock		  "simulink3/Nonlinear/Manual Switch"
		  SourceType		  "Manual Switch"
		  sw			  "0"
		  action		  "0"
		}
		Block {
		  BlockType		  Reference
		  Name			  "Manual Switch"
		  Ports			  [2, 1]
		  Position		  [560, 37, 590, 68]
		  SourceBlock		  "simulink3/Nonlinear/Manual Switch"
		  SourceType		  "Manual Switch"
		  sw			  "1"
		  action		  "0"
		}
		Block {
		  BlockType		  Math
		  Name			  "Math\nFunction"
		  Ports			  [2, 1]
		  Position		  [495, 52, 525, 83]
		  Operator		  "pow"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Math
		  Name			  "Math\nFunction1"
		  Ports			  [2, 1]
		  Position		  [385, 122, 415, 153]
		  Operator		  "pow"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Multiplier6"
		  Ports			  [2, 1]
		  Position		  [255, 42, 285, 73]
		  ShowName		  off
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Multiplier7"
		  Ports			  [2, 1]
		  Position		  [450, 107, 480, 138]
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Signum
		  Name			  "Sign"
		  Position		  [315, 84, 350, 116]
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum11"
		  Ports			  [2, 1]
		  Position		  [200, 32, 230, 63]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum12"
		  Ports			  [2, 1]
		  Position		  [85, 67, 115, 98]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum14"
		  Ports			  [2, 1]
		  Position		  [85, 117, 115, 148]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "mean"
		  Position		  [135, 70, 165, 100]
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "SOC \ncorrection \nfactor"
		  Position		  [705, 93, 735, 107]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Multiplier7"
		  SrcPort		  1
		  Points		  [135, 0]
		  DstBlock		  "Manual \nSwitch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sign"
		  SrcPort		  1
		  Points		  [0, 15]
		  DstBlock		  "Multiplier7"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Math\nFunction1"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Multiplier7"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Manual \nSwitch1"
		  SrcPort		  1
		  DstBlock		  "SOC \ncorrection \nfactor"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Manual Switch"
		  SrcPort		  1
		  Points		  [25, 0]
		  DstBlock		  "Manual \nSwitch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Multiplier6"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, 40]
		    Branch {
		    Points		    [0, 30]
		    DstBlock		    "Math\nFunction1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sign"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [0, 0]
		    Branch {
		    Points		    [0, -15]
		    DstBlock		    "Manual Switch"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Math\nFunction"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Constant4"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Math\nFunction1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Math\nFunction"
		  SrcPort		  1
		  Points		  [0, -10]
		  DstBlock		  "Manual Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  Points		  [65, 0]
		  DstBlock		  "Math\nFunction"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "0.5*range"
		  SrcPort		  1
		  Points		  [70, 0]
		  DstBlock		  "Multiplier6"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum11"
		  SrcPort		  1
		  DstBlock		  "Multiplier6"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "low soc"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Sum14"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum12"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "high soc"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, 50]
		    DstBlock		    "Sum14"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum12"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Sum14"
		  SrcPort		  1
		  DstBlock		  "0.5*range"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum12"
		  SrcPort		  1
		  DstBlock		  "mean"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "mean"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Sum11"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "SOC"
		  SrcPort		  1
		  DstBlock		  "Sum11"
		  DstPort		  1
		}
		Annotation {
		  Position		  [591, 201]
		  Text			  "Depending in the location of the ma"
"nual\nswitches the correction factor will either\nbe a linear, quad, or cubic"
" function within the \nspecified range"
		}
	      }
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation2"
	      Position		      [870, 50, 900, 80]
	      UpperLimit	      "inf"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum12"
	      Ports		      [2, 1]
	      Position		      [315, 162, 345, 193]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum13"
	      Ports		      [2, 1]
	      Position		      [690, 117, 720, 148]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum14"
	      Ports		      [2, 1]
	      Position		      [630, 237, 660, 268]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "2"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum2"
	      Ports		      [2, 1]
	      Position		      [805, 47, 835, 78]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "2"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [635, 135, 665, 165]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [405, 360, 435, 390]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch4"
	      Position		      [550, 370, 580, 400]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "goal SOC1"
	      Position		      [45, 511, 115, 529]
	      Value		      "cs_hi_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "goal SOC2"
	      Position		      [45, 546, 115, 564]
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "goal trq frac"
	      Position		      [190, 177, 280, 193]
	      Value		      "cs_lo_trq_frac"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "goal trq frac1"
	      Position		      [190, 132, 280, 148]
	      Value		      "cs_hi_trq_frac"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "max trq \nand \ntrq frac"
	      Ports		      [2, 2]
	      Position		      [145, 87, 175, 138]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"max trq \nand \ntrq frac"
		Location		[47, 120, 476, 354]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "trq req"
		  Position		  [25, 53, 55, 67]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "spd req"
		  Position		  [25, 93, 55, 107]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [140, 135, 160, 155]
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Product
		  Name			  "Multiplier3"
		  Ports			  [2, 1]
		  Position		  [260, 87, 290, 118]
		  ShowName		  off
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation4"
		  Position		  [140, 87, 165, 113]
		  UpperLimit		  "inf"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation7"
		  Position		  [315, 92, 340, 118]
		  UpperLimit		  "1"
		  LowerLimit		  "0"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum8"
		  Ports			  [2, 1]
		  Position		  [200, 92, 230, 123]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "2"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "max_torque\n lookup"
		  Position		  [80, 88, 110, 112]
		  InputValues		  "fc_map_spd*fc_spd_scale"
		  OutputValues		  "fc_max_trq*fc_trq_scale"
		}
		Block {
		  BlockType		  Outport
		  Name			  "max trq"
		  Position		  [365, 57, 395, 73]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "trq frac"
		  Position		  [365, 98, 395, 112]
		  Port			  "2"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Saturation7"
		  SrcPort		  1
		  DstBlock		  "trq frac"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "spd req"
		  SrcPort		  1
		  DstBlock		  "max_torque\n lookup"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation4"
		  SrcPort		  1
		  Points		  [5, 0]
		  Branch {
		    Points		    [0, -35]
		    DstBlock		    "max trq"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum8"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "max_torque\n lookup"
		  SrcPort		  1
		  DstBlock		  "Saturation4"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [20, 0]
		  DstBlock		  "Sum8"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum8"
		  SrcPort		  1
		  DstBlock		  "Multiplier3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Multiplier3"
		  SrcPort		  1
		  DstBlock		  "Saturation7"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "trq req"
		  SrcPort		  1
		  Points		  [185, 0]
		  DstBlock		  "Multiplier3"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "mean"
	      Position		      [365, 165, 395, 195]
	      Gain		      "0.5"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "trq \nCorrection\n Factor"
	      Ports		      [3, 1]
	      Position		      [315, 209, 345, 261]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"trq \nCorrection\n Factor"
		Location		[135, 173, 870, 418]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "trq"
		  Position		  [20, 33, 50, 47]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "high trq"
		  Position		  [20, 67, 50, 83]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "low trq"
		  Position		  [20, 98, 50, 112]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Gain
		  Name			  "0.5*range"
		  Position		  [135, 120, 165, 150]
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant3"
		  Position		  [360, 45, 380, 65]
		  Value			  "3"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant4"
		  Position		  [360, 130, 380, 150]
		  Value			  "2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Reference
		  Name			  "Manual Switch"
		  Ports			  [2, 1]
		  Position		  [485, 17, 515, 48]
		  SourceBlock		  "simulink3/Nonlinear/Manual Switch"
		  SourceType		  "Manual Switch"
		  sw			  "1"
		  action		  "0"
		}
		Block {
		  BlockType		  Reference
		  Name			  "Manual Switch1"
		  Ports			  [2, 1]
		  Position		  [560, 62, 590, 93]
		  SourceBlock		  "simulink3/Nonlinear/Manual Switch"
		  SourceType		  "Manual Switch"
		  sw			  "0"
		  action		  "0"
		}
		Block {
		  BlockType		  Math
		  Name			  "Math\nFunction"
		  Ports			  [2, 1]
		  Position		  [410, 32, 440, 63]
		  Operator		  "pow"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Math
		  Name			  "Math\nFunction1"
		  Ports			  [2, 1]
		  Position		  [415, 117, 445, 148]
		  Operator		  "pow"
		  OutputSignalType	  "auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Multiplier6"
		  Ports			  [2, 1]
		  Position		  [255, 42, 285, 73]
		  ShowName		  off
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Multiplier7"
		  Ports			  [2, 1]
		  Position		  [490, 97, 520, 128]
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Signum
		  Name			  "Sign"
		  Position		  [305, 79, 340, 111]
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum11"
		  Ports			  [2, 1]
		  Position		  [200, 32, 230, 63]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum12"
		  Ports			  [2, 1]
		  Position		  [85, 67, 115, 98]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum14"
		  Ports			  [2, 1]
		  Position		  [85, 117, 115, 148]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Gain
		  Name			  "mean"
		  Position		  [135, 70, 165, 100]
		  Gain			  "0.5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "trq \ncorrection \nfactor"
		  Position		  [625, 73, 655, 87]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Multiplier7"
		  SrcPort		  1
		  Points		  [0, -30]
		  DstBlock		  "Manual Switch1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sign"
		  SrcPort		  1
		  Points		  [0, 10]
		  DstBlock		  "Multiplier7"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Math\nFunction1"
		  SrcPort		  1
		  Points		  [25, 0]
		  DstBlock		  "Multiplier7"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Manual Switch1"
		  SrcPort		  1
		  DstBlock		  "trq \ncorrection \nfactor"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Manual Switch"
		  SrcPort		  1
		  Points		  [25, 0]
		  DstBlock		  "Manual Switch1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Multiplier6"
		  SrcPort		  1
		  Points		  [0, 0]
		  Branch {
		    Points		    [0, 35]
		    Branch {
		    Points		    [0, 30]
		    DstBlock		    "Math\nFunction1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sign"
		    DstPort		    1
		    }
		  }
		  Branch {
		    Points		    [0, -20; 105, 0]
		    Branch {
		    Points		    [0, -15]
		    DstBlock		    "Manual Switch"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Math\nFunction"
		    DstPort		    1
		    }
		  }
		}
		Line {
		  SrcBlock		  "Constant4"
		  SrcPort		  1
		  DstBlock		  "Math\nFunction1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Math\nFunction"
		  SrcPort		  1
		  Points		  [0, -10]
		  DstBlock		  "Manual Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant3"
		  SrcPort		  1
		  DstBlock		  "Math\nFunction"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "0.5*range"
		  SrcPort		  1
		  Points		  [70, 0]
		  DstBlock		  "Multiplier6"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum11"
		  SrcPort		  1
		  DstBlock		  "Multiplier6"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "low trq"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Sum14"
		    DstPort		    2
		  }
		  Branch {
		    DstBlock		    "Sum12"
		    DstPort		    2
		  }
		}
		Line {
		  SrcBlock		  "high trq"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    Points		    [0, 50]
		    DstBlock		    "Sum14"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum12"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Sum14"
		  SrcPort		  1
		  DstBlock		  "0.5*range"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum12"
		  SrcPort		  1
		  DstBlock		  "mean"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "mean"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "Sum11"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "trq"
		  SrcPort		  1
		  DstBlock		  "Sum11"
		  DstPort		  1
		}
		Annotation {
		  Position		  [586, 191]
		  Text			  "Depending in the location of the ma"
"nual\nswitches the correction factor will either\nbe a linear, quad, or cubic"
" function within the \nspecified range"
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "SOC corrected \ntrq req'd (N*m)"
	      Position		      [945, 58, 975, 72]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      Points		      [0, 65; 90, 0]
	      Branch {
		DstBlock		"Manual \nSwitch1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Abs"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Manual \nSwitch1"
	      SrcPort		      1
	      Points		      [10, 0; 0, -65]
	      DstBlock		      "Sum14"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Abs"
	      SrcPort		      1
	      DstBlock		      "Manual \nSwitch1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Manual \nSwitch"
	      SrcPort		      1
	      DstBlock		      "Multiplier4"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "Sum14"
	      SrcPort		      1
	      DstBlock		      "Manual \nSwitch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "goal trq frac"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		Points			[0, 65]
		DstBlock		"trq \nCorrection\n Factor"
		DstPort			3
	      }
	      Branch {
		DstBlock		"Sum12"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "max trq \nand \ntrq frac"
	      SrcPort		      2
	      Points		      [115, 0]
	      Branch {
		Points			[0, 95]
		DstBlock		"trq \nCorrection\n Factor"
		DstPort			1
	      }
	      Branch {
		Points			[115, 0]
		Branch {
		  Points		  [0, 80]
		  Branch {
		    Points		    [0, 45]
		    DstBlock		    "Relational\nOperator5"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Relational\nOperator1"
		    DstPort		    2
		  }
		}
		Branch {
		  DstBlock		  "Sum13"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      Points		      [0, -75]
	      DstBlock		      "Switch4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "SOC \nCorrection\n Factor"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -195]
		DstBlock		"Relational\nOperator4"
		DstPort			2
	      }
	      Branch {
		Points			[0, 110; 405, 0; 0, -340]
		Branch {
		  Points		  [70, 0]
		  DstBlock		  "Manual \nSwitch"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Sum14"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [-10, 0]
	      DstBlock		      "Switch4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      DstBlock		      "Switch4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator7"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      Points		      [0, 30]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		Points			[0, 205]
		DstBlock		"Logical\nOperator7"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Logical\nOperator3"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch3"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 245; -125, 0]
		DstBlock		"Logical\nOperator6"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Logical\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 45; -150, 0; 0, 60]
		Branch {
		  Points		  [0, 175]
		  DstBlock		  "Logical\nOperator8"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "Logical\nOperator3"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, -50]
		DstBlock		"Logical\nOperator2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      Points		      [10, 0; 0, -60]
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "mean"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 85]
		DstBlock		"Relational\nOperator5"
		DstPort			2
	      }
	      Branch {
		Points			[0, -20]
		DstBlock		"Switch2"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "goal trq frac1"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 30]
		Branch {
		  Points		  [0, 65]
		  DstBlock		  "trq \nCorrection\n Factor"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Sum12"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[135, 0]
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "Switch2"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Sum12"
	      SrcPort		      1
	      DstBlock		      "mean"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Sum13"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "goal SOC2"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "SOC \nCorrection\n Factor"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "goal SOC1"
	      SrcPort		      1
	      DstBlock		      "SOC \nCorrection\n Factor"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <ess>2"
	      SrcPort		      1
	      Points		      [35, 0]
	      DstBlock		      "SOC \nCorrection\n Factor"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, 60]
		Branch {
		  Points		  [0, 135]
		  DstBlock		  "Logical\nOperator5"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "Logical\nOperator4"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[215, 0]
		DstBlock		"Logical\nOperator2"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"max trq \nand \ntrq frac"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sum2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Demux"
	      SrcPort		      2
	      Points		      [0, 40]
	      DstBlock		      "max trq \nand \ntrq frac"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation2"
	      SrcPort		      1
	      DstBlock		      "SOC corrected \ntrq req'd (N*m)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum2"
	      SrcPort		      1
	      DstBlock		      "Saturation2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      SrcPort		      1
	      DstBlock		      "Demux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max trq \nand \ntrq frac"
	      SrcPort		      1
	      DstBlock		      "Multiplier4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum13"
	      SrcPort		      1
	      Points		      [0, 20]
	      DstBlock		      "Multiplier4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Multiplier4"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch4"
	      SrcPort		      1
	      Points		      [10, 0; 0, -175]
	      DstBlock		      "Multiplier4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "trq \nCorrection\n Factor"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Annotation {
	      Position		      [822, 418]
	      Text		      "This controller produces a modified trq"
" request based on the \nSOC and the trq request.  The objective is to move th"
"e SOC to the \nmean of the hi and lo set points and to move the trq operation"
" to the \nmean of the hi and lo trq set points"
	    }
	  }
	}
	Block {
	  BlockType		  Selector
	  Name			  "Selector"
	  Ports			  [1, 1]
	  Position		  [165, 160, 195, 190]
	  InputType		  "Vector"
	  ElementSrc		  "Internal"
	  Elements		  "2"
	  RowSrc		  "Internal"
	  Rows			  "1"
	  ColumnSrc		  "Internal"
	  Columns		  "1"
	  InputPortWidth	  "2"
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch"
	  Position		  [390, 95, 420, 125]
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "help"
	  Ports			  []
	  Position		  [476, 224, 507, 267]
	  BackgroundColor	  "yellow"
	  DropShadow		  on
	  ShowName		  off
	  OpenFcn		  "web(['file:\\\\\\' which('Parallel.htm')])"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "image(imread('doc_man.jpg'))"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "help"
	    Location		    [203, 331, 569, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "minimum trq\n(N*m)"
	  Ports			  [1, 1]
	  Position		  [165, 90, 195, 120]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "minimum trq\n(N*m)"
	    Location		    [193, 234, 786, 475]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      Position		      [55, 43, 85, 57]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [370, 150, 390, 170]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [175, 109, 220, 131]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [295, 24, 400, 76]
	      Gain		      "cs_min_trq_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [300, 112, 330, 143]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Selector
	      Name		      "Selector"
	      Ports		      [1, 1]
	      Position		      [135, 35, 165, 65]
	      InputType		      "Vector"
	      ElementSrc	      "Internal"
	      Elements		      "2"
	      RowSrc		      "Internal"
	      Rows		      "1"
	      ColumnSrc		      "Internal"
	      Columns		      "1"
	      InputPortWidth	      "2"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [420, 115, 450, 145]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "goal SOC"
	      Position		      [135, 149, 265, 171]
	      Value		      "0.5*(cs_hi_soc+cs_lo_soc)"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [215, 38, 245, 62]
	      InputValues	      "fc_map_spd"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "minimum trq\n(N*m)"
	      Position		      [495, 123, 525, 137]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "goal SOC"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [5, 0; 0, -20]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Selector"
	      SrcPort		      1
	      DstBlock		      "max_torque lookup"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      SrcPort		      1
	      DstBlock		      "Selector"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "minimum trq\n(N*m)"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [525, 113, 555, 127]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "SOC corrected \ntrq req'd (N*m)"
	  SrcPort		  1
	  Points		  [95, 0; 0, 60]
	  DstBlock		  "MinMax"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "MinMax"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  Points		  [50, 0]
	  Branch {
	    DstBlock		    "SOC corrected \ntrq req'd (N*m)"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 75]
	    Branch {
	      Points		      [0, 70]
	      DstBlock		      "Selector"
	      DstPort		      1
	    }
	    Branch {
	      DstBlock		      "minimum trq\n(N*m)"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "minimum trq\n(N*m)"
	  SrcPort		  1
	  DstBlock		  "MinMax"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "From <vc>"
	  SrcPort		  1
	  Points		  [130, 0; 0, -125]
	  DstBlock		  "Switch"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Selector"
	  SrcPort		  1
	  Points		  [235, 0; 0, -45]
	  DstBlock		  "Mux"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Mux"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Switch"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  3
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "electric assist\ncontrol strategy \nCVT <cs>"
      Ports		      [1, 1]
      Position		      [215, 239, 245, 271]
      BackgroundColor	      "yellow"
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"electric assist\ncontrol strategy \nCVT <cs>"
	Location		[43, 216, 875, 620]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [40, 33, 70, 47]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Block NOTES1"
	  Ports			  []
	  Position		  [430, 25, 486, 65]
	  BackgroundColor	  "green"
	  ShowName		  off
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "disp('Block\\nNOTES')"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "Block NOTES1"
	    Location		    [91, 413, 529, 634]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Annotation {
	      Position		      [217, 12]
	      VerticalAlignment	      "top"
	      Text		      "Known issues: tm:8/16/00\n?? Should ine"
"rtia estimate be included too??\n?? unsure why I must bypass speed calc??\n"
	    }
	  }
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant"
	  Position		  [550, 130, 570, 150]
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux"
	  Ports			  [1, 2]
	  Position		  [415, 152, 450, 188]
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux1"
	  Ports			  [1, 2]
	  Position		  [110, 96, 115, 134]
	  BackgroundColor	  "black"
	  ShowName		  off
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC trq and spd"
	  Ports			  [3, 1]
	  Position		  [355, 154, 385, 186]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC trq and spd"
	    Location		    [37, 137, 999, 475]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "power req'd\nby FC (W)"
	      Position		      [160, 143, 190, 157]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "FC on"
	      Position		      [675, 248, 705, 262]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "Mode"
	      Position		      [95, 28, 125, 42]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [130, 230, 186, 270]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[340, 545, 722, 675]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [202, 27]
		  VerticalAlignment	  "top"
		  Text			  "In modes 1 and 2 engine is off and "
"trq req is zero\nIn mode 3 a charge pwr is added to the pwr req and the spd "
"\nand trq are then determined based on modified pwr\nIn Mode 4 the trq is det"
"ermined by fc IOL"
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [480, 80, 500, 100]
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [770, 179, 790, 201]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [180, 54, 200, 76]
	      Value		      "3"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [840, 142, 875, 178]
	      Inputs		      "2"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [235, 52, 265, 83]
	      NamePlacement	      "alternate"
	      Operator		      "=="
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation3"
	      Position		      [495, 15, 525, 35]
	      FontName		      "Arial"
	      UpperLimit	      "max(ptc_fc_mc_iol_pwr_vec)"
	      LowerLimit	      "min(ptc_fc_mc_iol_pwr_vec)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation7"
	      Position		      [405, 170, 435, 190]
	      FontName		      "Arial"
	      UpperLimit	      "max(ptc_fc_iol_pwr_vec)"
	      LowerLimit	      "min(ptc_fc_iol_pwr_vec)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Speed Interp"
	      Ports		      [2, 1]
	      Position		      [395, 75, 445, 150]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"Speed Interp"
		Location		[497, 208, 839, 510]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"automatic"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "Mode"
		  Position		  [170, 15, 200, 30]
		  Orientation		  "down"
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "pwr req"
		  Position		  [15, 13, 45, 27]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  MultiPortSwitch
		  Name			  "Multiport\nSwitch"
		  Ports			  [5, 1]
		  Position		  [215, 33, 230, 217]
		  Inputs		  "4"
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation3"
		  Position		  [55, 50, 85, 70]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_fc_mc_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_fc_mc_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation6"
		  Position		  [55, 160, 85, 180]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_mc_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_mc_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation7"
		  Position		  [55, 105, 85, 125]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_fc_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_fc_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation8"
		  Position		  [55, 215, 85, 235]
		  FontName		  "Arial"
		  UpperLimit		  "max(ptc_mc_gen_iol_pwr_vec)"
		  LowerLimit		  "min(ptc_mc_gen_iol_pwr_vec)"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired engine spd\nengine and moto"
"r"
		  Position		  [130, 48, 160, 72]
		  InputValues		  "ptc_fc_mc_iol_pwr_vec"
		  OutputValues		  "ptc_fc_mc_iol_spd_vec"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired engine spd\nengine only"
		  Position		  [130, 103, 160, 127]
		  InputValues		  "ptc_fc_iol_pwr_vec"
		  OutputValues		  "ptc_fc_iol_spd_vec"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired motor spd\nmotor only"
		  Position		  [130, 158, 160, 182]
		  InputValues		  "ptc_mc_iol_pwr_vec"
		  OutputValues		  "ptc_mc_iol_spd_vec"
		}
		Block {
		  BlockType		  Lookup
		  Name			  "desired motor spd\nmotor only regen"
		  Position		  [130, 213, 160, 237]
		  InputValues		  "fliplr(ptc_mc_gen_iol_pwr_vec)"
		  OutputValues		  "fliplr(ptc_mc_gen_iol_spd_vec)"
		}
		Block {
		  BlockType		  Outport
		  Name			  "input spd"
		  Position		  [255, 118, 285, 132]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "Saturation6"
		  SrcPort		  1
		  DstBlock		  "desired motor spd\nmotor only"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation8"
		  SrcPort		  1
		  DstBlock		  "desired motor spd\nmotor only regen"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation7"
		  SrcPort		  1
		  DstBlock		  "desired engine spd\nengine only"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation3"
		  SrcPort		  1
		  DstBlock		  "desired engine spd\nengine and moto"
"r"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Multiport\nSwitch"
		  SrcPort		  1
		  DstBlock		  "input spd"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Mode"
		  SrcPort		  1
		  Points		  [0, 20]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "pwr req"
		  SrcPort		  1
		  Points		  [0, 25; -10, 0; 0, 15]
		  Branch {
		    DstBlock		    "Saturation3"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 55]
		    Branch {
		    DstBlock		    "Saturation7"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 55]
		    Branch {
		    DstBlock		    "Saturation6"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Saturation8"
		    DstPort		    1
		    }
		    }
		  }
		}
		Line {
		  SrcBlock		  "desired motor spd\nmotor only regen"
		  SrcPort		  1
		  Points		  [35, 0]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "desired motor spd\nmotor only"
		  SrcPort		  1
		  Points		  [30, 0; 0, -45]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "desired engine spd\nengine only"
		  SrcPort		  1
		  Points		  [20, 0; 0, 45]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  4
		}
		Line {
		  SrcBlock		  "desired engine spd\nengine and moto"
"r"
		  SrcPort		  1
		  Points		  [10, 0; 0, 135]
		  DstBlock		  "Multiport\nSwitch"
		  DstPort		  5
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [535, 92, 565, 123]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum1"
	      Ports		      [2, 1]
	      Position		      [235, 102, 265, 133]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [765, 135, 795, 165]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      ToWorkspace
	      Name		      "To Workspace1"
	      Position		      [395, 215, 455, 245]
	      VariableName	      "cs_pwr_r"
	      MaxDataPoints	      "inf"
	      Decimation	      "1"
	      SampleTime	      "-1"
	      SaveFormat	      "Array"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "chg pwr req'd\n(W)"
	      Ports		      [0, 1]
	      Position		      [90, 105, 120, 135]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"chg pwr req'd\n(W)"
		Location		[312, 140, 791, 383]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [50, 48, 195, 72]
		  Value			  "cs_charge_pwr*fc_trq_scale"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  From
		  Name			  "From <ess>1"
		  Position		  [65, 94, 110, 116]
		  CloseFcn		  "tagdialog Close"
		  GotoTag		  "SOC"
		}
		Block {
		  BlockType		  Constant
		  Name			  "Goal"
		  Position		  [20, 134, 155, 156]
		  Value			  "(cs_lo_soc+cs_hi_soc)/2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [280, 52, 310, 83]
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Product
		  Name			  "Product1"
		  Ports			  [2, 1]
		  Position		  [230, 142, 260, 173]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Range"
		  Position		  [20, 174, 155, 196]
		  Value			  "(cs_hi_soc-cs_lo_soc)/2"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Saturate
		  Name			  "Saturation"
		  Position		  [330, 55, 360, 85]
		  UpperLimit		  "inf"
		  LowerLimit		  "-inf"
		  LinearizeAsGain	  on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [180, 97, 210, 128]
		  IconShape		  "rectangular"
		  Inputs		  "-+"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "add'l pwr req'd\n(W)"
		  Position		  [395, 63, 425, 77]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "[]"
		}
		Line {
		  SrcBlock		  "From <ess>1"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Goal"
		  SrcPort		  1
		  Points		  [5, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Range"
		  SrcPort		  1
		  Points		  [55, 0]
		  DstBlock		  "Product1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product1"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Saturation"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Saturation"
		  SrcPort		  1
		  DstBlock		  "add'l pwr req'd\n(W)"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Product
	      Name		      "desired engine trq \nmode 3 (Nm)"
	      Ports		      [2, 1]
	      Position		      [615, 102, 645, 133]
	      Inputs		      "/*"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "desired engine trq \nmode 4 (Nm)"
	      Position		      [585, 13, 615, 37]
	      InputValues	      "ptc_fc_mc_iol_pwr_vec"
	      OutputValues	      "ptc_fc_mc_iol_trq_vec"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "mode==3?"
	      Position		      [310, 115, 340, 145]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "mode==4?"
	      Position		      [680, 50, 710, 80]
	      Threshold		      "3.5"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "old engine spin up"
	      Ports		      [2]
	      Position		      [840, 217, 870, 268]
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"old engine spin up"
		Location		[251, 321, 809, 528]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"automatic"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "In1"
		  Position		  [60, 25, 90, 40]
		  Orientation		  "down"
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "In2"
		  Position		  [25, 63, 55, 77]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant6"
		  Position		  [90, 104, 110, 126]
		  Orientation		  "left"
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant7"
		  Position		  [160, 124, 180, 146]
		  Orientation		  "left"
		  Value			  "eps"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Gain
		  Name			  "Gain"
		  Position		  [375, 35, 405, 65]
		  Gain			  ".5"
		  Multiplication	  "Element-wise(K.*u)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [315, 72, 345, 103]
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [1, 1]
		  Position		  [265, 119, 295, 151]
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [215, 120, 245, 150]
		  X0			  "0"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "Relational\nOperator"
		  Position		  [155, 62, 185, 93]
		  Operator		  ">"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch2"
		  Position		  [90, 55, 120, 85]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch3"
		  Position		  [435, 75, 465, 105]
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  Terminator
		  Name			  "Terminator"
		  Position		  [485, 80, 505, 100]
		}
		Line {
		  SrcBlock		  "In2"
		  SrcPort		  1
		  DstBlock		  "Switch2"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Switch3"
		  SrcPort		  1
		  DstBlock		  "Terminator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant6"
		  SrcPort		  1
		  Points		  [-10, 0]
		  DstBlock		  "Switch2"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "Switch3"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant7"
		  SrcPort		  1
		  Points		  [-15, 0]
		  DstBlock		  "Relational\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Relational\nOperator"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Logical\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Switch2"
		  SrcPort		  1
		  Points		  [10, 0]
		  Branch {
		    DstBlock		    "Relational\nOperator"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -20; 225, 0]
		    Branch {
		    DstBlock		    "Gain"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 50]
		    DstBlock		    "Switch3"
		    DstPort		    3
		    }
		  }
		}
		Line {
		  SrcBlock		  "Gain"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Switch3"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "In1"
		  SrcPort		  1
		  DstBlock		  "Switch2"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine torque\nand speed\n(Nm), (rad/s)"
	      Position		      [910, 150, 930, 170]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "mode==3?"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, 0]
		Branch {
		  Points		  [0, 100]
		  DstBlock		  "To Workspace1"
		  DstPort		  1
		}
		Branch {
		  Points		  [0, 50]
		  DstBlock		  "Saturation7"
		  DstPort		  1
		}
	      }
	      Branch {
		Points			[0, -105]
		DstBlock		"Saturation3"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Speed Interp"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "power req'd\nby FC (W)"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		DstBlock		"Sum1"
		DstPort			2
	      }
	      Branch {
		Points			[65, 0; 0, -10]
		DstBlock		"mode==3?"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "Sum1"
	      SrcPort		      1
	      DstBlock		      "mode==3?"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [15, 0; 0, 60]
	      DstBlock		      "mode==3?"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      Points		      [0, 10]
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "chg pwr req'd\n(W)"
	      SrcPort		      1
	      Points		      [0, -10]
	      DstBlock		      "Sum1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mode"
	      SrcPort		      1
	      Points		      [25, 0]
	      Branch {
		Points			[0, 60]
		DstBlock		"Speed Interp"
		DstPort			1
	      }
	      Branch {
		Points			[65, 0]
		Branch {
		  DstBlock		  "Relational\nOperator1"
		  DstPort		  1
		}
		Branch {
		  Points		  [95, 0; 0, 30]
		  DstBlock		  "mode==4?"
		  DstPort		  2
		}
	      }
	    }
	    Line {
	      SrcBlock		      "Saturation7"
	      SrcPort		      1
	      Points		      [140, 0; 0, -55]
	      DstBlock		      "desired engine trq \nmode 3 (Nm)"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "FC on"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		Points			[0, -105]
		DstBlock		"Switch1"
		DstPort			2
	      }
	      Branch {
		DstBlock		"old engine spin up"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Speed Interp"
	      SrcPort		      1
	      Points		      [40, 0]
	      Branch {
		Points			[0, 115; 325, 0]
		Branch {
		  Points		  [0, -60]
		  DstBlock		  "Mux"
		  DstPort		  2
		}
		Branch {
		  DstBlock		  "old engine spin up"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "desired engine trq \nmode 3 (Nm)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation3"
	      SrcPort		      1
	      DstBlock		      "desired engine trq \nmode 4 (Nm)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "desired engine trq \nmode 4 (Nm)"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "mode==4?"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "desired engine trq \nmode 3 (Nm)"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "mode==4?"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "engine torque\nand speed\n(Nm), (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "mode==4?"
	      SrcPort		      1
	      Points		      [25, 0; 0, 75]
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	  }
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc>"
	  Position		  [130, 160, 200, 180]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "engine_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc>1"
	  Position		  [235, 180, 305, 200]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "mode"
	}
	Block {
	  BlockType		  MinMax
	  Name			  "MinMax"
	  Ports			  [2, 1]
	  Position		  [485, 97, 515, 128]
	  Function		  "max"
	  Inputs		  "2"
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux"
	  Ports			  [2, 1]
	  Position		  [660, 117, 695, 153]
	  Inputs		  "2"
	  DisplayOption		  "none"
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch"
	  Position		  [600, 110, 630, 140]
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace"
	  Position		  [240, 93, 305, 117]
	  VariableName		  "cl_trq_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace1"
	  Position		  [155, 114, 215, 136]
	  VariableName		  "cl_spd_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace2"
	  Position		  [680, 70, 740, 90]
	  VariableName		  "cs_trq_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  ToWorkspace
	  Name			  "To Workspace3"
	  Position		  [470, 169, 530, 191]
	  VariableName		  "cs_spd_in_r"
	  MaxDataPoints		  "inf"
	  Decimation		  "1"
	  SampleTime		  "-1"
	  SaveFormat		  "Array"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "help"
	  Ports			  []
	  Position		  [551, 24, 582, 67]
	  BackgroundColor	  "yellow"
	  DropShadow		  on
	  ShowName		  off
	  OpenFcn		  "web(['file:\\\\\\' which('Parallel.htm')])"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "image(imread('doc_man.jpg'))"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "help"
	    Location		    [203, 331, 569, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "minimum trq\n(Nm)"
	  Ports			  [1, 1]
	  Position		  [420, 90, 450, 120]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "minimum trq\n(Nm)"
	    Location		    [209, 214, 793, 522]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      Position		      [40, 108, 70, 122]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "(--)"
	      Position		      [60, 223, 130, 247]
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [355, 215, 375, 235]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>"
	      Position		      [60, 174, 105, 196]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "SOC"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [280, 89, 385, 141]
	      Gain		      "cs_min_trq_frac"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [200, 177, 230, 208]
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Selector
	      Name		      "Selector"
	      Ports		      [1, 1]
	      Position		      [120, 100, 150, 130]
	      InputType		      "Vector"
	      ElementSrc	      "Internal"
	      Elements		      "2"
	      RowSrc		      "Internal"
	      Rows		      "1"
	      ColumnSrc		      "Internal"
	      Columns		      "1"
	      InputPortWidth	      "2"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [405, 180, 435, 210]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Terminator
	      Name		      "Terminator"
	      Position		      [400, 30, 420, 50]
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "constant threshhold trq (N*m)"
	      Position		      [240, 28, 370, 52]
	      Value		      "max(fc_max_trq)*0.33"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "max_torque lookup"
	      Position		      [200, 103, 230, 127]
	      InputValues	      "fc_map_spd"
	      OutputValues	      "fc_max_trq*fc_trq_scale"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "minimum trq\n(N*m)"
	      Position		      [480, 188, 510, 202]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "max_torque lookup"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Selector"
	      SrcPort		      1
	      DstBlock		      "max_torque lookup"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "trq and spd req'd\ninto trq coupler\n(N"
"*m, rad/s)"
	      SrcPort		      1
	      DstBlock		      "Selector"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "constant threshhold trq (N*m)"
	      SrcPort		      1
	      DstBlock		      "Terminator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [5, 0; 0, -20]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "minimum trq\n(N*m)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "(--)"
	      SrcPort		      1
	      Points		      [25, 0; 0, -35]
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <ess>"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator2"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "mod pwr req"
	  Ports			  [1, 1]
	  Position		  [205, 15, 235, 65]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "mod pwr req"
	    Location		    [214, 74, 955, 744]
	    Open		    off
	    ModelBrowserVisibility  on
	    ModelBrowserWidth	    200
	    ScreenColor		    "automatic"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [105, 43, 135, 57]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From"
	      Position		      [80, 73, 205, 97]
	      BackgroundColor	      "gray"
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "acc_mech_pwr_est"
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [265, 31, 280, 104]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [305, 63, 335, 77]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  Product
	  Name			  "raw pwr req"
	  Ports			  [1, 1]
	  Position		  [135, 24, 165, 56]
	  FontName		  "Arial"
	  Inputs		  "1"
	  Multiplication	  "Element-wise(.*)"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [715, 128, 745, 142]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "Demux1"
	  SrcPort		  2
	  Points		  [5, 0]
	  Branch {
	    Points		    [0, 110; 520, 0]
	    DstBlock		    "Mux"
	    DstPort		    2
	  }
	  Branch {
	    DstBlock		    "To Workspace1"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  2
	  DstBlock		  "To Workspace3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "FC trq and spd"
	  SrcPort		  1
	  DstBlock		  "Demux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "mod pwr req"
	  SrcPort		  1
	  Points		  [100, 0]
	  DstBlock		  "FC trq and spd"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux1"
	  SrcPort		  1
	  DstBlock		  "To Workspace"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  Points		  [20, 0]
	  Branch {
	    Points		    [0, 40]
	    Branch {
	      DstBlock		      "Demux1"
	      DstPort		      1
	    }
	    Branch {
	      Points		      [310, 0]
	      DstBlock		      "minimum trq\n(Nm)"
	      DstPort		      1
	    }
	  }
	  Branch {
	    DstBlock		    "raw pwr req"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Switch"
	  SrcPort		  1
	  Points		  [10, 0]
	  Branch {
	    Points		    [0, -45]
	    DstBlock		    "To Workspace2"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "Mux"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "minimum trq\n(Nm)"
	  SrcPort		  1
	  DstBlock		  "MinMax"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  1
	  Points		  [15, 0]
	  DstBlock		  "MinMax"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Mux"
	  SrcPort		  1
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "Switch"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "MinMax"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <vc>1"
	  SrcPort		  1
	  Points		  [10, 0; 0, -10]
	  DstBlock		  "FC trq and spd"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "From <vc>"
	  SrcPort		  1
	  Points		  [10, 0]
	  Branch {
	    DstBlock		    "FC trq and spd"
	    DstPort		    2
	  }
	  Branch {
	    Points		    [0, 50; 320, 0; 0, -95]
	    DstBlock		    "Switch"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "raw pwr req"
	  SrcPort		  1
	  DstBlock		  "mod pwr req"
	  DstPort		  1
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "fuel cell\nadaptive\n<cs>"
      Ports		      [1, 1]
      Position		      [320, 557, 365, 593]
      ShowPortLabels	      on
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"fuel cell\nadaptive\n<cs>"
	Location		[204, 140, 895, 677]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"automatic"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "power req'd\nby bus (W)"
	  Position		  [85, 58, 115, 72]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Delta SOC\nexpected from regen"
	  Ports			  [2, 1]
	  Position		  [220, 97, 250, 133]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "Delta SOC\nexpected from regen"
	    Location		    [204, 375, 794, 659]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "Power req'd\nby bus (W)"
	      Position		      [50, 188, 80, 202]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "Soc"
	      Position		      [65, 33, 95, 47]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "  "
	      Position		      [325, 208, 350, 232]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      " 2"
	      Position		      [200, 153, 225, 177]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Delta\nSOC"
	      Ports		      [2, 1]
	      Position		      [265, 48, 290, 77]
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From<mc>1"
	      Position		      [100, 138, 190, 162]
	      ShowName		      off
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_pwr_out_a"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [300, 162, 330, 193]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory1"
	      Position		      [210, 29, 240, 51]
	      X0		      "ess_init_soc"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Regen "
	      Position		      [375, 165, 405, 195]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Regen flag conditions"
	      Position		      [195, 198, 220, 222]
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [240, 187, 270, 218]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [240, 142, 270, 173]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [315, 100, 345, 130]
	      ShowName		      off
	      UpperLimit	      "1"
	      LowerLimit	      "0"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [435, 164, 500, 196]
	      ShowName		      off
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time (s)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskInitialization      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "cs_regen_avg_time"
	      System {
		Name			"Subsystem"
		Location		[130, 153, 575, 369]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [30, 55, 50, 75]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "1/average time"
		  Position		  [255, 154, 295, 176]
		  FontName		  "Arial"
		  Value			  "1/n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [80, 55, 100, 75]
		  ShowName		  off
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [340, 66, 360, 84]
		  ShowName		  off
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [225, 60, 245, 80]
		  ShowName		  off
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  TransportDelay
		  Name			  "Transport\nDelay"
		  Position		  [155, 90, 195, 120]
		  DelayTime		  "n"
		  InitialInput		  "0"
		  BufferSize		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [390, 65, 410, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "1/average time"
		  SrcPort		  1
		  Points		  [15, 0; 0, -85]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Transport\nDelay"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Delta SOC\nregen"
	      Position		      [535, 173, 565, 187]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Delta\nSOC"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Regen "
	      SrcPort		      1
	      DstBlock		      "Subsystem"
	      DstPort		      1
	    }
	    Line {
	      Labels		      [0, 0]
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      DstBlock		      "Delta SOC\nregen"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Regen "
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Soc"
	      SrcPort		      1
	      Points		      [80, 0]
	      Branch {
		Points			[0, 30]
		DstBlock		"Delta\nSOC"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Memory1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Delta\nSOC"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Regen "
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Power req'd\nby bus (W)"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "  "
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Regen "
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Regen flag conditions"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      " 2"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From<mc>1"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator1"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Demux
	  Name			  "Demux"
	  Ports			  [1, 2]
	  Position		  [475, 203, 480, 272]
	  BackgroundColor	  "black"
	  ShowName		  off
	  Outputs		  "2"
	  BusSelectionMode	  off
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [65, 155, 125, 175]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "SOC"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>1"
	  Position		  [55, 253, 140, 277]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "ess_max_pwr"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>2"
	  Position		  [55, 303, 155, 327]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "ess_max_chg_pwr"
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc>"
	  Position		  [420, 289, 480, 311]
	  NamePlacement		  "alternate"
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "key_on"
	}
	Block {
	  BlockType		  From
	  Name			  "From <vc> "
	  Position		  [55, 405, 150, 425]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "fc_pwr_out_a"
	}
	Block {
	  BlockType		  From
	  Name			  "From<ess>"
	  Position		  [55, 354, 130, 376]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "ess_tmp"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>3"
	  Position		  [570, 273, 645, 297]
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Logic
	  Name			  "Logical\nOperator"
	  Ports			  [2, 1]
	  Position		  [510, 255, 540, 315]
	  Operator		  "AND"
	  Inputs		  "2"
	}
	Block {
	  BlockType		  Memory
	  Name			  "Memory"
	  Position		  [175, 403, 200, 427]
	  X0			  "0"
	  InheritSampleTime	  off
	  RTWStateStorageClass	  "Auto"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "Minimize\nenergy"
	  Ports			  [1, 1]
	  Position		  [335, 220, 455, 260]
	  FunctionName		  "sfun_fuelcell_adapt"
	  Parameters		  "cs_max_pwr_rise_rate,cs_max_pwr_fall_rate,f"
"c_fuel_lhv,cs_shutoff,cs_min_pwr,cs_max_pwr,cs_mean_eff_bool,cs_mean_eff,cs_p"
"lot_output"
	  PortCounts		  "[]"
	  SFunctionModules	  "''"
	}
	Block {
	  BlockType		  Mux
	  Name			  "Mux"
	  Ports			  [8, 1]
	  Position		  [300, 39, 310, 441]
	  ShowName		  off
	  Inputs		  "8"
	  DisplayOption		  "bar"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "SOC regulation factor"
	  Ports			  [1, 1]
	  Position		  [205, 201, 250, 229]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "SOC regulation factor"
	    Location		    [237, 527, 903, 713]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "automatic"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [120, 58, 150, 72]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "1"
	      Position		      [445, 20, 465, 40]
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Goal"
	      Position		      [25, 94, 160, 116]
	      Value		      "(cs_lo_soc+cs_hi_soc)/2"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Product1"
	      Ports		      [2, 1]
	      Position		      [235, 102, 265, 133]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Range"
	      Position		      [25, 134, 160, 156]
	      Value		      "(cs_hi_soc-cs_lo_soc)/2"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [310, 105, 340, 135]
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [185, 57, 215, 88]
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [505, 55, 535, 85]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Fcn
	      Name		      "between\n 0.8 and 1.2"
	      Position		      [380, 105, 440, 135]
	      Expr		      "0.2*u+1"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "boolean sustaining/depleting"
	      Position		      [340, 59, 475, 81]
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "Out1"
	      Position		      [600, 63, 630, 77]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Product1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Range"
	      SrcPort		      1
	      Points		      [55, 0]
	      DstBlock		      "Product1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Goal"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Product1"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "between\n 0.8 and 1.2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "boolean sustaining/depleting"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "1"
	      SrcPort		      1
	      Points		      [10, 0; 0, 30]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "between\n 0.8 and 1.2"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Out1"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Outport
	  Name			  "engine pwr (W)"
	  Position		  [545, 213, 575, 227]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "power req'd\nby bus (W)"
	  SrcPort		  1
	  Points		  [75, 0]
	  Branch {
	    DstBlock		    "Mux"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 40]
	    DstBlock		    "Delta SOC\nexpected from regen"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "Mux"
	  SrcPort		  1
	  DstBlock		  "Minimize\nenergy"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [0, 0; 30, 0]
	  Branch {
	    Points		    [20, 0]
	    Branch {
	      DstBlock		      "Mux"
	      DstPort		      3
	    }
	    Branch {
	      Points		      [0, 50]
	      DstBlock		      "SOC regulation factor"
	      DstPort		      1
	    }
	  }
	  Branch {
	    Points		    [0, -40]
	    DstBlock		    "Delta SOC\nexpected from regen"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "Minimize\nenergy"
	  SrcPort		  1
	  DstBlock		  "Demux"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <vc>"
	  SrcPort		  1
	  DstBlock		  "Logical\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  2
	  Points		  [10, 0]
	  DstBlock		  "Logical\nOperator"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Demux"
	  SrcPort		  1
	  DstBlock		  "engine pwr (W)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Logical\nOperator"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "SOC regulation factor"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  4
	}
	Line {
	  SrcBlock		  "From <ess>1"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  5
	}
	Line {
	  SrcBlock		  "From <ess>2"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  6
	}
	Line {
	  SrcBlock		  "From<ess>"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  7
	}
	Line {
	  SrcBlock		  "Memory"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  8
	}
	Line {
	  SrcBlock		  "From <vc> "
	  SrcPort		  1
	  DstBlock		  "Memory"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Delta SOC\nexpected from regen"
	  SrcPort		  1
	  DstBlock		  "Mux"
	  DstPort		  2
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "fuel cell\ncontrol strategy\n<cs>"
      Ports		      [1, 1]
      Position		      [220, 549, 255, 591]
      BackgroundColor	      "yellow"
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"fuel cell\ncontrol strategy\n<cs>"
	Location		[31, 75, 545, 336]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "power req'd\nby bus (W)"
	  Position		  [25, 158, 55, 172]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC on"
	  Ports			  [4, 1]
	  Position		  [305, 73, 335, 107]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC on"
	    Location		    [19, 94, 984, 697]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "ess max pwr would\nbe insufficient"
	      Position		      [35, 563, 65, 577]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "SOC"
	      Position		      [25, 298, 55, 312]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "FC pwr\ncommand"
	      Position		      [20, 398, 50, 412]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "bus pwr req"
	      Position		      [85, 523, 115, 537]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [80, 371, 130, 389]
	      ShowName		      off
	      Value		      "cs_hi_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [15, 442, 205, 468]
	      ShowName		      off
	      Value		      "cs_min_pwr*fc_pwr_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant10"
	      Position		      [675, 316, 735, 334]
	      Orientation	      "left"
	      ShowName		      off
	      Value		      "cs_fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [215, 537, 235, 553]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [95, 257, 150, 273]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [95, 72, 115, 88]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [95, 42, 115, 58]
	      ShowName		      off
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [100, 101, 185, 119]
	      ShowName		      off
	      Value		      "cs_min_off_time"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [86, 200, 284, 225]
	      Orientation	      "up"
	      ShowName		      off
	      Value		      "1.2*cs_min_pwr*fc_pwr_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [760, 320, 800, 340]
	      Orientation	      "left"
	      ShowName		      off
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [235, 270, 355, 290]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [365, 437, 385, 453]
	      ShowName		      off
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>2"
	      Position		      [50, 478, 160, 502]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_chg_pwr"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>"
	      Position		      [755, 242, 810, 258]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "key_on"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [240, 320, 270, 350]
	      Gain		      "0.5"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [295, 367, 325, 398]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [390, 242, 420, 273]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [1, 1]
	      Position		      [390, 489, 420, 521]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator11"
	      Ports		      [2, 1]
	      Position		      [685, 270, 715, 305]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator13"
	      Ports		      [3, 1]
	      Position		      [765, 272, 795, 308]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [3, 1]
	      Position		      [335, 234, 365, 266]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [265, 67, 295, 98]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [3, 1]
	      Position		      [560, 253, 590, 287]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [2, 1]
	      Position		      [620, 261, 650, 294]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [2, 1]
	      Position		      [440, 322, 470, 353]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [1, 1]
	      Position		      [440, 279, 470, 311]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [2, 1]
	      Position		      [485, 392, 515, 423]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [2, 1]
	      Position		      [335, 487, 365, 518]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [385, 15, 415, 45]
	      Orientation	      "left"
	      X0		      "cs_fc_init_state"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [150, 357, 180, 388]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [240, 397, 270, 428]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [190, 242, 220, 273]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [210, 57, 240, 88]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [200, 152, 230, 183]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [295, 297, 325, 328]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [425, 397, 455, 428]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator7"
	      Position		      [270, 447, 300, 478]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator8"
	      Position		      [270, 522, 300, 553]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [80, 143, 125, 177]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time (s)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskInitialization      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "5"
	      System {
		Name			"Subsystem"
		Location		[115, 388, 551, 664]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [30, 55, 50, 75]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [255, 154, 295, 176]
		  FontName		  "Arial"
		  Value			  "n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [80, 55, 100, 75]
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [340, 66, 360, 84]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [225, 60, 245, 80]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  TransportDelay
		  Name			  "Transport\nDelay"
		  Position		  [155, 90, 195, 120]
		  DelayTime		  "n"
		  InitialInput		  "0"
		  BufferSize		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [390, 65, 410, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [15, 0; 0, -85]
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Transport\nDelay"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [190, 317, 220, 348]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum2"
	      Ports		      [2, 1]
	      Position		      [195, 482, 225, 513]
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [490, 279, 520, 311]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "dt"
	      Ports		      [0, 1]
	      Position		      [360, 390, 390, 420]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"dt"
		Location		[80, 285, 429, 424]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [65, 60, 85, 80]
		  FontName		  "Arial"
		  FontSize		  8
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [125, 85, 160, 105]
		  FontName		  "Arial"
		  FontSize		  8
		  X0			  "-1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 65, 225, 85]
		  FontName		  "Arial"
		  FontSize		  8
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [255, 65, 275, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -15]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "just shut \ndown"
	      Ports		      [1, 1]
	      Position		      [50, 48, 80, 82]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"just shut \ndown"
		Location		[71, 150, 410, 293]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "state"
		  Position		  [15, 20, 35, 40]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [220, 23, 250, 47]
		  FontName		  "Arial"
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [1, 1]
		  Position		  [135, 18, 165, 42]
		  FontName		  "Arial"
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [135, 85, 170, 105]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Outport
		  Name			  "trigger"
		  Position		  [295, 25, 315, 45]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "trigger"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [30, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "state"
		  SrcPort		  1
		  Points		  [50, 0]
		  Branch {
		    Points		    [0, 65]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "Logical\nOperator1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "no-lag\nReset Integrator"
	      Ports		      [3, 1]
	      Position		      [135, 44, 175, 86]
	      ShowName		      off
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "No-lag Reset Integrator"
	      MaskDescription	      "No-lag Reset Integrator"
	      MaskHelp		      "Integrates first input using Euler tech"
"nique.\\nAt the time step that input 2 <> zero,\\noutput is reset to input 3."
	      MaskPromptString	      "Initial Value"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskInitialization      "initval=@1;"
	      MaskDisplay	      "disp('1/s\\nw/ reset\\nno lag')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "0"
	      System {
		Name			"no-lag\nReset Integrator"
		Location		[265, 331, 787, 595]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [60, 100, 80, 120]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "in_2"
		  Position		  [60, 140, 80, 160]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "in_3"
		  Position		  [45, 185, 65, 205]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [105, 155, 125, 175]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [340, 55, 375, 75]
		  Orientation		  "left"
		  FontName		  "Arial"
		  X0			  "initval"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [160, 96, 180, 114]
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [230, 90, 250, 110]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [290, 139, 320, 171]
		  FontName		  "Arial"
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [112, 50, 138, 80]
		  Orientation		  "down"
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    }
		  }
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "in_2==0"
		  Position		  [160, 143, 190, 167]
		  Operator		  "=="
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [455, 145, 475, 165]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "in_2==0"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "in_2==0"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [85, 0]
		  Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		  Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [10, 0; 0, 45]
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [-130, 0; 0, 30]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  Points		  [0, 15]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "in_2"
		  SrcPort		  1
		  DstBlock		  "in_2==0"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_3"
		  SrcPort		  1
		  Points		  [195, 0; 0, -30]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "FC on"
	      Position		      [850, 283, 880, 297]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "dt"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      Points		      [35, 0]
	      Branch {
		Points			[0, 90; 75, 0]
		DstBlock		"Logical\nOperator8"
		DstPort			1
	      }
	      Branch {
		Points			[20, 0; 0, 15]
		DstBlock		"Logical\nOperator7"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [0, -35]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		DstBlock		"Logical\nOperator6"
		DstPort			1
	      }
	      Branch {
		Points			[50, 0]
		DstBlock		"Switch"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		Points			[0, -40]
		DstBlock		"Sum"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-60, 0]
	      Branch {
		Points			[-285, 0]
		DstBlock		"just shut \ndown"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Logical\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "no-lag\nReset Integrator"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "just shut \ndown"
	      SrcPort		      1
	      DstBlock		      "no-lag\nReset Integrator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "no-lag\nReset Integrator"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "no-lag\nReset Integrator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [10, 0; 0, 165]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "SOC"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator5"
		DstPort			1
	      }
	      Branch {
		Points			[0, 60]
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		Points			[0, -55]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "FC pwr\ncommand"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Subsystem"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "ess max pwr would\nbe insufficient"
	      SrcPort		      1
	      Points		      [465, 0; 0, -300]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      Points		      [0, 30]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <ess>2"
	      SrcPort		      1
	      DstBlock		      "Sum2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "bus pwr req"
	      SrcPort		      1
	      Points		      [55, 0]
	      Branch {
		DstBlock		"Relational\nOperator8"
		DstPort			1
	      }
	      Branch {
		Points			[0, -25]
		DstBlock		"Sum2"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Sum2"
	      SrcPort		      1
	      Points		      [0, -30]
	      DstBlock		      "Relational\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      Points		      [175, 0; 0, -220]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator7"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator8"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"Relational\nOperator1"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Relational\nOperator7"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator11"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant10"
	      SrcPort		      1
	      Points		      [-10, 0; 0, -30]
	      DstBlock		      "Logical\nOperator11"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator11"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "From <vc>"
	      SrcPort		      1
	      Points		      [-10, 0; 0, 30]
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [-15, 0; 0, -30]
	      DstBlock		      "Logical\nOperator13"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator13"
	      SrcPort		      1
	      Points		      [30, 0]
	      Branch {
		DstBlock		"FC on"
		DstPort			1
	      }
	      Branch {
		Points			[0, -260]
		DstBlock		"Memory"
		DstPort			1
	      }
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC pwr command,\nmodified by SOC"
	  Ports			  [3, 1]
	  Position		  [205, 149, 235, 181]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC pwr command,\nmodified by SOC"
	    Location		    [101, 251, 923, 551]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "SOC"
	      Position		      [130, 123, 160, 137]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "raw\npwr command\n(W)"
	      Position		      [85, 28, 115, 42]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "pwr req'd at bus (W)"
	      Position		      [205, 43, 235, 57]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [670, 225, 726, 265]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[168, 385, 648, 555]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [242, 57]
		  VerticalAlignment	  "top"
		  Text			  "1/5/98/98:tm  Modified calculation "
"of additional power required to maintain goal SOC\n(SOC_goal - SOC_actual) / "
"(0.5*SOC_range) * cs_charge_pwr\ntherefore when\nactual_SOC=cs_lo_soc ==> 1.0"
"  *cs_charge_pwr\nactual_SOC=goal_SOC ==> 0.0  *cs_charge_pwr\nactual_SOC=cs_"
"hi_soc ==> -1.0 * cs_charge_pwr"
		}
		Annotation {
		  Position		  [222, 17]
		  VerticalAlignment	  "top"
		  Text			  "This block determines the additiona"
"l power required of the fuel convertor\n to maintian an SOC equal to the aver"
"age of cs_hi_soc and cs_lo_soc."
		}
	      }
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>2"
	      Position		      [175, 78, 285, 102]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_chg_pwr"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [370, 127, 460, 173]
	      Gain		      "cs_charge_pwr"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [205, 222, 240, 258]
	      ShowName		      off
	      Gain		      "0.5"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain2"
	      Position		      [495, 51, 520, 79]
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Goal SOC"
	      Position		      [35, 177, 175, 203]
	      Value		      "0.5*(cs_hi_soc+cs_lo_soc)"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax1"
	      Ports		      [2, 1]
	      Position		      [495, 97, 525, 128]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Multiplier"
	      Ports		      [2, 1]
	      Position		      [270, 132, 300, 163]
	      ShowName		      off
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Multiplier1"
	      Ports		      [2, 1]
	      Position		      [625, 57, 655, 88]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "SOC Range"
	      Position		      [55, 228, 175, 252]
	      Value		      "cs_hi_soc-cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [320, 135, 350, 165]
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [210, 122, 240, 153]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum1"
	      Ports		      [2, 1]
	      Position		      [690, 27, 720, 58]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum4"
	      Ports		      [2, 1]
	      Position		      [335, 67, 365, 98]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [555, 50, 585, 80]
	      Threshold		      "0"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "ess state"
	      Position		      [550, 105, 600, 125]
	      Value		      "ess_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "pwr command\nmodifed for SOC\n(W)"
	      Position		      [750, 38, 780, 52]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "SOC"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Goal SOC"
	      SrcPort		      1
	      Points		      [10, 0; 0, -45]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "SOC Range"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Multiplier"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Multiplier"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [5, 0; 0, -85]
	      DstBlock		      "Multiplier"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "MinMax1"
	      SrcPort		      1
	      Points		      [5, 0; 0, -60]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -30]
		DstBlock		"MinMax1"
		DstPort			2
	      }
	      Branch {
		Points			[65, 0]
		DstBlock		"Switch"
		DstPort			3
	      }
	    }
	    Line {
	      SrcBlock		      "Gain2"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "raw\npwr command\n(W)"
	      SrcPort		      1
	      DstBlock		      "Sum1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "pwr req'd at bus (W)"
	      SrcPort		      1
	      Points		      [35, 0]
	      Branch {
		Points			[0, 25]
		DstBlock		"Sum4"
		DstPort			1
	      }
	      Branch {
		Points			[205, 0]
		DstBlock		"Gain2"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "From <ess>2"
	      SrcPort		      1
	      DstBlock		      "Sum4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum4"
	      SrcPort		      1
	      Points		      [110, 0]
	      DstBlock		      "MinMax1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum1"
	      SrcPort		      1
	      DstBlock		      "pwr command\nmodifed for SOC\n(W)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "ess state"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Multiplier1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Multiplier1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Multiplier1"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Sum1"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC pwr command,\nw/ limits enforced"
	  Ports			  [3, 1]
	  Position		  [305, 139, 335, 171]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC pwr command,\nw/ limits enforced"
	    Location		    [156, 171, 855, 561]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "ess max pwr would\nbe insufficient"
	      Position		      [45, 33, 75, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "SOC"
	      Position		      [45, 88, 75, 102]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "FC pwr\ncommand"
	      Position		      [45, 258, 75, 272]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [27, 315, 163, 335]
	      Orientation	      "up"
	      Value		      "cs_min_pwr*fc_pwr_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [290, 153, 350, 177]
	      Orientation	      "left"
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [25, 220, 160, 240]
	      Value		      "cs_max_pwr*fc_pwr_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [3, 1]
	      Position		      [385, 71, 420, 139]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [305, 24, 335, 56]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [140, 257, 170, 288]
	      Function		      "max"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax1"
	      Ports		      [2, 1]
	      Position		      [255, 257, 285, 288]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [535, 270, 565, 300]
	      RisingSlewLimit	      "cs_max_pwr_rise_rate*fc_pwr_scale"
	      FallingSlewLimit	      "cs_max_pwr_fall_rate*fc_pwr_scale"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [305, 87, 335, 118]
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [460, 270, 490, 300]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "ess state"
	      Position		      [295, 205, 345, 225]
	      Value		      "ess_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "limited\nFC pwr\ncommand\n(W)"
	      Position		      [615, 278, 645, 292]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "ess max pwr would\nbe insufficient"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "SOC"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-5, 0; 0, -55]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "limited\nFC pwr\ncommand\n(W)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Rate Limiter"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [45, 0]
	      Branch {
		Points			[0, 20]
		DstBlock		"Switch"
		DstPort			3
	      }
	      Branch {
		Points			[20, 0]
		DstBlock		"MinMax1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "MinMax1"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [75, 0]
	      DstBlock		      "MinMax1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -30]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "FC pwr\ncommand"
	      SrcPort		      1
	      DstBlock		      "MinMax"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "ess state"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      3
	    }
	  }
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [100, 75, 160, 95]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "SOC"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>1"
	  Position		  [90, 33, 175, 57]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "ess_max_pwr"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>3"
	  Position		  [380, 81, 455, 99]
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Product
	  Name			  "Product"
	  Ports			  [2, 1]
	  Position		  [380, 138, 410, 162]
	  ShowName		  off
	  FontName		  "Arial"
	  Inputs		  "2"
	  Multiplication	  "Element-wise(.*)"
	  SaturateOnIntegerOverflow on
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [200, 12, 230, 43]
	  Operator		  ">="
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "pwr req'd from\nFC to supply\npwr req'd at "
"bus\n(W)"
	  Ports			  [1, 1]
	  Position		  [110, 150, 140, 180]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "pwr req'd from\nFC to supply\npwr req'd a"
"t bus\n(W)"
	    Location		    [140, 150, 608, 416]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "power req'd\nby bus (W)"
	      Position		      [15, 43, 45, 57]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [135, 145, 155, 165]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [265, 90, 285, 110]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [125, 77, 155, 108]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [260, 45, 290, 75]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "pwr req'd\nof FC (W)"
	      Position		      [335, 53, 365, 67]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "power req'd\nby bus (W)"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 35]
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Switch"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-20, 0]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [70, 0; 0, -35]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "pwr req'd\nof FC (W)"
	      DstPort		      1
	    }
	  }
	}
	Block {
	  BlockType		  Outport
	  Name			  "engine pwr (W)"
	  Position		  [445, 140, 465, 160]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "0"
	}
	Line {
	  SrcBlock		  "power req'd\nby bus (W)"
	  SrcPort		  1
	  Points		  [25, 0]
	  Branch {
	    Points		    [0, 75; 85, 0]
	    Branch {
	      Points		      [100, 0; 0, -135]
	      DstBlock		      "FC on"
	      DstPort		      4
	    }
	    Branch {
	      Points		      [0, -65]
	      DstBlock		      "FC pwr command,\nmodified by SOC"
	      DstPort		      3
	    }
	  }
	  Branch {
	    Points		    [0, -145]
	    DstBlock		    "Relational\nOperator"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "pwr req'd from\nFC to supply\npwr req'd a"
"t bus\n(W)"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <ess>1"
	  SrcPort		  1
	  Points		  [5, 0]
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Product"
	  SrcPort		  1
	  DstBlock		  "engine pwr (W)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "pwr req'd from\nFC to supply\npwr req'd at "
"bus\n(W)"
	  SrcPort		  1
	  DstBlock		  "FC pwr command,\nmodified by SOC"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "FC pwr command,\nw/ limits enforced"
	  SrcPort		  1
	  DstBlock		  "Product"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  Points		  [50, 0; 0, 45]
	  Branch {
	    DstBlock		    "FC on"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 70]
	    DstBlock		    "FC pwr command,\nw/ limits enforced"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [5, 0]
	  Branch {
	    Points		    [0, 70]
	    DstBlock		    "FC pwr command,\nmodified by SOC"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [90, 0]
	    Branch {
	      DstBlock		      "FC on"
	      DstPort		      2
	    }
	    Branch {
	      Points		      [0, 70]
	      DstBlock		      "FC pwr command,\nw/ limits enforced"
	      DstPort		      2
	    }
	  }
	}
	Line {
	  SrcBlock		  "FC pwr command,\nmodified by SOC"
	  SrcPort		  1
	  Points		  [10, 0]
	  Branch {
	    DstBlock		    "FC pwr command,\nw/ limits enforced"
	    DstPort		    3
	  }
	  Branch {
	    Points		    [0, -70]
	    DstBlock		    "FC on"
	    DstPort		    3
	  }
	}
	Line {
	  SrcBlock		  "FC on"
	  SrcPort		  1
	  Points		  [10, 0]
	  Branch {
	    DstBlock		    "Goto <fc>3"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 55]
	    DstBlock		    "Product"
	    DstPort		    1
	  }
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "fuel cell <cs> config"
      Ports		      [1, 1]
      Position		      [655, 705, 720, 755]
      ShowPortLabels	      off
      BlockChoice	      "fuel cell adaptive <cs>"
      TemplateBlock	      "self"
      MemberBlocks	      "fuel cell adaptive <cs>,fuel cell control strat"
"egy <cs>"
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      System {
	Name			"fuel cell <cs> config"
	Location		[148, 182, 646, 482]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "power req'd\nby bus (W)"
	  Position		  [20, 40, 40, 60]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Reference
	  Name			  "fuel cell\nadaptive\n<cs>"
	  Ports			  [1, 1]
	  Position		  [100, 40, 140, 80]
	  SourceBlock		  "lib_controls/fuel cell\nadaptive\n<cs>"
	  SourceType		  "Unknown"
	}
	Block {
	  BlockType		  Outport
	  Name			  "engine pwr (W)"
	  Position		  [200, 40, 220, 60]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "power req'd\nby bus (W)"
	  SrcPort		  1
	  Points		  [20, 0; 0, 10]
	  DstBlock		  "fuel cell\nadaptive\n<cs>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "fuel cell\nadaptive\n<cs>"
	  SrcPort		  1
	  Points		  [20, 0; 0, -10]
	  DstBlock		  "engine pwr (W)"
	  DstPort		  1
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "par <cs> config"
      Ports		      [1, 1]
      Position		      [380, 681, 420, 719]
      ShowPortLabels	      off
      BlockChoice	      "electric assist control strategy <cs>"
      TemplateBlock	      "self"
      MemberBlocks	      "Adaptive control strategy <cs>,Fuzzy Logic cont"
"rol strategy <cs>,Fuzzy Logic control strategy with Emissions <cs>,electric a"
"ssist control strategy <cs>,electric assist control strategy bal <cs>"
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      System {
	Name			"par <cs> config"
	Location		[148, 182, 646, 482]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  Position		  [20, 40, 40, 60]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Reference
	  Name			  "electric assist\ncontrol strategy\n<cs>"
	  Ports			  [1, 1]
	  Position		  [100, 40, 140, 80]
	  SourceBlock		  "lib_controls/electric assist\ncontrol strat"
"egy\n<cs>"
	  SourceType		  "Unknown"
	}
	Block {
	  BlockType		  Outport
	  Name			  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  Position		  [200, 40, 220, 60]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "trq and spd req'd\ninto clutch\n(N*m, rad/s"
")"
	  SrcPort		  1
	  Points		  [20, 0; 0, 10]
	  DstBlock		  "electric assist\ncontrol strategy\n<cs>"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "electric assist\ncontrol strategy\n<cs>"
	  SrcPort		  1
	  Points		  [20, 0; 0, -10]
	  DstBlock		  "trq and spd\nreq'd from\nengine\n(N*m, rad/"
"s)"
	  DstPort		  1
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "par <vc> config"
      Ports		      [0, 1]
      Position		      [375, 771, 440, 819]
      ShowPortLabels	      off
      BlockChoice	      "<vc> par"
      TemplateBlock	      "self"
      MemberBlocks	      "<vc> par,<vc> par Adaptive,<vc> par balanced"
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      System {
	Name			"par <vc> config"
	Location		[148, 182, 646, 482]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Reference
	  Name			  "<vc> par"
	  Ports			  [0, 1]
	  Position		  [100, 40, 140, 80]
	  SourceBlock		  "lib_controls/<vc> par"
	  SourceType		  "Unknown"
	}
	Block {
	  BlockType		  Outport
	  Name			  "clutch\nstate"
	  Position		  [200, 40, 220, 60]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "<vc> par"
	  SrcPort		  1
	  Points		  [20, 0; 0, -10]
	  DstBlock		  "clutch\nstate"
	  DstPort		  1
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "series hybrid\ncontrol stategy\n <cs>"
      Ports		      [1, 1]
      Position		      [220, 444, 260, 486]
      BackgroundColor	      "yellow"
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      MaskDisplay	      "image(imread('bdi_cs.jpg'))"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"series hybrid\ncontrol stategy\n <cs>"
	Location		[28, 74, 737, 351]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "power req'd\nby bus (W)"
	  Position		  [25, 158, 55, 172]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC on"
	  Ports			  [4, 1]
	  Position		  [325, 73, 355, 107]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC on"
	    Location		    [142, 74, 915, 686]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "ess max pwr would\nbe insufficient"
	      Position		      [35, 563, 65, 577]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "SOC"
	      Position		      [25, 298, 55, 312]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "FC pwr\ncommand"
	      Position		      [20, 398, 50, 412]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "bus pwr req"
	      Position		      [85, 523, 115, 537]
	      Port		      "4"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [80, 371, 130, 389]
	      ShowName		      off
	      Value		      "cs_hi_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [15, 442, 205, 468]
	      ShowName		      off
	      Value		      "cs_min_pwr*fc_spd_scale*fc_trq_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant11"
	      Position		      [215, 537, 235, 553]
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [95, 257, 150, 273]
	      ShowName		      off
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [95, 72, 115, 88]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [95, 42, 115, 58]
	      ShowName		      off
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [100, 101, 185, 119]
	      ShowName		      off
	      Value		      "cs_min_off_time"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [86, 200, 284, 225]
	      Orientation	      "up"
	      ShowName		      off
	      Value		      "1.2*cs_min_pwr*fc_spd_scale*fc_trq_scal"
"e"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [615, 300, 655, 320]
	      Orientation	      "left"
	      ShowName		      off
	      Value		      "fc_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant8"
	      Position		      [235, 270, 355, 290]
	      NamePlacement	      "alternate"
	      ShowName		      off
	      Value		      "cs_charge_deplete_bool"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant9"
	      Position		      [365, 437, 385, 453]
	      ShowName		      off
	      Value		      "1"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>2"
	      Position		      [50, 478, 160, 502]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_chg_pwr"
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <vc>"
	      Position		      [610, 227, 665, 243]
	      Orientation	      "left"
	      NamePlacement	      "alternate"
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "key_on"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [240, 320, 270, 350]
	      Gain		      "0.5"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [295, 367, 325, 398]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [2, 1]
	      Position		      [390, 242, 420, 273]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator10"
	      Ports		      [1, 1]
	      Position		      [390, 489, 420, 521]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator2"
	      Ports		      [3, 1]
	      Position		      [335, 234, 365, 266]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator3"
	      Ports		      [2, 1]
	      Position		      [265, 67, 295, 98]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator4"
	      Ports		      [3, 1]
	      Position		      [560, 253, 590, 287]
	      ShowName		      off
	      Operator		      "OR"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator5"
	      Ports		      [4, 1]
	      Position		      [620, 259, 650, 291]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "4"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator6"
	      Ports		      [2, 1]
	      Position		      [440, 322, 470, 353]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator7"
	      Ports		      [1, 1]
	      Position		      [440, 279, 470, 311]
	      ShowName		      off
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator8"
	      Ports		      [2, 1]
	      Position		      [485, 392, 515, 423]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator9"
	      Ports		      [2, 1]
	      Position		      [335, 487, 365, 518]
	      ShowName		      off
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [385, 15, 415, 45]
	      Orientation	      "left"
	      X0		      "cs_fc_init_state"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [150, 357, 180, 388]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator1"
	      Position		      [240, 397, 270, 428]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator2"
	      Position		      [190, 242, 220, 273]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator3"
	      Position		      [210, 57, 240, 88]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator4"
	      Position		      [200, 152, 230, 183]
	      ShowName		      off
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator5"
	      Position		      [295, 297, 325, 328]
	      ShowName		      off
	      Operator		      "<="
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator6"
	      Position		      [425, 397, 455, 428]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator7"
	      Position		      [270, 447, 300, 478]
	      ShowName		      off
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator8"
	      Position		      [270, 522, 300, 553]
	      ShowName		      off
	      Operator		      "<"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Subsystem"
	      Ports		      [1, 1]
	      Position		      [80, 143, 125, 177]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "Running Average"
	      MaskDescription	      "Running Average"
	      MaskHelp		      "Output is the average of the last (Aver"
"aging Time) seconds of input."
	      MaskPromptString	      "Averaging Time (s)"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskInitialization      "n=@1;"
	      MaskDisplay	      "disp('Running\\nAverage')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "5"
	      System {
		Name			"Subsystem"
		Location		[115, 388, 551, 664]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [30, 55, 50, 75]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant1"
		  Position		  [255, 154, 295, 176]
		  FontName		  "Arial"
		  Value			  "n"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Integrator
		  Name			  "Integrator"
		  Ports			  [1, 1]
		  Position		  [80, 55, 100, 75]
		  ExternalReset		  "none"
		  InitialConditionSource  "internal"
		  InitialCondition	  "0"
		  LimitOutput		  off
		  UpperSaturationLimit	  "inf"
		  LowerSaturationLimit	  "-inf"
		  ShowSaturationPort	  off
		  ShowStatePort		  off
		  AbsoluteTolerance	  "auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [340, 66, 360, 84]
		  Inputs		  "*/"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [225, 60, 245, 80]
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  TransportDelay
		  Name			  "Transport\nDelay"
		  Position		  [155, 90, 195, 120]
		  DelayTime		  "n"
		  InitialInput		  "0"
		  BufferSize		  "1024"
		  PadeOrder		  "0"
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [390, 65, 410, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Integrator"
		  SrcPort		  1
		  Points		  [25, 0]
		  Branch {
		    DstBlock		    "Sum"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 40]
		    DstBlock		    "Transport\nDelay"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Transport\nDelay"
		  SrcPort		  1
		  Points		  [10, 0]
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "Integrator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Constant1"
		  SrcPort		  1
		  Points		  [15, 0; 0, -85]
		  DstBlock		  "Product"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [190, 317, 220, 348]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum2"
	      Ports		      [2, 1]
	      Position		      [195, 482, 225, 513]
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [490, 279, 520, 311]
	      FontName		      "Arial"
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "dt"
	      Ports		      [0, 1]
	      Position		      [360, 390, 390, 420]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"dt"
		Location		[80, 285, 429, 424]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Clock
		  Name			  "Clock"
		  Position		  [65, 60, 85, 80]
		  FontName		  "Arial"
		  FontSize		  8
		  DisplayTime		  off
		  Decimation		  "10"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [125, 85, 160, 105]
		  FontName		  "Arial"
		  FontSize		  8
		  X0			  "-1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum1"
		  Ports			  [2, 1]
		  Position		  [205, 65, 225, 85]
		  FontName		  "Arial"
		  FontSize		  8
		  IconShape		  "rectangular"
		  Inputs		  "+-"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [255, 65, 275, 85]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Clock"
		  SrcPort		  1
		  Points		  [15, 0]
		  Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [10, 0; 0, -15]
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Sum1"
		  SrcPort		  1
		  DstBlock		  "out_1"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "just shut \ndown"
	      Ports		      [1, 1]
	      Position		      [50, 48, 80, 82]
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      System {
		Name			"just shut \ndown"
		Location		[71, 150, 410, 293]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "state"
		  Position		  [15, 20, 35, 40]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator"
		  Ports			  [2, 1]
		  Position		  [220, 23, 250, 47]
		  FontName		  "Arial"
		  Operator		  "AND"
		  Inputs		  "2"
		}
		Block {
		  BlockType		  Logic
		  Name			  "Logical\nOperator1"
		  Ports			  [1, 1]
		  Position		  [135, 18, 165, 42]
		  FontName		  "Arial"
		  Operator		  "NOT"
		  Inputs		  "1"
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory1"
		  Position		  [135, 85, 170, 105]
		  FontName		  "Arial"
		  X0			  "1"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Outport
		  Name			  "trigger"
		  Position		  [295, 25, 315, 45]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "Logical\nOperator1"
		  SrcPort		  1
		  DstBlock		  "Logical\nOperator"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "state"
		  SrcPort		  1
		  Points		  [50, 0]
		  Branch {
		    DstBlock		    "Logical\nOperator1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, 65]
		    DstBlock		    "Memory1"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "Memory1"
		  SrcPort		  1
		  Points		  [30, 0]
		  DstBlock		  "Logical\nOperator"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Logical\nOperator"
		  SrcPort		  1
		  DstBlock		  "trigger"
		  DstPort		  1
		}
	      }
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "no-lag\nReset Integrator"
	      Ports		      [3, 1]
	      Position		      [135, 44, 175, 86]
	      ShowName		      off
	      ShowPortLabels	      off
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskType		      "No-lag Reset Integrator"
	      MaskDescription	      "No-lag Reset Integrator"
	      MaskHelp		      "Integrates first input using Euler tech"
"nique.\\nAt the time step that input 2 <> zero,\\noutput is reset to input 3."
	      MaskPromptString	      "Initial Value"
	      MaskStyleString	      "edit"
	      MaskTunableValueString  "on"
	      MaskEnableString	      "on"
	      MaskVisibilityString    "on"
	      MaskToolTipString	      "on"
	      MaskInitialization      "initval=@1;"
	      MaskDisplay	      "disp('1/s\\nw/ reset\\nno lag')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "0"
	      System {
		Name			"no-lag\nReset Integrator"
		Location		[265, 331, 787, 595]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Block {
		  BlockType		  Inport
		  Name			  "in_1"
		  Position		  [60, 100, 80, 120]
		  Port			  "1"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "in_2"
		  Position		  [60, 140, 80, 160]
		  Port			  "2"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Inport
		  Name			  "in_3"
		  Position		  [45, 185, 65, 205]
		  Port			  "3"
		  LatchInput		  off
		  Interpolate		  on
		}
		Block {
		  BlockType		  Constant
		  Name			  "Constant"
		  Position		  [105, 155, 125, 175]
		  Value			  "0"
		  VectorParams1D	  on
		}
		Block {
		  BlockType		  Memory
		  Name			  "Memory"
		  Position		  [340, 55, 375, 75]
		  Orientation		  "left"
		  FontName		  "Arial"
		  X0			  "initval"
		  InheritSampleTime	  off
		  RTWStateStorageClass	  "Auto"
		}
		Block {
		  BlockType		  Product
		  Name			  "Product"
		  Ports			  [2, 1]
		  Position		  [160, 96, 180, 114]
		  FontName		  "Arial"
		  Inputs		  "2"
		  Multiplication	  "Element-wise(.*)"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Sum
		  Name			  "Sum"
		  Ports			  [2, 1]
		  Position		  [230, 90, 250, 110]
		  FontName		  "Arial"
		  IconShape		  "rectangular"
		  Inputs		  "++"
		  SaturateOnIntegerOverflow on
		}
		Block {
		  BlockType		  Switch
		  Name			  "Switch"
		  Position		  [290, 139, 320, 171]
		  FontName		  "Arial"
		  Threshold		  "eps"
		}
		Block {
		  BlockType		  SubSystem
		  Name			  "dt"
		  Ports			  [0, 1]
		  Position		  [112, 50, 138, 80]
		  Orientation		  "down"
		  ShowPortLabels	  off
		  TreatAsAtomicUnit	  off
		  RTWSystemCode		  "Auto"
		  RTWFcnNameOpts	  "Auto"
		  RTWFileNameOpts	  "Auto"
		  System {
		    Name		    "dt"
		    Location		    [80, 285, 429, 424]
		    Open		    off
		    ModelBrowserVisibility  off
		    ModelBrowserWidth	    200
		    ScreenColor		    "white"
		    PaperOrientation	    "landscape"
		    PaperPositionMode	    "auto"
		    PaperType		    "usletter"
		    PaperUnits		    "inches"
		    ZoomFactor		    "100"
		    Block {
		    BlockType		    Clock
		    Name		    "Clock"
		    Position		    [65, 60, 85, 80]
		    FontName		    "Arial"
		    FontSize		    8
		    DisplayTime		    off
		    Decimation		    "10"
		    }
		    Block {
		    BlockType		    Memory
		    Name		    "Memory1"
		    Position		    [125, 85, 160, 105]
		    FontName		    "Arial"
		    FontSize		    8
		    X0			    "-1"
		    InheritSampleTime	    off
		    RTWStateStorageClass    "Auto"
		    }
		    Block {
		    BlockType		    Sum
		    Name		    "Sum1"
		    Ports		    [2, 1]
		    Position		    [205, 65, 225, 85]
		    FontName		    "Arial"
		    FontSize		    8
		    IconShape		    "rectangular"
		    Inputs		    "+-"
		    SaturateOnIntegerOverflow on
		    }
		    Block {
		    BlockType		    Outport
		    Name		    "out_1"
		    Position		    [255, 65, 275, 85]
		    Port		    "1"
		    OutputWhenDisabled	    "held"
		    InitialOutput	    "0"
		    }
		    Line {
		    SrcBlock		    "Clock"
		    SrcPort		    1
		    Points		    [15, 0]
		    Branch {
		    DstBlock		    "Sum1"
		    DstPort		    1
		    }
		    Branch {
		    Points		    [0, 25]
		    DstBlock		    "Memory1"
		    DstPort		    1
		    }
		    }
		    Line {
		    SrcBlock		    "Memory1"
		    SrcPort		    1
		    Points		    [10, 0; 0, -15]
		    DstBlock		    "Sum1"
		    DstPort		    2
		    }
		    Line {
		    SrcBlock		    "Sum1"
		    SrcPort		    1
		    DstBlock		    "out_1"
		    DstPort		    1
		    }
		  }
		}
		Block {
		  BlockType		  RelationalOperator
		  Name			  "in_2==0"
		  Position		  [160, 143, 190, 167]
		  Operator		  "=="
		}
		Block {
		  BlockType		  Outport
		  Name			  "out_1"
		  Position		  [455, 145, 475, 165]
		  Port			  "1"
		  OutputWhenDisabled	  "held"
		  InitialOutput		  "0"
		}
		Line {
		  SrcBlock		  "in_3"
		  SrcPort		  1
		  Points		  [195, 0; 0, -30]
		  DstBlock		  "Switch"
		  DstPort		  3
		}
		Line {
		  SrcBlock		  "in_2"
		  SrcPort		  1
		  DstBlock		  "in_2==0"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "in_1"
		  SrcPort		  1
		  DstBlock		  "Product"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "dt"
		  SrcPort		  1
		  Points		  [0, 15]
		  DstBlock		  "Product"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Product"
		  SrcPort		  1
		  DstBlock		  "Sum"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Memory"
		  SrcPort		  1
		  Points		  [-130, 0; 0, 30]
		  DstBlock		  "Sum"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Sum"
		  SrcPort		  1
		  Points		  [10, 0; 0, 45]
		  DstBlock		  "Switch"
		  DstPort		  1
		}
		Line {
		  SrcBlock		  "Switch"
		  SrcPort		  1
		  Points		  [85, 0]
		  Branch {
		    DstBlock		    "out_1"
		    DstPort		    1
		  }
		  Branch {
		    Points		    [0, -90]
		    DstBlock		    "Memory"
		    DstPort		    1
		  }
		}
		Line {
		  SrcBlock		  "in_2==0"
		  SrcPort		  1
		  DstBlock		  "Switch"
		  DstPort		  2
		}
		Line {
		  SrcBlock		  "Constant"
		  SrcPort		  1
		  Points		  [15, 0]
		  DstBlock		  "in_2==0"
		  DstPort		  2
		}
	      }
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "FC on"
	      Position		      [695, 268, 725, 282]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"Relational\nOperator7"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator8"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator7"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator9"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator10"
	      SrcPort		      1
	      Points		      [175, 0; 0, -225]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [-5, 0]
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      4
	    }
	    Line {
	      SrcBlock		      "From <vc>"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator5"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -245]
		DstBlock		"Memory"
		DstPort			1
	      }
	      Branch {
		DstBlock		"FC on"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator4"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator9"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator10"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [45, 0]
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum2"
	      SrcPort		      1
	      Points		      [0, -30]
	      DstBlock		      "Relational\nOperator7"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "bus pwr req"
	      SrcPort		      1
	      Points		      [55, 0]
	      Branch {
		Points			[0, -25]
		DstBlock		"Sum2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Relational\nOperator8"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "From <ess>2"
	      SrcPort		      1
	      DstBlock		      "Sum2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant11"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator8"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator5"
	      SrcPort		      1
	      Points		      [0, 30]
	      DstBlock		      "Logical\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "ess max pwr would\nbe insufficient"
	      SrcPort		      1
	      Points		      [465, 0; 0, -300]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "FC pwr\ncommand"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		DstBlock		"Subsystem"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator1"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "SOC"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		Points			[0, -55]
		DstBlock		"Relational\nOperator2"
		DstPort			1
	      }
	      Branch {
		Points			[0, 60]
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Relational\nOperator5"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator2"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator3"
	      SrcPort		      1
	      Points		      [10, 0; 0, 165]
	      DstBlock		      "Logical\nOperator2"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Subsystem"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator4"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      DstBlock		      "no-lag\nReset Integrator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      DstBlock		      "no-lag\nReset Integrator"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "just shut \ndown"
	      SrcPort		      1
	      DstBlock		      "no-lag\nReset Integrator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "no-lag\nReset Integrator"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator3"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      Points		      [-60, 0]
	      Branch {
		DstBlock		"Logical\nOperator2"
		DstPort			1
	      }
	      Branch {
		Points			[-285, 0]
		DstBlock		"just shut \ndown"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [20, 0]
	      Branch {
		DstBlock		"Relational\nOperator2"
		DstPort			2
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			2
	      }
	      Branch {
		Points			[0, -40]
		DstBlock		"Sum"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Relational\nOperator5"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator7"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator6"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [0, 0]
	      Branch {
		Points			[50, 0]
		DstBlock		"Switch"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Logical\nOperator6"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      Points		      [0, -35]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant8"
	      SrcPort		      1
	      Points		      [35, 0]
	      Branch {
		Points			[20, 0; 0, 15]
		DstBlock		"Logical\nOperator7"
		DstPort			1
	      }
	      Branch {
		Points			[0, 90; 75, 0]
		DstBlock		"Logical\nOperator8"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator8"
	      SrcPort		      1
	      Points		      [25, 0]
	      DstBlock		      "Logical\nOperator4"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "dt"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant9"
	      SrcPort		      1
	      Points		      [20, 0]
	      DstBlock		      "Relational\nOperator6"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator6"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator8"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC pwr command,\nmodified by SOC"
	  Ports			  [3, 1]
	  Position		  [225, 149, 255, 181]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC pwr command,\nmodified by SOC"
	    Location		    [187, 74, 960, 426]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "SOC"
	      Position		      [130, 123, 160, 137]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "raw\npwr command\n(W)"
	      Position		      [85, 28, 115, 42]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "pwr req'd at bus (W)"
	      Position		      [205, 43, 235, 57]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [640, 280, 696, 320]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[170, 383, 650, 553]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [222, 17]
		  VerticalAlignment	  "top"
		  Text			  "This block determines the additiona"
"l power required of the fuel convertor\n to maintian an SOC equal to the aver"
"age of cs_hi_soc and cs_lo_soc."
		}
		Annotation {
		  Position		  [242, 57]
		  VerticalAlignment	  "top"
		  Text			  "1/5/98/98:tm  Modified calculation "
"of additional power required to maintain goal SOC\n(SOC_goal - SOC_actual) / "
"(0.5*SOC_range) * cs_charge_pwr\ntherefore when\nactual_SOC=cs_lo_soc ==> 1.0"
"  *cs_charge_pwr\nactual_SOC=goal_SOC ==> 0.0  *cs_charge_pwr\nactual_SOC=cs_"
"hi_soc ==> -1.0 * cs_charge_pwr\n\n2/6/01:tm added if battery disabled - do n"
"ot modify request"
		}
	      }
	    }
	    Block {
	      BlockType		      From
	      Name		      "From <ess>2"
	      Position		      [175, 78, 285, 102]
	      CloseFcn		      "tagdialog Close"
	      GotoTag		      "ess_max_chg_pwr"
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [370, 127, 460, 173]
	      Gain		      "cs_charge_pwr"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain1"
	      Position		      [205, 222, 240, 258]
	      ShowName		      off
	      Gain		      "0.5"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain2"
	      Position		      [495, 51, 520, 79]
	      Gain		      "-1"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Goal SOC"
	      Position		      [35, 177, 175, 203]
	      Value		      "0.5*(cs_hi_soc+cs_lo_soc)"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax1"
	      Ports		      [2, 1]
	      Position		      [495, 97, 525, 128]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Multiplier"
	      Ports		      [2, 1]
	      Position		      [270, 132, 300, 163]
	      ShowName		      off
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "Multiplier1"
	      Ports		      [2, 1]
	      Position		      [615, 57, 645, 88]
	      ShowName		      off
	      Inputs		      "2"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "SOC Range"
	      Position		      [55, 228, 175, 252]
	      Value		      "cs_hi_soc-cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [320, 135, 350, 165]
	      UpperLimit	      "1"
	      LowerLimit	      "-1"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [210, 122, 240, 153]
	      ShowName		      off
	      IconShape		      "rectangular"
	      Inputs		      "-+"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum1"
	      Ports		      [2, 1]
	      Position		      [665, 27, 680, 58]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum4"
	      Ports		      [2, 1]
	      Position		      [335, 67, 365, 98]
	      IconShape		      "rectangular"
	      Inputs		      "+-"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [555, 50, 585, 80]
	      Threshold		      "0"
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "ess state"
	      Position		      [495, 160, 545, 180]
	      Value		      "ess_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "pwr command\nmodifed for SOC\n(W)"
	      Position		      [710, 38, 740, 52]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "Sum4"
	      SrcPort		      1
	      Points		      [110, 0]
	      DstBlock		      "MinMax1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "From <ess>2"
	      SrcPort		      1
	      DstBlock		      "Sum4"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "pwr req'd at bus (W)"
	      SrcPort		      1
	      Points		      [35, 0]
	      Branch {
		Points			[205, 0]
		DstBlock		"Gain2"
		DstPort			1
	      }
	      Branch {
		Points			[0, 25]
		DstBlock		"Sum4"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "raw\npwr command\n(W)"
	      SrcPort		      1
	      DstBlock		      "Sum1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain2"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[65, 0]
		DstBlock		"Switch"
		DstPort			3
	      }
	      Branch {
		Points			[0, -30]
		DstBlock		"MinMax1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "MinMax1"
	      SrcPort		      1
	      Points		      [5, 0; 0, -60]
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Gain1"
	      SrcPort		      1
	      Points		      [5, 0; 0, -85]
	      DstBlock		      "Multiplier"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      DstBlock		      "Gain"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "Multiplier"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Multiplier"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "SOC Range"
	      SrcPort		      1
	      DstBlock		      "Gain1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Goal SOC"
	      SrcPort		      1
	      Points		      [10, 0; 0, -45]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "SOC"
	      SrcPort		      1
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum1"
	      SrcPort		      1
	      DstBlock		      "pwr command\nmodifed for SOC\n(W)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Multiplier1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Multiplier1"
	      SrcPort		      1
	      DstBlock		      "Sum1"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "ess state"
	      SrcPort		      1
	      Points		      [50, 0]
	      DstBlock		      "Multiplier1"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC pwr command,\nw/ limits enforced"
	  Ports			  [3, 1]
	  Position		  [325, 139, 355, 171]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC pwr command,\nw/ limits enforced"
	    Location		    [45, 91, 735, 454]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "ess max pwr would\nbe insufficient"
	      Position		      [45, 33, 75, 47]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "SOC"
	      Position		      [45, 88, 75, 102]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "FC pwr\ncommand"
	      Position		      [45, 243, 75, 257]
	      Port		      "3"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [27, 300, 213, 320]
	      Orientation	      "up"
	      Value		      "cs_min_pwr*fc_spd_scale*fc_trq_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [290, 148, 350, 172]
	      Orientation	      "left"
	      Value		      "cs_lo_soc"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [25, 200, 215, 220]
	      Value		      "cs_max_pwr*fc_spd_scale*fc_trq_scale"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [290, 193, 350, 217]
	      Value		      "ess_on"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [3, 1]
	      Position		      [385, 74, 410, 136]
	      Operator		      "AND"
	      Inputs		      "3"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [305, 24, 335, 56]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax"
	      Ports		      [2, 1]
	      Position		      [140, 242, 170, 273]
	      Function		      "max"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      MinMax
	      Name		      "MinMax1"
	      Ports		      [2, 1]
	      Position		      [255, 237, 285, 268]
	      Function		      "min"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      RateLimiter
	      Name		      "Rate Limiter"
	      Position		      [535, 250, 565, 280]
	      RisingSlewLimit	      "cs_max_pwr_rise_rate*fc_spd_scale*fc_tr"
"q_scale"
	      FallingSlewLimit	      "cs_max_pwr_fall_rate*fc_spd_scale*fc_tr"
"q_scale"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [305, 87, 335, 118]
	      Operator		      ">="
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [460, 250, 490, 280]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "limited\nFC pwr\ncommand\n(W)"
	      Position		      [615, 258, 645, 272]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "ess max pwr would\nbe insufficient"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "SOC"
	      SrcPort		      1
	      DstBlock		      "Relational\nOperator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "FC pwr\ncommand"
	      SrcPort		      1
	      DstBlock		      "MinMax"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax"
	      SrcPort		      1
	      Points		      [45, 0]
	      Branch {
		Points			[0, 35; 225, 0]
		DstBlock		"Switch"
		DstPort			3
	      }
	      Branch {
		DstBlock		"MinMax1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [0, -30]
	      DstBlock		      "MinMax"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      Points		      [30, 0]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-5, 0; 0, -50]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Rate Limiter"
	      SrcPort		      1
	      DstBlock		      "limited\nFC pwr\ncommand\n(W)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "Rate Limiter"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "MinMax1"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [0, 35]
	      DstBlock		      "MinMax1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      3
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "FC trq and spd"
	  Ports			  [2, 1]
	  Position		  [410, 132, 440, 163]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "FC trq and spd"
	    Location		    [97, 99, 939, 407]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "FC on"
	      Position		      [35, 163, 65, 177]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Inport
	      Name		      "power req'd\nby FC (W)"
	      Position		      [35, 73, 65, 87]
	      Port		      "2"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      SubSystem
	      Name		      "Block NOTES"
	      Ports		      []
	      Position		      [770, 255, 826, 295]
	      BackgroundColor	      "green"
	      ShowName		      off
	      ShowPortLabels	      on
	      TreatAsAtomicUnit	      off
	      RTWSystemCode	      "Auto"
	      RTWFcnNameOpts	      "Auto"
	      RTWFileNameOpts	      "Auto"
	      MaskDisplay	      "disp('Block\\nNOTES')"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      System {
		Name			"Block NOTES"
		Location		[622, 566, 1038, 699]
		Open			off
		ModelBrowserVisibility	off
		ModelBrowserWidth	200
		ScreenColor		"white"
		PaperOrientation	"landscape"
		PaperPositionMode	"auto"
		PaperType		"usletter"
		PaperUnits		"inches"
		ZoomFactor		"100"
		Annotation {
		  Position		  [207, 63]
		  Text			  "This block determines the required "
"fuel converter torque and speed from the\nrequired power using a vector usual"
"ly representing the locus of best efficiency\nor lowest emissions points in t"
"he map.  The speed request is cut in half if it is\nnonzero and preceded by a"
" zero speed request to account for the fact that all\nADVISOR's drivetrain co"
"mponents deal in speeds averaged over the time step.\nA speed command here of"
" 1/2 of max. engine speed means that the AVERAGE\nengine speed required is 1/"
"2 of max.  If the previous speed was zero, that means\nthat the speed at the "
"end of the current time step must be equal to max. engine\nspeed."
		}
	      }
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [245, 20, 265, 40]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant5"
	      Position		      [380, 109, 400, 131]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant6"
	      Position		      [380, 199, 400, 221]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant7"
	      Position		      [455, 224, 475, 246]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Gain
	      Name		      "Gain"
	      Position		      [675, 135, 705, 165]
	      Gain		      ".5"
	      Multiplication	      "Element-wise(K.*u)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator"
	      Ports		      [2, 1]
	      Position		      [620, 172, 650, 203]
	      Operator		      "AND"
	      Inputs		      "2"
	    }
	    Block {
	      BlockType		      Logic
	      Name		      "Logical\nOperator1"
	      Ports		      [1, 1]
	      Position		      [565, 219, 595, 251]
	      Operator		      "NOT"
	      Inputs		      "1"
	    }
	    Block {
	      BlockType		      Memory
	      Name		      "Memory"
	      Position		      [515, 220, 545, 250]
	      X0		      "0"
	      InheritSampleTime	      off
	      RTWStateStorageClass    "Auto"
	    }
	    Block {
	      BlockType		      Mux
	      Name		      "Mux"
	      Ports		      [2, 1]
	      Position		      [690, 72, 725, 108]
	      Inputs		      "2"
	      DisplayOption	      "none"
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [450, 162, 480, 193]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [110, 65, 140, 95]
	      UpperLimit	      "max(cs_pwr)"
	      LowerLimit	      "min(cs_pwr)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [240, 57, 270, 88]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch1"
	      Position		      [375, 65, 405, 95]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch2"
	      Position		      [375, 155, 405, 185]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch3"
	      Position		      [730, 175, 760, 205]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "desired\nspd (rad/s)"
	      Position		      [175, 65, 205, 95]
	      InputValues	      "cs_pwr"
	      OutputValues	      "cs_spd"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "desired\ntrq (Nm)"
	      Ports		      [2, 1]
	      Position		      [300, 52, 330, 83]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "engine torque\nand speed\n(Nm), (rad/s)"
	      Position		      [775, 80, 795, 100]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "0"
	    }
	    Line {
	      SrcBlock		      "Switch3"
	      SrcPort		      1
	      Points		      [0, -60; -90, 0]
	      DstBlock		      "Mux"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Gain"
	      SrcPort		      1
	      Points		      [0, 30]
	      DstBlock		      "Switch3"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Switch2"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, -20; 230, 0]
		Branch {
		  Points		  [0, 50]
		  DstBlock		  "Switch3"
		  DstPort		  3
		}
		Branch {
		  DstBlock		  "Gain"
		  DstPort		  1
		}
	      }
	      Branch {
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "Logical\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		DstBlock		"Memory"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Logical\nOperator"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Memory"
	      SrcPort		      1
	      DstBlock		      "Logical\nOperator1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant7"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Logical\nOperator"
	      SrcPort		      1
	      DstBlock		      "Switch3"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch1"
	      SrcPort		      1
	      DstBlock		      "Mux"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Mux"
	      SrcPort		      1
	      DstBlock		      "engine torque\nand speed\n(Nm), (rad/s)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "FC on"
	      SrcPort		      1
	      Points		      [285, 0]
	      Branch {
		DstBlock		"Switch2"
		DstPort			2
	      }
	      Branch {
		Points			[0, -90]
		DstBlock		"Switch1"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "desired\nspd (rad/s)"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 80]
		DstBlock		"Switch2"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			2
	      }
	    }
	    Line {
	      SrcBlock		      "Constant6"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch2"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Constant5"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch1"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [5, 0]
	      Branch {
		Points			[0, -65; 130, 0; 0, 45]
		DstBlock		"desired\ntrq (Nm)"
		DstPort			1
	      }
	      Branch {
		DstBlock		"desired\nspd (rad/s)"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "power req'd\nby FC (W)"
	      SrcPort		      1
	      DstBlock		      "Saturation"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Sum"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "desired\ntrq (Nm)"
	      SrcPort		      1
	      DstBlock		      "Switch1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      DstBlock		      "desired\ntrq (Nm)"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [105, 75, 165, 95]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "SOC"
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>1"
	  Position		  [100, 33, 185, 57]
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "ess_max_pwr"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>2"
	  Position		  [595, 103, 675, 127]
	  GotoTag		  "spd_command"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  Goto
	  Name			  "Goto <fc>3"
	  Position		  [395, 81, 470, 99]
	  GotoTag		  "engine_on"
	  TagVisibility		  "global"
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator"
	  Position		  [215, 12, 245, 43]
	  Operator		  ">="
	}
	Block {
	  BlockType		  Selector
	  Name			  "Selector"
	  Ports			  [1, 1]
	  Position		  [485, 100, 515, 130]
	  InputType		  "Vector"
	  ElementSrc		  "Internal"
	  Elements		  "2"
	  RowSrc		  "Internal"
	  Rows			  "1"
	  ColumnSrc		  "Internal"
	  Columns		  "1"
	  InputPortWidth	  "2"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "power follower"
	  Ports			  []
	  Position		  [481, 194, 512, 237]
	  BackgroundColor	  "yellow"
	  DropShadow		  on
	  OpenFcn		  "web(['file:\\\\\\' which('Series.htm')]);"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "image(imread('doc_man.jpg'))"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "power follower"
	    Location		    [203, 331, 569, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "pwr req'd from\nFC to supply\npwr req'd at "
"bus\n(W)"
	  Ports			  [1, 1]
	  Position		  [120, 150, 150, 180]
	  ShowPortLabels	  off
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  System {
	    Name		    "pwr req'd from\nFC to supply\npwr req'd a"
"t bus\n(W)"
	    Location		    [162, 130, 985, 392]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "power req'd\nby bus (W)"
	      Position		      [15, 43, 45, 57]
	      Port		      "1"
	      LatchInput	      off
	      Interpolate	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant"
	      Position		      [225, 90, 245, 110]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant1"
	      Position		      [460, 45, 480, 65]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant2"
	      Position		      [535, 215, 555, 235]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant3"
	      Position		      [705, 100, 725, 120]
	      Orientation	      "left"
	      Value		      "0"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      Constant
	      Name		      "Constant4"
	      Position		      [575, 85, 595, 105]
	      Orientation	      "left"
	      Value		      "eps"
	      VectorParams1D	      on
	    }
	    Block {
	      BlockType		      RelationalOperator
	      Name		      "Relational\nOperator"
	      Position		      [530, 152, 560, 183]
	      Operator		      ">"
	    }
	    Block {
	      BlockType		      Saturate
	      Name		      "Saturation"
	      Position		      [80, 35, 110, 65]
	      UpperLimit	      "max(cs_pwr)"
	      LowerLimit	      "min(cs_pwr)"
	      LinearizeAsGain	      on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum"
	      Ports		      [2, 1]
	      Position		      [220, 42, 250, 73]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum1"
	      Ports		      [2, 1]
	      Position		      [455, 82, 485, 113]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Sum
	      Name		      "Sum2"
	      Ports		      [2, 1]
	      Position		      [570, 37, 600, 68]
	      IconShape		      "rectangular"
	      Inputs		      "++"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Switch
	      Name		      "Switch"
	      Position		      [700, 50, 730, 80]
	      Threshold		      "eps"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "est.\nefficiency"
	      Ports		      [2, 1]
	      Position		      [510, 27, 540, 58]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup
	      Name		      "est. desired\nspd (rad/s)"
	      Position		      [155, 35, 185, 65]
	      InputValues	      "cs_pwr"
	      OutputValues	      "cs_spd"
	    }
	    Block {
	      BlockType		      Product
	      Name		      "est. desired\ntrq (Nm)"
	      Ports		      [2, 1]
	      Position		      [280, 27, 310, 58]
	      Inputs		      "*/"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Product
	      Name		      "est. pwr\nreq'd into\ngenerator"
	      Ports		      [2, 1]
	      Position		      [635, 37, 665, 68]
	      Inputs		      "/*"
	      Multiplication	      "Element-wise(.*)"
	      SaturateOnIntegerOverflow	on
	    }
	    Block {
	      BlockType		      Lookup2D
	      Name		      "generator\noutput power\nmap (W)"
	      Position		      [345, 16, 410, 54]
	      RowIndex		      "gc_map_spd*gc_spd_scale"
	      ColumnIndex	      "gc_map_trq*gc_trq_scale"
	      OutputValues	      "gc_outpwr_map*gc_spd_scale*gc_trq_scale"
	    }
	    Block {
	      BlockType		      Outport
	      Name		      "pwr req'd\nof FC (W)"
	      Position		      [770, 58, 800, 72]
	      Port		      "1"
	      OutputWhenDisabled      "held"
	      InitialOutput	      "[]"
	    }
	    Line {
	      SrcBlock		      "power req'd\nby bus (W)"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, 110]
		DstBlock		"Relational\nOperator"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Saturation"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "Constant2"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Relational\nOperator"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant1"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Sum1"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum1"
	      SrcPort		      1
	      Points		      [5, 0]
	      DstBlock		      "est.\nefficiency"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "generator\noutput power\nmap (W)"
	      SrcPort		      1
	      DstBlock		      "est.\nefficiency"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Saturation"
	      SrcPort		      1
	      Points		      [15, 0]
	      Branch {
		Points			[0, 80; 310, 0]
		Branch {
		  DstBlock		  "Sum1"
		  DstPort		  2
		}
		Branch {
		  Points		  [180, 0]
		  DstBlock		  "est. pwr\nreq'd into\ngenerator"
		  DstPort		  2
		}
	      }
	      Branch {
		Points			[5, 0]
		Branch {
		  Points		  [0, -35; 130, 0]
		  DstBlock		  "est. desired\ntrq (Nm)"
		  DstPort		  1
		}
		Branch {
		  DstBlock		  "est. desired\nspd (rad/s)"
		  DstPort		  1
		}
	      }
	    }
	    Line {
	      SrcBlock		      "est. desired\nspd (rad/s)"
	      SrcPort		      1
	      Points		      [10, 0]
	      Branch {
		Points			[0, -25]
		DstBlock		"generator\noutput power\nmap (W)"
		DstPort			1
	      }
	      Branch {
		DstBlock		"Sum"
		DstPort			1
	      }
	    }
	    Line {
	      SrcBlock		      "est. desired\ntrq (Nm)"
	      SrcPort		      1
	      DstBlock		      "generator\noutput power\nmap (W)"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Sum"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Sum"
	      SrcPort		      1
	      Points		      [10, 0]
	      DstBlock		      "est. desired\ntrq (Nm)"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Constant3"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Switch"
	      DstPort		      3
	    }
	    Line {
	      SrcBlock		      "Relational\nOperator"
	      SrcPort		      1
	      Points		      [115, 0; 0, -105]
	      DstBlock		      "Switch"
	      DstPort		      2
	    }
	    Line {
	      SrcBlock		      "Switch"
	      SrcPort		      1
	      DstBlock		      "pwr req'd\nof FC (W)"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "est. pwr\nreq'd into\ngenerator"
	      SrcPort		      1
	      DstBlock		      "Switch"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "est.\nefficiency"
	      SrcPort		      1
	      DstBlock		      "Sum2"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Sum2"
	      SrcPort		      1
	      Points		      [15, 0]
	      DstBlock		      "est. pwr\nreq'd into\ngenerator"
	      DstPort		      1
	    }
	    Line {
	      SrcBlock		      "Constant4"
	      SrcPort		      1
	      Points		      [-15, 0]
	      DstBlock		      "Sum2"
	      DstPort		      2
	    }
	  }
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "thermostat"
	  Ports			  []
	  Position		  [411, 194, 442, 237]
	  BackgroundColor	  "yellow"
	  DropShadow		  on
	  OpenFcn		  "web(['file:\\\\\\' which('Series-therm.htm'"
")]);"
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "image(imread('doc_man.jpg'))"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "thermostat"
	    Location		    [203, 331, 569, 538]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	  }
	}
	Block {
	  BlockType		  Outport
	  Name			  "engine torque\nand speed\n(Nm), (rad/s)"
	  Position		  [565, 140, 585, 160]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "0"
	}
	Line {
	  SrcBlock		  "Selector"
	  SrcPort		  1
	  DstBlock		  "Goto <fc>2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "FC trq and spd"
	  SrcPort		  1
	  Points		  [25, 0]
	  Branch {
	    DstBlock		    "Selector"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "engine torque\nand speed\n(Nm), (rad/s)"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "FC pwr command,\nw/ limits enforced"
	  SrcPort		  1
	  DstBlock		  "FC trq and spd"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "FC on"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    DstBlock		    "Goto <fc>3"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 50]
	    DstBlock		    "FC trq and spd"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "power req'd\nby bus (W)"
	  SrcPort		  1
	  Points		  [25, 0]
	  Branch {
	    Points		    [0, 70; 100, 0]
	    Branch {
	      Points		      [100, 0; 0, -130]
	      DstBlock		      "FC on"
	      DstPort		      4
	    }
	    Branch {
	      Points		      [0, -60]
	      DstBlock		      "FC pwr command,\nmodified by SOC"
	      DstPort		      3
	    }
	  }
	  Branch {
	    Points		    [0, -145]
	    DstBlock		    "Relational\nOperator"
	    DstPort		    1
	  }
	  Branch {
	    DstBlock		    "pwr req'd from\nFC to supply\npwr req'd a"
"t bus\n(W)"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "From <ess>1"
	  SrcPort		  1
	  Points		  [10, 0]
	  DstBlock		  "Relational\nOperator"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Relational\nOperator"
	  SrcPort		  1
	  Points		  [50, 0; 0, 45]
	  Branch {
	    DstBlock		    "FC on"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 70]
	    DstBlock		    "FC pwr command,\nw/ limits enforced"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "pwr req'd from\nFC to supply\npwr req'd at "
"bus\n(W)"
	  SrcPort		  1
	  DstBlock		  "FC pwr command,\nmodified by SOC"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "FC pwr command,\nmodified by SOC"
	  SrcPort		  1
	  Points		  [5, 0]
	  Branch {
	    DstBlock		    "FC pwr command,\nw/ limits enforced"
	    DstPort		    3
	  }
	  Branch {
	    Points		    [0, -70]
	    DstBlock		    "FC on"
	    DstPort		    3
	  }
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    Points		    [90, 0]
	    Branch {
	      DstBlock		      "FC on"
	      DstPort		      2
	    }
	    Branch {
	      Points		      [0, 70]
	      DstBlock		      "FC pwr command,\nw/ limits enforced"
	      DstPort		      2
	    }
	  }
	  Branch {
	    Points		    [0, 70]
	    DstBlock		    "FC pwr command,\nmodified by SOC"
	    DstPort		    1
	  }
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "user contributed engine on\n(balanced parallel "
"hybrid)"
      Ports		      [5, 3]
      Position		      [770, 189, 805, 301]
      AncestorBlock	      "lib_controls/<vc> ISG bal shift\nby time CD3xx/"
"engine on\n(balanced parallel hybrid)"
      ShowPortLabels	      off
      TreatAsAtomicUnit	      off
      RTWSystemCode	      "Auto"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      System {
	Name			"user contributed engine on\n(balanced paralle"
"l hybrid)"
	Location		[228, 106, 1040, 776]
	Open			off
	ModelBrowserVisibility	on
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	ZoomFactor		"80"
	Block {
	  BlockType		  Inport
	  Name			  "trq req'd\nout of clutch\n(N*m)"
	  Position		  [190, 18, 220, 32]
	  Port			  "1"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Inport
	  Name			  "spd req'd\nout of clutch\n(N*m)1"
	  Position		  [185, 88, 215, 102]
	  Port			  "2"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Inport
	  Name			  "fc_spd_out_r"
	  Position		  [595, 543, 625, 557]
	  Port			  "3"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Inport
	  Name			  "v_ave_req"
	  Position		  [330, 513, 360, 527]
	  Port			  "4"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Inport
	  Name			  "clutch\nstate"
	  Position		  [285, 458, 315, 472]
	  Port			  "5"
	  LatchInput		  off
	  Interpolate		  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "(--)2"
	  Position		  [695, 45, 735, 65]
	  Value			  "fc_on"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "(--)3"
	  Position		  [625, 256, 655, 274]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Value			  "1"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "(--)4"
	  Position		  [280, 285, 350, 305]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Value			  "cs_lo_soc"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Block NOTES"
	  Ports			  []
	  Position		  [45, 65, 101, 105]
	  BackgroundColor	  "green"
	  ShowName		  off
	  ShowPortLabels	  on
	  TreatAsAtomicUnit	  off
	  RTWSystemCode		  "Auto"
	  RTWFcnNameOpts	  "Auto"
	  RTWFileNameOpts	  "Auto"
	  MaskDisplay		  "disp('Block\\nNOTES')"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  System {
	    Name		    "Block NOTES"
	    Location		    [232, 291, 754, 446]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    ZoomFactor		    "100"
	    Annotation {
	      Position		      [260, 77]
	      Text		      "this user-contributed model came from S"
"erve Ploumen-Research Engineer in Energy Management\n at Ford Forschungszentr"
"um Aachen GmbH (Ford Research Centre Aachen)\nThe following is from the email"
":\nFor integrated Starter/generator equipped vehicles, we found it important "
"to make the activation of \nengine start-stop dependent on thetime needed for"
" the engine-warmup (or catalyst warmup if you like)\n and also dependent in t"
"he SOC of the energy storage device. Furthermore we found \nit important to d"
"elay the engine shut-down after the vehicle has come to a stop after a brakin"
"g period. \n\nTherefore we implemented these functionality in the control str"
"ategy of Advisor's parallel hybrid model.\n"
	    }
	  }
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant1"
	  Position		  [320, 363, 440, 387]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Value			  "vc_eng_warmup_time"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant2"
	  Position		  [105, 189, 245, 211]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Value			  "engine_shutdown_delay"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant3"
	  Position		  [580, 499, 660, 521]
	  ShowName		  off
	  Value			  "vc_launch_spd"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant4"
	  Position		  [340, 470, 360, 490]
	  Value			  "1"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant5"
	  Position		  [385, 525, 405, 545]
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant6"
	  Position		  [265, 565, 285, 585]
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant7"
	  Position		  [825, 540, 845, 560]
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant8"
	  Position		  [815, 90, 835, 110]
	  Orientation		  "down"
	  NamePlacement		  "alternate"
	  ShowName		  off
	  Value			  "1"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  Constant
	  Name			  "Constant9"
	  Position		  [100, 235, 120, 255]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Value			  "0"
	  VectorParams1D	  on
	}
	Block {
	  BlockType		  From
	  Name			  "From <ess>"
	  Position		  [330, 254, 375, 276]
	  ForegroundColor	  "blue"
	  NamePlacement		  "alternate"
	  ShowName		  off
	  CloseFcn		  "tagdialog Close"
	  GotoTag		  "SOC"
	}
	Block {
	  BlockType		  HitCross
	  Name			  "Hit \nCrossing1"
	  Ports			  [1, 1]
	  Position		  [195, 225, 225, 255]
	  ForegroundColor	  "blue"
	  HitCrossingOffset	  "0"
	  HitCrossingDirection	  "rising"
	  ShowOutputPort	  on
	}
	Block {
	  BlockType		  Logic
	  Name			  "Logical\nOperator10"
	  Ports			  [3, 1]
	  Position		  [520, 501, 550, 559]
	  ShowName		  off
	  Operator		  "AND"
	  Inputs		  "3"
	}
	Block {
	  BlockType		  Logic
	  Name			  "Logical\nOperator12"
	  Ports			  [3, 1]
	  Position		  [775, 113, 800, 207]
	  ShowName		  off
	  Operator		  "AND"
	  Inputs		  "3"
	}
	Block {
	  BlockType		  Logic
	  Name			  "Logical\nOperator2"
	  Ports			  [2, 1]
	  Position		  [545, 250, 575, 345]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Operator		  "AND"
	  Inputs		  "2"
	}
	Block {
	  BlockType		  RateLimiter
	  Name			  "Rate Limiter1"
	  Position		  [250, 225, 280, 255]
	  ForegroundColor	  "blue"
	  RisingSlewLimit	  "inf"
	  FallingSlewLimit	  "-1/1"
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "Relational\nOperator1"
	  Position		  [475, 317, 505, 348]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Operator		  ">"
	}
	Block {
	  BlockType		  Saturate
	  Name			  "Saturation"
	  Position		  [775, 515, 805, 545]
	  UpperLimit		  "max(fc_map_spd)*fc_spd_scale"
	  LowerLimit		  "vc_idle_spd*vc_idle_bool"
	  LinearizeAsGain	  on
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch"
	  Position		  [695, 503, 725, 557]
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch1"
	  Position		  [895, 524, 920, 556]
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch2"
	  Position		  [380, 194, 410, 236]
	  ForegroundColor	  "blue"
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch3"
	  Position		  [695, 209, 725, 251]
	  ForegroundColor	  "blue"
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  Switch
	  Name			  "Switch4"
	  Position		  [855, 134, 880, 166]
	  Threshold		  "eps"
	}
	Block {
	  BlockType		  Terminator
	  Name			  "Terminator"
	  Position		  [290, 15, 310, 35]
	}
	Block {
	  BlockType		  Terminator
	  Name			  "Terminator1"
	  Position		  [290, 85, 310, 105]
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "clutch\ndisengaged"
	  Position		  [400, 457, 430, 488]
	  Operator		  "=="
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "clutch\ndisengaged1"
	  Position		  [145, 222, 175, 253]
	  ForegroundColor	  "blue"
	  Operator		  "=="
	}
	Block {
	  BlockType		  Reference
	  Name			  "key_on"
	  Ports			  [0, 1]
	  Position		  [480, 84, 535, 116]
	  NamePlacement		  "alternate"
	  SourceBlock		  "lib_controls/<vc> ISG bal shift\nby time CD"
"3xx/engine on\n(balanced parallel hybrid)/key_on"
	  SourceType		  "Repeating table"
	  MaskParam1		  "vc_key_on(:,1)"
	  MaskParam2		  "vc_key_on(:,2)"
	  Port {
	    PortNumber		    1
	    Name		    "ignition key is on"
	    TestPoint		    off
	    LinearAnalysisOutput    off
	    LinearAnalysisInput	    off
	    RTWStorageClass	    "Auto"
	  }
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "moving next\ntime"
	  Position		  [325, 552, 355, 583]
	  Operator		  ">"
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "moving next\ntime1"
	  Position		  [415, 257, 445, 288]
	  ForegroundColor	  "blue"
	  ShowName		  off
	  Operator		  ">="
	}
	Block {
	  BlockType		  RelationalOperator
	  Name			  "not\nmoving"
	  Position		  [460, 512, 490, 543]
	  Operator		  "=="
	}
	Block {
	  BlockType		  Reference
	  Name			  "repeated cycle time"
	  Ports			  [0, 1]
	  Position		  [360, 307, 395, 343]
	  ForegroundColor	  "blue"
	  FontName		  "Arial"
	  SourceBlock		  "lib_controls/<vc> ISG bal shift\nby time CD"
"3xx/engine on\n(balanced parallel hybrid)/repeated cycle time"
	  SourceType		  "Forward looking repeating table"
	  t			  "cyc_mph(:,1)"
	  y			  "cyc_mph(:,1)"
	}
	Block {
	  BlockType		  Reference
	  Name			  "repeated cycle:\n speed required at\nend of"
" NEXT step"
	  Ports			  [0, 1]
	  Position		  [30, 497, 65, 533]
	  ForegroundColor	  "blue"
	  FontName		  "Arial"
	  SourceBlock		  "lib_controls/<vc> ISG bal shift\nby time CD"
"3xx/engine on\n(balanced parallel hybrid)/repeated cycle:\n speed required at"
"\nend of NEXT step"
	  SourceType		  "Forward looking repeating table"
	  t			  "cyc_mph(:,1)"
	  y			  "cyc_mph(:,2)"
	}
	Block {
	  BlockType		  Outport
	  Name			  "engine on"
	  Position		  [930, 143, 960, 157]
	  Port			  "1"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Block {
	  BlockType		  Outport
	  Name			  "spd command\n (rad/s)"
	  Position		  [950, 533, 980, 547]
	  Port			  "2"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Block {
	  BlockType		  Outport
	  Name			  "key on"
	  Position		  [700, 93, 730, 107]
	  Port			  "3"
	  OutputWhenDisabled	  "held"
	  InitialOutput		  "[]"
	}
	Line {
	  SrcBlock		  "trq req'd\nout of clutch\n(N*m)"
	  SrcPort		  1
	  DstBlock		  "Terminator"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "spd req'd\nout of clutch\n(N*m)1"
	  SrcPort		  1
	  DstBlock		  "Terminator1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Logical\nOperator2"
	  SrcPort		  1
	  Points		  [25, 0; 0, -70]
	  DstBlock		  "Switch3"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Relational\nOperator1"
	  SrcPort		  1
	  Points		  [20, 0]
	  DstBlock		  "Logical\nOperator2"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Switch3"
	  SrcPort		  1
	  Points		  [25, 0; 0, -40]
	  DstBlock		  "Logical\nOperator12"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "moving next\ntime1"
	  SrcPort		  1
	  DstBlock		  "Logical\nOperator2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "(--)3"
	  SrcPort		  1
	  Points		  [10, 0; 0, -20]
	  DstBlock		  "Switch3"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Constant1"
	  SrcPort		  1
	  Points		  [10, 0; 0, -35]
	  DstBlock		  "Relational\nOperator1"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "repeated cycle time"
	  SrcPort		  1
	  DstBlock		  "Relational\nOperator1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "From <ess>"
	  SrcPort		  1
	  DstBlock		  "moving next\ntime1"
	  DstPort		  1
	}
	Line {
	  Name			  "ignition key is on"
	  Labels		  [0, 0]
	  SrcBlock		  "key_on"
	  SrcPort		  1
	  Points		  [0, 0; 125, 0]
	  Branch {
	    Points		    [0, 60]
	    DstBlock		    "Logical\nOperator12"
	    DstPort		    2
	  }
	  Branch {
	    DstBlock		    "key on"
	    DstPort		    1
	  }
	}
	Line {
	  SrcBlock		  "(--)2"
	  SrcPort		  1
	  Points		  [15, 0; 0, 75]
	  DstBlock		  "Logical\nOperator12"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant3"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Switch"
	  SrcPort		  1
	  DstBlock		  "Saturation"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Logical\nOperator10"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "fc_spd_out_r"
	  SrcPort		  1
	  DstBlock		  "Switch"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Saturation"
	  SrcPort		  1
	  DstBlock		  "Switch1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "clutch\nstate"
	  SrcPort		  1
	  DstBlock		  "clutch\ndisengaged"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Switch1"
	  SrcPort		  1
	  DstBlock		  "spd command\n (rad/s)"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant7"
	  SrcPort		  1
	  DstBlock		  "Switch1"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Constant4"
	  SrcPort		  1
	  DstBlock		  "clutch\ndisengaged"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "v_ave_req"
	  SrcPort		  1
	  DstBlock		  "not\nmoving"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant5"
	  SrcPort		  1
	  DstBlock		  "not\nmoving"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "repeated cycle:\n speed required at\nend of"
" NEXT step"
	  SrcPort		  1
	  Points		  [15, 0]
	  Branch {
	    Points		    [225, 0]
	    DstBlock		    "moving next\ntime"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, -285]
	    Branch {
	      Points		      [0, -15]
	      DstBlock		      "Switch2"
	      DstPort		      2
	    }
	    Branch {
	      DstBlock		      "clutch\ndisengaged1"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "Constant6"
	  SrcPort		  1
	  DstBlock		  "moving next\ntime"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "clutch\ndisengaged"
	  SrcPort		  1
	  Points		  [70, 0]
	  DstBlock		  "Logical\nOperator10"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "not\nmoving"
	  SrcPort		  1
	  DstBlock		  "Logical\nOperator10"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "moving next\ntime"
	  SrcPort		  1
	  Points		  [0, 0; 140, 0]
	  Branch {
	    Points		    [0, -20]
	    DstBlock		    "Logical\nOperator10"
	    DstPort		    3
	  }
	  Branch {
	    Points		    [65, 0; 0, -80; 250, 0; 0, -340]
	    DstBlock		    "Switch4"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "(--)4"
	  SrcPort		  1
	  Points		  [25, 0; 0, -15]
	  DstBlock		  "moving next\ntime1"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "Logical\nOperator12"
	  SrcPort		  1
	  DstBlock		  "Switch4"
	  DstPort		  3
	}
	Line {
	  SrcBlock		  "Constant8"
	  SrcPort		  1
	  Points		  [0, 25]
	  DstBlock		  "Switch4"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Switch4"
	  SrcPort		  1
	  Points		  [0, 0; 20, 0]
	  Branch {
	    DstBlock		    "engine on"
	    DstPort		    1
	  }
	  Branch {
	    Points		    [0, 40; -50, 0; 0, 350]
	    DstBlock		    "Switch1"
	    DstPort		    2
	  }
	}
	Line {
	  SrcBlock		  "Switch2"
	  SrcPort		  1
	  Points		  [0, 0]
	  DstBlock		  "Switch3"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant2"
	  SrcPort		  1
	  DstBlock		  "Switch2"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Constant9"
	  SrcPort		  1
	  DstBlock		  "clutch\ndisengaged1"
	  DstPort		  2
	}
	Line {
	  SrcBlock		  "clutch\ndisengaged1"
	  SrcPort		  1
	  DstBlock		  "Hit \nCrossing1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Hit \nCrossing1"
	  SrcPort		  1
	  DstBlock		  "Rate Limiter1"
	  DstPort		  1
	}
	Line {
	  SrcBlock		  "Rate Limiter1"
	  SrcPort		  1
	  Points		  [35, 0; 0, -10]
	  DstBlock		  "Switch2"
	  DstPort		  3
	}
      }
    }
    Annotation {
      Position		      [81, 21]
      ForegroundColor	      "blue"
      BackgroundColor	      "yellow"
      Text		      "Vehicle Controls:"
      DropShadow	      on
      FontName		      "Arial"
      FontSize		      14
    }
    Annotation {
      Position		      [55, 54]
      Text		      "Conventional"
    }
    Annotation {
      Position		      [60, 449]
      Text		      "Series"
    }
    Annotation {
      Position		      [51, 143]
      Text		      "Parallel"
    }
    Annotation {
      Position		      [58, 559]
      Text		      "Fuel Cell"
    }
    Annotation {
      Position		      [56, 668]
      Text		      "EV"
    }
    Annotation {
      Position		      [60, 752]
      Text		      "Other"
    }
    Annotation {
      Position		      [411, 124]
      Text		      "-----------------------------------------------"
"-----------------------------------------------------------------------------"
"-----------------------------------------------------------------------------"
"------------------------------------------------------------"
    }
    Annotation {
      Position		      [211, 419]
      Text		      "-----------------------------------------------"
"-------------------------------------------------------------------------"
    }
    Annotation {
      Position		      [216, 529]
      Text		      "-----------------------------------------------"
"-------------------------------------------------------------------------"
    }
    Annotation {
      Position		      [211, 634]
      Text		      "-----------------------------------------------"
"-------------------------------------------------------------------------"
    }
    Annotation {
      Position		      [601, 529]
      Text		      "-----------------------------------------------"
"-------------------------------------------------------------------------"
    }
    Annotation {
      Position		      [531, 18]
      Text		      "Saber Co-simulation"
    }
    Annotation {
      Position		      [474, 449]
      Text		      "control sub-models"
    }
    Annotation {
      Position		      [601, 419]
      Text		      "-----------------------------------------------"
"-------------------------------------------------------------------------"
    }
    Annotation {
      Position		      [474, 548]
      Text		      "Fuzzy Logic"
    }
    Annotation {
      Position		      [601, 634]
      Text		      "-----------------------------------------------"
"-------------------------------------------------------------------------"
    }
    Annotation {
      Position		      [408, 662]
      Text		      "Configurable Subsystem for BD_PAR the <cs> bloc"
"ks"
    }
    Annotation {
      Position		      [403, 752]
      Text		      "Configurable Subsystem for BD_PAR the <vc> bloc"
"ks"
    }
    Annotation {
      Position		      [675, 679]
      Text		      "Configurable subsystem for BD_FUELCELL the <cs>"
" blocks"
    }
  }
}
